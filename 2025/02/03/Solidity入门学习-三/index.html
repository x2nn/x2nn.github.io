<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="é‡è½½ Solidityä¸­å…è®¸å‡½æ•°è¿›è¡Œé‡è½½ï¼ˆoverloadingï¼‰ï¼Œå³åå­—ç›¸åŒä½†è¾“å…¥å‚æ•°ç±»å‹ä¸åŒçš„å‡½æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œä»–ä»¬è¢«è§†ä¸ºä¸åŒçš„å‡½æ•°ã€‚æ³¨æ„ï¼ŒSolidityä¸å…è®¸ä¿®é¥°å™¨ï¼ˆmodifierï¼‰é‡è½½ã€‚ æµ‹è¯•ä»£ç Overloading.solï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516&#x2F;&#x2F; SPDX-License-Identifier: MITpragma solidity ^0.8.2">
<meta property="og:type" content="article">
<meta property="og:title" content="Solidityå…¥é—¨å­¦ä¹ (ä¸‰)">
<meta property="og:url" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/index.html">
<meta property="og:site_name" content="X2n.">
<meta property="og:description" content="é‡è½½ Solidityä¸­å…è®¸å‡½æ•°è¿›è¡Œé‡è½½ï¼ˆoverloadingï¼‰ï¼Œå³åå­—ç›¸åŒä½†è¾“å…¥å‚æ•°ç±»å‹ä¸åŒçš„å‡½æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œä»–ä»¬è¢«è§†ä¸ºä¸åŒçš„å‡½æ•°ã€‚æ³¨æ„ï¼ŒSolidityä¸å…è®¸ä¿®é¥°å™¨ï¼ˆmodifierï¼‰é‡è½½ã€‚ æµ‹è¯•ä»£ç Overloading.solï¼Œå¦‚ä¸‹ï¼š 12345678910111213141516&#x2F;&#x2F; SPDX-License-Identifier: MITpragma solidity ^0.8.2">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204032523893.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204035623180.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204041504259.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204160942747.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204161621064.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204164248838.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172302122.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172327987.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172500152.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172829438.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204165726035.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204165840188.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204170920553.png">
<meta property="article:published_time" content="2025-02-02T18:20:13.000Z">
<meta property="article:modified_time" content="2025-02-05T15:39:27.637Z">
<meta property="article:author" content="ğŸ’—">
<meta property="article:tag" content="ä»¥å¤ªåŠ">
<meta property="article:tag" content="solidity">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204032523893.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Solidityå…¥é—¨å­¦ä¹ (ä¸‰)</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="X2n." type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&text=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&is_video=false&description=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)&body=Check out this article: https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&name=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&t=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E8%BD%BD"><span class="toc-number">1.</span> <span class="toc-text">é‡è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="toc-number">1.1.</span> <span class="toc-text">å‡½æ•°é‡è½½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E5%8C%B9%E9%85%8D%EF%BC%88Argument-Matching%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">å‚æ•°åŒ¹é…ï¼ˆArgument Matchingï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%93%E5%90%88%E7%BA%A6"><span class="toc-number">2.</span> <span class="toc-text">åº“åˆçº¦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%93%E5%90%88%E7%BA%A6-2"><span class="toc-number">2.1.</span> <span class="toc-text">åº“åˆçº¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Strings%E5%BA%93%E5%90%88%E7%BA%A6"><span class="toc-number">2.2.</span> <span class="toc-text">Stringsåº“åˆçº¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BA%93%E5%90%88%E7%BA%A6%EF%BC%9F"><span class="toc-number">2.3.</span> <span class="toc-text">å¦‚ä½•ä½¿ç”¨åº“åˆçº¦ï¼Ÿ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Import"><span class="toc-number">3.</span> <span class="toc-text">Import</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Import%E7%94%A8%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">Importç”¨æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%AF%BC%E5%85%A5%E7%BB%93%E6%9E%9C"><span class="toc-number">3.2.</span> <span class="toc-text">æµ‹è¯•å¯¼å…¥ç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E5%92%8C%E5%8F%91%E9%80%81ETH"><span class="toc-number">4.</span> <span class="toc-text">æ¥æ”¶å’Œå‘é€ETH</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6ETH"><span class="toc-number">4.1.</span> <span class="toc-text">æ¥æ”¶ETH</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6ETH%E5%87%BD%E6%95%B0receive"><span class="toc-number">4.1.1.</span> <span class="toc-text">æ¥æ”¶ETHå‡½æ•°receive</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E9%80%80ETH%E5%87%BD%E6%95%B0fallback"><span class="toc-number">4.1.2.</span> <span class="toc-text">å›é€€ETHå‡½æ•°fallback</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#receive%E5%92%8Cfallback%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">4.1.3.</span> <span class="toc-text">receiveå’Œfallbackçš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA"><span class="toc-number">4.1.4.</span> <span class="toc-text">æµ‹è¯•ä»£ç æ¼”ç¤º</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E9%80%81ETH"><span class="toc-number">4.2.</span> <span class="toc-text">å‘é€ETH</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6ETH%E5%90%88%E7%BA%A6"><span class="toc-number">4.2.1.</span> <span class="toc-text">æ¥æ”¶ETHåˆçº¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81ETH%E5%90%88%E7%BA%A6"><span class="toc-number">4.2.2.</span> <span class="toc-text">å‘é€ETHåˆçº¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Transfer%E7%94%A8%E6%B3%95-%E6%AC%A1%E4%BC%98"><span class="toc-number">4.2.3.</span> <span class="toc-text">Transferç”¨æ³•(æ¬¡ä¼˜)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Send%E7%94%A8%E6%B3%95"><span class="toc-number">4.2.4.</span> <span class="toc-text">Sendç”¨æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Call%E7%94%A8%E6%B3%95-%E6%8F%90%E5%80%A1%E4%BD%BF%E7%94%A8"><span class="toc-number">4.2.5.</span> <span class="toc-text">Callç”¨æ³•(æå€¡ä½¿ç”¨)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.2.6.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Solidityå…¥é—¨å­¦ä¹ (ä¸‰)
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ğŸ’—</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-02-02T18:20:13.000Z" class="dt-published" itemprop="datePublished">2025-02-03</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Web3/">Web3</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/solidity/" rel="tag">solidity</a>, <a class="p-category" href="/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/" rel="tag">ä»¥å¤ªåŠ</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="é‡è½½">é‡è½½</h2>
<p><code>Solidity</code>ä¸­å…è®¸å‡½æ•°è¿›è¡Œé‡è½½ï¼ˆ<code>overloading</code>ï¼‰ï¼Œå³åå­—ç›¸åŒä½†è¾“å…¥å‚æ•°ç±»å‹ä¸åŒçš„å‡½æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œä»–ä»¬è¢«è§†ä¸ºä¸åŒçš„å‡½æ•°ã€‚æ³¨æ„ï¼Œ<strong><code>Solidity</code>ä¸å…è®¸ä¿®é¥°å™¨ï¼ˆ<code>modifier</code>ï¼‰é‡è½½ã€‚</strong></p>
<p>æµ‹è¯•ä»£ç <code>Overloading.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Overloading&#123;</span><br><span class="line">    function saySomething() public pure returns(string memory)&#123;</span><br><span class="line">        return (&quot;Nothing&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    function saySomething(string memory something) public pure returns (string memory) &#123;</span><br><span class="line">        return(something);</span><br><span class="line">    &#125;</span><br><span class="line">    function f(uint8 _in) public pure returns (uint8 out) &#123;</span><br><span class="line">        out = _in;</span><br><span class="line">    &#125;</span><br><span class="line">    function f(uint256 _in) public pure returns (uint256 out) &#123;</span><br><span class="line">        out = _in;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å‡½æ•°é‡è½½">å‡½æ•°é‡è½½</h3>
<p>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸¤ä¸ªéƒ½å«<code>saySomething()</code>çš„å‡½æ•°ï¼Œä¸€ä¸ªæ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œè¾“å‡º<code>&quot;Nothing&quot;</code>ï¼›å¦ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ª<code>string</code>å‚æ•°ï¼Œè¾“å‡ºè¿™ä¸ª<code>string</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function saySomething() public pure returns(string memory)&#123;</span><br><span class="line">        return (&quot;Nothing&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    function saySomething(string memory something) public pure returns (string memory) &#123;</span><br><span class="line">        return(something);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆé‡è½½å‡½æ•°åœ¨ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘åï¼Œç”±äºä¸åŒçš„å‚æ•°ç±»å‹ï¼Œéƒ½å˜æˆäº†ä¸åŒçš„å‡½æ•°é€‰æ‹©å™¨ï¼ˆselectorï¼‰ã€‚</p>
<p>ä»¥ <code>Overloading.sol</code> åˆçº¦ä¸ºä¾‹ï¼Œåœ¨ Remix ä¸Šç¼–è¯‘éƒ¨ç½²åï¼Œåˆ†åˆ«è°ƒç”¨é‡è½½å‡½æ•° <code>saySomething()</code> å’Œ <code>saySomething(string memory something)</code>ï¼Œå¯ä»¥çœ‹åˆ°ä»–ä»¬è¿”å›äº†ä¸åŒçš„ç»“æœï¼Œè¢«åŒºåˆ†ä¸ºä¸åŒçš„å‡½æ•°ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204032523893.png" alt="image-20250204032523893"></p>
<h3 id="å‚æ•°åŒ¹é…ï¼ˆArgument-Matchingï¼‰">å‚æ•°åŒ¹é…ï¼ˆArgument Matchingï¼‰</h3>
<p>åœ¨è°ƒç”¨é‡è½½å‡½æ•°æ—¶ï¼Œä¼šæŠŠè¾“å…¥çš„å®é™…å‚æ•°å’Œå‡½æ•°å‚æ•°çš„å˜é‡ç±»å‹åšåŒ¹é…ã€‚ å¦‚æœå‡ºç°å¤šä¸ªåŒ¹é…çš„é‡è½½å‡½æ•°ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­æœ‰ä¸¤ä¸ªå«<code>f()</code>çš„å‡½æ•°ï¼Œä¸€ä¸ªå‚æ•°ä¸º<code>uint8</code>ï¼Œå¦ä¸€ä¸ªä¸º<code>uint256</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function f(uint8 _in) public pure returns (uint8 out) &#123;</span><br><span class="line">    out = _in;</span><br><span class="line">&#125;</span><br><span class="line">function f(uint256 _in) public pure returns (uint256 out) &#123;</span><br><span class="line">    out = _in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è°ƒç”¨<code>f(50)</code>ï¼Œå› ä¸º<code>50</code>æ—¢å¯ä»¥è¢«è½¬æ¢ä¸º<code>uint8</code>ï¼Œä¹Ÿå¯ä»¥è¢«è½¬æ¢ä¸º<code>uint256</code>ï¼Œå› æ­¤ä¼šæŠ¥é”™ã€‚</p>
<h2 id="åº“åˆçº¦">åº“åˆçº¦</h2>
<p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç”¨<code>ERC721</code>çš„å¼•ç”¨çš„åº“åˆçº¦<code>Strings</code>ä¸ºä¾‹ä»‹ç»<code>Solidity</code>ä¸­çš„åº“åˆçº¦ï¼ˆ<code>Library</code>ï¼‰ï¼Œå¹¶æ€»ç»“äº†å¸¸ç”¨çš„åº“åˆçº¦ã€‚</p>
<p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Library.sol</code>å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">library Strings &#123;</span><br><span class="line">    bytes16 private constant _HEX_SYMBOLS = &quot;0123456789abcdef&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        // Inspired by OraclizeAPI&#x27;s implementation - MIT licence</span><br><span class="line">        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol</span><br><span class="line"></span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 digits;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            digits++;</span><br><span class="line">            temp /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        bytes memory buffer = new bytes(digits);</span><br><span class="line">        while (value != 0) &#123;</span><br><span class="line">            digits -= 1;</span><br><span class="line">            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));</span><br><span class="line">            value /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0x00&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 length = 0;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            length++;</span><br><span class="line">            temp &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return toHexString(value, length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value, uint256 length) public pure returns (string memory) &#123;</span><br><span class="line">        bytes memory buffer = new bytes(2 * length + 2);</span><br><span class="line">        buffer[0] = &quot;0&quot;;</span><br><span class="line">        buffer[1] = &quot;x&quot;;</span><br><span class="line">        for (uint256 i = 2 * length + 1; i &gt; 1; --i) &#123;</span><br><span class="line">            buffer[i] = _HEX_SYMBOLS[value &amp; 0xf];</span><br><span class="line">            value &gt;&gt;= 4;</span><br><span class="line">        &#125;</span><br><span class="line">        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ç”¨å‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªåº“åˆçº¦</span><br><span class="line">contract UseLibrary&#123;    </span><br><span class="line">    // åˆ©ç”¨using foræ“ä½œä½¿ç”¨åº“</span><br><span class="line">    using Strings for uint256;</span><br><span class="line">    function getString1(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">        // åº“å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ ä¸ºuint256å‹å˜é‡çš„æˆå‘˜</span><br><span class="line">        return _number.toHexString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // ç›´æ¥é€šè¿‡åº“åˆçº¦åè°ƒç”¨</span><br><span class="line">    function getString2(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">        return Strings.toHexString(_number);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åº“åˆçº¦-2">åº“åˆçº¦</h3>
<p>åº“åˆçº¦æ˜¯ä¸€ç§ç‰¹æ®Šçš„åˆçº¦ï¼Œä¸ºäº†æå‡<code>Solidity</code>ä»£ç çš„å¤ç”¨æ€§å’Œå‡å°‘<code>gas</code>è€Œå­˜åœ¨ã€‚åº“åˆçº¦æ˜¯ä¸€ç³»åˆ—çš„å‡½æ•°åˆé›†ï¼Œç”±å¤§ç¥æˆ–è€…é¡¹ç›®æ–¹åˆ›ä½œï¼Œå’±ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œä¼šç”¨å°±è¡Œäº†ã€‚</p>
<p>ä»–å’Œæ™®é€šåˆçº¦ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸åŒï¼š</p>
<ol>
<li>ä¸èƒ½å­˜åœ¨çŠ¶æ€å˜é‡</li>
<li>ä¸èƒ½å¤Ÿç»§æ‰¿æˆ–è¢«ç»§æ‰¿</li>
<li>ä¸èƒ½æ¥æ”¶ä»¥å¤ªå¸</li>
<li>ä¸å¯ä»¥è¢«é”€æ¯</li>
</ol>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåº“åˆçº¦ä¸­çš„å‡½æ•°å¯è§æ€§å¦‚æœè¢«è®¾ç½®ä¸º<code>public</code>æˆ–è€…<code>external</code>ï¼Œåˆ™åœ¨è°ƒç”¨å‡½æ•°æ—¶ä¼šè§¦å‘ä¸€æ¬¡<code>delegatecall</code>ã€‚è€Œå¦‚æœè¢«è®¾ç½®ä¸º<code>internal</code>ï¼Œåˆ™ä¸ä¼šå¼•èµ·ã€‚å¯¹äºè®¾ç½®ä¸º<code>private</code>å¯è§æ€§çš„å‡½æ•°æ¥è¯´ï¼Œå…¶ä»…èƒ½åœ¨åº“åˆçº¦ä¸­å¯è§ï¼Œåœ¨å…¶ä»–åˆçº¦ä¸­ä¸å¯ç”¨ã€‚</p>
<h3 id="Stringsåº“åˆçº¦">Stringsåº“åˆçº¦</h3>
<p><code>Stringsåº“åˆçº¦</code>æ˜¯å°†<code>uint256</code>ç±»å‹è½¬æ¢ä¸ºç›¸åº”çš„<code>string</code>ç±»å‹çš„ä»£ç åº“ï¼Œæ ·ä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">library Strings &#123;</span><br><span class="line">    bytes16 private constant _HEX_SYMBOLS = &quot;0123456789abcdef&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        // Inspired by OraclizeAPI&#x27;s implementation - MIT licence</span><br><span class="line">        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol</span><br><span class="line"></span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 digits;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            digits++;</span><br><span class="line">            temp /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        bytes memory buffer = new bytes(digits);</span><br><span class="line">        while (value != 0) &#123;</span><br><span class="line">            digits -= 1;</span><br><span class="line">            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));</span><br><span class="line">            value /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0x00&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 length = 0;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            length++;</span><br><span class="line">            temp &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return toHexString(value, length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value, uint256 length) public pure returns (string memory) &#123;</span><br><span class="line">        bytes memory buffer = new bytes(2 * length + 2);</span><br><span class="line">        buffer[0] = &quot;0&quot;;</span><br><span class="line">        buffer[1] = &quot;x&quot;;</span><br><span class="line">        for (uint256 i = 2 * length + 1; i &gt; 1; --i) &#123;</span><br><span class="line">            buffer[i] = _HEX_SYMBOLS[value &amp; 0xf];</span><br><span class="line">            value &gt;&gt;= 4;</span><br><span class="line">        &#125;</span><br><span class="line">        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®ƒä¸»è¦åŒ…å«ä¸¤ä¸ªå‡½æ•°ï¼Œ<code>toString()</code>å°†<code>uint256</code>è½¬æ¢ä¸º10è¿›åˆ¶çš„<code>string</code>ï¼Œ<code>toHexString()</code>å°†<code>uint256</code>è½¬æ¢ä¸º16è¿›åˆ¶çš„<code>string</code>ã€‚</p>
<h3 id="å¦‚ä½•ä½¿ç”¨åº“åˆçº¦ï¼Ÿ">å¦‚ä½•ä½¿ç”¨åº“åˆçº¦ï¼Ÿ</h3>
<p>æˆ‘ä»¬ç”¨<code>Strings</code>åº“åˆçº¦çš„<code>toHexString()</code>æ¥æ¼”ç¤ºä¸¤ç§ä½¿ç”¨åº“åˆçº¦ä¸­å‡½æ•°çš„åŠæ³•ã€‚</p>
<ul>
<li>åˆ©ç”¨using foræŒ‡ä»¤ï¼ŒæŒ‡ä»¤<code>using A for B;</code>å¯ç”¨äºé™„åŠ åº“åˆçº¦ï¼ˆä»åº“<code> A</code>ï¼‰åˆ°ä»»ä½•ç±»å‹ï¼ˆ<code>B</code>ï¼‰ã€‚æ·»åŠ å®ŒæŒ‡ä»¤åï¼Œåº“<code>A</code>ä¸­çš„å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ ä¸º<code>B</code>ç±»å‹å˜é‡çš„æˆå‘˜ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚æ³¨æ„ï¼šåœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«å½“ä½œç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// åˆ©ç”¨using foræŒ‡ä»¤</span><br><span class="line">using Strings for uint256;</span><br><span class="line">function getString1(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">    // åº“åˆçº¦ä¸­çš„å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ ä¸ºuint256å‹å˜é‡çš„æˆå‘˜</span><br><span class="line">    return _number.toHexString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡åº“åˆçº¦åç§°è°ƒç”¨å‡½æ•°</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ç›´æ¥é€šè¿‡åº“åˆçº¦åè°ƒç”¨</span><br><span class="line">function getString2(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">    return Strings.toHexString(_number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éƒ¨ç½²åˆçº¦å¹¶è¾“å…¥<code>130</code>æµ‹è¯•ä¸€ä¸‹ï¼Œä¸¤ç§æ–¹æ³•å‡èƒ½è¿”å›æ­£ç¡®çš„16è¿›åˆ¶string <code>0x82</code>ã€‚è¯æ˜æˆ‘ä»¬è°ƒç”¨åº“åˆçº¦æˆåŠŸï¼</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204035623180.png" alt="image-20250204035623180"></p>
<p>å¸¸è§çš„åº“åˆçº¦æœ‰ï¼š</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Strings.sol">Strings</a>ï¼šå°†<code>uint256</code>è½¬æ¢ä¸º<code>String</code></li>
<li><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Address.sol">Address</a>ï¼šåˆ¤æ–­æŸä¸ªåœ°å€æ˜¯å¦ä¸ºåˆçº¦åœ°å€</li>
<li><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Create2.sol">Create2</a>ï¼šæ›´å®‰å…¨çš„ä½¿ç”¨<code>Create2 EVM opcode</code></li>
<li><a target="_blank" rel="noopener" href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Arrays.sol">Arrays</a>ï¼šè·Ÿæ•°ç»„ç›¸å…³çš„åº“åˆçº¦</li>
</ol>
<h2 id="Import">Import</h2>
<p>åœ¨Solidityä¸­ï¼Œ<code>import</code>è¯­å¥å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å¼•ç”¨å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæé«˜ä»£ç çš„å¯é‡ç”¨æ€§å’Œç»„ç»‡æ€§ã€‚æœ¬æ•™ç¨‹å°†å‘ä½ ä»‹ç»å¦‚ä½•åœ¨Solidityä¸­ä½¿ç”¨<code>import</code>è¯­å¥ã€‚</p>
<h3 id="Importç”¨æ³•"><code>Import</code>ç”¨æ³•</h3>
<ul>
<li>é€šè¿‡æºæ–‡ä»¶ç›¸å¯¹ä½ç½®å¯¼å…¥ï¼Œä¾‹å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶ç»“æ„</span><br><span class="line">â”œâ”€â”€ Import.sol</span><br><span class="line">â””â”€â”€ Yeye.sol</span><br><span class="line"></span><br><span class="line">// é€šè¿‡æ–‡ä»¶ç›¸å¯¹ä½ç½®import</span><br><span class="line">import &#x27;./Yeye.sol&#x27;;</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡æºæ–‡ä»¶ç½‘å€å¯¼å…¥ç½‘ä¸Šçš„åˆçº¦çš„å…¨å±€ç¬¦å·ï¼Œä¾‹å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// é€šè¿‡ç½‘å€å¼•ç”¨</span><br><span class="line">import &#x27;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Address.sol&#x27;;</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡<code>npm</code>çš„ç›®å½•å¯¼å…¥ï¼Œä¾‹å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;@openzeppelin/contracts/access/Ownable.sol&#x27;;</span><br></pre></td></tr></table></figure>
<ul>
<li>é€šè¿‡æŒ‡å®š<code>å…¨å±€ç¬¦å·</code>å¯¼å…¥åˆçº¦ç‰¹å®šçš„å…¨å±€ç¬¦å·ï¼Œä¾‹å­ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123;Yeye&#125; from &#x27;./Yeye.sol&#x27;;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¼•ç”¨(<code>import</code>)åœ¨ä»£ç ä¸­çš„ä½ç½®ä¸ºï¼šåœ¨å£°æ˜ç‰ˆæœ¬å·ä¹‹åï¼Œåœ¨å…¶ä½™ä»£ç ä¹‹å‰ã€‚</li>
</ul>
<h3 id="æµ‹è¯•å¯¼å…¥ç»“æœ">æµ‹è¯•å¯¼å…¥ç»“æœ</h3>
<p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µä»£ç æµ‹è¯•æ˜¯å¦æˆåŠŸå¯¼å…¥äº†å¤–éƒ¨æºä»£ç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// é€šè¿‡æ–‡ä»¶ç›¸å¯¹ä½ç½®import</span><br><span class="line">import &#x27;./Yeye.sol&#x27;;</span><br><span class="line">// é€šè¿‡`å…¨å±€ç¬¦å·`å¯¼å…¥ç‰¹å®šçš„åˆçº¦</span><br><span class="line">import &#123;Yeye&#125; from &#x27;./Yeye.sol&#x27;;</span><br><span class="line">// é€šè¿‡ç½‘å€å¼•ç”¨</span><br><span class="line">import &#x27;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Address.sol&#x27;;</span><br><span class="line">// å¼•ç”¨OpenZeppelinåˆçº¦</span><br><span class="line">import &#x27;@openzeppelin/contracts/access/Ownable.sol&#x27;;</span><br><span class="line"></span><br><span class="line">contract Import &#123;</span><br><span class="line">    // æˆåŠŸå¯¼å…¥Addressåº“</span><br><span class="line">    using Address for address;</span><br><span class="line">    // å£°æ˜yeyeå˜é‡</span><br><span class="line">    Yeye yeye = new Yeye();</span><br><span class="line"></span><br><span class="line">    // æµ‹è¯•æ˜¯å¦èƒ½è°ƒç”¨yeyeçš„å‡½æ•°</span><br><span class="line">    function test() external&#123;</span><br><span class="line">        yeye.hip();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>Yeye.sol</code>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// ç¬¬10è®²åˆçº¦ç»§æ‰¿ä¸­çš„Yeyeåˆçº¦</span><br><span class="line">contract Yeye &#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰3ä¸ªfunction: hip(), pop(), yeye()ï¼ŒLogå€¼ä¸ºYeyeã€‚</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye hip&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye pop&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204041504259.png" alt="image-20250204041504259"></p>
<h2 id="æ¥æ”¶å’Œå‘é€ETH">æ¥æ”¶å’Œå‘é€ETH</h2>
<p>æœ¬è®²ä¸»è¦ä»‹ç»ETHçš„æ¥æ”¶å’Œå‘é€ã€‚</p>
<h3 id="æ¥æ”¶ETH">æ¥æ”¶ETH</h3>
<p><code>Solidity</code>æ”¯æŒä¸¤ç§ç‰¹æ®Šçš„å›è°ƒå‡½æ•°ï¼Œ<code>receive()</code>å’Œ<code>fallback()</code>ï¼Œä»–ä»¬ä¸»è¦åœ¨ä¸¤ç§æƒ…å†µä¸‹è¢«ä½¿ç”¨ï¼š</p>
<ul>
<li>æ¥æ”¶ETH</li>
<li>å¤„ç†åˆçº¦ä¸­ä¸å­˜åœ¨çš„å‡½æ•°è°ƒç”¨ï¼ˆä»£ç†åˆçº¦proxy contractï¼‰</li>
</ul>
<p><strong>æ³¨æ„âš ï¸</strong>ï¼šåœ¨Solidity 0.6.xç‰ˆæœ¬ä¹‹å‰ï¼Œè¯­æ³•ä¸Šåªæœ‰ <code>fallback()</code> å‡½æ•°ï¼Œç”¨æ¥æ¥æ”¶ç”¨æˆ·å‘é€çš„ETHæ—¶è°ƒç”¨ä»¥åŠåœ¨è¢«è°ƒç”¨å‡½æ•°ç­¾åæ²¡æœ‰åŒ¹é…åˆ°æ—¶ï¼Œæ¥è°ƒç”¨ã€‚ 0.6ç‰ˆæœ¬ä¹‹åï¼ŒSoliditæ‰å°† <code>fallback()</code> å‡½æ•°æ‹†åˆ†æˆ <code>receive()</code> å’Œ <code>fallback()</code> ä¸¤ä¸ªå‡½æ•°ã€‚</p>
<h4 id="æ¥æ”¶ETHå‡½æ•°receive">æ¥æ”¶ETHå‡½æ•°<code>receive</code></h4>
<p><code>receive()</code>å‡½æ•°æ˜¯åœ¨åˆçº¦æ”¶åˆ°<code>ETH</code>è½¬è´¦æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚</p>
<p>ä¸€ä¸ªåˆçº¦æœ€å¤šæœ‰ä¸€ä¸ª<code>receive()</code>å‡½æ•°ï¼Œå£°æ˜æ–¹å¼ä¸ä¸€èˆ¬å‡½æ•°ä¸ä¸€æ ·ï¼Œä¸éœ€è¦<code>function</code>å…³é”®å­—ï¼š<code>receive() external payable &#123; ... &#125;</code>ã€‚<code>receive()</code>å‡½æ•°ä¸èƒ½æœ‰ä»»ä½•çš„å‚æ•°ï¼Œä¸èƒ½è¿”å›ä»»ä½•å€¼ï¼Œ<strong>å¿…é¡»åŒ…å«<code>external</code>å’Œ<code>payable</code>ã€‚</strong></p>
<p>å½“åˆçº¦æ¥æ”¶ETHçš„æ—¶å€™ï¼Œ<code>receive()</code>ä¼šè¢«è§¦å‘ã€‚<code>receive()</code>æœ€å¥½ä¸è¦æ‰§è¡Œå¤ªå¤šçš„é€»è¾‘å› ä¸ºå¦‚æœåˆ«äººç”¨<code>send</code>å’Œ<code>transfer</code>æ–¹æ³•å‘é€<code>ETH</code>çš„è¯ï¼Œ<code>gas</code>ä¼šé™åˆ¶åœ¨<code>2300</code>ï¼Œ<code>receive()</code>å¤ªå¤æ‚å¯èƒ½ä¼šè§¦å‘<code>Out of Gas</code>æŠ¥é”™ï¼›å¦‚æœç”¨<code>call</code>å°±å¯ä»¥è‡ªå®šä¹‰<code>gas</code>æ‰§è¡Œæ›´å¤æ‚çš„é€»è¾‘ï¼ˆè¿™ä¸‰ç§å‘é€ETHçš„æ–¹æ³•æˆ‘ä»¬ä¹‹åä¼šè®²åˆ°ï¼‰ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨<code>receive()</code>é‡Œå‘é€ä¸€ä¸ª<code>event</code>ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰äº‹ä»¶</span><br><span class="line">event Received(address Sender, uint Value);</span><br><span class="line">// æ¥æ”¶ETHæ—¶é‡Šæ”¾Receivedäº‹ä»¶</span><br><span class="line">receive() external payable &#123;</span><br><span class="line">    emit Received(msg.sender, msg.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ‰äº›æ¶æ„åˆçº¦ï¼Œä¼šåœ¨<code>receive()</code> å‡½æ•°ï¼ˆè€ç‰ˆæœ¬çš„è¯ï¼Œå°±æ˜¯ <code>fallback()</code> å‡½æ•°ï¼‰åµŒå…¥æ¶æ„æ¶ˆè€—<code>gas</code>çš„å†…å®¹æˆ–è€…ä½¿å¾—æ‰§è¡Œæ•…æ„å¤±è´¥çš„ä»£ç ï¼Œå¯¼è‡´ä¸€äº›åŒ…å«é€€æ¬¾å’Œè½¬è´¦é€»è¾‘çš„åˆçº¦ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œå› æ­¤å†™åŒ…å«é€€æ¬¾ç­‰é€»è¾‘çš„åˆçº¦æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„è¿™ç§æƒ…å†µã€‚</p>
<h4 id="å›é€€ETHå‡½æ•°fallback">å›é€€ETHå‡½æ•°<code>fallback</code></h4>
<p><code>fallback()</code>å‡½æ•°ä¼šåœ¨è°ƒç”¨åˆçº¦ä¸å­˜åœ¨çš„å‡½æ•°æ—¶è¢«è§¦å‘ã€‚å¯ç”¨äºæ¥æ”¶ETHï¼Œä¹Ÿå¯ä»¥ç”¨äºä»£ç†åˆçº¦<code>proxy contract</code>ã€‚</p>
<p><code>fallback()</code>å£°æ˜æ—¶ä¸éœ€è¦<code>function</code>å…³é”®å­—ï¼Œ<strong>å¿…é¡»ç”±<code>external</code>ä¿®é¥°ï¼Œä¸€èˆ¬ä¹Ÿä¼šç”¨<code>payable</code>ä¿®é¥°</strong>ï¼Œç”¨äºæ¥æ”¶ETH:<code>fallback() external payable &#123; ... &#125;</code>ã€‚</p>
<p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>fallback()</code>å‡½æ•°ï¼Œè¢«è§¦å‘æ—¶å€™ä¼šé‡Šæ”¾<code>fallbackCalled</code>äº‹ä»¶ï¼Œå¹¶è¾“å‡º<code>msg.sender</code>ï¼Œ<code>msg.value</code>å’Œ<code>msg.data</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">event fallbackCalled(address Sender, uint Value, bytes Data);</span><br><span class="line"></span><br><span class="line">// fallback</span><br><span class="line">fallback() external payable&#123;</span><br><span class="line">    emit fallbackCalled(msg.sender, msg.value, msg.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="receiveå’Œfallbackçš„åŒºåˆ«"><code>receive</code>å’Œ<code>fallback</code>çš„åŒºåˆ«</h4>
<p><code>receive</code>å’Œ<code>fallback</code>éƒ½èƒ½å¤Ÿç”¨äºæ¥æ”¶<code>ETH</code>ï¼Œä»–ä»¬è§¦å‘çš„è§„åˆ™å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">è§¦å‘fallback() è¿˜æ˜¯ receive()?</span><br><span class="line">           æ¥æ”¶ETH</span><br><span class="line">              |</span><br><span class="line">         msg.dataæ˜¯ç©ºï¼Ÿ</span><br><span class="line">            /  \</span><br><span class="line">          æ˜¯    å¦</span><br><span class="line">          /      \</span><br><span class="line">receive()å­˜åœ¨?   fallback()</span><br><span class="line">        / \</span><br><span class="line">       æ˜¯  å¦</span><br><span class="line">      /     \</span><br><span class="line">receive()   fallback()</span><br></pre></td></tr></table></figure>
<p>ç®€å•æ¥è¯´ï¼Œåˆçº¦æ¥æ”¶<code>ETH</code>æ—¶ï¼Œ<code>msg.data</code>ä¸ºç©ºä¸”å­˜åœ¨<code>receive()</code>æ—¶ï¼Œä¼šè§¦å‘<code>receive()</code>ï¼›<code>msg.data</code>ä¸ä¸ºç©ºæˆ–ä¸å­˜åœ¨<code>receive()</code>æ—¶ï¼Œä¼šè§¦å‘<code>fallback()</code>ï¼Œæ­¤æ—¶<code>fallback()</code>å¿…é¡»ä¸º<code>payable</code>ã€‚</p>
<p><code>receive()</code>å’Œ<code>payable fallback()</code>å‡ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå‘åˆçº¦<strong>ç›´æ¥</strong>å‘é€<code>ETH</code>å°†ä¼šæŠ¥é”™ï¼ˆä½ ä»å¯ä»¥é€šè¿‡å¸¦æœ‰<code>payable</code>çš„å‡½æ•°å‘åˆçº¦å‘é€<code>ETH</code>ï¼‰ã€‚</p>
<h4 id="æµ‹è¯•ä»£ç æ¼”ç¤º">æµ‹è¯•ä»£ç æ¼”ç¤º</h4>
<p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Fallback.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">contract Fallback &#123;</span><br><span class="line">    /* è§¦å‘fallback() è¿˜æ˜¯ receive()?</span><br><span class="line">           æ¥æ”¶ETH</span><br><span class="line">              |</span><br><span class="line">         msg.dataæ˜¯ç©ºï¼Ÿ</span><br><span class="line">            /  \</span><br><span class="line">          æ˜¯    å¦</span><br><span class="line">          /      \</span><br><span class="line">receive()å­˜åœ¨?   fallback()</span><br><span class="line">        / \</span><br><span class="line">       æ˜¯  å¦</span><br><span class="line">      /     \</span><br><span class="line">receive()  fallback   </span><br><span class="line">    */</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰äº‹ä»¶</span><br><span class="line">    event receivedCalled(address Sender, uint Value);</span><br><span class="line">    event fallbackCalled(address Sender, uint Value, bytes Data);</span><br><span class="line"></span><br><span class="line">    // æ¥æ”¶ETHæ—¶é‡Šæ”¾Receivedäº‹ä»¶</span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        emit receivedCalled(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // fallback</span><br><span class="line">    fallback() external payable&#123;</span><br><span class="line">        emit fallbackCalled(msg.sender, msg.value, msg.data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½²å¹¶æ‰§è¡Œä»£ç ï¼Œ<code>VALUE</code>æ ä¸­è¾“å…¥è¦å‘é€åˆ°åˆçº¦ä¸­çš„é‡‘é¢ï¼Œ<code>CALLDATA</code>ç•™ç©ºï¼Œç‚¹å‡»<code>Transact</code>ï¼ŒæˆåŠŸè§¦å‘åˆ°<code>receivedCalled</code>äº‹ä»¶ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204160942747.png" alt="image-20250204160942747"></p>
<p>åŒæ ·ï¼Œ<code>VALUE</code>æ ä¸­è¾“å…¥è¦å‘é€åˆ°åˆçº¦ä¸­çš„é‡‘é¢ï¼Œ<code>CALLDATA</code>è¾“å…¥ä»»æ„ç¼–å†™çš„<code>0xabcd</code>ï¼Œç‚¹å‡»<code>Transact</code>ï¼ŒæˆåŠŸè§¦å‘åˆ°<code>fallbackCalled</code>äº‹ä»¶ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204161621064.png" alt="image-20250204161621064"></p>
<h3 id="å‘é€ETH">å‘é€ETH</h3>
<p><code>Solidity</code>æœ‰ä¸‰ç§æ–¹æ³•å‘å…¶ä»–åˆçº¦å‘é€<code>ETH</code>ï¼Œä»–ä»¬æ˜¯ï¼š<code>transfer()</code>ï¼Œ<code>send()</code>å’Œ<code>call()</code>ï¼Œå…¶ä¸­<code>call()</code>æ˜¯è¢«é¼“åŠ±çš„ç”¨æ³•ã€‚</p>
<p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>SendETH.sol</code>å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// 3ç§æ–¹æ³•å‘é€ETH</span><br><span class="line">// transfer: 2300 gas, revert</span><br><span class="line">// send: 2300 gas, return bool</span><br><span class="line">// call: all gas, return (bool, data)</span><br><span class="line"></span><br><span class="line">error SendFailed(); // ç”¨sendå‘é€ETHå¤±è´¥error</span><br><span class="line">error CallFailed(); // ç”¨callå‘é€ETHå¤±è´¥error</span><br><span class="line"></span><br><span class="line">contract SendETH &#123;</span><br><span class="line">    // æ„é€ å‡½æ•°ï¼Œpayableä½¿å¾—éƒ¨ç½²çš„æ—¶å€™å¯ä»¥è½¬ethè¿›å»</span><br><span class="line">    constructor() payable&#123;&#125;</span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;&#125;</span><br><span class="line"></span><br><span class="line">    // ç”¨transfer()å‘é€ETH</span><br><span class="line">    function transferETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        _to.transfer(amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // send()å‘é€ETH</span><br><span class="line">    function sendETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        // å¤„ç†ä¸‹sendçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">        bool success = _to.send(amount);</span><br><span class="line">        if(!success)&#123;</span><br><span class="line">            revert SendFailed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // call()å‘é€ETH</span><br><span class="line">    function callETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        // å¤„ç†ä¸‹callçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">        (bool success,) = _to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">        if(!success)&#123;</span><br><span class="line">            revert CallFailed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract ReceiveETH &#123;</span><br><span class="line">    // æ”¶åˆ°ethäº‹ä»¶ï¼Œè®°å½•amountå’Œgas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line"></span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;</span><br><span class="line">        emit Log(msg.value, gasleft());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è¿”å›åˆçº¦ETHä½™é¢</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¥æ”¶ETHåˆçº¦">æ¥æ”¶ETHåˆçº¦</h4>
<p>æˆ‘ä»¬å…ˆéƒ¨ç½²ä¸€ä¸ªæ¥æ”¶<code>ETH</code>åˆçº¦<code>ReceiveETH</code>ã€‚<code>ReceiveETH</code>åˆçº¦é‡Œæœ‰ä¸€ä¸ªäº‹ä»¶<code>Log</code>ï¼Œè®°å½•æ”¶åˆ°çš„<code>ETH</code>æ•°é‡å’Œ<code>gas</code>å‰©ä½™ã€‚è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯<code>receive()</code>å‡½æ•°ï¼Œæ”¶åˆ°<code>ETH</code>è¢«è§¦å‘ï¼Œå¹¶å‘é€<code>Log</code>äº‹ä»¶ï¼›å¦ä¸€ä¸ªæ˜¯æŸ¥è¯¢åˆçº¦<code>ETH</code>ä½™é¢çš„<code>getBalance()</code>å‡½æ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract ReceiveETH &#123;</span><br><span class="line">    // æ”¶åˆ°ethäº‹ä»¶ï¼Œè®°å½•amountå’Œgas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line">    </span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;</span><br><span class="line">        emit Log(msg.value, gasleft());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è¿”å›åˆçº¦ETHä½™é¢</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½²<code>ReceiveETH</code>åˆçº¦åï¼Œè¿è¡Œ<code>getBalance()</code>å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰åˆçº¦çš„<code>ETH</code>ä½™é¢ä¸º<code>0</code>ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204164248838.png" alt="image-20250204164248838"></p>
<h4 id="å‘é€ETHåˆçº¦">å‘é€ETHåˆçº¦</h4>
<p>æˆ‘ä»¬å°†å®ç°ä¸‰ç§æ–¹æ³•å‘<code>ReceiveETH</code>åˆçº¦å‘é€<code>ETH</code>ã€‚é¦–å…ˆï¼Œå…ˆåœ¨å‘é€ETHåˆçº¦<code>SendETH</code>ä¸­å®ç°<code>payable</code>çš„<code>æ„é€ å‡½æ•°</code>å’Œ<code>receive()</code>ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨éƒ¨ç½²æ—¶å’Œéƒ¨ç½²åå‘åˆçº¦è½¬è´¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">contract SendETH &#123;</span><br><span class="line">    // æ„é€ å‡½æ•°ï¼Œpayableä½¿å¾—éƒ¨ç½²çš„æ—¶å€™å¯ä»¥è½¬ethè¿›å»</span><br><span class="line">    constructor() payable&#123;&#125;</span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Transferç”¨æ³•-æ¬¡ä¼˜">Transferç”¨æ³•(æ¬¡ä¼˜)</h4>
<ul>
<li>
<p>ç”¨æ³•æ˜¯<code>æ¥æ”¶æ–¹åœ°å€.transfer(å‘é€ETHæ•°é¢)</code>ã€‚</p>
</li>
<li>
<p><code>transfer()</code>çš„<code>gas</code>é™åˆ¶æ˜¯<code>2300</code>ï¼Œè¶³å¤Ÿç”¨äºè½¬è´¦ï¼Œä½†å¯¹æ–¹åˆçº¦çš„<code>fallback()</code>æˆ–<code>receive()</code>å‡½æ•°ä¸èƒ½å®ç°å¤ªå¤æ‚çš„é€»è¾‘ã€‚</p>
</li>
<li>
<p><code>transfer()</code>å¦‚æœè½¬è´¦å¤±è´¥ï¼Œä¼šè‡ªåŠ¨<code>revert</code>ï¼ˆå›æ»šäº¤æ˜“ï¼‰ã€‚</p>
</li>
</ul>
<p>ä»£ç æ ·ä¾‹ï¼Œæ³¨æ„é‡Œé¢çš„<code>_to</code>å¡«<code>ReceiveETH</code><strong>åˆçº¦çš„åœ°å€</strong>ï¼Œ<code>amount</code>æ˜¯<code>ETH</code>è½¬è´¦é‡‘é¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ç”¨transfer()å‘é€ETH</span><br><span class="line">function transferETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    _to.transfer(amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½²<code>SendETH</code>åˆçº¦åï¼Œå¯¹<code>ReceiveETH</code>åˆçº¦å‘é€ETHã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172302122.png" alt="image-20250204172302122"></p>
<p><code>ReceiveETH</code>åˆçº¦æˆåŠŸæ¥æ”¶åˆ°è½¬è´¦çš„ETHã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172327987.png" alt="image-20250204172327987"></p>
<p><code>amount</code>&gt;<code>value</code>ï¼Œè½¬è´¦å¤±è´¥ï¼Œå‘ç”Ÿ<code>revert</code>ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172500152.png" alt="image-20250204172500152"></p>
<h4 id="Sendç”¨æ³•">Sendç”¨æ³•</h4>
<p>ç”¨æ³•æ˜¯<code>æ¥æ”¶æ–¹åœ°å€.send(å‘é€ETHæ•°é¢)</code>ã€‚</p>
<ul>
<li><code>send()</code>çš„<code>gas</code>é™åˆ¶æ˜¯<code>2300</code>ï¼Œè¶³å¤Ÿç”¨äºè½¬è´¦ï¼Œä½†å¯¹æ–¹åˆçº¦çš„<code>fallback()</code>æˆ–<code>receive()</code>å‡½æ•°ä¸èƒ½å®ç°å¤ªå¤æ‚çš„é€»è¾‘ã€‚</li>
<li><code>send()</code>å¦‚æœè½¬è´¦å¤±è´¥ï¼Œä¸ä¼š<code>revert</code>ã€‚</li>
<li><code>send()</code>çš„è¿”å›å€¼æ˜¯<code>bool</code>ï¼Œä»£è¡¨ç€è½¬è´¦æˆåŠŸæˆ–å¤±è´¥ï¼Œéœ€è¦é¢å¤–ä»£ç å¤„ç†ä¸€ä¸‹ã€‚</li>
</ul>
<p>ä»£ç æ ·ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error SendFailed(); // ç”¨sendå‘é€ETHå¤±è´¥error</span><br><span class="line"></span><br><span class="line">// send()å‘é€ETH</span><br><span class="line">function sendETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    // å¤„ç†ä¸‹sendçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">    bool success = _to.send(amount);</span><br><span class="line">    if(!success)&#123;</span><br><span class="line">        revert SendFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>amount</code>&gt;<code>value</code>ï¼Œè½¬è´¦å¤±è´¥ï¼Œå‘ç”Ÿ<code>revert</code>ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172829438.png" alt="image-20250204172829438"></p>
<h4 id="Callç”¨æ³•-æå€¡ä½¿ç”¨">Callç”¨æ³•(æå€¡ä½¿ç”¨)</h4>
<p>ç”¨æ³•æ˜¯<code>æ¥æ”¶æ–¹åœ°å€.call&#123;value: å‘é€ETHæ•°é¢&#125;(&quot;&quot;)</code>ã€‚</p>
<ul>
<li><code>call()</code>æ²¡æœ‰<code>gas</code>é™åˆ¶ï¼Œå¯ä»¥æ”¯æŒå¯¹æ–¹åˆçº¦<code>fallback()</code>æˆ–<code>receive()</code>å‡½æ•°å®ç°å¤æ‚é€»è¾‘ã€‚</li>
<li><code>call()</code>å¦‚æœè½¬è´¦å¤±è´¥ï¼Œä¸ä¼š<code>revert</code>ã€‚</li>
<li><code>call()</code>çš„è¿”å›å€¼æ˜¯<code>(bool, bytes)</code>ï¼Œå…¶ä¸­<code>bool</code>ä»£è¡¨ç€è½¬è´¦æˆåŠŸæˆ–å¤±è´¥ï¼Œéœ€è¦é¢å¤–ä»£ç å¤„ç†ä¸€ä¸‹ã€‚</li>
</ul>
<p>ä»£ç æ ·ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error CallFailed(); // ç”¨callå‘é€ETHå¤±è´¥error</span><br><span class="line"></span><br><span class="line">// call()å‘é€ETH</span><br><span class="line">function callETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    // å¤„ç†ä¸‹callçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">    (bool success,) = _to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">    if(!success)&#123;</span><br><span class="line">        revert CallFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½²<code>SendETH</code>åˆçº¦åï¼Œå¯¹<code>ReceiveETH</code>åˆçº¦å‘é€ETHã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204165726035.png" alt="image-20250204165726035"></p>
<p><code>ReceiveETH</code>åˆçº¦æˆåŠŸæ¥æ”¶åˆ°è½¬è´¦çš„ETHã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204165840188.png" alt="image-20250204165840188"></p>
<p><code>amount</code>&gt;<code>value</code>ï¼Œè½¬è´¦å¤±è´¥ï¼Œå‘ç”Ÿ<code>revert</code>ã€‚</p>
<p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204170920553.png" alt="image-20250204170920553"></p>
<h4 id="æ€»ç»“">æ€»ç»“</h4>
<p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»<code>Solidity</code>ä¸‰ç§å‘é€<code>ETH</code>çš„æ–¹æ³•ï¼š<code>transfer</code>ï¼Œ<code>send</code>å’Œ<code>call</code>ã€‚</p>
<ul>
<li>**<code>call</code>æ²¡æœ‰<code>gas</code>é™åˆ¶ï¼Œæœ€ä¸ºçµæ´»ï¼Œæ˜¯æœ€æå€¡çš„æ–¹æ³•ï¼ï¼ï¼**âš ï¸âš ï¸âš ï¸</li>
<li><code>transfer</code>æœ‰<code>2300 gas</code>é™åˆ¶ï¼Œä½†æ˜¯å‘é€å¤±è´¥ä¼šè‡ªåŠ¨<code>revert</code>äº¤æ˜“ï¼Œæ˜¯æ¬¡ä¼˜é€‰æ‹©ï¼›</li>
<li><code>send</code>æœ‰<code>2300 gas</code>é™åˆ¶ï¼Œè€Œä¸”å‘é€å¤±è´¥ä¸ä¼šè‡ªåŠ¨<code>revert</code>äº¤æ˜“ï¼Œå‡ ä¹æ²¡æœ‰äººç”¨å®ƒã€‚</li>
</ul>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<p><a target="_blank" rel="noopener" href="https://www.wtf.academy/zh/course/solidity102/Fallback">https://www.wtf.academy/zh/course/solidity102/Fallback</a></p>
<p><a target="_blank" rel="noopener" href="https://www.wtf.academy/zh/course/solidity102/SendETH">https://www.wtf.academy/zh/course/solidity102/SendETH</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E8%BD%BD"><span class="toc-number">1.</span> <span class="toc-text">é‡è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD"><span class="toc-number">1.1.</span> <span class="toc-text">å‡½æ•°é‡è½½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E5%8C%B9%E9%85%8D%EF%BC%88Argument-Matching%EF%BC%89"><span class="toc-number">1.2.</span> <span class="toc-text">å‚æ•°åŒ¹é…ï¼ˆArgument Matchingï¼‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%93%E5%90%88%E7%BA%A6"><span class="toc-number">2.</span> <span class="toc-text">åº“åˆçº¦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%93%E5%90%88%E7%BA%A6-2"><span class="toc-number">2.1.</span> <span class="toc-text">åº“åˆçº¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Strings%E5%BA%93%E5%90%88%E7%BA%A6"><span class="toc-number">2.2.</span> <span class="toc-text">Stringsåº“åˆçº¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%BA%93%E5%90%88%E7%BA%A6%EF%BC%9F"><span class="toc-number">2.3.</span> <span class="toc-text">å¦‚ä½•ä½¿ç”¨åº“åˆçº¦ï¼Ÿ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Import"><span class="toc-number">3.</span> <span class="toc-text">Import</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Import%E7%94%A8%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">Importç”¨æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%AF%BC%E5%85%A5%E7%BB%93%E6%9E%9C"><span class="toc-number">3.2.</span> <span class="toc-text">æµ‹è¯•å¯¼å…¥ç»“æœ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E5%92%8C%E5%8F%91%E9%80%81ETH"><span class="toc-number">4.</span> <span class="toc-text">æ¥æ”¶å’Œå‘é€ETH</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6ETH"><span class="toc-number">4.1.</span> <span class="toc-text">æ¥æ”¶ETH</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6ETH%E5%87%BD%E6%95%B0receive"><span class="toc-number">4.1.1.</span> <span class="toc-text">æ¥æ”¶ETHå‡½æ•°receive</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E9%80%80ETH%E5%87%BD%E6%95%B0fallback"><span class="toc-number">4.1.2.</span> <span class="toc-text">å›é€€ETHå‡½æ•°fallback</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#receive%E5%92%8Cfallback%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">4.1.3.</span> <span class="toc-text">receiveå’Œfallbackçš„åŒºåˆ«</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81%E6%BC%94%E7%A4%BA"><span class="toc-number">4.1.4.</span> <span class="toc-text">æµ‹è¯•ä»£ç æ¼”ç¤º</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E9%80%81ETH"><span class="toc-number">4.2.</span> <span class="toc-text">å‘é€ETH</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6ETH%E5%90%88%E7%BA%A6"><span class="toc-number">4.2.1.</span> <span class="toc-text">æ¥æ”¶ETHåˆçº¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81ETH%E5%90%88%E7%BA%A6"><span class="toc-number">4.2.2.</span> <span class="toc-text">å‘é€ETHåˆçº¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Transfer%E7%94%A8%E6%B3%95-%E6%AC%A1%E4%BC%98"><span class="toc-number">4.2.3.</span> <span class="toc-text">Transferç”¨æ³•(æ¬¡ä¼˜)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Send%E7%94%A8%E6%B3%95"><span class="toc-number">4.2.4.</span> <span class="toc-text">Sendç”¨æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Call%E7%94%A8%E6%B3%95-%E6%8F%90%E5%80%A1%E4%BD%BF%E7%94%A8"><span class="toc-number">4.2.5.</span> <span class="toc-text">Callç”¨æ³•(æå€¡ä½¿ç”¨)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.2.6.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&text=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&is_video=false&description=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)&body=Check out this article: https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&title=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&name=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://x2nn.github.io/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/&t=Solidityå…¥é—¨å­¦ä¹ (ä¸‰)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        Copyright &copy;
        
        
        2024-2025
        ğŸ’—
      </div>
      <div class="footer-right">
        <nav>
          <ul>
            <!--
          --><li><a href="/">Home</a></li><!--
        --><!--
          --><li><a href="/archives/">Writing</a></li><!--
        --><!--
          --><li><a href="/tags/">Tag</a></li><!--
        --><!--
          --><li><a href="/categories/">Category</a></li><!--
        --><!--
          --><li><a href="/search/">Search</a></li><!--
        --><!--
          --><li><a href="/about/">About</a></li><!--
        -->
          </ul>
          <ul>
            
              <!-- ä¸è’œå­ç»Ÿè®¡ -->
              <span id="busuanzi_container_site_pv">
                  æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
              </span>
              <span class="post-meta-divider">|</span>
              <span id="busuanzi_container_site_uv" style='display:none'>
                      æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº
              </span>
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            
          </ul>
        </nav>
      </div>
      
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
