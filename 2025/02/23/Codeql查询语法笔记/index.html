<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="ç”Ÿæˆæ•°æ®åº“ ä»¥ä¸‹ä¸ºå„ç§è¯­è¨€åˆ›å»ºæ•°æ®åº“çš„å‘½ä»¤ã€‚ 12345678# javacodeql database create &quot;~&#x2F;CodeQL&#x2F;databases&#x2F;code-database&quot; --source-root&#x3D;&quot;~&#x2F;CodeQL&#x2F;projects&#x2F;java-code&quot; --language&#x3D;java --command&#x3D;&quot;mvn clean">
<meta property="og:type" content="article">
<meta property="og:title" content="CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°">
<meta property="og:url" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="X2n.">
<meta property="og:description" content="ç”Ÿæˆæ•°æ®åº“ ä»¥ä¸‹ä¸ºå„ç§è¯­è¨€åˆ›å»ºæ•°æ®åº“çš„å‘½ä»¤ã€‚ 12345678# javacodeql database create &quot;~&#x2F;CodeQL&#x2F;databases&#x2F;code-database&quot; --source-root&#x3D;&quot;~&#x2F;CodeQL&#x2F;projects&#x2F;java-code&quot; --language&#x3D;java --command&#x3D;&quot;mvn clean">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211310603.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223210106772.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211244232.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317094330880.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317104709821.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317113123536.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428223626775.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428224020685.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428233723056.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428234414817.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250429143457327.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250429152458427.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430115409761.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430125024851.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430124352869.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430151657937.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430151848901.png">
<meta property="og:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430190645346.png">
<meta property="article:published_time" content="2025-02-23T01:32:49.000Z">
<meta property="article:modified_time" content="2025-04-30T13:35:58.371Z">
<meta property="article:author" content="ğŸ’—">
<meta property="article:tag" content="CodeQL">
<meta property="article:tag" content="QLè¯­æ³•">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211310603.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="X2n." type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/02/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&text=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&is_video=false&description=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°&body=Check out this article: https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&name=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&t=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">ç”Ÿæˆæ•°æ®åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">åŸºç¡€è¯­æ³•ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.</span> <span class="toc-text">ç¼–å†™ç¬¬ä¸€ä¸ªæŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AAQL%E5%8C%85"><span class="toc-number">3.1.</span> <span class="toc-text">åˆ›å»ºç¬¬ä¸€ä¸ªQLåŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.2.</span> <span class="toc-text">ç¼–å†™æŸ¥è¯¢</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QL%E8%AF%AD%E8%A8%80%E5%8F%82%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">QLè¯­è¨€å‚è€ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%93%E8%AF%8DPredicates"><span class="toc-number">4.1.</span> <span class="toc-text">è°“è¯Predicates</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E7%BB%93%E6%9E%9C%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.1.</span> <span class="toc-text">æ— ç»“æœè°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.2.</span> <span class="toc-text">ç»“æœè°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.3.</span> <span class="toc-text">é€’å½’è°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E8%B0%93%E8%AF%8D%E3%80%81%E9%9D%9E%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D%E3%80%81%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.4.</span> <span class="toc-text">ç‰¹å¾è°“è¯ã€éæˆå‘˜è°“è¯ã€æˆå‘˜è°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E8%A1%8C%E4%B8%BA%E4%B8%8E%E7%BB%91%E5%AE%9A%E9%9B%86"><span class="toc-number">4.1.5.</span> <span class="toc-text">ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E7%BB%91%E5%AE%9A%E9%9B%86"><span class="toc-number">4.1.5.1.</span> <span class="toc-text">å•ä¸ªç»‘å®šé›†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E7%BB%91%E5%AE%9A%E9%9B%86"><span class="toc-number">4.1.5.2.</span> <span class="toc-text">å¤šä¸ªç»‘å®šé›†</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2Queries"><span class="toc-number">4.2.</span> <span class="toc-text">æŸ¥è¯¢Queries</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#select%E5%AD%90%E5%8F%A5"><span class="toc-number">4.2.1.</span> <span class="toc-text">selectå­å¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%B0%93%E8%AF%8D"><span class="toc-number">4.2.2.</span> <span class="toc-text">æŸ¥è¯¢è°“è¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8BTypes"><span class="toc-number">4.3.</span> <span class="toc-text">ç±»å‹Types</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B-Primitive-types"><span class="toc-number">4.3.1.</span> <span class="toc-text">åŸå§‹ç±»å‹(Primitive types)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB-Classes"><span class="toc-number">4.3.2.</span> <span class="toc-text">ç±»(Classes)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%B1%BB%E5%9E%8B-Defining-a-class"><span class="toc-number">4.3.2.1.</span> <span class="toc-text">å®šä¹‰ä¸€ä¸ªç±»å‹(Defining a class)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B1%BB%E4%B8%BB%E4%BD%93-Class-bodies"><span class="toc-number">4.3.2.2.</span> <span class="toc-text">ç±»ä¸»ä½“(Class bodies)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E8%B0%93%E8%AF%8D-Characteristic-predicate"><span class="toc-number">4.3.2.3.</span> <span class="toc-text">ç‰¹å¾è°“è¯(Characteristic predicate)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D-Member-predicate"><span class="toc-number">4.3.2.4.</span> <span class="toc-text">æˆå‘˜è°“è¯(Member predicate)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5-Field"><span class="toc-number">4.3.2.5.</span> <span class="toc-text">å­—æ®µ(Field)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E7%B1%BB-Concrete-classes"><span class="toc-number">4.3.2.6.</span> <span class="toc-text">å…·ä½“ç±»(Concrete classes)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E7%B1%BB-Abstract-classes"><span class="toc-number">4.3.2.7.</span> <span class="toc-text">æŠ½è±¡ç±»(Abstract classes)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E5%86%99%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D-Overriding-member-predicates"><span class="toc-number">4.3.2.8.</span> <span class="toc-text">é‡å†™æˆå‘˜è°“è¯(Overriding member predicates)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF-Multiple-inheritance"><span class="toc-number">4.3.2.9.</span> <span class="toc-text">å¤šé‡ç»§æ‰¿(Multiple inheritance)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Final%E6%8B%93%E5%B1%95-Final-extensions"><span class="toc-number">4.3.2.10.</span> <span class="toc-text">Finalæ‹“å±•(Final extensions)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8FVariables"><span class="toc-number">4.4.</span> <span class="toc-text">å˜é‡Variables</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F-Declaring-a-variable"><span class="toc-number">4.4.1.</span> <span class="toc-text">å£°æ˜å˜é‡(Declaring a variable)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E7%94%B1%E5%8F%98%E9%87%8F%E5%92%8C%E7%BB%91%E5%AE%9A%E5%8F%98%E9%87%8F-Free-and-bound-variables"><span class="toc-number">4.4.2.</span> <span class="toc-text">è‡ªç”±å˜é‡å’Œç»‘å®šå˜é‡(Free and bound variables)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8FExpressions"><span class="toc-number">4.5.</span> <span class="toc-text">è¡¨è¾¾å¼Expressions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6%E7%B1%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F-Super-expressions"><span class="toc-number">4.5.1.</span> <span class="toc-text">çˆ¶ç±»è¡¨è¾¾å¼(Super expressions)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E5%BC%8FFormulas"><span class="toc-number">4.6.</span> <span class="toc-text">å…¬å¼Formulas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F-Order"><span class="toc-number">4.6.1.</span> <span class="toc-text">é¡ºåº(Order)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3Annotations"><span class="toc-number">4.7.</span> <span class="toc-text">æ³¨è§£Annotations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">ğŸ’—</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-02-23T01:32:49.000Z" class="dt-published" itemprop="datePublished">2025-02-23</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">ä»£ç å®¡è®¡</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CodeQL/" rel="tag">CodeQL</a>, <a class="p-category" href="/tags/QL%E8%AF%AD%E6%B3%95/" rel="tag">QLè¯­æ³•</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="ç”Ÿæˆæ•°æ®åº“">ç”Ÿæˆæ•°æ®åº“</h2>
<p>ä»¥ä¸‹ä¸ºå„ç§è¯­è¨€åˆ›å»ºæ•°æ®åº“çš„å‘½ä»¤ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">java</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/projects/java-code&quot; --language=java --command=&quot;mvn clean install -file pom.xml&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Go</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/projects/java-code&quot; --language=go</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Python</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/databases/code-database&quot; --language=python</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">JavaScript</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/databases/code-database&quot; --language=javascript</span><br></pre></td></tr></table></figure>
<p><code>CodeQL</code>ä¸æ”¯æŒ<code>PHP</code>ï¼Œæ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ç±»å‹ï¼Œå‚è€ƒå®˜ç½‘<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ã€‚å¯¹äº<code>Java</code>ä»£ç æœ‰äº›ä¸åŒï¼Œéœ€è¦è¿›è¡Œä»£ç çš„ç¼–è¯‘å<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œæ‰èƒ½ç”Ÿæˆç›¸å…³çš„æ•°æ®åº“ã€‚</p>
<p>ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œè‹¥å‡ºç°ç¯å¢ƒé—®é¢˜å¯ä½¿ç”¨<code>--verbose</code>è¾“å‡ºè¯¦ç»†çš„é”™è¯¯ï¼Œè¿›è¡Œé”™è¯¯çš„å®šä½ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create webgoat-qldb -language= java --command &quot;./mvnw clean package -DskipTests&quot; --verbose</span><br></pre></td></tr></table></figure>
<p>å¯¹äº<code>Java</code>ä»£ç çš„ç‰¹æ®Šæ€§<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼Œï¼Œå®æˆ˜ä¸­è·å–åˆ°çš„å¯èƒ½æ˜¯ç¼–è¯‘åçš„<code>Java</code>ä»£ç ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å·¥å…·<code>CodeQLpy</code><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼Œå®ƒå¯ä»¥å¯¹å¤šç§ä¸åŒç±»å‹çš„javaä»£ç è¿›è¡Œä»£ç å®¡è®¡ï¼ŒåŒ…æ‹¬jspæ–‡ä»¶ã€SpringMVCçš„waråŒ…ã€SpringBootçš„jaråŒ…ã€mavenæºä»£ç ã€‚</p>
<h2 id="åŸºç¡€è¯­æ³•ç»“æ„">åŸºç¡€è¯­æ³•ç»“æ„</h2>
<p><code>Codeql</code>æŸ¥è¯¢è¯­æ³•æœ‰ç‚¹ç±»ä¼¼<code>SQL</code>æŸ¥è¯¢ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Query metadata</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">import <span class="comment">/* ... CodeQL libraries or modules ... */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ... Optional, define CodeQL classes and predicates ... */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="comment">/* ... å˜é‡å£°æ˜ ... */</span></span><br><span class="line"><span class="keyword">where</span> <span class="comment">/* ... é€»è¾‘å¤„ç† ... */</span></span><br><span class="line"><span class="keyword">select</span> <span class="comment">/* ... è¡¨è¾¾å¼ ... */</span></span><br></pre></td></tr></table></figure>
<h2 id="ç¼–å†™ç¬¬ä¸€ä¸ªæŸ¥è¯¢">ç¼–å†™ç¬¬ä¸€ä¸ªæŸ¥è¯¢</h2>
<h3 id="åˆ›å»ºç¬¬ä¸€ä¸ªQLåŒ…">åˆ›å»ºç¬¬ä¸€ä¸ªQLåŒ…</h3>
<p>è¿™é‡Œä»¥<code>WebGoat</code><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>åˆ›å»ºçš„æ•°æ®åº“ä¸ºæŸ¥è¯¢å¯¹è±¡ã€‚</p>
<p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾åç»­ä½ ç¼–å†™çš„<code>CodeQL</code>è„šæœ¬ï¼Œ<code>CodeQL</code>å®˜æ–¹ç§°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸º<code>QL Pack</code>ã€‚</p>
<p>ä¾‹å¦‚åä¸º<code>qltest</code>çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»º1ä¸ª<code>QL Pack</code>çš„é…ç½®æ–‡ä»¶ï¼Œåç§°å›ºå®šä¸º<code>qlpack.yml</code>ã€‚å†åˆ›å»ºä¸€ä¸ªqlåç¼€çš„æ–‡ä»¶ï¼Œåç§°éšæ„ã€‚</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211310603.png" alt="image-20250223211310603"></p>
<p><code>qlpack.yml</code>æ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">qltest</span></span><br><span class="line"><span class="attr">version:</span> <span class="number">0.0</span><span class="number">.0</span></span><br><span class="line"><span class="attr">libraryPathDependencies:</span> <span class="string">codeql-java</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>ç¬¬ä¸€è¡Œè¡¨ç¤ºè¿™ä¸ªQLåŒ…çš„åç§°ä¸º<code>qltest</code>ï¼Œå¿…é€‰ï¼Œå¦‚æœä½ åœ¨VSCodeä¸­åŒæ—¶æ‰“å¼€å¤šä¸ªQLåŒ…æ—¶ï¼Œè¦ä¿è¯è¿™ä¸ªnameçš„å€¼å”¯ä¸€ä¸é‡å¤ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒè¡Œè¡¨ç¤ºè¿™ä¸ªQLåŒ…çš„ç‰ˆæœ¬å·ï¼Œå¿…é€‰ã€‚</p>
</li>
<li>
<p>ç¬¬ä¸‰è¡Œè¡¨ç¤ºè¿™ä¸ªQLåŒ…çš„ä¾èµ–ï¼Œå¿…é€‰ï¼Œcodeql-javaè¡¨ç¤ºéœ€è¦Javaè¯­è¨€çš„QLæ ‡å‡†åº“ä¾èµ–ã€‚</p>
</li>
</ul>
<p>åœ¨VSCodeçš„CodeQLæ’ä»¶ä¸­æ·»åŠ ç”¨CodeQLåˆ›å»ºçš„WebGoatçš„æ•°æ®åº“</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223210106772.png" alt="image-20250223210106772"></p>
<h3 id="ç¼–å†™æŸ¥è¯¢">ç¼–å†™æŸ¥è¯¢</h3>
<p>åœ¨<code>webgoat-query.ql</code>æ–‡ä»¶ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç ï¼Œç”¨æ¥æŸ¥æ‰¾WebGoaté¡¹ç›®ä¸­æ‰€æœ‰å£°æ˜çš„æ–¹æ³•ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import java</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="keyword">Method</span> m</span><br><span class="line"><span class="keyword">select</span> m</span><br></pre></td></tr></table></figure>
<p>ç„¶åå³é”®ç‚¹å‡»<code>webgoat-query.ql</code>æ–‡ä»¶ï¼Œç‚¹å‡»ã€CodeQL: Run Query ã€‘æ¥æ‰§è¡Œæœ¬æ¬¡æŸ¥è¯¢ï¼Œæ‰§è¡Œå®Œæˆååœ¨å³è¾¹å¯ä»¥çœ‹åˆ°å¤šå‡ºä¸€åˆ—ç”¨æ¥æ˜¾ç¤ºæŸ¥è¯¢ç»“æœã€‚</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211244232.png" alt="image-20250223211244232"></p>
<h2 id="QLè¯­è¨€å‚è€ƒ">QLè¯­è¨€å‚è€ƒ</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/about-the-ql-language/">å…³äº QL è¯­è¨€</a>ï¼šQL æ˜¯ CodeQL çš„å¼ºå¤§æŸ¥è¯¢è¯­è¨€ï¼Œç”¨äºåˆ†æä»£ç ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/predicates/">è°“è¯</a>ï¼šè°“è¯ç”¨äºæè¿°æ„æˆ QL ç¨‹åºçš„é€»è¾‘å…³ç³»ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/queries/">æŸ¥è¯¢</a>ï¼šæŸ¥è¯¢æ˜¯ QL ç¨‹åºçš„è¾“å‡ºã€‚ä»–ä»¬è¯„ä¼°ç»“æœé›†ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/">ç±»å‹</a>ï¼šQL æ˜¯ä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå› æ­¤æ¯ä¸ªå˜é‡éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå£°æ˜çš„ç±»å‹ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/modules/">æ¨¡å—</a>ï¼šæ¨¡å—æä¾›äº†ä¸€ç§é€šè¿‡å°†ç›¸å…³ç±»å‹ã€è°“è¯å’Œå…¶ä»–æ¨¡å—ç»„åˆåœ¨ä¸€èµ·æ¥ç»„ç»‡ QL ä»£ç çš„æ–¹æ³•ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/aliases/">åˆ«å</a>ï¼šåˆ«åæ˜¯ç°æœ‰ QL å®ä½“çš„æ›¿ä»£åç§°ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/variables/">å˜é‡</a>ï¼šQL ä¸­çš„å˜é‡ä¸ä»£æ•°æˆ–é€»è¾‘ä¸­çš„å˜é‡çš„ä½¿ç”¨æ–¹å¼ç±»ä¼¼ã€‚å®ƒä»¬ä»£è¡¨ä¸€ç»„å€¼ï¼Œè¿™äº›å€¼é€šå¸¸å—å…¬å¼é™åˆ¶ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/expressions/">è¡¨è¾¾å¼</a>ï¼šè¡¨è¾¾å¼è®¡ç®—ä¸ºä¸€ç»„å€¼å¹¶å…·æœ‰ç±»å‹ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/formulas/">å…¬å¼</a>ï¼šå…¬å¼å®šä¹‰äº†è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„è‡ªç”±å˜é‡ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/annotations/">æ³¨é‡Š</a>ï¼šæ³¨é‡Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥å°†å…¶ç›´æ¥æ”¾åœ¨ QL å®ä½“æˆ–åç§°çš„å£°æ˜ä¹‹å‰ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/recursion/">é€’å½’</a>ï¼šQL ä¸ºé€’å½’æä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚å¦‚æœ QL ä¸­çš„è°“è¯ç›´æ¥æˆ–é—´æ¥ä¾èµ–äºè‡ªèº«ï¼Œåˆ™ç§°å…¶ä¸ºé€’å½’è°“è¯ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/lexical-syntax/">è¯æ³•è¯­æ³•</a>ï¼šQL è¯­æ³•åŒ…æ‹¬ä¸åŒç§ç±»çš„å…³é”®å­—ã€æ ‡è¯†ç¬¦å’Œæ³¨é‡Šã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/name-resolution/">åç§°è§£æ</a>ï¼šQL ç¼–è¯‘å™¨å°†åç§°è§£æä¸ºç¨‹åºå…ƒç´ ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/evaluation-of-ql-programs/">QLæ–¹æ¡ˆçš„è¯„ä»·</a>ï¼šä»¥å¤šä¸ªä¸åŒçš„æ­¥éª¤è¯„ä¼°QLç¨‹åºã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/">QL è¯­è¨€è§„èŒƒ</a>ï¼šQLè¯­è¨€çš„å½¢å¼è§„èŒƒã€‚å®ƒä¸ºæœ¯è¯­ï¼Œè¯­æ³•å’Œæœ‰å…³QLçš„å…¶ä»–æŠ€æœ¯ç»†èŠ‚æä¾›äº†å…¨é¢çš„å‚è€ƒã€‚</li>
</ul>
<h3 id="è°“è¯Predicates">è°“è¯Predicates</h3>
<p>å®˜æ–¹æ–‡æ¡£<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> ,è°“è¯ï¼ˆPredicatesï¼‰æœ‰ç‚¹ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„å‡½æ•°ï¼Œä½†åˆä¸å‡½æ•°ä¸åŒï¼Œè°“è¯ç”¨äºæè¿°æ„æˆ QL ç¨‹åºçš„é€»è¾‘å…³ç³»ã€‚ç¡®åˆ‡çš„è¯´ï¼Œè°“è¯æè¿°çš„æ˜¯ç»™å®šå‚æ•°ä¸å…ƒç»„é›†åˆçš„å…³ç³»ã€‚<br>
å®šä¹‰è°“è¯æœ‰ä»¥ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹(å‘ç‚¹)ï¼š</p>
<ol>
<li>éœ€è¦æ³¨æ„çš„æ˜¯è°“è¯çš„åå­—<strong>å¼€å¤´å¿…é¡»æ˜¯å°å†™å­—æ¯</strong>ã€‚</li>
<li>ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†ã€‚</li>
</ol>
<h4 id="æ— ç»“æœè°“è¯">æ— ç»“æœè°“è¯</h4>
<p>æ²¡æœ‰ç»“æœçš„è°“è¯ä»¥predicateä½œä¸ºå¼€å¤´ï¼Œå‰©ä¸‹çš„è¯­æ³•ç»“æ„ç±»ä¼¼äºå®šä¹‰å‡½æ•°ã€‚è¿™ç§è°“è¯åªèƒ½åœ¨whereè¯­å¥ä¸­ä½¿ç”¨<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ã€‚</p>
<p>ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">predicate isCity(string city) &#123;</span><br><span class="line">city <span class="operator">=</span> &quot;Beijing&quot;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">city <span class="operator">=</span> &quot;ShangHai&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string city</span><br><span class="line"><span class="keyword">where</span> city <span class="operator">=</span> &quot;Beijing&quot; <span class="keyword">and</span> isCity(city)</span><br><span class="line"><span class="keyword">select</span> city</span><br></pre></td></tr></table></figure>
<h4 id="ç»“æœè°“è¯">ç»“æœè°“è¯</h4>
<p>æœ‰ç»“æœçš„è°“è¯çš„å®šä¹‰ç±»ä¼¼äº<code>C/C++</code>è¯­è¨€çš„å‡½æ•°å®šä¹‰ï¼Œå·²è¿”å›ç±»å‹æ›¿ä»£<code>predicate</code>ä½œä¸ºå¼€å¤´ã€‚è¿™ç§è°“è¯å¯ä»¥åœ¨<code>where</code>ä¸<code>select</code>è¯­å¥ä¸­ä½¿ç”¨ã€‚</p>
<p>ç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="keyword">in</span> [<span class="number">1</span> .. <span class="number">10</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="type">int</span> v</span><br><span class="line"><span class="keyword">where</span> v <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> addOne(v)</span><br></pre></td></tr></table></figure>
<h4 id="é€’å½’è°“è¯">é€’å½’è°“è¯</h4>
<p>è¿™é‡Œè¯´çš„é€’å½’å¹¶éæˆ‘ä»¬å¸¸è§„ç†è§£çš„å‡½æ•°é€’å½’ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª<strong>å¯åå‘æŸ¥æ‰¾çš„è°“è¯</strong>ï¼Œæˆ–è€…æ¢ä¸€ä¸ªæ€ç»´ï¼ŒæŠŠéé€’å½’çš„ç»“æœè°“è¯ç†è§£ä¸ºä¸€ä¸ªæœ‰å‘å›¾ï¼Œé‚£ä¹ˆ<strong>é€’å½’çš„ç»“æœè°“è¯å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ— å‘å›¾</strong>ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">string getANeighbor(string country) &#123;</span><br><span class="line">    country <span class="operator">=</span> &quot;France&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Belgium&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> &quot;France&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Germany&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Austria&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Belgium&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> getANeighbor(<span class="keyword">result</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string people</span><br><span class="line"><span class="keyword">where</span> people <span class="operator">=</span> getANeighbor(&quot;Germany&quot;)</span><br><span class="line"><span class="keyword">select</span> people</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317094330880.png" alt="image-20250317094330880"></p>
<p>è¾“å‡ºçš„ç»“æœä¸ºï¼š<code>France</code>ã€<code>Austria</code>ã€<code>Belgium</code>ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¼šæœ‰<code>France</code>å‘¢ï¼Ÿ</p>
<p>å› ä¸º<code>getANeighbor(&quot;Germany&quot;)</code>ï¼Œç”±</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Austria&quot;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Belgium&quot;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å¾—åˆ°<code>Austriaã€Belgium</code>ã€‚</p>
<p>è¿™é‡Œçš„é€’å½’ä¸æ˜¯<strong>å•å‘</strong>çš„ï¼Œè€Œæ˜¯<strong>åŒå‘</strong>çš„ï¼Œç”±äºå­˜åœ¨<code>France -&gt; Germany</code>ï¼Œæ‰€ä»¥ç”±<code>Germany</code>å¯ä»¥åå‘é€’å½’å¾—åˆ°<code>France</code>è¿™ä¸ªç»“æœã€‚</p>
<h4 id="ç‰¹å¾è°“è¯ã€éæˆå‘˜è°“è¯ã€æˆå‘˜è°“è¯">ç‰¹å¾è°“è¯ã€éæˆå‘˜è°“è¯ã€æˆå‘˜è°“è¯</h4>
<p>è°“è¯åˆ†ä¸ºä¸‰ç§ï¼Œå³<strong>éæˆå‘˜è°“è¯</strong>ã€<strong>æˆå‘˜è°“è¯è¯­</strong>å’Œ<strong>ç‰¹å¾è°“è¯</strong>ã€‚</p>
<ul>
<li>
<p>éæˆå‘˜è°“è¯æ˜¯åœ¨<strong>ç±»ä¹‹å¤–å®šä¹‰</strong>çš„ï¼Œå®ƒä»¬ä¸æ˜¯ä»»ä½•ç±»çš„æˆå‘˜ã€‚</p>
</li>
<li>
<p>æˆå‘˜è°“è¯åˆ™æ˜¯åœ¨ç±»é‡Œé¢å®šä¹‰çš„ã€‚</p>
</li>
<li>
<p>ç‰¹å¾è°“è¯åˆ™æ˜¯ç±»ä¸­çš„ç‰¹æ®Šè°“è¯ã€‚</p>
</li>
</ul>
<p>ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­ç±»çš„æ„é€ å‡½æ•°ã€‚</p>
<p>æ¯ç§è°“è¯çš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> getSuccessor(<span class="type">int</span> i) &#123;  <span class="operator">/</span><span class="operator">/</span> <span class="number">1.</span> éæˆå‘˜è°“è¯(Non<span class="operator">-</span><span class="keyword">member</span> predicate)</span><br><span class="line">  <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">  i <span class="keyword">in</span> [<span class="number">1</span> .. <span class="number">9</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class FavoriteNumbers extends <span class="type">int</span> &#123;</span><br><span class="line">  FavoriteNumbers() &#123;  <span class="operator">/</span><span class="operator">/</span> <span class="number">2.</span> ç‰¹å¾è°“è¯(Characteristic predicate)</span><br><span class="line">    this <span class="operator">=</span> <span class="number">1</span> <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">4</span> <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">9</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string getName() &#123;   <span class="operator">/</span><span class="operator">/</span> <span class="number">3.</span> æˆå‘˜è°“è¯(<span class="keyword">Member</span> predicate) <span class="keyword">for</span> the class `FavoriteNumbers`</span><br><span class="line">    this <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;one&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">4</span> <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;four&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">9</span> <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;nine&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†">ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†</h4>
<p>è°“è¯åªèƒ½åŒ…å«æœ‰é™æ•°é‡çš„å…ƒç»„ã€‚</p>
<p>æ­£ä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> æ­£ä¾‹ï¼Œiè¢«é™å®šåœ¨<span class="number">1</span>åˆ°<span class="number">10</span>å†…ï¼Œæˆ–è€…ä½ ä¹Ÿå¯ä»¥ç»™ièµ‹ä¸€ä¸ªç¡®å®šçš„å€¼å¦‚i<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="keyword">in</span> [<span class="number">1</span> .. <span class="number">10</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åä¾‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> åä¾‹ï¼Œiæ˜¯æ— é™æ•°é‡å€¼çš„ï¼Œæ­¤æ—¶CodeQLç¼–è¯‘å™¨ä¼šæŠ¥é”™: The body <span class="keyword">of</span> this <span class="string">&#x27;test::addOne&#x27;</span> does <span class="keyword">not</span> bind <span class="string">&#x27;result&#x27;</span> <span class="keyword">to</span> a value.</span><br><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317104709821.png" alt="image-20250317104709821"></p>
<h5 id="å•ä¸ªç»‘å®šé›†">å•ä¸ªç»‘å®šé›†</h5>
<p>ä¸ºäº†ä½¿ä¸Šè¿°çš„åä¾‹è°“è¯èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»‘å®šé›†(bindingset)ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å»è°ƒç”¨è¿™ä¸ªè°“è¯æ—¶ï¼Œä¼ é€’çš„å‚æ•°è¿˜æ˜¯<strong>åªèƒ½åœ¨æœ‰é™çš„å‚æ•°é›†ä¸­</strong>ã€‚<br>
ä¸Šé¢çš„åä¾‹å¯ä»¥ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bindingset[i]</span><br><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å»è°ƒç”¨è¿™ä¸ªè°“è¯ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä¼ é€’è¿‡æ¥çš„å‚æ•°è¿˜æ˜¯åªèƒ½åœ¨æœ‰é™çš„å‚æ•°é›†ä¸­</span><br><span class="line"><span class="keyword">from</span> <span class="type">int</span> i</span><br><span class="line"><span class="keyword">where</span> i <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> addOne(i)</span><br></pre></td></tr></table></figure>
<h5 id="å¤šä¸ªç»‘å®šé›†">å¤šä¸ªç»‘å®šé›†</h5>
<p>æˆ‘ä»¬åŒæ ·å¯ä»¥æ·»åŠ å¤šä¸ªç»‘å®šé›†ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bindingset[x] bindingset[y]</span><br><span class="line">predicate plusOne(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">  x <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> y</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">from</span> <span class="type">int</span> z</span><br><span class="line"><span class="keyword">where</span> z<span class="operator">=</span> <span class="number">2</span> <span class="keyword">and</span> plusOne(<span class="number">1</span>, z)</span><br><span class="line"><span class="keyword">select</span> z</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317113123536.png" alt="image-20250317113123536"></p>
<p>è¿™ä¸ªç»‘å®šé›†çš„æ„æ€æ˜¯å¦‚æœxæˆ–yç»‘å®š(bound)äº†ï¼Œé‚£ä¹ˆxå’Œyéƒ½ç»‘å®šï¼Œå³è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°å—åˆ°çº¦æŸã€‚<br>
å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸¤è€…éƒ½å—çº¦æŸï¼Œå¯ä»¥å°†ä¾‹å­ä¿®æ”¹ä¸€ä¸‹:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bindingset[x, y]</span><br><span class="line">predicate plusOne(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">  x <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè¿™ä¸ªè°“è¯å°±å˜ä¸ºäº†ä¸€ä¸ªç±»ä¼¼äºæ ¡éªŒçš„å‡½æ•°ï¼Œå³<code>x+1 == y</code>ã€‚</p>
<h3 id="æŸ¥è¯¢Queries">æŸ¥è¯¢Queries</h3>
<p>å®˜æ–¹æ–‡æ¡£<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>ï¼ŒæŸ¥è¯¢æ˜¯<code>CodeQL</code>çš„è¾“å‡ºã€‚æŸ¥è¯¢çš„ä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯</p>
<ul>
<li><code>select</code>å­å¥</li>
<li>æŸ¥è¯¢è°“è¯­ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä»å½“å‰æ¨¡å—ä¸­å®šä¹‰æˆ–è€…ä»å…¶ä»–æ¨¡å—ä¸­å¯¼å…¥ã€‚</li>
</ul>
<h4 id="selectå­å¥">selectå­å¥</h4>
<p>å­å¥çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="comment">/* ... variable declarations ... */</span></span><br><span class="line"><span class="keyword">where</span> <span class="comment">/* ... logical formula ... */</span></span><br><span class="line"><span class="keyword">select</span> <span class="comment">/* ... expressions ... */</span></span><br></pre></td></tr></table></figure>
<p><code>from</code>å’Œ<code>where</code>éƒ¨åˆ†æ˜¯å¯é€‰çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>from</code>ä¸­å®šä¹‰å˜é‡ï¼Œåœ¨<code>where</code>ä¸­ç»™å˜é‡èµ‹å€¼å’Œå¯¹æŸ¥è¯¢ç»“æœçš„è¿‡æ»¤ï¼Œæœ€ååœ¨<code>select</code>ä¸­æ˜¾ç¤ºç»“æœã€‚</p>
<p>åœ¨<code>select</code>åé¢é™¤äº†è¡¨è¾¾å¼(<code>expressions</code>)ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸€äº›å…³é”®å­—ï¼š</p>
<ul>
<li><code>as</code>å…³é”®å­—ï¼Œåé¢è·Ÿéšä¸€ä¸ªåå­—ã€‚ä½œç”¨ç›¸å½“äºsqlä¸­çš„<code>as</code>ï¼Œä¸ºç»“æœåˆ—æä¾›äº†ä¸€ä¸ª&quot;æ ‡ç­¾&quot;ï¼Œå¹¶å…è®¸åœ¨åç»­çš„<code>select</code>è¡¨è¾¾å¼ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</li>
<li><code>order by</code>å…³é”®å­—ï¼Œåé¢è·Ÿéšä¸€ä¸ªç»“æœåˆ—åã€‚ä½œç”¨ç›¸å½“äºsqlä¸­çš„<code>order by</code>ï¼Œç”¨äºæ’åºç»“æœï¼Œå¹¶ä¸”åœ¨ç»“æœåˆ—ååå¯é€‰<code>asc</code>(å‡åº)æˆ–<code>desc</code>(é™åº)å…³é”®å­—ã€‚</li>
</ul>
<p><code>as</code>å…³é”®å­—ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> x, <span class="type">int</span> y</span><br><span class="line"><span class="keyword">where</span> x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>]</span><br><span class="line"><span class="keyword">select</span> x, y, x <span class="operator">*</span> y <span class="keyword">as</span> product, &quot;product: &quot; <span class="operator">+</span> product</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428223626775.png" alt="image-20250428223626775"></p>
<p><code>order by</code>å…³é”®å­—ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> x, <span class="type">int</span> y</span><br><span class="line"><span class="keyword">where</span> x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>]</span><br><span class="line"><span class="keyword">select</span> x, y, x <span class="operator">*</span> y <span class="keyword">as</span> product, &quot;product: &quot; <span class="operator">+</span> product <span class="keyword">order</span> <span class="keyword">by</span> y <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428224020685.png" alt="image-20250428224020685"></p>
<h4 id="æŸ¥è¯¢è°“è¯">æŸ¥è¯¢è°“è¯</h4>
<p>æŸ¥è¯¢è°“è¯æ˜¯ä¸€ä¸ª<strong>éæˆå‘˜è°“è¯</strong>ï¼Œå¹¶åœ¨æœ€å¼€å¤´ä½¿ç”¨<code>query</code>ä½œä¸ºæ³¨è§£ã€‚å®ƒè¿”å›è°“è¯è®¡ç®—ç»“æœçš„æ‰€æœ‰å…ƒç»„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹:</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query <span class="type">int</span> getProduct(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">  x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span></span><br><span class="line">  y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>] <span class="keyword">and</span></span><br><span class="line">  <span class="keyword">result</span> <span class="operator">=</span> x <span class="operator">*</span> y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428233723056.png" alt="image-20250428233723056"></p>
<p>ç¼–å†™æŸ¥è¯¢è°“è¯è€Œä¸æ˜¯<code>select</code>å­å¥çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä»£ç çš„å…¶å®ƒéƒ¨åˆ†è°ƒç”¨è°“è¯ã€‚<code>select</code>å­å¥å°±åƒä¸€ä¸ªåŒ¿åè°“è¯ï¼Œä½ ä»¥åæ— æ³•è°ƒç”¨å®ƒã€‚</p>
<p>ä¾‹å¦‚ï¼Œ æˆ‘ä»¬å¯ä»¥åœ¨ç±»ä¸­çš„ç‰¹å¾è°“è¯å†…éƒ¨è°ƒç”¨ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">query <span class="type">int</span> getProduct(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span></span><br><span class="line">    y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>] <span class="keyword">and</span></span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> x <span class="operator">*</span> y</span><br><span class="line">&#125;</span><br><span class="line">class MultipleOfThree extends <span class="type">int</span> &#123;</span><br><span class="line">    MultipleOfThree() &#123; </span><br><span class="line">        this <span class="operator">=</span> getProduct(_, _) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">from</span> MultipleOfThree m <span class="keyword">select</span> m</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬æŸ¥è¯¢ç»“æœå°±æœ‰2ä¸ªï¼Œä¸€ä¸ªæ˜¯å†…ç½®çš„<code>#select</code>ï¼Œä¸€ä¸ªæ˜¯<code>getProduct</code>ï¼Œ<code>#select</code>çš„ç»“æœå¦‚ä¸‹:</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428234414817.png" alt="image-20250428234414817"></p>
<h3 id="ç±»å‹Types">ç±»å‹Types</h3>
<p><code>QL</code>æ˜¯ä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå› æ­¤æ¯ä¸ªå˜é‡éƒ½å¿…é¡»å…·æœ‰å£°æ˜ç±»å‹ã€‚</p>
<p>ç±»å‹æ˜¯ä¸€ç»„å€¼ã€‚ä¾‹å¦‚ï¼Œç±»å‹<code>int</code>æ˜¯æ•´æ•°çš„é›†åˆã€‚æ³¨æ„âš ï¸ï¼Œä¸€ä¸ªå€¼å¯ä»¥å±äºå¤šä¸ªé›†åˆï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥æœ‰å¤šç§ç±»å‹ã€‚</p>
<p><code>QL</code>ä¸­çš„ç±»å‹æœ‰åŸå§‹ç±»å‹(<code>primitive types</code>)ã€ç±»(<code>classes</code>)ã€å­—ç¬¦ç±»å‹(<code>character types</code>)ã€ç±»åŸŸç±»å‹(<code>class domain types</code>)ã€ä»£æ•°æ•°æ®ç±»å‹(<code>algebraic datatypes</code>)ã€ç±»å‹è”åˆ(<code>type unions</code>)å’Œæ•°æ®åº“ç±»å‹(<code>database types</code>)ã€‚</p>
<h4 id="åŸå§‹ç±»å‹-Primitive-types">åŸå§‹ç±»å‹(Primitive types)</h4>
<p>è¿™äº›ç±»å‹å†…ç½®äº QL ä¸­ï¼Œå¹¶ä¸”å§‹ç»ˆåœ¨å…¨å±€<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/name-resolution/#namespaces">å‘½åç©ºé—´</a>ä¸­å¯ç”¨ï¼Œç‹¬ç«‹äºæ‚¨æ­£åœ¨æŸ¥è¯¢çš„æ•°æ®åº“ã€‚</p>
<ol>
<li><strong>boolean</strong> : æ­¤ç±»å‹åŒ…å«å€¼<code>true</code>å’Œ<code>false</code>ã€‚</li>
<li><strong>float</strong> : æ­¤ç±»å‹åŒ…å«64ä½æµ®ç‚¹æ•°ï¼Œä¾‹å¦‚<code>6.28</code>å’Œ<code>-0.618</code></li>
<li><strong>int</strong> : æ­¤ç±»å‹åŒ…å« 32 ä½<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Two's_complement">äºŒè¿›åˆ¶è¡¥ç </a>æ•´æ•°ï¼Œä¾‹å¦‚<code>-1</code>å’Œ<code>42</code> ã€‚</li>
<li><strong>string</strong> : æ­¤ç±»å‹åŒ…å« 16 ä½å­—ç¬¦çš„æœ‰é™å­—ç¬¦ä¸²ã€‚</li>
<li><strong>data</strong> : æ­¤ç±»å‹åŒ…å«æ—¥æœŸï¼ˆä¹Ÿå¯ä»¥åŒ…å«æ—¶é—´ï¼‰ã€‚</li>
</ol>
<p>QL åœ¨åŸºæœ¬ç±»å‹ä¸Šå®šä¹‰äº†ä¸€ç³»åˆ—å†…ç½®æ“ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥é€šè¿‡ä½¿ç”¨<code> .</code>çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œ <code>1.toString()</code>æ˜¯æ•´æ•°å¸¸é‡<code>1</code>çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚æœ‰å…³ QL ä¸­å¯ç”¨çš„å†…ç½®æ“ä½œçš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜… QL è¯­è¨€è§„èŒƒä¸­çš„<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#built-ins">å†…ç½®æ“ä½œ</a>éƒ¨åˆ†ã€‚</p>
<p>æ­¤å¤–ï¼Œ <a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/modules/#bigint">QlBuiltins::BigInt</a>æœ‰ä¸€ä¸ªä»»æ„èŒƒå›´çš„æ•´æ•°åŸå§‹ç±»å‹</p>
<h4 id="ç±»-Classes">ç±»(Classes)</h4>
<p>ä½ å¯ä»¥åœ¨<code>QL</code>ä¸­å®šä¹‰è‡ªå·±çš„ç±»å‹ã€‚ä¸€ç§æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ª<strong>ç±»</strong>ã€‚</p>
<p>ç±»æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥é‡å†™å’Œæ„é€ ä»£ç ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ï¼š</p>
<ul>
<li>å°†ç›¸å…³å€¼ç»„åˆåœ¨ä¸€èµ·ã€‚</li>
<li>æ ¹æ®è¿™äº›å€¼å®šä¹‰<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#member-predicates">æˆå‘˜è°“è¯</a>ã€‚</li>
<li>å®šä¹‰å­ç±»ä»¥é‡å†™æˆå‘˜è°“è¯ã€‚</li>
</ul>
<p>QL ä¸­çš„ç±»ä¸ä¼šâ€œåˆ›å»ºâ€æ–°å¯¹è±¡ï¼Œå®ƒä»…è¡¨ç¤ºé€»è¾‘å±æ€§ã€‚å¦‚æœæŸä¸ªå€¼æ»¡è¶³è¯¥é€»è¾‘å±æ€§ï¼Œåˆ™è¯¥å€¼å±äºç‰¹å®šç±»ã€‚</p>
<h5 id="å®šä¹‰ä¸€ä¸ªç±»å‹-Defining-a-class">å®šä¹‰ä¸€ä¸ªç±»å‹(Defining a class)</h5>
<p>è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š</p>
<ol>
<li>å…³é”®å­—<code>class</code></li>
<li>ç±»çš„åç§°ã€‚è¿™æ˜¯ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#identifiers">æ ‡è¯†ç¬¦</a> ä»¥å¤§å†™å­—æ¯å¼€å¤´ã€‚</li>
<li>æ”¹ç±»é€šè¿‡<code>extends</code>å’Œ<code>/</code>æˆ–<code>instanceof</code>å…³è”çˆ¶ç±»å‹(<code>supertypes</code>)ã€‚</li>
<li>ç±»çš„ä¸»ä½“ï¼Œç”¨æ‹¬å·æ‹¬èµ·æ¥ã€‚</li>
</ol>
<p>å®šä¹‰ç±»çš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ClassName</span> [<span class="keyword">extends</span> <span class="title class_">Parent</span>] &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç±»åé¦–å­—æ¯å¿…é¡»æ˜¯å¤§å†™âš ï¸ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™å®šä¹‰äº†ä¸€ä¸ªç±»<code>OneTwoThree</code>ï¼Œå®ƒåŒ…å«å€¼<code>1</code>,<code>2</code>å’Œ<code>3</code>ã€‚ <a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a>æ•æ‰ â€œæ˜¯æ•´æ•° 1ã€2 æˆ– 3 ä¹‹ä¸€â€ çš„é€»è¾‘å±æ€§ã€‚</p>
<p><code>OneTwoThree</code>æ‰©å±•äº†<code>int</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯<code>int</code>çš„å­ç±»å‹ã€‚<code>QL</code>ä¸­çš„ç±»å¿…é¡»å§‹ç»ˆå…·æœ‰è‡³å°‘ä¸€ä¸ªçˆ¶ç±»å‹(<code>supertypes</code>)ã€‚ä½¿ç”¨<code>extends</code>å…³é”®å­—å¼•ç”¨çš„çˆ¶ç±»å‹ç§°ä¸ºç±»çš„åŸºç±»å‹(<code>base types</code>)ã€‚ç±»çš„å€¼åŒ…å«åœ¨çˆ¶ç±»å‹çš„äº¤é›†ä¸­ï¼ˆå³ï¼Œå®ƒä»¬ä½äº<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#domain-types">ç±»çš„åŸŸç±»å‹</a>ä¸­ï¼‰ã€‚ç±»ä»å…¶åŸºç±»å‹ç»§æ‰¿æ‰€æœ‰æˆå‘˜è°“è¯ã€‚</p>
<p>ä¸€ä¸ªç±»å¯ä»¥æ‰©å±•å¤šç§ç±»å‹ã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&quot;<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#multiple-inheritance"> å¤šé‡ç»§æ‰¿ </a>&quot;ã€‚ä¸€ä¸ªç±»å¯ä»¥æ‰©å±•<code>final</code>ç±»å‹ï¼ˆæˆ–<code>final</code>ç±»å‹çš„åˆ«åï¼‰ï¼Œè¯·å‚é˜…&quot;<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#final-extensions">final æ‰©å±• </a>â€œã€‚ç±»è¿˜å¯ä»¥ç‰¹åŒ–å…¶ä»–ç±»å‹ï¼Œè€Œæ— éœ€é€šè¿‡<code>instanceof</code>æ‰©å±•ç±»æ¥å£ï¼Œè¯·å‚é˜…â€<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#instanceof-extensions"> ä¸æ‰©å±•å­ç±»å‹ </a>&quot;ã€‚</p>
<p>åœ¨<code>CodeQL</code>ä¸­ï¼Œç±»å…è®¸å¤šé‡ç»§æ‰¿ï¼Œä½†æ˜¯ä»¥ä¸‹æ“ä½œæ˜¯éæ³•çš„:</p>
<ul>
<li>ä¸èƒ½ç»§æ‰¿æœ¬èº«</li>
<li>ä¸èƒ½ç»§æ‰¿<code>final</code>ç±»</li>
<li>ä¸èƒ½ç»§æ‰¿ä¸å…¼å®¹çš„ç±»å‹ï¼Œè¯·å‚è€ƒ&quot;<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#type-compatibility"> ç±»å‹å…¼å®¹æ€§ </a>&quot;ã€‚</li>
</ul>
<p>ä½ ä¹Ÿå¯ä»¥ä¸ºç±»æ·»åŠ æ³¨è§£ã€‚å¯ä»¥æŸ¥çœ‹ç±»çš„<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/annotations/#annotations-overview">æ³¨è§£</a>åˆ—è¡¨ã€‚</p>
<h5 id="ç±»ä¸»ä½“-Class-bodies">ç±»ä¸»ä½“(Class bodies)</h5>
<p>ç±»çš„ä¸»ä½“å¯ä»¥åŒ…å«ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a>(<code>characteristic predicate</code>)å£°æ˜ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a>(<code>member predicate</code>)å£°æ˜ã€‚</li>
<li>ä»»æ„æ•°é‡çš„<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#fields">å­—æ®µ</a>(<code>field</code>)å£°æ˜ã€‚</li>
</ul>
<p>å½“ä½ å®šä¹‰ä¸€ä¸ªç±»æ—¶ï¼Œè¯¥ç±»è¿˜ä¼šä»å…¶çˆ¶ç±»å‹ç»§æ‰¿æ‰€æœ‰éç§æœ‰æˆå‘˜è°“è¯å’Œå­—æ®µã€‚</p>
<p>æ ¹æ®å®ƒä»¬æ˜¯å¦æ˜¯<code>final</code>çš„ï¼Œä½ å¯ä»¥<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#overriding-member-predicates">é‡å†™</a>(<code>override</code>)æˆ– <a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#final-extensions">éšè—</a>(<code>shadow</code>)è¿™äº›è°“è¯å’Œå­—æ®µä»¥èµ‹äºˆå®ƒä»¬æ›´å…·ä½“çš„å®šä¹‰ã€‚</p>
<h5 id="ç‰¹å¾è°“è¯-Characteristic-predicate">ç‰¹å¾è°“è¯(Characteristic predicate)</h5>
<p>ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­ç±»çš„æ„é€ å‡½æ•°ï¼Œåªèƒ½å®šä¹‰ä¸€ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç‰¹å¾è°“è¯ä¸­ä½¿ç”¨<code>this</code>æ¥é™åˆ¶ç±»ä¸­å¯èƒ½çš„å€¼ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ<code>OneTwoThree</code>è¢«é™åˆ¶ä¸º<code>1-3</code>ä¸­çš„æ•´æ•°ã€‚</p>
<h5 id="æˆå‘˜è°“è¯-Member-predicate">æˆå‘˜è°“è¯(Member predicate)</h5>
<p>è¿™äº›è°“è¯ä»…é€‚ç”¨äºç±»ä¸­ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å»è°ƒç”¨ç±»çš„æˆå‘˜è°“è¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class OneTwoThree extends <span class="type">int</span> &#123;</span><br><span class="line">    OneTwoThree() &#123; <span class="operator">/</span><span class="operator">/</span> characteristic predicate</span><br><span class="line">      this <span class="operator">=</span> <span class="number">1</span> <span class="keyword">or</span> this <span class="operator">=</span> <span class="number">2</span> <span class="keyword">or</span> this <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    string getAString() &#123; <span class="operator">/</span><span class="operator">/</span> <span class="keyword">member</span> predicate</span><br><span class="line">      <span class="keyword">result</span> <span class="operator">=</span> &quot;One, two or three: &quot; <span class="operator">+</span> this.toString()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    predicate isEven() &#123; <span class="operator">/</span><span class="operator">/</span> <span class="keyword">member</span> predicate</span><br><span class="line">      this <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="number">1.</span>(OneTwoThree).getAString()</span><br></pre></td></tr></table></figure>
<p>ç»“æœä¸ºï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250429143457327.png" alt="image-20250429143457327"></p>
<p>è¡¨è¾¾å¼ï¼ˆ<code>OneTwoThree</code>)æ˜¯ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/expressions/#casts">å¼ºåˆ¶ç±»å‹è½¬æ¢ </a>ã€‚å®ƒç¡®ä¿<code>1</code>å…·æœ‰ç±»å‹<code>OneTwoThree</code>è€Œä¸ä»…ä»…æ˜¯<code>int</code>ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥è®¿é—®æˆå‘˜è°“è¯<code>getAString()</code>ã€‚</p>
<p>è¿˜å¯ä»¥è¿™æ ·è°ƒç”¨ï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>string</code>å®šä¹‰çš„å†…ç½®å‡½æ•°<code>toUpperCase()</code>ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1.</span>(OneTwoThree).getAString().toUpperCase()</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250429152458427.png" alt="image-20250429152458427"></p>
<h5 id="å­—æ®µ-Field">å­—æ®µ(Field)</h5>
<p>è¿™äº›æ˜¯åœ¨ç±»ä¸»ä½“ä¸­å£°æ˜çš„å˜é‡ã€‚ç±»ä¸»ä½“ä¸­å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å­—æ®µå£°æ˜ã€‚ä½ å¯ä»¥åœ¨ç±»å†…éƒ¨çš„è°“è¯å£°æ˜ä¸­ä½¿ç”¨è¿™äº›å˜é‡ã€‚ä¸<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#this">å˜é‡ </a><code>this</code> ç±»ä¼¼ï¼Œå­—æ®µå¿…é¡»åœ¨<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a> ä¸­å—åˆ°çº¦æŸã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼Œå®ƒè¾“å‡º<code>10</code>ä»¥å†…æ¯ä¸ªæ•°å­—çš„é™¤æ•°ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class <span class="type">SmallInt</span> extends <span class="type">int</span> &#123;</span><br><span class="line">    <span class="type">SmallInt</span>() &#123; this <span class="operator">=</span> [<span class="number">1</span> .. <span class="number">10</span>] &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  class DivisibleInt extends <span class="type">SmallInt</span> &#123;</span><br><span class="line">    <span class="type">SmallInt</span> divisor;   <span class="operator">/</span><span class="operator">/</span> declaration <span class="keyword">of</span> the field `divisor`</span><br><span class="line">    DivisibleInt() &#123; this <span class="operator">%</span> divisor <span class="operator">=</span> <span class="number">0</span> &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="type">SmallInt</span> getADivisor() &#123; <span class="keyword">result</span> <span class="operator">=</span> divisor &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">from</span> DivisibleInt i</span><br><span class="line">  <span class="keyword">select</span> i, i.getADivisor()</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430115409761.png" alt="image-20250430115409761"></p>
<h5 id="å…·ä½“ç±»-Concrete-classes">å…·ä½“ç±»(Concrete classes)</h5>
<p>ä¸Šè¿°æ‰€æåˆ°çš„ç±»éƒ½æ˜¯å…·ä½“çš„ç±»ï¼Œå…·ä½“ç±»æ˜¯é€šè¿‡é™åˆ¶è¾ƒå¤§ç±»å‹ä¸­çš„å€¼æ¥å®šä¹‰çš„ã€‚</p>
<h5 id="æŠ½è±¡ç±»-Abstract-classes">æŠ½è±¡ç±»(Abstract classes)</h5>
<p>å¸¦æœ‰ <code>abstract</code><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/annotations/#abstract"> æ³¨é‡Šçš„</a>ç±»ç§°ä¸º<strong>æŠ½è±¡</strong>ç±»ã€‚å…·ä½“è€Œè¨€ï¼Œå¯¹äºæŠ½è±¡ç±»ä¸­çš„å€¼ï¼Œå®ƒå¿…é¡»<strong>æ»¡è¶³ç±»æœ¬èº«çš„ç‰¹å¾è°“è¯å’Œå­ç±»çš„ç‰¹å¾è°“è¯</strong>ã€‚è¯·æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ final æ‰©å±•ä¸è¢«è§†ä¸ºå­ç±»ã€‚</p>
<p>å¦‚æœæ‚¨æƒ³å°†å¤šä¸ªç°æœ‰ç±»å½’ç±»åˆ°ä¸€ä¸ªé€šç”¨åç§°ä¸‹ï¼ŒæŠ½è±¡ç±»å°±éå¸¸æœ‰ç”¨ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨æ‰€æœ‰è¿™äº›ç±»ä¸Šå®šä¹‰æˆå‘˜è°“è¯ã€‚ä½ è¿˜å¯ä»¥æ‰©å±•é¢„å®šä¹‰çš„æŠ½è±¡ç±»ï¼šä¾‹å¦‚ï¼Œå¦‚æœä½ å¯¼å…¥ä¸€ä¸ªåŒ…å«æŠ½è±¡ç±»çš„åº“ï¼Œåˆ™å¯ä»¥ä¸ºå…¶æ·»åŠ æ›´å¤šå­ç±»ã€‚</p>
<p>ä¾‹å­ï¼š</p>
<p>å¸Œæœ›è¯†åˆ«æ‰€æœ‰å¯è§£é‡Šä¸º SQL æŸ¥è¯¢çš„è¡¨è¾¾å¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŠ½è±¡ç±»æ¥æè¿°è¿™äº›è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SqlExpr</span> <span class="keyword">extends</span> <span class="title class_">Expr</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å®šä¹‰å„ç§å­ç±»â€”â€”æ¯ç§æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¯¹åº”ä¸€ä¸ªã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å®šä¹‰ä¸€ä¸ªå­ç±» <code>class PostgresSqlExpr extends SqlExpr</code> ï¼Œå®ƒåŒ…å«ä¼ é€’ç»™æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢çš„<code>Postgres API</code>çš„è¡¨è¾¾å¼ã€‚ä½ ä¹Ÿå¯ä»¥ä¸º<code>MySQL</code>å’Œå…¶ä»–æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå®šä¹‰ç±»ä¼¼çš„å­ç±»ã€‚</p>
<h5 id="é‡å†™æˆå‘˜è°“è¯-Overriding-member-predicates">é‡å†™æˆå‘˜è°“è¯(Overriding member predicates)</h5>
<p>å¦‚æœä¸€ä¸ªç±»ä»é<code>final</code> çš„çˆ¶ç±»å‹ç»§æ‰¿äº†æˆå‘˜è°“è¯ï¼Œåˆ™å¯ä»¥<strong>é‡å†™</strong>ç»§æ‰¿çš„å®šä¹‰ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸ç»§æ‰¿è°“è¯å…·æœ‰ç›¸åŒåç§°å’Œå±æ€§çš„æˆå‘˜è°“è¯ï¼Œå¹¶æ·»åŠ  <code>override</code><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/annotations/#override"> æ³¨è§£ </a>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæ‰©å±•äº†ä¸€ä¸‹å‰é¢çš„ä¾‹å­ï¼š</p>
<p><code>OneTwo</code>çš„<code>getAstring()</code>è¦†ç›–äº†åŸæ¥çš„<code>OneTwoThree</code>çš„<code>getAstring()</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">    OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwo</span> <span class="keyword">extends</span> <span class="title class_">OneTwoThree</span> &#123;</span><br><span class="line">    OneTwo() &#123;</span><br><span class="line">      <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">    override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">      result = <span class="string">&quot;One or two: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">from OneTwoThree o select o, o.getAString()</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430125024851.png" alt="image-20250430125024851"></p>
<p>å†åŠ ä¸€ä¸ª<code>TwoThree</code>ï¼Œç»§ç»­é‡å†™<code>getAString()</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwo</span> <span class="keyword">extends</span> <span class="title class_">OneTwoThree</span> &#123;</span><br><span class="line">  OneTwo() &#123;</span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">  override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = <span class="string">&quot;One or two: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TwoThree</span> <span class="keyword">extends</span> <span class="title class_">OneTwoThree</span> &#123;</span><br><span class="line">  TwoThree() &#123;</span><br><span class="line">    <span class="built_in">this</span> = <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line">  override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = <span class="string">&quot;Two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">from OneTwoThree o</span><br><span class="line">select o, o.getAString()</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œè¾“å‡ºçš„ç»“æœä¸ºï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430124352869.png" alt="image-20250430124352869"></p>
<h5 id="å¤šé‡ç»§æ‰¿-Multiple-inheritance">å¤šé‡ç»§æ‰¿(Multiple inheritance)</h5>
<p>ä¸€ä¸ªç±»å¯ä»¥æ‰©å±•å¤šç§ç±»å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼šç»§æ‰¿è‡ªæ‰€æœ‰è¿™äº›ç±»å‹ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Two</span> <span class="keyword">extends</span> <span class="title class_">OneTwo</span>, TwoThree &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªç±»<code>Two</code>åŒæ—¶ç»§æ‰¿äº†<code>OneTwo</code>å’Œ<code>TwoThree</code>ï¼Œå®ƒè¿˜é—´æ¥ç»§æ‰¿è‡ª<code>OneTwoThree</code>å’Œ<code>int</code>ï¼Œé‚£ä¹ˆé€šè¿‡ç‰¹å¾è°“è¯æˆ‘ä»¬çŸ¥é“å…¶å€¼åªèƒ½æ˜¯2ã€‚<br>
å¦‚æœä¸€ä¸ªå­ç±»ç»§æ‰¿äº†åŒä¸€ä¸ªè°“è¯çš„å¤šä¸ªå®šä¹‰ï¼Œé‚£ä¹ˆè¯¥ç±»è¿˜éœ€è¦æ‰‹åŠ¨é‡å†™è¯¥è°“è¯ä»¥é¿å…æ­§ä¹‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>super</code>è¡¨è¾¾å¼ã€‚</p>
<p>ä¾‹å¦‚:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Two</span> <span class="keyword">extends</span> <span class="title class_">OneTwo</span>, TwoThree &#123;</span><br><span class="line">  override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = TwoThree.<span class="built_in">super</span>.getAString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Finalæ‹“å±•-Final-extensions">Finalæ‹“å±•(Final extensions)</h5>
<p>ç±»å¯ä»¥æ‰©å±•<code>final</code>ç±»å‹æˆ–<code>final</code>ç±»å‹çš„åˆ«åã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼šç»§æ‰¿è¿™äº›çˆ¶ç±»å‹çš„æ‰€æœ‰æˆå‘˜è°“è¯å’Œå­—æ®µçš„<code>final</code>ç‰ˆæœ¬ã€‚é€šè¿‡<code>final</code>æ‰©å±•ç»§æ‰¿çš„æˆå‘˜è°“è¯æ— æ³•è¢«è¦†ç›–ï¼Œä½†å¯ä»¥è¢«éšè—ã€‚</p>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">    OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">FinalOneTwoThree</span> = OneTwoThree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoFinalExtension</span> <span class="keyword">extends</span> <span class="title class_">FinalOneTwoThree</span> &#123;</span><br><span class="line">  OneTwoFinalExtension() &#123;</span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = <span class="string">&quot;One or two: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">from OneTwoThree o </span><br><span class="line">select o, o.getAString()</span><br><span class="line"><span class="comment">//from OneTwoFinalExtension o </span></span><br><span class="line"><span class="comment">//select o, o.getAString()</span></span><br></pre></td></tr></table></figure>
<p>è¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430151657937.png" alt="image-20250430151657937"></p>
<p>ä¿®æ”¹ä¸ºï¼š<code>from OneTwoFinalExtension o select o, o.getAString()</code></p>
<p>å½“åœ¨<code>OneTwoFinalExtension</code>ä¸Šè°ƒç”¨<code>getAString()</code>æ—¶ï¼ŒåŸå§‹å®šä¹‰è¢«å±è”½äº†ã€‚ç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430151848901.png" alt="image-20250430151848901"></p>
<h3 id="å˜é‡Variables">å˜é‡Variables</h3>
<p>QL ä¸­çš„å˜é‡ä½¿ç”¨æ–¹å¼ä¸ä»£æ•°æˆ–é€»è¾‘ä¸­çš„å˜é‡ç±»ä¼¼ã€‚å®ƒä»¬è¡¨ç¤ºä¸€ç»„å€¼ï¼Œè¿™äº›å€¼é€šå¸¸å—å…¬å¼(<code>formula</code>)çº¦æŸã€‚</p>
<p>è¿™ä¸å…¶ä»–ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­çš„å˜é‡ä¸åŒï¼Œåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå˜é‡ä»£è¡¨å¯èƒ½åŒ…å«æ•°æ®çš„å†…å­˜ä½ç½®ã€‚è¿™äº›æ•°æ®ä¹Ÿå¯èƒ½éšæ—¶é—´è€Œå˜åŒ–ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>QL</code>ä¸­ï¼Œ <code>n = n + 1</code> æ˜¯ä¸€ä¸ªç­‰å¼<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/formulas/#formulas">å…¬å¼ </a>ï¼Œä»…å½“ <code>n</code> ç­‰äº <code>n + 1</code> æ—¶æ‰æˆç«‹ï¼ˆå› æ­¤å®é™…ä¸Šå®ƒå¯¹ä»»ä½•æ•°å€¼éƒ½ä¸æˆç«‹ï¼‰ã€‚åœ¨<code>Java</code>ä¸­ï¼Œ <code>n = n + 1</code> ä¸æ˜¯ç­‰å¼ï¼Œè€Œæ˜¯ä¸€ä¸ªèµ‹å€¼æ“ä½œï¼Œå®ƒé€šè¿‡åœ¨å½“å‰å€¼ä¸ŠåŠ  <code>1</code> æ¥æ›´æ”¹ <code>n</code> çš„å€¼ã€‚</p>
<h4 id="å£°æ˜å˜é‡-Declaring-a-variable">å£°æ˜å˜é‡(Declaring a variable)</h4>
<p>æ‰€æœ‰å˜é‡å£°æ˜éƒ½ç”±å˜é‡<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#types">ç±»å‹</a>å’Œåç§°ç»„æˆã€‚åç§°å¯ä»¥æ˜¯ä»»ä½•<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#identifiers">æ ‡è¯†ç¬¦</a> ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ <code>int i</code> ã€ <code>SsaDefinitionNode node</code> å’Œ <code>LocalScopeVariable lsv</code> å£°æ˜å˜é‡ <code>i</code> ã€ <code>node</code> å’Œ <code>lsv</code> çš„ç±»å‹ä¸º <code>int</code> ã€ <code>SsaDefinitionNode</code> å’Œ <code>LocalScopeVariable</code></p>
<p>å˜é‡å£°æ˜å‡ºç°åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¾‹å¦‚åœ¨<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/queries/#select-clauses">é€‰æ‹©å­å¥</a>ä¸­ã€åœ¨<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/formulas/#quantified-formulas">é‡åŒ–å…¬å¼</a>ä¸­ã€ä½œä¸º<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/predicates/#predicates">è°“è¯</a>çš„å‚æ•°ç­‰ç­‰ã€‚</p>
<p>ä»æ¦‚å¿µä¸Šè®²ï¼Œä½ å¯ä»¥è®¤ä¸ºå˜é‡ä¿å­˜äº†å…¶ç±»å‹å…è®¸çš„æ‰€æœ‰å€¼ï¼Œ<strong>ä½†è¦å—åˆ°ä»»ä½•è¿›ä¸€æ­¥çš„çº¦æŸâš ï¸</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹é€‰æ‹©å­å¥ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> i</span><br><span class="line"><span class="keyword">where</span> i <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">9</span>]</span><br><span class="line"><span class="keyword">select</span> i</span><br></pre></td></tr></table></figure>
<p>ä»…æ ¹æ®å˜é‡ <code>i</code> çš„ç±»å‹ï¼Œå®ƒå¯ä»¥åŒ…å«æ‰€æœ‰æ•´æ•°ã€‚ç„¶è€Œï¼Œå®ƒå—åˆ°å…¬å¼ <code>i in [0 .. 9]</code> çš„é™åˆ¶ã€‚å› æ­¤ï¼Œ<code>select</code> å­å¥çš„ç»“æœæ˜¯ä»<code>0</code> åˆ°<code>9</code>ä¹‹é—´çš„<code>10</code>ä¸ªæ•°å­—ï¼ˆå« <code>0</code> å’Œ <code>9</code> ï¼‰ã€‚</p>
<p>å¦å¤–ï¼Œè¯·æ³¨æ„âš ï¸æŸ¥è¯¢ä¼šå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> i</span><br><span class="line"><span class="keyword">select</span> i</span><br></pre></td></tr></table></figure>
<p>ç†è®ºä¸Šï¼Œå®ƒä¼šæœ‰æ— é™å¤šä¸ªç»“æœï¼Œå› ä¸ºå˜é‡<code>i</code>çš„å¯èƒ½å€¼å¹¶ä¸å—é™äºæœ‰é™ä¸ªã€‚æƒ³äº†è§£æ›´å¤šï¼Œå¯å‚é˜…â€œ<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/evaluation-of-ql-programs/#binding"> ç»‘å®š </a>â€ã€‚</p>
<h4 id="è‡ªç”±å˜é‡å’Œç»‘å®šå˜é‡-Free-and-bound-variables">è‡ªç”±å˜é‡å’Œç»‘å®šå˜é‡(Free and bound variables)</h4>
<p>å˜é‡å¯ä»¥æ‰®æ¼”ä¸åŒçš„è§’è‰²ã€‚æœ‰äº›å˜é‡æ˜¯<strong>è‡ªç”±å˜é‡</strong> ï¼Œå®ƒä»¬çš„å€¼ç›´æ¥å½±å“ä½¿ç”¨å®ƒä»¬çš„<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/expressions/#expressions">è¡¨è¾¾å¼</a>çš„å€¼ï¼Œæˆ–è€… ä½¿ç”¨å®ƒä»¬çš„<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/formulas/#formulas">å…¬å¼</a>æ˜¯å¦æˆç«‹ã€‚å…¶ä»–å˜é‡è¢«ç§°ä¸º<strong>ç»‘å®š</strong>å˜é‡ï¼Œå®ƒä»¬è¢«é™åˆ¶åœ¨ç‰¹å®šçš„å€¼é›†å†…ã€‚</p>
<p>ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;hello&quot;.indexOf(&quot;l&quot;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span>(<span class="type">float</span> f <span class="operator">|</span> f <span class="keyword">in</span> [<span class="number">-3</span> .. <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">(i <span class="operator">+</span> <span class="number">7</span>) <span class="operator">*</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">x.<span class="built_in">sqrt</span>()</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ²¡æœ‰ä»»ä½•å˜é‡ã€‚å®ƒæŸ¥æ‰¾å­—ç¬¦ä¸² <code>&quot;hello&quot;</code> ä¸­ <code>&quot;l&quot;</code> å‡ºç°çš„ï¼ˆä»é›¶å¼€å§‹çš„ï¼‰ç´¢å¼•ï¼Œå› æ­¤å…¶è®¡ç®—ç»“æœä¸º <code>2</code> å’Œ <code>3</code> ã€‚</p>
<p>ç¬¬äºŒä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä¸º <code>-3</code> ï¼Œå³ <code>[-3 .. 3]</code> èŒƒå›´å†…çš„æœ€å°å€¼ã€‚è™½ç„¶æ­¤è¡¨è¾¾å¼ä½¿ç”¨äº†å˜é‡ <code>f</code> ï¼Œä½†å®ƒåªæ˜¯ä¸€ä¸ªå ä½ç¬¦æˆ–â€œè™šæ‹Ÿâ€å˜é‡ï¼Œæ‚¨æ— æ³•ä¸ºå…¶èµ‹å€¼ã€‚æ‚¨å¯ä»¥å°† <code>f</code> æ›¿æ¢ä¸ºå…¶ä»–å˜é‡ï¼Œè€Œä¸ä¼šæ”¹å˜è¡¨è¾¾å¼çš„å«ä¹‰ã€‚ä¾‹å¦‚ï¼Œ <code>min(float f | f in [-3 .. 3])</code> å§‹ç»ˆç­‰äº <code>min(float other | other in [-3 .. 3])</code> . è¿™æ˜¯<strong>ç»‘å®šå˜é‡</strong>çš„ä¸€ä¸ªä¾‹å­ã€‚</p>
<p>å¯¹äºè¡¨è¾¾å¼ <code>(i + 7) * 3</code> å’Œ <code>x.sqrt()</code> ã€‚åœ¨è¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œè¡¨è¾¾å¼çš„å€¼å–å†³äºå˜é‡ <code>i</code> å’Œ <code>x</code> åˆ†åˆ«è¢«èµ‹å€¼çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå˜é‡çš„å€¼ä¼šå½±å“è¡¨è¾¾å¼çš„å€¼ã€‚è¿™äº›éƒ½æ˜¯<strong>è‡ªç”±å˜é‡</strong>çš„ä¾‹å­ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œå¦‚æœå…¬å¼åŒ…å«è‡ªç”±å˜é‡ï¼Œåˆ™è¯¥å…¬å¼æ˜¯å¦æˆç«‹å–å†³äºåˆ†é…ç»™è¿™äº›å˜é‡çš„å€¼ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;hello&quot;.indexOf(&quot;l&quot;) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span>(<span class="type">float</span> f <span class="operator">|</span> f <span class="keyword">in</span> [<span class="number">-3</span> .. <span class="number">3</span>]) <span class="operator">=</span> <span class="number">-3</span></span><br><span class="line"></span><br><span class="line">(i <span class="operator">+</span> <span class="number">7</span>) <span class="operator">*</span> <span class="number">3</span> instanceof <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">exists</span>(<span class="type">float</span> y <span class="operator">|</span> x.<span class="built_in">sqrt</span>() <span class="operator">=</span> y)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>ç¬¬ä¸€ä¸ªå…¬å¼ä¸åŒ…å«ä»»ä½•å˜é‡ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šæˆç«‹ï¼ˆå› ä¸º <code>&quot;hello&quot;.indexOf(&quot;l&quot;)</code> å…·æœ‰å€¼ <code>2</code> å’Œ <code>3</code> ï¼Œè€Œæ²¡æœ‰ <code>1</code> ï¼‰ã€‚</p>
</li>
<li>
<p>ç¬¬äºŒä¸ªå…¬å¼ä»…åŒ…å«ä¸€ä¸ªç»‘å®šå˜é‡ï¼Œå› æ­¤ä¸å—è¯¥å˜é‡å˜åŒ–çš„å½±å“ã€‚ç”±äº <code>min(float f | f in [-3 .. 3])</code> ç­‰äº <code>-3</code> ï¼Œå› æ­¤è¯¥å…¬å¼å§‹ç»ˆæˆç«‹ã€‚</p>
</li>
<li>
<p>ç¬¬ä¸‰ä¸ªå…¬å¼åŒ…å«ä¸€ä¸ªè‡ªç”±å˜é‡ <code>i</code> ã€‚å…¬å¼æ˜¯å¦æˆç«‹å–å†³äºèµ‹ç»™ <code>i</code> å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœèµ‹ç»™ <code>i</code> å€¼ä¸º<code>1</code> æˆ– <code>2</code> ï¼ˆæˆ–ä»»ä½•å…¶ä»– <code>int</code> ï¼‰ï¼Œåˆ™å…¬å¼æˆç«‹ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœèµ‹ç»™ <code>i</code>å€¼ä¸º <code>3.5</code> ï¼Œåˆ™å…¬å¼ä¸æˆç«‹ã€‚</p>
</li>
</ul>
<p>ç¬¬å››ä¸ªå…¬å¼åŒ…å«ä¸€ä¸ªè‡ªç”±å˜é‡ <code>x</code> å’Œä¸€ä¸ªç»‘å®šå˜é‡ <code>y</code> ã€‚å¦‚æœ <code>x</code> è¢«èµ‹å€¼ä¸ºéè´Ÿæ•°ï¼Œåˆ™æœ€åä¸€ä¸ªå…¬å¼æˆç«‹ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ <code>x</code> è¢«èµ‹å€¼ä¸º ä¾‹å¦‚ <code>-9</code> ï¼Œåˆ™å…¬å¼ä¸æˆç«‹ã€‚å˜é‡ <code>y</code> ä¸ä¼šå½±å“å…¬å¼æ˜¯å¦æˆç«‹ã€‚</p>
<h3 id="è¡¨è¾¾å¼Expressions">è¡¨è¾¾å¼Expressions</h3>
<p>è¡¨è¾¾å¼è®¡ç®—ä¸€ç»„å€¼å¹¶å…·æœ‰ç±»å‹ã€‚ä¾‹å¦‚ï¼Œè¡¨è¾¾å¼ <code>1 + 2</code> è®¡ç®—ç»“æœä¸ºæ•´æ•° <code>3</code> ï¼Œè¡¨è¾¾å¼ <code>&quot;QL&quot;</code> è®¡ç®—ç»“æœä¸ºå­—ç¬¦ä¸² <code>&quot;QL&quot;</code> ã€‚1 <code>1 + 2</code><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#types"> ç±»å‹</a>ä¸º <code>int</code> ï¼Œè€Œ <code>&quot;QL&quot;</code> ç±»å‹ä¸º <code>string</code> ã€‚æœ¬å°èŠ‚åªè®²è¿°çˆ¶ç±»è¡¨è¾¾å¼ï¼Œå…¶å®ƒå¯å‚è€ƒ<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>ã€‚</p>
<h4 id="çˆ¶ç±»è¡¨è¾¾å¼-Super-expressions">çˆ¶ç±»è¡¨è¾¾å¼(Super expressions)</h4>
<p><code>QL</code>ä¸­çš„çˆ¶ç±»è¡¨è¾¾å¼ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚<code>Java</code>ï¼‰ä¸­çš„çˆ¶ç±»è¡¨è¾¾å¼ç±»ä¼¼ã€‚å½“æ‚¨æƒ³è¦ä½¿ç”¨çˆ¶ç±»å‹çš„è°“è¯å®šä¹‰æ—¶ï¼Œå¯ä»¥åœ¨è°“è¯è°ƒç”¨ä¸­ä½¿ç”¨å®ƒä»¬ã€‚å®é™…ä¸Šï¼Œå½“è°“è¯ä»å…¶çˆ¶ç±»å‹ç»§æ‰¿ä¸¤ä¸ªå®šä¹‰æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°“è¯å¿…é¡»<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#overriding-member-predicates">é‡å†™</a> è¿™äº›å®šä¹‰æ˜¯ä¸ºäº†é¿å…æ­§ä¹‰ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ç‰¹å®šè¶…ç±»å‹çš„å®šä¹‰ï¼Œè€Œä¸æ˜¯ç¼–å†™æ–°çš„å®šä¹‰ï¼Œå¯ä»¥ä½¿ç”¨çˆ¶ç±»è¡¨è¾¾å¼ã€‚</p>
<p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç±» <code>C</code> ç»§æ‰¿äº†è°“è¯çš„ä¸¤ä¸ªå®šä¹‰ <code>getANumber()</code> â€” ä¸€ä¸ªæ¥è‡ª <code>A</code> ï¼Œä¸€ä¸ªæ¥è‡ª <code>B</code> ã€‚å®ƒä¸ä¼šé‡å†™ä¸¤ä¸ªå®šä¹‰ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>B</code> ä¸­çš„å®šä¹‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  A() &#123; <span class="built_in">this</span> = <span class="number">1</span> &#125;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">getANumber</span><span class="params">()</span> &#123; result = <span class="number">2</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  B() &#123; <span class="built_in">this</span> = <span class="number">1</span> &#125;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">getANumber</span><span class="params">()</span> &#123; result = <span class="number">3</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> <span class="keyword">extends</span> <span class="title class_">A</span>, B &#123;</span><br><span class="line">  <span class="comment">// Need to define `int getANumber()`; otherwise it would be ambiguous</span></span><br><span class="line">  override <span class="type">int</span> <span class="title function_">getANumber</span><span class="params">()</span> &#123;</span><br><span class="line">    result = B.<span class="built_in">super</span>.getANumber()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">from C c</span><br><span class="line">select c, c.getANumber()</span><br></pre></td></tr></table></figure>
<p>è¯¥æŸ¥è¯¢çš„ç»“æœä¸ºï¼š</p>
<p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430190645346.png" alt="image-20250430190645346"></p>
<h3 id="å…¬å¼Formulas">å…¬å¼Formulas</h3>
<p>å…¬å¼å®šä¹‰è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„è‡ªç”±å˜é‡ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚</p>
<p>æ ¹æ®èµ‹äºˆè¿™äº›<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/variables/#free-variables">è‡ªç”±å˜é‡</a>çš„å€¼ï¼Œå…¬å¼å¯èƒ½ä¸ºçœŸæˆ–ä¸ºå‡ã€‚å½“å…¬å¼ä¸ºçœŸæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸è¯´è¯¥å…¬å¼æˆç«‹ ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœå°†å€¼ <code>9</code> èµ‹ç»™ <code>x</code> ï¼Œå…¬å¼ <code>x = 4 + 5</code> æˆç«‹ï¼Œä½†å¯¹äºå…¶ä»–èµ‹å€¼ï¼Œå…¬å¼ <code>x</code> = 4 + 5 ä¸æˆç«‹ã€‚æœ‰äº›å…¬å¼æ²¡æœ‰ä»»ä½•è‡ªç”±å˜é‡ã€‚ä¾‹å¦‚ï¼Œ <code>1 &lt; 2</code> å§‹ç»ˆæˆç«‹ï¼Œè€Œ <code>1 &gt; 2</code> æ°¸è¿œä¸ä¼šæˆç«‹ã€‚</p>
<p>ä¸‹é¢åªä»‹ç»ä¸ªäººè®¤ä¸ºæ¯”è¾ƒç‰¹æ®Šçš„ç‚¹ï¼Œå…¶å®ƒç‚¹è¾ƒä¸ºç®€å•ï¼Œå¯å‚è€ƒåŸæ–‡<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>ã€‚</p>
<h4 id="é¡ºåº-Order">é¡ºåº(Order)</h4>
<p>è¦ä½¿ç”¨è¿™äº›é¡ºåºè¿ç®—ç¬¦ä¹‹ä¸€æ¯”è¾ƒä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼å¿…é¡»å…·æœ‰ä¸€ä¸ªç±»å‹ï¼Œå¹¶ä¸”è¿™äº›ç±»å‹å¿…é¡»<a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/types/#type-compatibility">å…¼å®¹</a>å¹¶ä¸” <a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#ordering">å¯æ’åºçš„ </a>ã€‚</p>
<p>è¿™äº›ç¬¦å·ä¸ºï¼š<code>&gt;ã€&gt;=ã€&lt;ã€&lt;=</code></p>
<p>ä¾‹å¦‚ï¼Œå…¬å¼ <code>&quot;Ann&quot; &lt; &quot;Anne&quot;</code> å’Œ <code>5 + 6 &gt;= 11</code> å‡æˆç«‹ã€‚</p>
<h3 id="æ³¨è§£Annotations">æ³¨è§£Annotations</h3>
<p>æ³¨é‡Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥å°†å…¶ç›´æ¥æ”¾ç½®åœ¨<code>QL</code> å®ä½“æˆ–åç§°çš„å£°æ˜ä¹‹å‰ã€‚ç±»ä¼¼äº<code>Java</code>è¯­è¨€ã€‚</p>
<p>ä¾‹å¦‚ï¼Œè¦å°†æ¨¡å— <code>M</code> å£°æ˜ä¸ºç§æœ‰çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">module</span> M &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¯·æ³¨æ„ï¼Œä¸€äº›æ³¨é‡Šä½œç”¨äºå®ä½“æœ¬èº«ï¼Œè€Œå…¶ä»–æ³¨é‡Šä½œç”¨äºå®ä½“çš„ç‰¹å®š<em>åç§°</em> ï¼š</p>
<ul>
<li>
<p>å¯¹<strong>å®ä½“</strong>è¿›è¡Œæ“ä½œï¼š <code>abstract</code> ã€ <code>cached</code> ã€ <code>external</code> ã€ <code>transient</code> ã€ <code>override</code> ã€ <code>pragma</code> ã€ <code>language</code> å’Œ <code>bindingset</code></p>
</li>
<li>
<p>å¯¹<strong>åç§°</strong>è¿›è¡Œæ“ä½œï¼š <code>deprecated</code> ã€ <code>library</code> ã€ <code>private</code> ã€ <code>final</code> å’Œ <code>query</code></p>
</li>
</ul>
<p>ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ <code>private</code> æ³¨é‡Šä¸€ä¸ªå®ä½“ï¼Œé‚£ä¹ˆåªæœ‰è¯¥ç‰¹å®šåç§°æ˜¯ç§æœ‰çš„ã€‚ä½ ä»ç„¶å¯ä»¥ä½¿ç”¨å…¶ä»–åç§°ï¼ˆä½¿ç”¨ <a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/aliases/#aliases">alias</a> ï¼‰è®¿é—®è¯¥å®ä½“ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ <code>cached</code> æ³¨é‡Šä¸€ä¸ªå®ä½“ï¼Œé‚£ä¹ˆè¯¥å®ä½“æœ¬èº«å°†è¢«ç¼“å­˜ã€‚</p>
<p>å…·ä½“çš„ä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> M &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">foo</span><span class="params">()</span> &#123; result = <span class="number">1</span> &#125;</span><br><span class="line">  <span class="type">predicate</span> <span class="variable">bar</span> <span class="operator">=</span> foo/<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ <code>select M::foo()</code> ä¼šæŠ¥é”™ï¼Œå› ä¸ºåç§° <code>foo</code> æ˜¯ç§æœ‰çš„ã€‚æŸ¥è¯¢ <code>select M::bar()</code> æ˜¯æœ‰æ•ˆçš„ï¼ˆè¿”å›ç»“æœ <code>1</code> ï¼‰ï¼Œå› ä¸ºåç§° <code>bar</code> æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”å®ƒæ˜¯è°“è¯ <code>foo</code> çš„åˆ«åã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/codeql-overview/supported-languages-and-frameworks/">https://codeql.github.com/docs/codeql-overview/supported-languages-and-frameworks/</a> â†© <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn2" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://paper.seebug.org/1324/">https://paper.seebug.org/1324/</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn3" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/article-20135.htm">https://bbs.kanxue.com/article-20135.htm</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn4" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://github.com/webraybtl/CodeQLpy">https://github.com/webraybtl/CodeQLpy</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn5" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://github.com/WebGoat/WebGoat">https://github.com/WebGoat/WebGoat</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn6" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/predicates/">https://codeql.github.com/docs/ql-language-reference/predicates/</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn7" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/codeql/2.CodeQL%E8%AF%AD%E6%B3%95/">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/codeql/2.CodeQLè¯­æ³•/</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn8" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/queries/#">https://codeql.github.com/docs/ql-language-reference/queries/#</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn9" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/expressions/#">https://codeql.github.com/docs/ql-language-reference/expressions/#</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p>
</li>
<li id="fn10" class="footnote-item"><p><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/ql-language-reference/formulas/#formulas">https://codeql.github.com/docs/ql-language-reference/formulas/#formulas</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p>
</li>
</ol>
</section>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">ç”Ÿæˆæ•°æ®åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">åŸºç¡€è¯­æ³•ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.</span> <span class="toc-text">ç¼–å†™ç¬¬ä¸€ä¸ªæŸ¥è¯¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AAQL%E5%8C%85"><span class="toc-number">3.1.</span> <span class="toc-text">åˆ›å»ºç¬¬ä¸€ä¸ªQLåŒ…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.2.</span> <span class="toc-text">ç¼–å†™æŸ¥è¯¢</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#QL%E8%AF%AD%E8%A8%80%E5%8F%82%E8%80%83"><span class="toc-number">4.</span> <span class="toc-text">QLè¯­è¨€å‚è€ƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%93%E8%AF%8DPredicates"><span class="toc-number">4.1.</span> <span class="toc-text">è°“è¯Predicates</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E7%BB%93%E6%9E%9C%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.1.</span> <span class="toc-text">æ— ç»“æœè°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.2.</span> <span class="toc-text">ç»“æœè°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.3.</span> <span class="toc-text">é€’å½’è°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E8%B0%93%E8%AF%8D%E3%80%81%E9%9D%9E%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D%E3%80%81%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D"><span class="toc-number">4.1.4.</span> <span class="toc-text">ç‰¹å¾è°“è¯ã€éæˆå‘˜è°“è¯ã€æˆå‘˜è°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E8%A1%8C%E4%B8%BA%E4%B8%8E%E7%BB%91%E5%AE%9A%E9%9B%86"><span class="toc-number">4.1.5.</span> <span class="toc-text">ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E4%B8%AA%E7%BB%91%E5%AE%9A%E9%9B%86"><span class="toc-number">4.1.5.1.</span> <span class="toc-text">å•ä¸ªç»‘å®šé›†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E7%BB%91%E5%AE%9A%E9%9B%86"><span class="toc-number">4.1.5.2.</span> <span class="toc-text">å¤šä¸ªç»‘å®šé›†</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2Queries"><span class="toc-number">4.2.</span> <span class="toc-text">æŸ¥è¯¢Queries</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#select%E5%AD%90%E5%8F%A5"><span class="toc-number">4.2.1.</span> <span class="toc-text">selectå­å¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%B0%93%E8%AF%8D"><span class="toc-number">4.2.2.</span> <span class="toc-text">æŸ¥è¯¢è°“è¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8BTypes"><span class="toc-number">4.3.</span> <span class="toc-text">ç±»å‹Types</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%A7%8B%E7%B1%BB%E5%9E%8B-Primitive-types"><span class="toc-number">4.3.1.</span> <span class="toc-text">åŸå§‹ç±»å‹(Primitive types)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB-Classes"><span class="toc-number">4.3.2.</span> <span class="toc-text">ç±»(Classes)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E7%B1%BB%E5%9E%8B-Defining-a-class"><span class="toc-number">4.3.2.1.</span> <span class="toc-text">å®šä¹‰ä¸€ä¸ªç±»å‹(Defining a class)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B1%BB%E4%B8%BB%E4%BD%93-Class-bodies"><span class="toc-number">4.3.2.2.</span> <span class="toc-text">ç±»ä¸»ä½“(Class bodies)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E8%B0%93%E8%AF%8D-Characteristic-predicate"><span class="toc-number">4.3.2.3.</span> <span class="toc-text">ç‰¹å¾è°“è¯(Characteristic predicate)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D-Member-predicate"><span class="toc-number">4.3.2.4.</span> <span class="toc-text">æˆå‘˜è°“è¯(Member predicate)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5-Field"><span class="toc-number">4.3.2.5.</span> <span class="toc-text">å­—æ®µ(Field)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E7%B1%BB-Concrete-classes"><span class="toc-number">4.3.2.6.</span> <span class="toc-text">å…·ä½“ç±»(Concrete classes)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E7%B1%BB-Abstract-classes"><span class="toc-number">4.3.2.7.</span> <span class="toc-text">æŠ½è±¡ç±»(Abstract classes)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E5%86%99%E6%88%90%E5%91%98%E8%B0%93%E8%AF%8D-Overriding-member-predicates"><span class="toc-number">4.3.2.8.</span> <span class="toc-text">é‡å†™æˆå‘˜è°“è¯(Overriding member predicates)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E9%87%8D%E7%BB%A7%E6%89%BF-Multiple-inheritance"><span class="toc-number">4.3.2.9.</span> <span class="toc-text">å¤šé‡ç»§æ‰¿(Multiple inheritance)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Final%E6%8B%93%E5%B1%95-Final-extensions"><span class="toc-number">4.3.2.10.</span> <span class="toc-text">Finalæ‹“å±•(Final extensions)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8FVariables"><span class="toc-number">4.4.</span> <span class="toc-text">å˜é‡Variables</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F-Declaring-a-variable"><span class="toc-number">4.4.1.</span> <span class="toc-text">å£°æ˜å˜é‡(Declaring a variable)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E7%94%B1%E5%8F%98%E9%87%8F%E5%92%8C%E7%BB%91%E5%AE%9A%E5%8F%98%E9%87%8F-Free-and-bound-variables"><span class="toc-number">4.4.2.</span> <span class="toc-text">è‡ªç”±å˜é‡å’Œç»‘å®šå˜é‡(Free and bound variables)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8FExpressions"><span class="toc-number">4.5.</span> <span class="toc-text">è¡¨è¾¾å¼Expressions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6%E7%B1%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F-Super-expressions"><span class="toc-number">4.5.1.</span> <span class="toc-text">çˆ¶ç±»è¡¨è¾¾å¼(Super expressions)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E5%BC%8FFormulas"><span class="toc-number">4.6.</span> <span class="toc-text">å…¬å¼Formulas</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%BA%E5%BA%8F-Order"><span class="toc-number">4.6.1.</span> <span class="toc-text">é¡ºåº(Order)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3Annotations"><span class="toc-number">4.7.</span> <span class="toc-text">æ³¨è§£Annotations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">å‚è€ƒ</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&text=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&is_video=false&description=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°&body=Check out this article: https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&title=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&name=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://x2nn.github.io/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/&t=CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        Copyright &copy;
        
        
        2024-2025
        ğŸ’—
      </div>
      <div class="footer-right">
        <nav>
          <ul>
            <!--
          --><li><a href="/">Home</a></li><!--
        --><!--
          --><li><a href="/archives/">Writing</a></li><!--
        --><!--
          --><li><a href="/tags/">Tag</a></li><!--
        --><!--
          --><li><a href="/categories/">Category</a></li><!--
        --><!--
          --><li><a href="/search/">Search</a></li><!--
        --><!--
          --><li><a href="/about/">About</a></li><!--
        -->
          </ul>
          <ul>
            
              <!-- ä¸è’œå­ç»Ÿè®¡ -->
              <span id="busuanzi_container_site_pv">
                  æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
              </span>
              <span class="post-meta-divider">|</span>
              <span id="busuanzi_container_site_uv" style='display:none'>
                      æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº
              </span>
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            
          </ul>
        </nav>
      </div>
      
</footer>


    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
